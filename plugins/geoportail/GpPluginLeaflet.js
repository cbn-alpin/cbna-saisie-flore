/*!
 * @brief French Geoportal Extension for Leaflet
 *
 * This software is released under the licence CeCILL-B (Free BSD compatible)
 * @see http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt
 * @see http://www.cecill.info/licences/Licence_CeCILL-B_V1-fr.txt
 * @see http://www.cecill.info/
 *
 * @copyright copyright (c) IGN
 * @license CeCILL-B
 * @author IGN
 * @version 2.2.4
 * @date 23/03/2022
 *
 */
/*!
 * @overview  Proj4Leaflet - Smooth Proj4js integration with Leaflet
 * @copyright Copyright (c) 2012, Kartena AB
 * @license   BSD 2-Clause "Simplified" License
 *            See https://raw.githubusercontent.com/kartena/Proj4Leaflet/master/LICENSE
 * @version 1.0.2
 */
/*!
 * @overview  leaflet-draw - Vector drawing and editing plugin for Leaflet
 * @copyright Copyright (c) 2012-2017 Jon West, Jacob Toye, and Leaflet
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/Leaflet/Leaflet.draw/master/MIT-LICENSE.md
 * @version   1.0.4
 */
/*!
 * Sortable -- JavaScript library for reorderable drag-and-drop lists on modern
 * browsers and touch devices. No jQuery required. Supports Meteor, AngularJS,
 * React, Polymer, Vue, Knockout and any CSS library, e.g. Bootstrap.
 *
 * Released under MIT LICENSE
 *
 * Copyright Lebedev Konstantin <ibnRubaXa@gmail.com>
 * https://github.com/SortableJS/Sortable
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * @version 1.14.0
 */
/*!
 * @overview  es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4
 */
/*!
 * @overview   Proj4js - Javascript reprojection library.
 *
 * @authors
 * - Mike Adair madairATdmsolutions.ca
 * - Richard Greenwood richATgreenwoodmap.com
 * - Didier Richard didier.richardATign.fr
 * - Stephen Irons stephen.ironsATclear.net.nz
 * - Olivier Terral oterralATgmail.com
 * - Calvin Metcalf cmetcalfATappgeo.com
 *
 * @copyright Copyright (c) 2014, Mike Adair, Richard Greenwood, Didier Richard, Stephen Irons, Olivier Terral and Calvin Metcalf
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/proj4js/proj4js/master/LICENSE.md
 * @version   2.7.5
 */
!function (t, e) { "object" == typeof exports && "object" == typeof module ? module.exports = e(require("leaflet"), require("node-fetch"), require("xmldom")) : "function" == typeof define && define.amd ? define("Gp", ["leaflet", "require", "require"], e) : "object" == typeof exports ? exports.Gp = e(require("leaflet"), require("node-fetch"), require("xmldom")) : t.Gp = e(t.L, t[void 0], t[void 0]) }(this, (function (t, e, i) {
  return function (t) { var e = {}; function i(n) { if (e[n]) return e[n].exports; var o = e[n] = { i: n, l: !1, exports: {} }; return t[n].call(o.exports, o, o.exports, i), o.l = !0, o.exports } return i.m = t, i.c = e, i.d = function (t, e, n) { i.o(t, e) || Object.defineProperty(t, e, { enumerable: !0, get: n }) }, i.r = function (t) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(t, "__esModule", { value: !0 }) }, i.t = function (t, e) { if (1 & e && (t = i(t)), 8 & e) return t; if (4 & e && "object" == typeof t && t && t.__esModule) return t; var n = Object.create(null); if (i.r(n), Object.defineProperty(n, "default", { enumerable: !0, value: t }), 2 & e && "string" != typeof t) for (var o in t) i.d(n, o, function (e) { return t[e] }.bind(null, o)); return n }, i.n = function (t) { var e = t && t.__esModule ? function () { return t.default } : function () { return t }; return i.d(e, "a", e), e }, i.o = function (t, e) { return Object.prototype.hasOwnProperty.call(t, e) }, i.p = "", i(i.s = 0) }([function (t, e, i) { "use strict"; i.r(e), i.d(e, "Services", (function () { return g })), i.d(e, "Error", (function () { return _ })), i.d(e, "Helper", (function () { return v })), i.d(e, "Protocols", (function () { return y })), i.d(e, "servicesDate", (function () { return E })), i.d(e, "servicesVersion", (function () { return w })), i.d(e, "leafletExtVersion", (function () { return b })), i.d(e, "leafletExtDate", (function () { return P })); var n = i(1), o = i(2), s = i.n(o); i.d(e, "LExtended", (function () { return s.a })); i(3), i(21); var a = i(32), r = i(157), l = i(161), c = i(141), u = (i(167), i(40)), h = i(163); i.d(e, "LayerUtils", (function () { return h.default })); var d = i(168); i.d(e, "ProxyUtils", (function () { return d.default })); var p = i(169); i.d(e, "ColorUtils", (function () { return p.default })); var m = i(139); i.d(e, "MathUtils", (function () { return m.default })); var f = i(34); i.d(e, "Logger", (function () { return f.default })); var g = u.default.Services, _ = u.default.Error, v = u.default.Helper, y = u.default.Protocols, E = u.default.servicesDate, w = u.default.servicesVersion, b = n.leafletExtVersion || n.version, P = n.date; s.a.geoportalLayer = l.default, s.a.geoportalControl = a.default, s.a.geoportalControl.ElevationPath.DISPLAY_PROFILE_LIB_D3 = r.default.DISPLAY_PROFILE_LIB_D3, s.a.geoportalControl.ElevationPath.DISPLAY_PROFILE_LIB_AMCHARTS = r.default.DISPLAY_PROFILE_LIB_AMCHARTS, s.a.geoportalControl.ElevationPath.DISPLAY_PROFILE_RAW = r.default.DISPLAY_PROFILE_RAW, s.a.geoportalControl.ElevationPath.DISPLAY_PROFILE_BY_DEFAULT = r.default.DISPLAY_PROFILE_BY_DEFAULT, s.a.geoportalCRS = c.default, s.a.geoportalCRS.EPSG2154 = c.default.EPSG2154(), s.a.geoportalCRS.EPSG27572 = c.default.EPSG27572(), s.a.geoportalCRS.EPSG4326 = c.default.EPSG4326() }, function (t) { t.exports = JSON.parse('{"name":"geoportal-extensions","description":"French Geoportal Extensions for OpenLayers, Leaflet and iTowns libraries","version":"2.6.11","date":"23/03/2022","leafletExtName":"French Geoportal Extension for Leaflet","leafletExtVersion":"2.2.4","olExtName":"French Geoportal Extension for OpenLayers","olExtVersion":"3.2.10","itownsExtName":"French Geoportal Extension for Itowns","itownsExtVersion":"2.3.6","main":"dist/leaflet/GpPluginLeaflet.js, dist/openlayers/GpPluginOpenLayers.js, dist/itowns/GpPluginItowns.js","module":"src/Leaflet/index.js, src/OpenLayers/index.js, src/Itowns/index.js","directories":{},"scripts":{"setup":"npm install","clean":"echo \\"Warning: target not yet implemented!\\" && exit 0","eslint":"eslint src/","test":"npm run test:serve","test:serve":"cd test && webpack-dev-server --hot --config webpack.test.serve.js","sample":"npm run sample:serve","sample:serve":"npm run sample:ol:serve","sample:itowns:serve":"webpack-dev-server --config build/webpack/webpack.config.itowns --mode=development --https --open-page samples/index-itowns-map.html --content-base . --output-public-path \'/dist/itowns/\' --port 9001 --open","sample:leaflet:serve":"webpack-dev-server --config build/webpack/webpack.config.leaflet --mode=development --https --open-page samples/index-leaflet-map.html --content-base . --output-public-path \'/dist/leaflet/\' --port 9001 --open","sample:ol:serve":"webpack-dev-server --config build/webpack/webpack.config.openlayers --mode=development --https --open-page samples/index-openlayers-map.html --content-base . --output-public-path \'/dist/openlayers/\' --port 9001 --open","doc":"npm run doc:serve","doc:serve":"npm run doc:ol:serve","doc:itowns:serve":"webpack-dev-server --hot  --config build/webpack/webpack.config.itowns --content-base jsdoc/itowns --port 9001 --open","doc:leaflet:serve":"webpack-dev-server --hot  --config build/webpack/webpack.config.leaflet --content-base jsdoc/leaflet --port 9001 --open","doc:ol:serve":"webpack-dev-server --hot  --config build/webpack/webpack.config.openlayers --content-base jsdoc/openlayers --port 9001 --open","build:dev":"npm-run-all --print-label --print-name build:*:dev","build:prod":"npm-run-all --print-label --print-name build:*:prod","build:src":"npm-run-all --print-label --print-name build:*:src","build":"npm-run-all --print-label --print-name build:*:*","build:itowns":"npm-run-all --print-label --print-name build:itowns:*","build:itowns:dev":"webpack --config build/webpack/webpack.config.itowns --mode=development","build:itowns:prod":"webpack --config build/webpack/webpack.config.itowns --mode=production","build:itowns:src":"webpack --config build/webpack/webpack.config.itowns --mode=none","build:ol":"npm-run-all --print-label --print-name build:ol:*","build:ol:dev":"webpack --config build/webpack/webpack.config.openlayers --mode=development","build:ol:prod":"webpack --config build/webpack/webpack.config.openlayers --mode=production","build:ol:src":"webpack --config build/webpack/webpack.config.openlayers --mode=none","build:leaflet":"npm-run-all --print-label --print-name build:leaflet:*","build:leaflet:dev":"webpack --config build/webpack/webpack.config.leaflet --mode=development","build:leaflet:prod":"webpack --config build/webpack/webpack.config.leaflet --mode=production","build:leaflet:src":"webpack --config build/webpack/webpack.config.leaflet --mode=none"},"repository":{"type":"git","url":"https://github.com/IGNF/geoportal-extensions.git"},"author":"IGNF","keywords":["geoportail","javascript","OpenLayers","Leaflet","Itowns","3D"],"license":"CECILL-B","bugs":{"url":"https://github.com/IGNF/geoportal-extensions/issues"},"homepage":"https://github.com/IGNF/geoportal-extensions#readme","dependencies":{"@mapbox/mapbox-gl-style-spec":"13.20.1","eventbusjs":"0.2.0","geoportal-access-lib":"3.1.0","itowns":"2.37.0","leaflet":"1.7.1","leaflet-draw":"1.0.4","loglevel":"^1.6.7","markdown-toc":"^1.2.0","ol":"6.9.0","ol-mapbox-style":"6.7.0","proj4":"2.7.5","proj4leaflet":"1.0.2","sortablejs":"1.14.0","three":"0.135.0","whatwg-fetch":"3.0.0"},"devDependencies":{"@babel/core":"^7.4.4","@babel/plugin-transform-template-literals":"^7.7.4","@babel/preset-env":"^7.4.4","babel-loader":"^8.0.5","chai":"^4.2.0","chalk":"^4.0.0","clean-webpack-plugin":"^3.0.0","copy-webpack-plugin":"^5.0.3","core-js":"^3.6.4","css-loader":"^3.4.2","eslint":"^6.8.0","eslint-config-standard":"^14.1.1","eslint-loader":"^4.0.0","eslint-plugin-import":"^2.17.2","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^4.1.1","eslint-plugin-standard":"^4.0.0","exports-loader":"^0.7.0","expose-loader":"^0.7.5","fs-extra":"^9.0.0","handlebars":"^4.7.5","handlebars-layouts":"^3.1.4","html-webpack-plugin":"^4.0.4","jsdoc-webpack-plugin":"^0.3.0","mini-css-extract-plugin":"^0.9.0","mocha":"^7.1.1","mocha-loader":"^5.0.0","npm-run-all":"^4.1.5","optimize-css-assets-webpack-plugin":"^5.0.1","path":"^0.12.7","replace-bundle-webpack-plugin":"^1.0.0","requirejs":"^2.3.6","responsive-loader":"^1.2.0","speed-measure-webpack-plugin":"^1.3.0","string-template":"^1.0.0","style-loader":"^1.1.3","terser-webpack-plugin":"^2.0.0","url-loader":"^4.0.0","webpack":"^4.30.0","webpack-cli":"^3.3.1","webpack-dev-server":"^3.3.1","webpack-node-externals":"^1.7.2"}}') }, function (e, i) { e.exports = t }, function (t, e, i) { "use strict"; i.r(e); i(4), i(5), i(6), i(7), i(8), i(9), i(10), i(11), i(12), i(13), i(14), i(15), i(16), i(17), i(18), i(19), i(20) }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { "use strict"; i.r(e); i(22), i(23), i(24), i(25), i(26), i(27), i(28), i(29), i(30); i(31) }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { }, function (t, e, i) { "use strict"; i.r(e); var n = i(33), o = i(39), s = i(138), a = i(149), r = i(152), l = i(154), c = i(157), u = i(160), h = { LayerSwitcher: function (t) { return new n.default(t) }, Isocurve: function (t) { return new o.default(t) }, MousePosition: function (t) { return new s.default(t) }, ReverseGeocode: function (t) { return new a.default(t) }, Route: function (t) { return new r.default(t) }, SearchEngine: function (t) { return new l.default(t) }, ElevationPath: function (t) { return new c.default(t) }, Logo: function (t) { return new u.default(t) } }; e.default = h }, function (t, e, i) { "use strict"; i.r(e); var n = i(2), o = i.n(n), s = i(34), a = i(36), r = i(37), l = s.default.getLogger("layerswitcher"), c = o.a.Control.Layers.extend({ includes: r.default, options: { collapsed: !0, position: "topright", autoZIndex: !0, layers: [] }, initialize: function (t) { if (o.a.Util.setOptions(this, t), this._uid = a.default.generate(), this._hasLayersConfig = !(!this.options.layers || 0 === Object.keys(this.options.layers).length), this._layersConfig = this._hasLayersConfig ? this.options.layers : [], this._layers = {}, this._lastZIndex = 0, this._hasLayersConfig) for (var e = 0; e < this._layersConfig.length; e++) { var i = this._layersConfig[e]; this._addLayer(i.layer, null, !0) } }, onAdd: function (t) { var e = t._layers; if (0 !== Object.keys(e).length) { var i = Object.keys(e); this._lastZIndex = 0; for (var n = 0; n < i.length; n++) { var o = i[n]; this.options.autoZIndex && e[o].setZIndex && (this._lastZIndex++, e[o].setZIndex(this._lastZIndex)), this._hasLayersConfig && this._layers[o] || this.addOverlay(e[o]) } } if (0 === Object.keys(e).length) { var s = this._layersConfig; this._lastZIndex = 0; for (var a = 0; a < s.length; a++) { var r = s[a].layer; t.hasLayer(r) || (t.addLayer(r), this.addOverlay(r, null), this.options.autoZIndex && r.setZIndex && (this._lastZIndex++, r.setZIndex(this._lastZIndex))) } } for (var c in this._layers) if (this._layers.hasOwnProperty(c)) { var u = this._layers[c], h = u.layer; u.visibility || this._updateVisibilityLayer(h) } return this._initLayout(), this._update(), t.on("layeradd", this._onLayerChange, this), t.on("layerremove", this._onLayerChange, this), t.eachLayer((function (t) { t.on("visibilitychange", (function () { l.trace("visibilitychange", t) }), this), t.on("attributionchange", (function () { l.trace("attributionchange", t) }), this) })), this._container }, _addLayer: function (t, e, i) { var n = t._geoportal_id ? t._geoportal_id : t._leaflet_id; if (void 0 !== n) { var s = {}; for (var a in this._layersConfig) if (this._layersConfig.hasOwnProperty(a) && n === o.a.stamp(this._layersConfig[a].layer)) { if (s = this._layersConfig[a].config, !(void 0 === this._layersConfig[a].display || this._layersConfig[a].display)) return; break } this._layers[n] = { layer: t, id: n, overlay: i, title: t._geoportal_id && t._title ? t._title : e || n, description: t._geoportal_id && t._description ? t._description : e || n, visibility: !0, legends: t._geoportal_id ? t._legends : null, metadata: t._geoportal_id ? t._metadata : null, quicklookUrl: t._geoportal_id ? t._quicklookUrl : null }, s && Object.keys(s).length && o.a.Util.extend(this._layers[n], s); var r = this._layers[n].visibility; t._geoportal_id && t.setVisible(r), r || this._updateVisibilityLayer(t) } }, addTo: function (t) { return o.a.Control.prototype.addTo.call(this, t), this }, _initLayout: function () { var t = this._container = this._createMainContainerElement(), e = this._createMainLayersShowElement(); t.appendChild(e), this.options.collapsed || (e.checked = !0); var i = this._overlaysList = this._createMainLayersElement(); t.appendChild(i); var n = this._createMainPictoElement(); t.appendChild(n); var s = this._createMainInfoElement(); switch (t.appendChild(s), this._createDraggableElement(this._overlaysList, this), o.a.DomEvent.disableClickPropagation(t).disableScrollPropagation(t), this._map.on("moveend", this._onOutOfRangeLayerZoom, this), this.getPosition()) { case "topright": case "bottomright": default: t.style.position = "relative", t.style.top = "0", t.style.right = "0"; break; case "topleft": case "bottomleft": t.style.position = "relative", t.style.top = "0", t.style.right = "initial", n.style.float = "left", i.style.borderBottomRightRadius = "5px", i.style.borderBottomLeftRadius = "0", s.style.right = "initial", s.style.left = "190px" } }, _update: function () { if (this._container) { this._overlaysList.innerHTML = ""; var t = []; for (var e in this._layers) this._layers.hasOwnProperty(e) && t.push(e); for (var i = t.sort((function (t, e) { return parseInt(t, 10) - parseInt(e, 10) })).reverse(), n = 0; n < i.length; n++) { var o = i[n], s = this._layers[o]; this._addItem(s) } } }, _addItem: function (t) { l.log("_addItem", t), t.opacity = t.layer.options.opacity; var e = this._createContainerLayerElement(t); return t.layer.options.minZoom > this._map.getZoom() || t.layer.options.maxZoom < this._map.getZoom() ? o.a.DomUtil.addClass(e, "outOfRange") : o.a.DomUtil.removeClass(e, "outOfRange"), this._overlaysList.appendChild(e), e }, _onLayerChange: function (t) { var e = this._layers[o.a.stamp(t.layer)]; e && (this._handlingClick || this._update(), this._map.fire("layeradd" === t.type ? "overlayadd" : "overlayremove", e)) }, removeLayer: function (t) { var e = o.a.stamp(t); delete this._layers[e], this._update(); var i = this._map; return i && i.hasLayer(t) && i.removeLayer(t), this }, _updateVisibilityLayer: function (t) { if (this._map) { this._handlingClick = !0; var e = this._layers[o.a.stamp(t)].visibility; e && !this._map.hasLayer(t) ? this._map.addLayer(t) : !e && this._map.hasLayer(t) ? this._map.removeLayer(t) : l.log("Status unknown layer !?"), this._handlingClick = !1, this._refocusOnMap() } }, _updateVisibilityDOMLayer: function (t) { var e = o.a.stamp(t), i = o.a.DomUtil.get(this._addUID("GPvisibility_ID_" + e)), n = this._layers[e].visibility; i.checked = n }, _updateOpacityDOMLayer: function (t) { var e = o.a.stamp(t), i = t.options.opacity, n = o.a.DomUtil.get(this._addUID("GPopacityValue_ID_" + e)); n.innerHTML = parseInt(100 * i, 10) + "%", n.value = parseInt(100 * i, 10) }, _onOutOfRangeLayerZoom: function () { var t = this._map, e = this._layers; for (var i in e) if (e.hasOwnProperty(i)) { var n = e[i].layer, s = e[i].id, a = o.a.DomUtil.get(this._addUID("GPlayerSwitcher_ID_" + s)); n.options.minZoom > t.getZoom() || n.options.maxZoom < t.getZoom() ? o.a.DomUtil.addClass(a, "outOfRange") : o.a.DomUtil.removeClass(a, "outOfRange") } }, _onVisibilityLayerClick: function (t) { var e = t.target.id, i = a.default.index(e); this._layers[i].visibility = o.a.DomUtil.get(e).checked; var n = this._layers[i].layer; this._updateVisibilityLayer(n) }, _onDropLayerClick: function (t) { var e = t.target.id, i = a.default.index(e), n = this._layers[i].layer; this.removeLayer(n) }, _onChangeLayerOpacity: function (t) { var e = t.target.id, i = a.default.index(e), n = this._layers[i].layer, s = t.target.value; o.a.DomUtil.get(this._addUID("GPopacityValue_ID_" + i)).innerHTML = s + "%", this._map.hasLayer(n) && (void 0 !== n.setOpacity ? n.setOpacity(s / 100) : n.setStyle({ fillOpacity: s / 100, opacity: s / 100 })) }, _onOpenLayerInfoClick: function (t) { var e = t.target.id, i = a.default.index(e), n = this._layers[i], s = o.a.DomUtil.get(t.target.id), r = null, l = null; if ("GPlayerInfoOpened" === s.className) return o.a.DomUtil.removeClass(s, "GPlayerInfoOpened"), o.a.DomUtil.addClass(s, "GPlayerInfo"), r = o.a.DomUtil.get(this._addUID("GPlayerInfoPanel")), o.a.DomUtil.removeClass(r, "GPpanel"), o.a.DomUtil.removeClass(r, "GPlayerInfoPanelOpened"), o.a.DomUtil.addClass(r, "GPlayerInfoPanelClosed"), l = o.a.DomUtil.get(this._addUID("GPlayerInfoContent")), void r.removeChild(l); for (var c = document.getElementsByClassName("GPlayerInfoOpened"), u = 0; u < c.length; u++)c[u].className = "GPlayerInfo"; o.a.DomUtil.removeClass(s, "GPlayerInfo"), o.a.DomUtil.addClass(s, "GPlayerInfoOpened"), r = o.a.DomUtil.get(this._addUID("GPlayerInfoPanel")), o.a.DomUtil.addClass(r, "GPpanel"), o.a.DomUtil.removeClass(r, "GPlayerInfoPanelClosed"), o.a.DomUtil.addClass(r, "GPlayerInfoPanelOpened"), (l = o.a.DomUtil.get(this._addUID("GPlayerInfoContent"))) && r.removeChild(l); var h = this._createContainerLayerInfoElement(n); r.appendChild(h) }, _onDragAndDropLayerClick: function (t) { var e = t.target.id, i = a.default.index(e), n = this._layers[i]; l.log(n); var o = document.querySelectorAll("div.GPlayerSwitcher_layer"); this._lastZIndex = o.length; for (var s = 0; s < o.length; s++) { var r = o[s].id, c = a.default.index(r), u = this._layers[c].layer; this.options.autoZIndex && u.setZIndex && (this._lastZIndex--, u.setZIndex(this._lastZIndex)) } }, addLayer: function (t, e) { var i = this._map, n = this._layersConfig; if (t) { i.hasLayer(t) || (l.log("[WARN] LayerSwitcher:addLayer - layer has not been added on map !"), i.addLayer(t)); var s = o.a.stamp(t); for (var a in n) if (n.hasOwnProperty(a) && s === o.a.stamp(n[a].layer)) { delete n[a]; break } var r = e || {}; o.a.Util.extend(r, { layer: t }), n.push(r), this._layers[s] || t.setZIndex(this._lastZIndex++), this.addOverlay(t), this._update() } else l.log("[ERROR] LayerSwitcher:addLayer - missing layer parameter !") }, setOpacity: function (t, e) { l.trace(t, e), e > 1 || e < 0 || this._map.hasLayer(t) && (void 0 !== t.setOpacity ? t.setOpacity(e) : (t.options.opacity = e, t.setStyle({ fillOpacity: e, opacity: e })), this._updateOpacityDOMLayer(t)) }, setVisibility: function (t, e) { l.trace(t, e), this._layers[o.a.stamp(t)].visibility = e, this._updateVisibilityDOMLayer(t), this._updateVisibilityLayer(t) } }); e.default = c }, function (t, e, i) { "use strict"; i.r(e); var n = i(35), o = { getLogger: function (t) { "false".match(/true/) ? n.disableAll() : n.enableAll(); var e = t || "default"; return n.getLogger(e) }, disableAll: function () { var t = n.getLoggers(); for (var e in t) { if (Object.hasOwnProperty.call(t, e)) t[e].disableAll() } }, enableAll: function () { var t = n.getLoggers(); for (var e in t) { if (Object.hasOwnProperty.call(t, e)) t[e].enableAll() } } }; e.default = o }, function (t, e, i) { var n, o; !function (s, a) { "use strict"; n = function () { var t = function () { }, e = "undefined", i = typeof window !== e && typeof window.navigator !== e && /Trident\/|MSIE /.test(window.navigator.userAgent), n = ["trace", "debug", "info", "warn", "error"]; function o(t, e) { var i = t[e]; if ("function" == typeof i.bind) return i.bind(t); try { return Function.prototype.bind.call(i, t) } catch (e) { return function () { return Function.prototype.apply.apply(i, [t, arguments]) } } } function s() { console.log && (console.log.apply ? console.log.apply(console, arguments) : Function.prototype.apply.apply(console.log, [console, arguments])), console.trace && console.trace() } function a(n) { return "debug" === n && (n = "log"), typeof console !== e && ("trace" === n && i ? s : void 0 !== console[n] ? o(console, n) : void 0 !== console.log ? o(console, "log") : t) } function r(e, i) { for (var o = 0; o < n.length; o++) { var s = n[o]; this[s] = o < e ? t : this.methodFactory(s, e, i) } this.log = this.debug } function l(t, i, n) { return function () { typeof console !== e && (r.call(this, i, n), this[t].apply(this, arguments)) } } function c(t, e, i) { return a(t) || l.apply(this, arguments) } function u(t, i, o) { var s, a = this; i = null == i ? "WARN" : i; var l = "loglevel"; function u(t) { var i = (n[t] || "silent").toUpperCase(); if (typeof window !== e && l) { try { return void (window.localStorage[l] = i) } catch (t) { } try { window.document.cookie = encodeURIComponent(l) + "=" + i + ";" } catch (t) { } } } function h() { var t; if (typeof window !== e && l) { try { t = window.localStorage[l] } catch (t) { } if (typeof t === e) try { var i = window.document.cookie, n = i.indexOf(encodeURIComponent(l) + "="); -1 !== n && (t = /^([^;]+)/.exec(i.slice(n))[1]) } catch (t) { } return void 0 === a.levels[t] && (t = void 0), t } } function d() { if (typeof window !== e && l) { try { return void window.localStorage.removeItem(l) } catch (t) { } try { window.document.cookie = encodeURIComponent(l) + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC" } catch (t) { } } } "string" == typeof t ? l += ":" + t : "symbol" == typeof t && (l = void 0), a.name = t, a.levels = { TRACE: 0, DEBUG: 1, INFO: 2, WARN: 3, ERROR: 4, SILENT: 5 }, a.methodFactory = o || c, a.getLevel = function () { return s }, a.setLevel = function (i, n) { if ("string" == typeof i && void 0 !== a.levels[i.toUpperCase()] && (i = a.levels[i.toUpperCase()]), !("number" == typeof i && i >= 0 && i <= a.levels.SILENT)) throw "log.setLevel() called with invalid level: " + i; if (s = i, !1 !== n && u(i), r.call(a, i, t), typeof console === e && i < a.levels.SILENT) return "No console available for logging" }, a.setDefaultLevel = function (t) { i = t, h() || a.setLevel(t, !1) }, a.resetLevel = function () { a.setLevel(i, !1), d() }, a.enableAll = function (t) { a.setLevel(a.levels.TRACE, t) }, a.disableAll = function (t) { a.setLevel(a.levels.SILENT, t) }; var p = h(); null == p && (p = i), a.setLevel(p, !1) } var h = new u, d = {}; h.getLogger = function (t) { if ("symbol" != typeof t && "string" != typeof t || "" === t) throw new TypeError("You must supply a name when creating a logger."); var e = d[t]; return e || (e = d[t] = new u(t, h.getLevel(), h.methodFactory)), e }; var p = typeof window !== e ? window.log : void 0; return h.noConflict = function () { return typeof window !== e && window.log === h && (window.log = p), h }, h.getLoggers = function () { return d }, h.default = h, h }, void 0 === (o = "function" == typeof n ? n.call(e, i, e, t) : n) || (t.exports = o) }() }, function (t, e, i) { "use strict"; i.r(e); var n, o = { generate: (n = Math.floor(Date.now()), function () { return n++ }), name: function (t) { var e = null, i = t.lastIndexOf("-"); return e = -1 === i ? t : t.substring(0, i), e }, index: function (t) { var e = null, i = this.name(t), n = i.lastIndexOf("_"); return -1 !== n && (e = i.substring(n + 1)), e }, uuid: function (t) { var e = null, i = t.lastIndexOf("-"); return -1 !== i && (e = parseInt(t.substring(i + 1), 10)), e } }; e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(38), o = { _createDraggableElement: function (t, e) { navigator.userAgent.match(/chrome|chromium|crios/i) ? n.default.create(t, { handle: ".GPlayerName", draggable: ".draggable-layer", ghostClass: "GPghostLayer", animation: 200, forceFallback: !0, onEnd: function (t) { e._onDragAndDropLayerClick(t) } }) : n.default.create(t, { handle: ".GPlayerName", draggable: ".draggable-layer", ghostClass: "GPghostLayer", animation: 200, onEnd: function (t) { e._onDragAndDropLayerClick(t) } }) }, _addUID: function (t) { return this._uid ? t + "-" + this._uid : t }, _createMainContainerElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPlayerSwitcher"), t.className = "GPwidget", t }, _createMainLayersShowElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPshowLayersList"), t.type = "checkbox", t }, _createMainLayersElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPlayersList"), t.className = "GPpanel", t }, _createMainPictoElement: function () { var t = this, e = document.createElement("label"); e.id = this._addUID("GPshowLayersListPicto"), e.className = "GPshowAdvancedToolPicto", e.htmlFor = this._addUID("GPshowLayersList"), e.title = "Afficher/masquer le gestionnaire de couches"; var i = document.createElement("span"); i.id = this._addUID("GPshowLayersListOpen"), i.className = "GPshowAdvancedToolOpen", i.addEventListener("click", (function () { if (document.getElementById(t._addUID("GPshowLayersList")).checked) { for (var e = document.getElementsByClassName("GPlayerInfoOpened"), i = 0; i < e.length; i++)e[i].className = "GPlayerInfo"; document.getElementById(t._addUID("GPlayerInfoPanel")).className = "GPlayerInfoPanelClosed" } })), e.appendChild(i); var n = document.createElement("span"); return n.addEventListener("click", (function () { if (document.getElementById(t._addUID("GPshowLayersList")).checked) { for (var e = document.getElementsByClassName("GPlayerInfoOpened"), i = 0; i < e.length; i++)e[i].className = "GPlayerInfo"; document.getElementById(t._addUID("GPlayerInfoPanel")).className = "GPlayerInfoPanelClosed" } })), n.id = t._addUID("GPshowLayersListClose"), e.appendChild(n), e }, _createMainInfoElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPlayerInfoPanel"), t.className = "GPpanel GPlayerInfoPanelClosed", t }, _createContainerLayerElement: function (t) { var e = document.createElement("div"); e.id = this._addUID("GPlayerSwitcher_ID_" + t.id), e.className = "GPlayerSwitcher_layer draggable-layer", e.appendChild(this._createBasicToolElement(t)); for (var i = this._createAdvancedToolShowElement(t), n = 0; n < i.length; n++)e.appendChild(i[n]); return e.appendChild(this._createAdvancedToolElement(t)), e }, _createBasicToolElement: function (t) { var e = document.createElement("div"); e.id = this._addUID("GPbasicTools_ID_" + t.id), e.className = "GPlayerBasicTools", e.appendChild(this._createBasicToolNameElement(t)); for (var i = this._createBasicToolVisibilityElement(t), n = 0; n < i.length; n++)e.appendChild(i[n]); return e }, _createBasicToolNameElement: function (t) { var e = document.createElement("span"); return e.id = this._addUID("GPname_ID_" + t.id), e.className = "GPlayerName", e.title = t.description || t.title, e.innerHTML = t.title, e }, _createBasicToolVisibilityElement: function (t) { var e = [], i = void 0 === t.visibility || t.visibility, n = this._addUID("GPvisibility_ID_" + t.id), o = document.createElement("input"); o.id = n, o.type = "checkbox", o.checked = i; var s = document.createElement("label"); s.htmlFor = n, s.id = this._addUID("GPvisibilityPicto_ID_" + t.id), s.className = "GPlayerVisibility", s.title = "Afficher/masquer la couche"; var a = this; return o.addEventListener ? o.addEventListener("click", (function (t) { a._onVisibilityLayerClick(t) })) : o.attachEvent && o.attachEvent("onclick", (function (t) { a._onVisibilityLayerClick(t) })), e.push(o), e.push(s), e }, _createAdvancedToolShowElement: function (t) { var e = [], i = document.createElement("label"); i.id = this._addUID("GPshowAdvancedToolsPicto_ID_" + t.id), i.htmlFor = this._addUID("GPshowAdvancedTools_ID_" + t.id), i.title = "Plus d'outils", i.className = "GPshowMoreOptions GPshowLayerAdvancedTools"; var n = document.createElement("input"); return n.type = "checkbox", n.id = this._addUID("GPshowAdvancedTools_ID_" + t.id), e.push(n), e.push(i), e }, _createAdvancedToolElement: function (t) { var e = document.createElement("div"); if (e.id = this._addUID("GPadvancedTools_ID_" + t.id), e.className = "GPlayerAdvancedTools", e.appendChild(this._createAdvancedToolDeleteElement(t)), t.title && t.description && e.appendChild(this._createAdvancedToolInformationElement(t)), "feature" !== t.type) for (var i = this._createAdvancedToolOpacityElement(t), n = 0; n < i.length; n++)e.appendChild(i[n]); return e }, _createAdvancedToolDeleteElement: function (t) { var e = document.createElement("div"); e.id = this._addUID("GPremove_ID_" + t.id), e.className = "GPlayerRemove", e.title = "Supprimer la couche", e.layerId = t.id; var i = this; return e.addEventListener ? e.addEventListener("click", (function (t) { i._onDropLayerClick(t) })) : e.attachEvent && e.attachEvent("onclick", (function (t) { i._onDropLayerClick(t) })), e }, _createAdvancedToolInformationElement: function (t) { var e = document.createElement("div"); e.id = this._addUID("GPinfo_ID_" + t.id), e.className = "GPlayerInfo", e.title = "Informations/légende", e.layerId = t.id; var i = this; return e.addEventListener ? e.addEventListener("click", (function (t) { i._onOpenLayerInfoClick(t) })) : e.attachEvent && e.attachEvent("onclick", (function (t) { i._onOpenLayerInfoClick(t) })), e }, _createAdvancedToolOpacityElement: function (t) { var e = [], i = document.createElement("div"); i.id = this._addUID("GPopacity_ID_" + t.id), i.className = "GPlayerOpacity", i.title = "Opacité"; var n = void 0 !== t.opacity ? t.opacity : 1; n = Math.round(100 * n); var o = document.createElement("input"); o.id = this._addUID("GPopacityValueDiv_ID_" + t.id), o.type = "range", o.value = n; var s = this; o.addEventListener ? o.addEventListener("change", (function (t) { s._onChangeLayerOpacity(t) })) : o.attachEvent && o.attachEvent("onchange", (function (t) { s._onChangeLayerOpacity(t) })), o.addEventListener ? o.addEventListener("input", (function (t) { s._onChangeLayerOpacity(t) })) : o.attachEvent && o.attachEvent("oninput", (function (t) { s._onChangeLayerOpacity(t) })), i.appendChild(o); var a = document.createElement("div"); a.id = this._addUID("GPopacityValueDiv_ID_" + t.id), a.className = "GPlayerOpacityValue"; var r = document.createElement("span"); return r.id = this._addUID("GPopacityValue_ID_" + t.id), r.innerHTML = n + "%", a.appendChild(r), e.push(i), e.push(a), e }, _createContainerLayerInfoElement: function (t) { var e = document.createElement("div"); e.id = this._addUID("GPlayerInfoContent"); var i = document.createElement("div"); if (i.id = this._addUID("GPlayerInfoTitle"), i.innerHTML = t.title, e.appendChild(i), t.quicklookUrl) { var n = document.createElement("div"); n.id = this._addUID("GPlayerInfoQuicklook"), n.title = "Afficher un aperçu de la couche"; var o = document.createElement("a"); o.href = t.quicklookUrl, o.appendChild(n), e.appendChild(o) } var s = document.createElement("div"); s.id = this._addUID("GPlayerInfoClose"), s.title = "Fermer la fenêtre"; var a = this, r = function () { document.getElementById(a._addUID("GPlayerInfoPanel")).className = "GPlayerInfoPanelClosed"; for (var t = document.getElementsByClassName("GPlayerInfoOpened"), e = 0; e < t.length; e++)t[e].className = "GPlayerInfo" }; s.addEventListener ? s.addEventListener("click", r) : s.attachEvent && s.attachEvent("onclick", r), e.appendChild(s); var l = document.createElement("div"); if (l.id = this._addUID("GPlayerInfoDescription"), l.innerHTML = t.description, e.appendChild(l), t.metadata) { var c = document.createElement("div"); c.id = this._addUID("GPlayerInfoMetadata"); var u = document.createElement("div"); u.className = "GPlayerInfoSubtitle", u.innerHTML = "Métadonnées", c.appendChild(u); for (var h = 0; h < t.metadata.length; h++) { var d = t.metadata[h].url, p = document.createElement("div"); p.className = "GPlayerInfoLink"; var m = document.createElement("a"); m.href = d, m.innerHTML = d, p.appendChild(m), c.appendChild(p) } 0 !== t.metadata.length && e.appendChild(c) } if (t.legends) { var f = document.createElement("div"); f.id = this._addUID("GPlayerInfoLegend"); var g = document.createElement("div"); g.className = "GPlayerInfoSubtitle", g.innerHTML = "Légende", f.appendChild(g); for (var _ = {}, v = t.maxScaleDenominator || 56e7, y = 0; y < t.legends.length; y++) { var E = t.legends[y].minScaleDenominator; if (E) { var w = E.toString(); E = Math.round(parseInt(w.substring(0, 3), 10) / 10) * Math.pow(10, w.length - 2) } else E = 270; _[E] = t.legends[y] } for (var b in _) if (_.hasOwnProperty(b)) { var P = _[b].url; if ("string" == typeof P && -1 === P.toLowerCase().indexOf("nolegend.jpg")) { var C = document.createElement("div"); C.className = "GPlayerInfoLink", v = _[b].maxScaleDenominator || v; var M = document.createElement("a"); M.href = P, M.innerHTML = "Du 1/" + b + " au 1/" + v, C.appendChild(M), f.appendChild(C) } else delete _[b] } 0 !== Object.keys(_).length && e.appendChild(f) } return e } }; e.default = o }, function (t, e, i) {
    "use strict";
    /**!
     * Sortable 1.14.0
     * @author  RubaXa   <trash@rubaxa.org>
     * @author  owenm    <owen23355@gmail.com>
     * @license MIT
     */
    function n(t, e) { var i = Object.keys(t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(t); e && (n = n.filter((function (e) { return Object.getOwnPropertyDescriptor(t, e).enumerable }))), i.push.apply(i, n) } return i } function o(t) { for (var e = 1; e < arguments.length; e++) { var i = null != arguments[e] ? arguments[e] : {}; e % 2 ? n(Object(i), !0).forEach((function (e) { a(t, e, i[e]) })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(i)) : n(Object(i)).forEach((function (e) { Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(i, e)) })) } return t } function s(t) { return s = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, s(t) } function a(t, e, i) { return e in t ? Object.defineProperty(t, e, { value: i, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = i, t } function r() { return r = Object.assign || function (t) { for (var e = 1; e < arguments.length; e++) { var i = arguments[e]; for (var n in i) Object.prototype.hasOwnProperty.call(i, n) && (t[n] = i[n]) } return t }, r.apply(this, arguments) } function l(t, e) { if (null == t) return {}; var i, n, o = function (t, e) { if (null == t) return {}; var i, n, o = {}, s = Object.keys(t); for (n = 0; n < s.length; n++)i = s[n], e.indexOf(i) >= 0 || (o[i] = t[i]); return o }(t, e); if (Object.getOwnPropertySymbols) { var s = Object.getOwnPropertySymbols(t); for (n = 0; n < s.length; n++)i = s[n], e.indexOf(i) >= 0 || Object.prototype.propertyIsEnumerable.call(t, i) && (o[i] = t[i]) } return o } function c(t) { return function (t) { if (Array.isArray(t)) return u(t) }(t) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (!t) return; if ("string" == typeof t) return u(t, e); var i = Object.prototype.toString.call(t).slice(8, -1); "Object" === i && t.constructor && (i = t.constructor.name); if ("Map" === i || "Set" === i) return Array.from(t); if ("Arguments" === i || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)) return u(t, e) }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function u(t, e) { (null == e || e > t.length) && (e = t.length); for (var i = 0, n = new Array(e); i < e; i++)n[i] = t[i]; return n } i.r(e), i.d(e, "MultiDrag", (function () { return be })), i.d(e, "Sortable", (function () { return qt })), i.d(e, "Swap", (function () { return he })); function h(t) { if ("undefined" != typeof window && window.navigator) return !!navigator.userAgent.match(t) } var d = h(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i), p = h(/Edge/i), m = h(/firefox/i), f = h(/safari/i) && !h(/chrome/i) && !h(/android/i), g = h(/iP(ad|od|hone)/i), _ = h(/chrome/i) && h(/android/i), v = { capture: !1, passive: !1 }; function y(t, e, i) { t.addEventListener(e, i, !d && v) } function E(t, e, i) { t.removeEventListener(e, i, !d && v) } function w(t, e) { if (e) { if (">" === e[0] && (e = e.substring(1)), t) try { if (t.matches) return t.matches(e); if (t.msMatchesSelector) return t.msMatchesSelector(e); if (t.webkitMatchesSelector) return t.webkitMatchesSelector(e) } catch (t) { return !1 } return !1 } } function b(t) { return t.host && t !== document && t.host.nodeType ? t.host : t.parentNode } function P(t, e, i, n) { if (t) { i = i || document; do { if (null != e && (">" === e[0] ? t.parentNode === i && w(t, e) : w(t, e)) || n && t === i) return t; if (t === i) break } while (t = b(t)) } return null } var C, M = /\s+/g; function S(t, e, i) { if (t && e) if (t.classList) t.classList[i ? "add" : "remove"](e); else { var n = (" " + t.className + " ").replace(M, " ").replace(" " + e + " ", " "); t.className = (n + (i ? " " + e : "")).replace(M, " ") } } function L(t, e, i) { var n = t && t.style; if (n) { if (void 0 === i) return document.defaultView && document.defaultView.getComputedStyle ? i = document.defaultView.getComputedStyle(t, "") : t.currentStyle && (i = t.currentStyle), void 0 === e ? i : i[e]; e in n || -1 !== e.indexOf("webkit") || (e = "-webkit-" + e), n[e] = i + ("string" == typeof i ? "" : "px") } } function x(t, e) { var i = ""; if ("string" == typeof t) i = t; else do { var n = L(t, "transform"); n && "none" !== n && (i = n + " " + i) } while (!e && (t = t.parentNode)); var o = window.DOMMatrix || window.WebKitCSSMatrix || window.CSSMatrix || window.MSCSSMatrix; return o && new o(i) } function G(t, e, i) { if (t) { var n = t.getElementsByTagName(e), o = 0, s = n.length; if (i) for (; o < s; o++)i(n[o], o); return n } return [] } function I() { var t = document.scrollingElement; return t || document.documentElement } function R(t, e, i, n, o) { if (t.getBoundingClientRect || t === window) { var s, a, r, l, c, u, h; if (t !== window && t.parentNode && t !== I() ? (a = (s = t.getBoundingClientRect()).top, r = s.left, l = s.bottom, c = s.right, u = s.height, h = s.width) : (a = 0, r = 0, l = window.innerHeight, c = window.innerWidth, u = window.innerHeight, h = window.innerWidth), (e || i) && t !== window && (o = o || t.parentNode, !d)) do { if (o && o.getBoundingClientRect && ("none" !== L(o, "transform") || i && "static" !== L(o, "position"))) { var p = o.getBoundingClientRect(); a -= p.top + parseInt(L(o, "border-top-width")), r -= p.left + parseInt(L(o, "border-left-width")), l = a + s.height, c = r + s.width; break } } while (o = o.parentNode); if (n && t !== window) { var m = x(o || t), f = m && m.a, g = m && m.d; m && (l = (a /= g) + (u /= g), c = (r /= f) + (h /= f)) } return { top: a, left: r, bottom: l, right: c, width: h, height: u } } } function A(t, e, i) { for (var n = N(t, !0), o = R(t)[e]; n;) { var s = R(n)[i]; if (!("top" === i || "left" === i ? o >= s : o <= s)) return n; if (n === I()) break; n = N(n, !1) } return !1 } function k(t, e, i, n) { for (var o = 0, s = 0, a = t.children; s < a.length;) { if ("none" !== a[s].style.display && a[s] !== qt.ghost && (n || a[s] !== qt.dragged) && P(a[s], i.draggable, t, !1)) { if (o === e) return a[s]; o++ } s++ } return null } function T(t, e) { for (var i = t.lastElementChild; i && (i === qt.ghost || "none" === L(i, "display") || e && !w(i, e));)i = i.previousElementSibling; return i || null } function D(t, e) { var i = 0; if (!t || !t.parentNode) return -1; for (; t = t.previousElementSibling;)"TEMPLATE" === t.nodeName.toUpperCase() || t === qt.clone || e && !w(t, e) || i++; return i } function O(t) { var e = 0, i = 0, n = I(); if (t) do { var o = x(t), s = o.a, a = o.d; e += t.scrollLeft * s, i += t.scrollTop * a } while (t !== n && (t = t.parentNode)); return [e, i] } function N(t, e) { if (!t || !t.getBoundingClientRect) return I(); var i = t, n = !1; do { if (i.clientWidth < i.scrollWidth || i.clientHeight < i.scrollHeight) { var o = L(i); if (i.clientWidth < i.scrollWidth && ("auto" == o.overflowX || "scroll" == o.overflowX) || i.clientHeight < i.scrollHeight && ("auto" == o.overflowY || "scroll" == o.overflowY)) { if (!i.getBoundingClientRect || i === document.body) return I(); if (n || e) return i; n = !0 } } } while (i = i.parentNode); return I() } function U(t, e) { return Math.round(t.top) === Math.round(e.top) && Math.round(t.left) === Math.round(e.left) && Math.round(t.height) === Math.round(e.height) && Math.round(t.width) === Math.round(e.width) } function j(t, e) { return function () { if (!C) { var i = arguments; 1 === i.length ? t.call(this, i[0]) : t.apply(this, i), C = setTimeout((function () { C = void 0 }), e) } } } function F(t, e, i) { t.scrollLeft += e, t.scrollTop += i } function B(t) { var e = window.Polymer, i = window.jQuery || window.Zepto; return e && e.dom ? e.dom(t).cloneNode(!0) : i ? i(t).clone(!0)[0] : t.cloneNode(!0) } function z(t, e) { L(t, "position", "absolute"), L(t, "top", e.top), L(t, "left", e.left), L(t, "width", e.width), L(t, "height", e.height) } function q(t) { L(t, "position", ""), L(t, "top", ""), L(t, "left", ""), L(t, "width", ""), L(t, "height", "") } var H = "Sortable" + (new Date).getTime(); function W() { var t, e = []; return { captureAnimationState: function () { (e = [], this.options.animation) && [].slice.call(this.el.children).forEach((function (t) { if ("none" !== L(t, "display") && t !== qt.ghost) { e.push({ target: t, rect: R(t) }); var i = o({}, e[e.length - 1].rect); if (t.thisAnimationDuration) { var n = x(t, !0); n && (i.top -= n.f, i.left -= n.e) } t.fromRect = i } })) }, addAnimationState: function (t) { e.push(t) }, removeAnimationState: function (t) { e.splice(function (t, e) { for (var i in t) if (t.hasOwnProperty(i)) for (var n in e) if (e.hasOwnProperty(n) && e[n] === t[i][n]) return Number(i); return -1 }(e, { target: t }), 1) }, animateAll: function (i) { var n = this; if (!this.options.animation) return clearTimeout(t), void ("function" == typeof i && i()); var o = !1, s = 0; e.forEach((function (t) { var e = 0, i = t.target, a = i.fromRect, r = R(i), l = i.prevFromRect, c = i.prevToRect, u = t.rect, h = x(i, !0); h && (r.top -= h.f, r.left -= h.e), i.toRect = r, i.thisAnimationDuration && U(l, r) && !U(a, r) && (u.top - r.top) / (u.left - r.left) == (a.top - r.top) / (a.left - r.left) && (e = function (t, e, i, n) { return Math.sqrt(Math.pow(e.top - t.top, 2) + Math.pow(e.left - t.left, 2)) / Math.sqrt(Math.pow(e.top - i.top, 2) + Math.pow(e.left - i.left, 2)) * n.animation }(u, l, c, n.options)), U(r, a) || (i.prevFromRect = a, i.prevToRect = r, e || (e = n.options.animation), n.animate(i, u, r, e)), e && (o = !0, s = Math.max(s, e), clearTimeout(i.animationResetTimer), i.animationResetTimer = setTimeout((function () { i.animationTime = 0, i.prevFromRect = null, i.fromRect = null, i.prevToRect = null, i.thisAnimationDuration = null }), e), i.thisAnimationDuration = e) })), clearTimeout(t), o ? t = setTimeout((function () { "function" == typeof i && i() }), s) : "function" == typeof i && i(), e = [] }, animate: function (t, e, i, n) { if (n) { L(t, "transition", ""), L(t, "transform", ""); var o = x(this.el), s = o && o.a, a = o && o.d, r = (e.left - i.left) / (s || 1), l = (e.top - i.top) / (a || 1); t.animatingX = !!r, t.animatingY = !!l, L(t, "transform", "translate3d(" + r + "px," + l + "px,0)"), this.forRepaintDummy = function (t) { return t.offsetWidth }(t), L(t, "transition", "transform " + n + "ms" + (this.options.easing ? " " + this.options.easing : "")), L(t, "transform", "translate3d(0,0,0)"), "number" == typeof t.animated && clearTimeout(t.animated), t.animated = setTimeout((function () { L(t, "transition", ""), L(t, "transform", ""), t.animated = !1, t.animatingX = !1, t.animatingY = !1 }), n) } } } } var V = [], Y = { initializeByDefault: !0 }, K = { mount: function (t) { for (var e in Y) Y.hasOwnProperty(e) && !(e in t) && (t[e] = Y[e]); V.forEach((function (e) { if (e.pluginName === t.pluginName) throw "Sortable: Cannot mount plugin ".concat(t.pluginName, " more than once") })), V.push(t) }, pluginEvent: function (t, e, i) { var n = this; this.eventCanceled = !1, i.cancel = function () { n.eventCanceled = !0 }; var s = t + "Global"; V.forEach((function (n) { e[n.pluginName] && (e[n.pluginName][s] && e[n.pluginName][s](o({ sortable: e }, i)), e.options[n.pluginName] && e[n.pluginName][t] && e[n.pluginName][t](o({ sortable: e }, i))) })) }, initializePlugins: function (t, e, i, n) { for (var o in V.forEach((function (n) { var o = n.pluginName; if (t.options[o] || n.initializeByDefault) { var s = new n(t, e, t.options); s.sortable = t, s.options = t.options, t[o] = s, r(i, s.defaults) } })), t.options) if (t.options.hasOwnProperty(o)) { var s = this.modifyOption(t, o, t.options[o]); void 0 !== s && (t.options[o] = s) } }, getEventProperties: function (t, e) { var i = {}; return V.forEach((function (n) { "function" == typeof n.eventProperties && r(i, n.eventProperties.call(e[n.pluginName], t)) })), i }, modifyOption: function (t, e, i) { var n; return V.forEach((function (o) { t[o.pluginName] && o.optionListeners && "function" == typeof o.optionListeners[e] && (n = o.optionListeners[e].call(t[o.pluginName], i)) })), n } }; function X(t) { var e = t.sortable, i = t.rootEl, n = t.name, s = t.targetEl, a = t.cloneEl, r = t.toEl, l = t.fromEl, c = t.oldIndex, u = t.newIndex, h = t.oldDraggableIndex, m = t.newDraggableIndex, f = t.originalEvent, g = t.putSortable, _ = t.extraEventProperties; if (e = e || i && i[H]) { var v, y = e.options, E = "on" + n.charAt(0).toUpperCase() + n.substr(1); !window.CustomEvent || d || p ? (v = document.createEvent("Event")).initEvent(n, !0, !0) : v = new CustomEvent(n, { bubbles: !0, cancelable: !0 }), v.to = r || i, v.from = l || i, v.item = s || i, v.clone = a, v.oldIndex = c, v.newIndex = u, v.oldDraggableIndex = h, v.newDraggableIndex = m, v.originalEvent = f, v.pullMode = g ? g.lastPutMode : void 0; var w = o(o({}, _), K.getEventProperties(n, e)); for (var b in w) v[b] = w[b]; i && i.dispatchEvent(v), y[E] && y[E].call(e, v) } } var Z = ["evt"], Q = function (t, e) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, n = i.evt, s = l(i, Z); K.pluginEvent.bind(qt)(t, e, o({ dragEl: $, parentEl: tt, ghostEl: et, rootEl: it, nextEl: nt, lastDownEl: ot, cloneEl: st, cloneHidden: at, dragStarted: yt, putSortable: dt, activeSortable: qt.active, originalEvent: n, oldIndex: rt, oldDraggableIndex: ct, newIndex: lt, newDraggableIndex: ut, hideGhostForTarget: jt, unhideGhostForTarget: Ft, cloneNowHidden: function () { at = !0 }, cloneNowShown: function () { at = !1 }, dispatchSortableEvent: function (t) { J({ sortable: e, name: t, originalEvent: n }) } }, s)) }; function J(t) { X(o({ putSortable: dt, cloneEl: st, targetEl: $, rootEl: it, oldIndex: rt, oldDraggableIndex: ct, newIndex: lt, newDraggableIndex: ut }, t)) } var $, tt, et, it, nt, ot, st, at, rt, lt, ct, ut, ht, dt, pt, mt, ft, gt, _t, vt, yt, Et, wt, bt, Pt, Ct = !1, Mt = !1, St = [], Lt = !1, xt = !1, Gt = [], It = !1, Rt = [], At = "undefined" != typeof document, kt = g, Tt = p || d ? "cssFloat" : "float", Dt = At && !_ && !g && "draggable" in document.createElement("div"), Ot = function () { if (At) { if (d) return !1; var t = document.createElement("x"); return t.style.cssText = "pointer-events:auto", "auto" === t.style.pointerEvents } }(), Nt = function (t, e) { var i = L(t), n = parseInt(i.width) - parseInt(i.paddingLeft) - parseInt(i.paddingRight) - parseInt(i.borderLeftWidth) - parseInt(i.borderRightWidth), o = k(t, 0, e), s = k(t, 1, e), a = o && L(o), r = s && L(s), l = a && parseInt(a.marginLeft) + parseInt(a.marginRight) + R(o).width, c = r && parseInt(r.marginLeft) + parseInt(r.marginRight) + R(s).width; if ("flex" === i.display) return "column" === i.flexDirection || "column-reverse" === i.flexDirection ? "vertical" : "horizontal"; if ("grid" === i.display) return i.gridTemplateColumns.split(" ").length <= 1 ? "vertical" : "horizontal"; if (o && a.float && "none" !== a.float) { var u = "left" === a.float ? "left" : "right"; return !s || "both" !== r.clear && r.clear !== u ? "horizontal" : "vertical" } return o && ("block" === a.display || "flex" === a.display || "table" === a.display || "grid" === a.display || l >= n && "none" === i[Tt] || s && "none" === i[Tt] && l + c > n) ? "vertical" : "horizontal" }, Ut = function (t) { function e(t, i) { return function (n, o, s, a) { var r = n.options.group.name && o.options.group.name && n.options.group.name === o.options.group.name; if (null == t && (i || r)) return !0; if (null == t || !1 === t) return !1; if (i && "clone" === t) return t; if ("function" == typeof t) return e(t(n, o, s, a), i)(n, o, s, a); var l = (i ? n : o).options.group.name; return !0 === t || "string" == typeof t && t === l || t.join && t.indexOf(l) > -1 } } var i = {}, n = t.group; n && "object" == s(n) || (n = { name: n }), i.name = n.name, i.checkPull = e(n.pull, !0), i.checkPut = e(n.put), i.revertClone = n.revertClone, t.group = i }, jt = function () { !Ot && et && L(et, "display", "none") }, Ft = function () { !Ot && et && L(et, "display", "") }; At && document.addEventListener("click", (function (t) { if (Mt) return t.preventDefault(), t.stopPropagation && t.stopPropagation(), t.stopImmediatePropagation && t.stopImmediatePropagation(), Mt = !1, !1 }), !0); var Bt = function (t) { if ($) { t = t.touches ? t.touches[0] : t; var e = (o = t.clientX, s = t.clientY, St.some((function (t) { var e = t[H].options.emptyInsertThreshold; if (e && !T(t)) { var i = R(t), n = o >= i.left - e && o <= i.right + e, r = s >= i.top - e && s <= i.bottom + e; return n && r ? a = t : void 0 } })), a); if (e) { var i = {}; for (var n in t) t.hasOwnProperty(n) && (i[n] = t[n]); i.target = i.rootEl = e, i.preventDefault = void 0, i.stopPropagation = void 0, e[H]._onDragOver(i) } } var o, s, a }, zt = function (t) { $ && $.parentNode[H]._isOutsideThisEl(t.target) }; function qt(t, e) { if (!t || !t.nodeType || 1 !== t.nodeType) throw "Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t)); this.el = t, this.options = e = r({}, e), t[H] = this; var i = { group: null, sort: !0, disabled: !1, store: null, handle: null, draggable: /^[uo]l$/i.test(t.nodeName) ? ">li" : ">*", swapThreshold: 1, invertSwap: !1, invertedSwapThreshold: null, removeCloneOnHide: !0, direction: function () { return Nt(t, this.options) }, ghostClass: "sortable-ghost", chosenClass: "sortable-chosen", dragClass: "sortable-drag", ignore: "a, img", filter: null, preventOnFilter: !0, animation: 0, easing: null, setData: function (t, e) { t.setData("Text", e.textContent) }, dropBubble: !1, dragoverBubble: !1, dataIdAttr: "data-id", delay: 0, delayOnTouchOnly: !1, touchStartThreshold: (Number.parseInt ? Number : window).parseInt(window.devicePixelRatio, 10) || 1, forceFallback: !1, fallbackClass: "sortable-fallback", fallbackOnBody: !1, fallbackTolerance: 0, fallbackOffset: { x: 0, y: 0 }, supportPointer: !1 !== qt.supportPointer && "PointerEvent" in window && !f, emptyInsertThreshold: 5 }; for (var n in K.initializePlugins(this, t, i), i) !(n in e) && (e[n] = i[n]); for (var o in Ut(e), this) "_" === o.charAt(0) && "function" == typeof this[o] && (this[o] = this[o].bind(this)); this.nativeDraggable = !e.forceFallback && Dt, this.nativeDraggable && (this.options.touchStartThreshold = 1), e.supportPointer ? y(t, "pointerdown", this._onTapStart) : (y(t, "mousedown", this._onTapStart), y(t, "touchstart", this._onTapStart)), this.nativeDraggable && (y(t, "dragover", this), y(t, "dragenter", this)), St.push(this.el), e.store && e.store.get && this.sort(e.store.get(this) || []), r(this, W()) } function Ht(t, e, i, n, o, s, a, r) { var l, c, u = t[H], h = u.options.onMove; return !window.CustomEvent || d || p ? (l = document.createEvent("Event")).initEvent("move", !0, !0) : l = new CustomEvent("move", { bubbles: !0, cancelable: !0 }), l.to = e, l.from = t, l.dragged = i, l.draggedRect = n, l.related = o || e, l.relatedRect = s || R(e), l.willInsertAfter = r, l.originalEvent = a, t.dispatchEvent(l), h && (c = h.call(u, l, a)), c } function Wt(t) { t.draggable = !1 } function Vt() { It = !1 } function Yt(t) { for (var e = t.tagName + t.className + t.src + t.href + t.textContent, i = e.length, n = 0; i--;)n += e.charCodeAt(i); return n.toString(36) } function Kt(t) { return setTimeout(t, 0) } function Xt(t) { return clearTimeout(t) } qt.prototype = { constructor: qt, _isOutsideThisEl: function (t) { this.el.contains(t) || t === this.el || (Et = null) }, _getDirection: function (t, e) { return "function" == typeof this.options.direction ? this.options.direction.call(this, t, e, $) : this.options.direction }, _onTapStart: function (t) { if (t.cancelable) { var e = this, i = this.el, n = this.options, o = n.preventOnFilter, s = t.type, a = t.touches && t.touches[0] || t.pointerType && "touch" === t.pointerType && t, r = (a || t).target, l = t.target.shadowRoot && (t.path && t.path[0] || t.composedPath && t.composedPath()[0]) || r, c = n.filter; if (function (t) { Rt.length = 0; var e = t.getElementsByTagName("input"), i = e.length; for (; i--;) { var n = e[i]; n.checked && Rt.push(n) } }(i), !$ && !(/mousedown|pointerdown/.test(s) && 0 !== t.button || n.disabled) && !l.isContentEditable && (this.nativeDraggable || !f || !r || "SELECT" !== r.tagName.toUpperCase()) && !((r = P(r, n.draggable, i, !1)) && r.animated || ot === r)) { if (rt = D(r), ct = D(r, n.draggable), "function" == typeof c) { if (c.call(this, t, r, this)) return J({ sortable: e, rootEl: l, name: "filter", targetEl: r, toEl: i, fromEl: i }), Q("filter", e, { evt: t }), void (o && t.cancelable && t.preventDefault()) } else if (c && (c = c.split(",").some((function (n) { if (n = P(l, n.trim(), i, !1)) return J({ sortable: e, rootEl: n, name: "filter", targetEl: r, fromEl: i, toEl: i }), Q("filter", e, { evt: t }), !0 })))) return void (o && t.cancelable && t.preventDefault()); n.handle && !P(l, n.handle, i, !1) || this._prepareDragStart(t, a, r) } } }, _prepareDragStart: function (t, e, i) { var n, o = this, s = o.el, a = o.options, r = s.ownerDocument; if (i && !$ && i.parentNode === s) { var l = R(i); if (it = s, tt = ($ = i).parentNode, nt = $.nextSibling, ot = i, ht = a.group, qt.dragged = $, pt = { target: $, clientX: (e || t).clientX, clientY: (e || t).clientY }, _t = pt.clientX - l.left, vt = pt.clientY - l.top, this._lastX = (e || t).clientX, this._lastY = (e || t).clientY, $.style["will-change"] = "all", n = function () { Q("delayEnded", o, { evt: t }), qt.eventCanceled ? o._onDrop() : (o._disableDelayedDragEvents(), !m && o.nativeDraggable && ($.draggable = !0), o._triggerDragStart(t, e), J({ sortable: o, name: "choose", originalEvent: t }), S($, a.chosenClass, !0)) }, a.ignore.split(",").forEach((function (t) { G($, t.trim(), Wt) })), y(r, "dragover", Bt), y(r, "mousemove", Bt), y(r, "touchmove", Bt), y(r, "mouseup", o._onDrop), y(r, "touchend", o._onDrop), y(r, "touchcancel", o._onDrop), m && this.nativeDraggable && (this.options.touchStartThreshold = 4, $.draggable = !0), Q("delayStart", this, { evt: t }), !a.delay || a.delayOnTouchOnly && !e || this.nativeDraggable && (p || d)) n(); else { if (qt.eventCanceled) return void this._onDrop(); y(r, "mouseup", o._disableDelayedDrag), y(r, "touchend", o._disableDelayedDrag), y(r, "touchcancel", o._disableDelayedDrag), y(r, "mousemove", o._delayedDragTouchMoveHandler), y(r, "touchmove", o._delayedDragTouchMoveHandler), a.supportPointer && y(r, "pointermove", o._delayedDragTouchMoveHandler), o._dragStartTimer = setTimeout(n, a.delay) } } }, _delayedDragTouchMoveHandler: function (t) { var e = t.touches ? t.touches[0] : t; Math.max(Math.abs(e.clientX - this._lastX), Math.abs(e.clientY - this._lastY)) >= Math.floor(this.options.touchStartThreshold / (this.nativeDraggable && window.devicePixelRatio || 1)) && this._disableDelayedDrag() }, _disableDelayedDrag: function () { $ && Wt($), clearTimeout(this._dragStartTimer), this._disableDelayedDragEvents() }, _disableDelayedDragEvents: function () { var t = this.el.ownerDocument; E(t, "mouseup", this._disableDelayedDrag), E(t, "touchend", this._disableDelayedDrag), E(t, "touchcancel", this._disableDelayedDrag), E(t, "mousemove", this._delayedDragTouchMoveHandler), E(t, "touchmove", this._delayedDragTouchMoveHandler), E(t, "pointermove", this._delayedDragTouchMoveHandler) }, _triggerDragStart: function (t, e) { e = e || "touch" == t.pointerType && t, !this.nativeDraggable || e ? this.options.supportPointer ? y(document, "pointermove", this._onTouchMove) : y(document, e ? "touchmove" : "mousemove", this._onTouchMove) : (y($, "dragend", this), y(it, "dragstart", this._onDragStart)); try { document.selection ? Kt((function () { document.selection.empty() })) : window.getSelection().removeAllRanges() } catch (t) { } }, _dragStarted: function (t, e) { if (Ct = !1, it && $) { Q("dragStarted", this, { evt: e }), this.nativeDraggable && y(document, "dragover", zt); var i = this.options; !t && S($, i.dragClass, !1), S($, i.ghostClass, !0), qt.active = this, t && this._appendGhost(), J({ sortable: this, name: "start", originalEvent: e }) } else this._nulling() }, _emulateDragOver: function () { if (mt) { this._lastX = mt.clientX, this._lastY = mt.clientY, jt(); for (var t = document.elementFromPoint(mt.clientX, mt.clientY), e = t; t && t.shadowRoot && (t = t.shadowRoot.elementFromPoint(mt.clientX, mt.clientY)) !== e;)e = t; if ($.parentNode[H]._isOutsideThisEl(t), e) do { if (e[H]) { if (e[H]._onDragOver({ clientX: mt.clientX, clientY: mt.clientY, target: t, rootEl: e }) && !this.options.dragoverBubble) break } t = e } while (e = e.parentNode); Ft() } }, _onTouchMove: function (t) { if (pt) { var e = this.options, i = e.fallbackTolerance, n = e.fallbackOffset, o = t.touches ? t.touches[0] : t, s = et && x(et, !0), a = et && s && s.a, r = et && s && s.d, l = kt && Pt && O(Pt), c = (o.clientX - pt.clientX + n.x) / (a || 1) + (l ? l[0] - Gt[0] : 0) / (a || 1), u = (o.clientY - pt.clientY + n.y) / (r || 1) + (l ? l[1] - Gt[1] : 0) / (r || 1); if (!qt.active && !Ct) { if (i && Math.max(Math.abs(o.clientX - this._lastX), Math.abs(o.clientY - this._lastY)) < i) return; this._onDragStart(t, !0) } if (et) { s ? (s.e += c - (ft || 0), s.f += u - (gt || 0)) : s = { a: 1, b: 0, c: 0, d: 1, e: c, f: u }; var h = "matrix(".concat(s.a, ",").concat(s.b, ",").concat(s.c, ",").concat(s.d, ",").concat(s.e, ",").concat(s.f, ")"); L(et, "webkitTransform", h), L(et, "mozTransform", h), L(et, "msTransform", h), L(et, "transform", h), ft = c, gt = u, mt = o } t.cancelable && t.preventDefault() } }, _appendGhost: function () { if (!et) { var t = this.options.fallbackOnBody ? document.body : it, e = R($, !0, kt, !0, t), i = this.options; if (kt) { for (Pt = t; "static" === L(Pt, "position") && "none" === L(Pt, "transform") && Pt !== document;)Pt = Pt.parentNode; Pt !== document.body && Pt !== document.documentElement ? (Pt === document && (Pt = I()), e.top += Pt.scrollTop, e.left += Pt.scrollLeft) : Pt = I(), Gt = O(Pt) } S(et = $.cloneNode(!0), i.ghostClass, !1), S(et, i.fallbackClass, !0), S(et, i.dragClass, !0), L(et, "transition", ""), L(et, "transform", ""), L(et, "box-sizing", "border-box"), L(et, "margin", 0), L(et, "top", e.top), L(et, "left", e.left), L(et, "width", e.width), L(et, "height", e.height), L(et, "opacity", "0.8"), L(et, "position", kt ? "absolute" : "fixed"), L(et, "zIndex", "100000"), L(et, "pointerEvents", "none"), qt.ghost = et, t.appendChild(et), L(et, "transform-origin", _t / parseInt(et.style.width) * 100 + "% " + vt / parseInt(et.style.height) * 100 + "%") } }, _onDragStart: function (t, e) { var i = this, n = t.dataTransfer, o = i.options; Q("dragStart", this, { evt: t }), qt.eventCanceled ? this._onDrop() : (Q("setupClone", this), qt.eventCanceled || ((st = B($)).draggable = !1, st.style["will-change"] = "", this._hideClone(), S(st, this.options.chosenClass, !1), qt.clone = st), i.cloneId = Kt((function () { Q("clone", i), qt.eventCanceled || (i.options.removeCloneOnHide || it.insertBefore(st, $), i._hideClone(), J({ sortable: i, name: "clone" })) })), !e && S($, o.dragClass, !0), e ? (Mt = !0, i._loopId = setInterval(i._emulateDragOver, 50)) : (E(document, "mouseup", i._onDrop), E(document, "touchend", i._onDrop), E(document, "touchcancel", i._onDrop), n && (n.effectAllowed = "move", o.setData && o.setData.call(i, n, $)), y(document, "drop", i), L($, "transform", "translateZ(0)")), Ct = !0, i._dragStartId = Kt(i._dragStarted.bind(i, e, t)), y(document, "selectstart", i), yt = !0, f && L(document.body, "user-select", "none")) }, _onDragOver: function (t) { var e, i, n, s, a = this.el, r = t.target, l = this.options, c = l.group, u = qt.active, h = ht === c, d = l.sort, p = dt || u, m = this, f = !1; if (!It) { if (void 0 !== t.preventDefault && t.cancelable && t.preventDefault(), r = P(r, l.draggable, a, !0), U("dragOver"), qt.eventCanceled) return f; if ($.contains(t.target) || r.animated && r.animatingX && r.animatingY || m._ignoreWhileAnimating === r) return B(!1); if (Mt = !1, u && !l.disabled && (h ? d || (n = tt !== it) : dt === this || (this.lastPutMode = ht.checkPull(this, u, $, t)) && c.checkPut(this, u, $, t))) { if (s = "vertical" === this._getDirection(t, r), e = R($), U("dragOverValid"), qt.eventCanceled) return f; if (n) return tt = it, j(), this._hideClone(), U("revert"), qt.eventCanceled || (nt ? it.insertBefore($, nt) : it.appendChild($)), B(!0); var g = T(a, l.draggable); if (!g || function (t, e, i) { var n = R(T(i.el, i.options.draggable)), o = 10; return e ? t.clientX > n.right + o || t.clientX <= n.right && t.clientY > n.bottom && t.clientX >= n.left : t.clientX > n.right && t.clientY > n.top || t.clientX <= n.right && t.clientY > n.bottom + o }(t, s, this) && !g.animated) { if (g === $) return B(!1); if (g && a === t.target && (r = g), r && (i = R(r)), !1 !== Ht(it, a, $, e, r, i, t, !!r)) return j(), a.appendChild($), tt = a, z(), B(!0) } else if (g && function (t, e, i) { var n = R(k(i.el, 0, i.options, !0)), o = 10; return e ? t.clientX < n.left - o || t.clientY < n.top && t.clientX < n.right : t.clientY < n.top - o || t.clientY < n.bottom && t.clientX < n.left }(t, s, this)) { var _ = k(a, 0, l, !0); if (_ === $) return B(!1); if (i = R(r = _), !1 !== Ht(it, a, $, e, r, i, t, !1)) return j(), a.insertBefore($, _), tt = a, z(), B(!0) } else if (r.parentNode === a) { i = R(r); var v, y, E, w = $.parentNode !== a, b = !function (t, e, i) { var n = i ? t.left : t.top, o = i ? t.right : t.bottom, s = i ? t.width : t.height, a = i ? e.left : e.top, r = i ? e.right : e.bottom, l = i ? e.width : e.height; return n === a || o === r || n + s / 2 === a + l / 2 }($.animated && $.toRect || e, r.animated && r.toRect || i, s), C = s ? "top" : "left", M = A(r, "top", "top") || A($, "top", "top"), x = M ? M.scrollTop : void 0; if (Et !== r && (y = i[C], Lt = !1, xt = !b && l.invertSwap || w), v = function (t, e, i, n, o, s, a, r) { var l = n ? t.clientY : t.clientX, c = n ? i.height : i.width, u = n ? i.top : i.left, h = n ? i.bottom : i.right, d = !1; if (!a) if (r && bt < c * o) { if (!Lt && (1 === wt ? l > u + c * s / 2 : l < h - c * s / 2) && (Lt = !0), Lt) d = !0; else if (1 === wt ? l < u + bt : l > h - bt) return -wt } else if (l > u + c * (1 - o) / 2 && l < h - c * (1 - o) / 2) return function (t) { return D($) < D(t) ? 1 : -1 }(e); if ((d = d || a) && (l < u + c * s / 2 || l > h - c * s / 2)) return l > u + c / 2 ? 1 : -1; return 0 }(t, r, i, s, b ? 1 : l.swapThreshold, null == l.invertedSwapThreshold ? l.swapThreshold : l.invertedSwapThreshold, xt, Et === r), 0 !== v) { var G = D($); do { G -= v, E = tt.children[G] } while (E && ("none" === L(E, "display") || E === et)) } if (0 === v || E === r) return B(!1); Et = r, wt = v; var I = r.nextElementSibling, O = !1, N = Ht(it, a, $, e, r, i, t, O = 1 === v); if (!1 !== N) return 1 !== N && -1 !== N || (O = 1 === N), It = !0, setTimeout(Vt, 30), j(), O && !I ? a.appendChild($) : r.parentNode.insertBefore($, O ? I : r), M && F(M, 0, x - M.scrollTop), tt = $.parentNode, void 0 === y || xt || (bt = Math.abs(y - R(r)[C])), z(), B(!0) } if (a.contains($)) return B(!1) } return !1 } function U(l, c) { Q(l, m, o({ evt: t, isOwner: h, axis: s ? "vertical" : "horizontal", revert: n, dragRect: e, targetRect: i, canSort: d, fromSortable: p, target: r, completed: B, onMove: function (i, n) { return Ht(it, a, $, e, i, R(i), t, n) }, changed: z }, c)) } function j() { U("dragOverAnimationCapture"), m.captureAnimationState(), m !== p && p.captureAnimationState() } function B(e) { return U("dragOverCompleted", { insertion: e }), e && (h ? u._hideClone() : u._showClone(m), m !== p && (S($, dt ? dt.options.ghostClass : u.options.ghostClass, !1), S($, l.ghostClass, !0)), dt !== m && m !== qt.active ? dt = m : m === qt.active && dt && (dt = null), p === m && (m._ignoreWhileAnimating = r), m.animateAll((function () { U("dragOverAnimationComplete"), m._ignoreWhileAnimating = null })), m !== p && (p.animateAll(), p._ignoreWhileAnimating = null)), (r === $ && !$.animated || r === a && !r.animated) && (Et = null), l.dragoverBubble || t.rootEl || r === document || ($.parentNode[H]._isOutsideThisEl(t.target), !e && Bt(t)), !l.dragoverBubble && t.stopPropagation && t.stopPropagation(), f = !0 } function z() { lt = D($), ut = D($, l.draggable), J({ sortable: m, name: "change", toEl: a, newIndex: lt, newDraggableIndex: ut, originalEvent: t }) } }, _ignoreWhileAnimating: null, _offMoveEvents: function () { E(document, "mousemove", this._onTouchMove), E(document, "touchmove", this._onTouchMove), E(document, "pointermove", this._onTouchMove), E(document, "dragover", Bt), E(document, "mousemove", Bt), E(document, "touchmove", Bt) }, _offUpEvents: function () { var t = this.el.ownerDocument; E(t, "mouseup", this._onDrop), E(t, "touchend", this._onDrop), E(t, "pointerup", this._onDrop), E(t, "touchcancel", this._onDrop), E(document, "selectstart", this) }, _onDrop: function (t) { var e = this.el, i = this.options; lt = D($), ut = D($, i.draggable), Q("drop", this, { evt: t }), tt = $ && $.parentNode, lt = D($), ut = D($, i.draggable), qt.eventCanceled || (Ct = !1, xt = !1, Lt = !1, clearInterval(this._loopId), clearTimeout(this._dragStartTimer), Xt(this.cloneId), Xt(this._dragStartId), this.nativeDraggable && (E(document, "drop", this), E(e, "dragstart", this._onDragStart)), this._offMoveEvents(), this._offUpEvents(), f && L(document.body, "user-select", ""), L($, "transform", ""), t && (yt && (t.cancelable && t.preventDefault(), !i.dropBubble && t.stopPropagation()), et && et.parentNode && et.parentNode.removeChild(et), (it === tt || dt && "clone" !== dt.lastPutMode) && st && st.parentNode && st.parentNode.removeChild(st), $ && (this.nativeDraggable && E($, "dragend", this), Wt($), $.style["will-change"] = "", yt && !Ct && S($, dt ? dt.options.ghostClass : this.options.ghostClass, !1), S($, this.options.chosenClass, !1), J({ sortable: this, name: "unchoose", toEl: tt, newIndex: null, newDraggableIndex: null, originalEvent: t }), it !== tt ? (lt >= 0 && (J({ rootEl: tt, name: "add", toEl: tt, fromEl: it, originalEvent: t }), J({ sortable: this, name: "remove", toEl: tt, originalEvent: t }), J({ rootEl: tt, name: "sort", toEl: tt, fromEl: it, originalEvent: t }), J({ sortable: this, name: "sort", toEl: tt, originalEvent: t })), dt && dt.save()) : lt !== rt && lt >= 0 && (J({ sortable: this, name: "update", toEl: tt, originalEvent: t }), J({ sortable: this, name: "sort", toEl: tt, originalEvent: t })), qt.active && (null != lt && -1 !== lt || (lt = rt, ut = ct), J({ sortable: this, name: "end", toEl: tt, originalEvent: t }), this.save())))), this._nulling() }, _nulling: function () { Q("nulling", this), it = $ = tt = et = nt = st = ot = at = pt = mt = yt = lt = ut = rt = ct = Et = wt = dt = ht = qt.dragged = qt.ghost = qt.clone = qt.active = null, Rt.forEach((function (t) { t.checked = !0 })), Rt.length = ft = gt = 0 }, handleEvent: function (t) { switch (t.type) { case "drop": case "dragend": this._onDrop(t); break; case "dragenter": case "dragover": $ && (this._onDragOver(t), function (t) { t.dataTransfer && (t.dataTransfer.dropEffect = "move"); t.cancelable && t.preventDefault() }(t)); break; case "selectstart": t.preventDefault() } }, toArray: function () { for (var t, e = [], i = this.el.children, n = 0, o = i.length, s = this.options; n < o; n++)P(t = i[n], s.draggable, this.el, !1) && e.push(t.getAttribute(s.dataIdAttr) || Yt(t)); return e }, sort: function (t, e) { var i = {}, n = this.el; this.toArray().forEach((function (t, e) { var o = n.children[e]; P(o, this.options.draggable, n, !1) && (i[t] = o) }), this), e && this.captureAnimationState(), t.forEach((function (t) { i[t] && (n.removeChild(i[t]), n.appendChild(i[t])) })), e && this.animateAll() }, save: function () { var t = this.options.store; t && t.set && t.set(this) }, closest: function (t, e) { return P(t, e || this.options.draggable, this.el, !1) }, option: function (t, e) { var i = this.options; if (void 0 === e) return i[t]; var n = K.modifyOption(this, t, e); i[t] = void 0 !== n ? n : e, "group" === t && Ut(i) }, destroy: function () { Q("destroy", this); var t = this.el; t[H] = null, E(t, "mousedown", this._onTapStart), E(t, "touchstart", this._onTapStart), E(t, "pointerdown", this._onTapStart), this.nativeDraggable && (E(t, "dragover", this), E(t, "dragenter", this)), Array.prototype.forEach.call(t.querySelectorAll("[draggable]"), (function (t) { t.removeAttribute("draggable") })), this._onDrop(), this._disableDelayedDragEvents(), St.splice(St.indexOf(this.el), 1), this.el = t = null }, _hideClone: function () { if (!at) { if (Q("hideClone", this), qt.eventCanceled) return; L(st, "display", "none"), this.options.removeCloneOnHide && st.parentNode && st.parentNode.removeChild(st), at = !0 } }, _showClone: function (t) { if ("clone" === t.lastPutMode) { if (at) { if (Q("showClone", this), qt.eventCanceled) return; $.parentNode != it || this.options.group.revertClone ? nt ? it.insertBefore(st, nt) : it.appendChild(st) : it.insertBefore(st, $), this.options.group.revertClone && this.animate($, st), L(st, "display", ""), at = !1 } } else this._hideClone() } }, At && y(document, "touchmove", (function (t) { (qt.active || Ct) && t.cancelable && t.preventDefault() })), qt.utils = { on: y, off: E, css: L, find: G, is: function (t, e) { return !!P(t, e, t, !1) }, extend: function (t, e) { if (t && e) for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]); return t }, throttle: j, closest: P, toggleClass: S, clone: B, index: D, nextTick: Kt, cancelNextTick: Xt, detectDirection: Nt, getChild: k }, qt.get = function (t) { return t[H] }, qt.mount = function () { for (var t = arguments.length, e = new Array(t), i = 0; i < t; i++)e[i] = arguments[i]; e[0].constructor === Array && (e = e[0]), e.forEach((function (t) { if (!t.prototype || !t.prototype.constructor) throw "Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t)); t.utils && (qt.utils = o(o({}, qt.utils), t.utils)), K.mount(t) })) }, qt.create = function (t, e) { return new qt(t, e) }, qt.version = "1.14.0"; var Zt, Qt, Jt, $t, te, ee, ie = [], ne = !1; function oe() { ie.forEach((function (t) { clearInterval(t.pid) })), ie = [] } function se() { clearInterval(ee) } var ae, re = j((function (t, e, i, n) { if (e.scroll) { var o, s = (t.touches ? t.touches[0] : t).clientX, a = (t.touches ? t.touches[0] : t).clientY, r = e.scrollSensitivity, l = e.scrollSpeed, c = I(), u = !1; Qt !== i && (Qt = i, oe(), Zt = e.scroll, o = e.scrollFn, !0 === Zt && (Zt = N(i, !0))); var h = 0, d = Zt; do { var p = d, m = R(p), f = m.top, g = m.bottom, _ = m.left, v = m.right, y = m.width, E = m.height, w = void 0, b = void 0, P = p.scrollWidth, C = p.scrollHeight, M = L(p), S = p.scrollLeft, x = p.scrollTop; p === c ? (w = y < P && ("auto" === M.overflowX || "scroll" === M.overflowX || "visible" === M.overflowX), b = E < C && ("auto" === M.overflowY || "scroll" === M.overflowY || "visible" === M.overflowY)) : (w = y < P && ("auto" === M.overflowX || "scroll" === M.overflowX), b = E < C && ("auto" === M.overflowY || "scroll" === M.overflowY)); var G = w && (Math.abs(v - s) <= r && S + y < P) - (Math.abs(_ - s) <= r && !!S), A = b && (Math.abs(g - a) <= r && x + E < C) - (Math.abs(f - a) <= r && !!x); if (!ie[h]) for (var k = 0; k <= h; k++)ie[k] || (ie[k] = {}); ie[h].vx == G && ie[h].vy == A && ie[h].el === p || (ie[h].el = p, ie[h].vx = G, ie[h].vy = A, clearInterval(ie[h].pid), 0 == G && 0 == A || (u = !0, ie[h].pid = setInterval(function () { n && 0 === this.layer && qt.active._onTouchMove(te); var e = ie[this.layer].vy ? ie[this.layer].vy * l : 0, i = ie[this.layer].vx ? ie[this.layer].vx * l : 0; "function" == typeof o && "continue" !== o.call(qt.dragged.parentNode[H], i, e, t, te, ie[this.layer].el) || F(ie[this.layer].el, i, e) }.bind({ layer: h }), 24))), h++ } while (e.bubbleScroll && d !== c && (d = N(d, !1))); ne = u } }), 30), le = function (t) { var e = t.originalEvent, i = t.putSortable, n = t.dragEl, o = t.activeSortable, s = t.dispatchSortableEvent, a = t.hideGhostForTarget, r = t.unhideGhostForTarget; if (e) { var l = i || o; a(); var c = e.changedTouches && e.changedTouches.length ? e.changedTouches[0] : e, u = document.elementFromPoint(c.clientX, c.clientY); r(), l && !l.el.contains(u) && (s("spill"), this.onSpill({ dragEl: n, putSortable: i })) } }; function ce() { } function ue() { } function he() { function t() { this.defaults = { swapClass: "sortable-swap-highlight" } } return t.prototype = { dragStart: function (t) { var e = t.dragEl; ae = e }, dragOverValid: function (t) { var e = t.completed, i = t.target, n = t.onMove, o = t.activeSortable, s = t.changed, a = t.cancel; if (o.options.swap) { var r = this.sortable.el, l = this.options; if (i && i !== r) { var c = ae; !1 !== n(i) ? (S(i, l.swapClass, !0), ae = i) : ae = null, c && c !== ae && S(c, l.swapClass, !1) } s(), e(!0), a() } }, drop: function (t) { var e = t.activeSortable, i = t.putSortable, n = t.dragEl, o = i || this.sortable, s = this.options; ae && S(ae, s.swapClass, !1), ae && (s.swap || i && i.options.swap) && n !== ae && (o.captureAnimationState(), o !== e && e.captureAnimationState(), function (t, e) { var i, n, o = t.parentNode, s = e.parentNode; if (!o || !s || o.isEqualNode(e) || s.isEqualNode(t)) return; i = D(t), n = D(e), o.isEqualNode(s) && i < n && n++; o.insertBefore(e, o.children[i]), s.insertBefore(t, s.children[n]) }(n, ae), o.animateAll(), o !== e && e.animateAll()) }, nulling: function () { ae = null } }, r(t, { pluginName: "swap", eventProperties: function () { return { swapItem: ae } } }) } ce.prototype = { startIndex: null, dragStart: function (t) { var e = t.oldDraggableIndex; this.startIndex = e }, onSpill: function (t) { var e = t.dragEl, i = t.putSortable; this.sortable.captureAnimationState(), i && i.captureAnimationState(); var n = k(this.sortable.el, this.startIndex, this.options); n ? this.sortable.el.insertBefore(e, n) : this.sortable.el.appendChild(e), this.sortable.animateAll(), i && i.animateAll() }, drop: le }, r(ce, { pluginName: "revertOnSpill" }), ue.prototype = { onSpill: function (t) { var e = t.dragEl, i = t.putSortable || this.sortable; i.captureAnimationState(), e.parentNode && e.parentNode.removeChild(e), i.animateAll() }, drop: le }, r(ue, { pluginName: "removeOnSpill" }); var de, pe, me, fe, ge, _e = [], ve = [], ye = !1, Ee = !1, we = !1; function be() { function t(t) { for (var e in this) "_" === e.charAt(0) && "function" == typeof this[e] && (this[e] = this[e].bind(this)); t.options.supportPointer ? y(document, "pointerup", this._deselectMultiDrag) : (y(document, "mouseup", this._deselectMultiDrag), y(document, "touchend", this._deselectMultiDrag)), y(document, "keydown", this._checkKeyDown), y(document, "keyup", this._checkKeyUp), this.defaults = { selectedClass: "sortable-selected", multiDragKey: null, setData: function (e, i) { var n = ""; _e.length && pe === t ? _e.forEach((function (t, e) { n += (e ? ", " : "") + t.textContent })) : n = i.textContent, e.setData("Text", n) } } } return t.prototype = { multiDragKeyDown: !1, isMultiDrag: !1, delayStartGlobal: function (t) { var e = t.dragEl; me = e }, delayEnded: function () { this.isMultiDrag = ~_e.indexOf(me) }, setupClone: function (t) { var e = t.sortable, i = t.cancel; if (this.isMultiDrag) { for (var n = 0; n < _e.length; n++)ve.push(B(_e[n])), ve[n].sortableIndex = _e[n].sortableIndex, ve[n].draggable = !1, ve[n].style["will-change"] = "", S(ve[n], this.options.selectedClass, !1), _e[n] === me && S(ve[n], this.options.chosenClass, !1); e._hideClone(), i() } }, clone: function (t) { var e = t.sortable, i = t.rootEl, n = t.dispatchSortableEvent, o = t.cancel; this.isMultiDrag && (this.options.removeCloneOnHide || _e.length && pe === e && (Pe(!0, i), n("clone"), o())) }, showClone: function (t) { var e = t.cloneNowShown, i = t.rootEl, n = t.cancel; this.isMultiDrag && (Pe(!1, i), ve.forEach((function (t) { L(t, "display", "") })), e(), ge = !1, n()) }, hideClone: function (t) { var e = this, i = (t.sortable, t.cloneNowHidden), n = t.cancel; this.isMultiDrag && (ve.forEach((function (t) { L(t, "display", "none"), e.options.removeCloneOnHide && t.parentNode && t.parentNode.removeChild(t) })), i(), ge = !0, n()) }, dragStartGlobal: function (t) { t.sortable; !this.isMultiDrag && pe && pe.multiDrag._deselectMultiDrag(), _e.forEach((function (t) { t.sortableIndex = D(t) })), _e = _e.sort((function (t, e) { return t.sortableIndex - e.sortableIndex })), we = !0 }, dragStarted: function (t) { var e = this, i = t.sortable; if (this.isMultiDrag) { if (this.options.sort && (i.captureAnimationState(), this.options.animation)) { _e.forEach((function (t) { t !== me && L(t, "position", "absolute") })); var n = R(me, !1, !0, !0); _e.forEach((function (t) { t !== me && z(t, n) })), Ee = !0, ye = !0 } i.animateAll((function () { Ee = !1, ye = !1, e.options.animation && _e.forEach((function (t) { q(t) })), e.options.sort && Ce() })) } }, dragOver: function (t) { var e = t.target, i = t.completed, n = t.cancel; Ee && ~_e.indexOf(e) && (i(!1), n()) }, revert: function (t) { var e = t.fromSortable, i = t.rootEl, n = t.sortable, o = t.dragRect; _e.length > 1 && (_e.forEach((function (t) { n.addAnimationState({ target: t, rect: Ee ? R(t) : o }), q(t), t.fromRect = o, e.removeAnimationState(t) })), Ee = !1, function (t, e) { _e.forEach((function (i, n) { var o = e.children[i.sortableIndex + (t ? Number(n) : 0)]; o ? e.insertBefore(i, o) : e.appendChild(i) })) }(!this.options.removeCloneOnHide, i)) }, dragOverCompleted: function (t) { var e = t.sortable, i = t.isOwner, n = t.insertion, o = t.activeSortable, s = t.parentEl, a = t.putSortable, r = this.options; if (n) { if (i && o._hideClone(), ye = !1, r.animation && _e.length > 1 && (Ee || !i && !o.options.sort && !a)) { var l = R(me, !1, !0, !0); _e.forEach((function (t) { t !== me && (z(t, l), s.appendChild(t)) })), Ee = !0 } if (!i) if (Ee || Ce(), _e.length > 1) { var c = ge; o._showClone(e), o.options.animation && !ge && c && ve.forEach((function (t) { o.addAnimationState({ target: t, rect: fe }), t.fromRect = fe, t.thisAnimationDuration = null })) } else o._showClone(e) } }, dragOverAnimationCapture: function (t) { var e = t.dragRect, i = t.isOwner, n = t.activeSortable; if (_e.forEach((function (t) { t.thisAnimationDuration = null })), n.options.animation && !i && n.multiDrag.isMultiDrag) { fe = r({}, e); var o = x(me, !0); fe.top -= o.f, fe.left -= o.e } }, dragOverAnimationComplete: function () { Ee && (Ee = !1, Ce()) }, drop: function (t) { var e = t.originalEvent, i = t.rootEl, n = t.parentEl, o = t.sortable, s = t.dispatchSortableEvent, a = t.oldIndex, r = t.putSortable, l = r || this.sortable; if (e) { var c = this.options, u = n.children; if (!we) if (c.multiDragKey && !this.multiDragKeyDown && this._deselectMultiDrag(), S(me, c.selectedClass, !~_e.indexOf(me)), ~_e.indexOf(me)) _e.splice(_e.indexOf(me), 1), de = null, X({ sortable: o, rootEl: i, name: "deselect", targetEl: me, originalEvt: e }); else { if (_e.push(me), X({ sortable: o, rootEl: i, name: "select", targetEl: me, originalEvt: e }), e.shiftKey && de && o.el.contains(de)) { var h, d, p = D(de), m = D(me); if (~p && ~m && p !== m) for (m > p ? (d = p, h = m) : (d = m, h = p + 1); d < h; d++)~_e.indexOf(u[d]) || (S(u[d], c.selectedClass, !0), _e.push(u[d]), X({ sortable: o, rootEl: i, name: "select", targetEl: u[d], originalEvt: e })) } else de = me; pe = l } if (we && this.isMultiDrag) { if (Ee = !1, (n[H].options.sort || n !== i) && _e.length > 1) { var f = R(me), g = D(me, ":not(." + this.options.selectedClass + ")"); if (!ye && c.animation && (me.thisAnimationDuration = null), l.captureAnimationState(), !ye && (c.animation && (me.fromRect = f, _e.forEach((function (t) { if (t.thisAnimationDuration = null, t !== me) { var e = Ee ? R(t) : f; t.fromRect = e, l.addAnimationState({ target: t, rect: e }) } }))), Ce(), _e.forEach((function (t) { u[g] ? n.insertBefore(t, u[g]) : n.appendChild(t), g++ })), a === D(me))) { var _ = !1; _e.forEach((function (t) { t.sortableIndex === D(t) || (_ = !0) })), _ && s("update") } _e.forEach((function (t) { q(t) })), l.animateAll() } pe = l } (i === n || r && "clone" !== r.lastPutMode) && ve.forEach((function (t) { t.parentNode && t.parentNode.removeChild(t) })) } }, nullingGlobal: function () { this.isMultiDrag = we = !1, ve.length = 0 }, destroyGlobal: function () { this._deselectMultiDrag(), E(document, "pointerup", this._deselectMultiDrag), E(document, "mouseup", this._deselectMultiDrag), E(document, "touchend", this._deselectMultiDrag), E(document, "keydown", this._checkKeyDown), E(document, "keyup", this._checkKeyUp) }, _deselectMultiDrag: function (t) { if (!(void 0 !== we && we || pe !== this.sortable || t && P(t.target, this.options.draggable, this.sortable.el, !1) || t && 0 !== t.button)) for (; _e.length;) { var e = _e[0]; S(e, this.options.selectedClass, !1), _e.shift(), X({ sortable: this.sortable, rootEl: this.sortable.el, name: "deselect", targetEl: e, originalEvt: t }) } }, _checkKeyDown: function (t) { t.key === this.options.multiDragKey && (this.multiDragKeyDown = !0) }, _checkKeyUp: function (t) { t.key === this.options.multiDragKey && (this.multiDragKeyDown = !1) } }, r(t, { pluginName: "multiDrag", utils: { select: function (t) { var e = t.parentNode[H]; e && e.options.multiDrag && !~_e.indexOf(t) && (pe && pe !== e && (pe.multiDrag._deselectMultiDrag(), pe = e), S(t, e.options.selectedClass, !0), _e.push(t)) }, deselect: function (t) { var e = t.parentNode[H], i = _e.indexOf(t); e && e.options.multiDrag && ~i && (S(t, e.options.selectedClass, !1), _e.splice(i, 1)) } }, eventProperties: function () { var t = this, e = [], i = []; return _e.forEach((function (n) { var o; e.push({ multiDragElement: n, index: n.sortableIndex }), o = Ee && n !== me ? -1 : Ee ? D(n, ":not(." + t.options.selectedClass + ")") : D(n), i.push({ multiDragElement: n, index: o }) })), { items: c(_e), clones: [].concat(ve), oldIndicies: e, newIndicies: i } }, optionListeners: { multiDragKey: function (t) { return "ctrl" === (t = t.toLowerCase()) ? t = "Control" : t.length > 1 && (t = t.charAt(0).toUpperCase() + t.substr(1)), t } } }) } function Pe(t, e) { ve.forEach((function (i, n) { var o = e.children[i.sortableIndex + (t ? Number(n) : 0)]; o ? e.insertBefore(i, o) : e.appendChild(i) })) } function Ce() { _e.forEach((function (t) { t !== me && t.parentNode && t.parentNode.removeChild(t) })) } qt.mount(new function () { function t() { for (var t in this.defaults = { scroll: !0, forceAutoScrollFallback: !1, scrollSensitivity: 30, scrollSpeed: 10, bubbleScroll: !0 }, this) "_" === t.charAt(0) && "function" == typeof this[t] && (this[t] = this[t].bind(this)) } return t.prototype = { dragStarted: function (t) { var e = t.originalEvent; this.sortable.nativeDraggable ? y(document, "dragover", this._handleAutoScroll) : this.options.supportPointer ? y(document, "pointermove", this._handleFallbackAutoScroll) : e.touches ? y(document, "touchmove", this._handleFallbackAutoScroll) : y(document, "mousemove", this._handleFallbackAutoScroll) }, dragOverCompleted: function (t) { var e = t.originalEvent; this.options.dragOverBubble || e.rootEl || this._handleAutoScroll(e) }, drop: function () { this.sortable.nativeDraggable ? E(document, "dragover", this._handleAutoScroll) : (E(document, "pointermove", this._handleFallbackAutoScroll), E(document, "touchmove", this._handleFallbackAutoScroll), E(document, "mousemove", this._handleFallbackAutoScroll)), se(), oe(), clearTimeout(C), C = void 0 }, nulling: function () { te = Qt = Zt = ne = ee = Jt = $t = null, ie.length = 0 }, _handleFallbackAutoScroll: function (t) { this._handleAutoScroll(t, !0) }, _handleAutoScroll: function (t, e) { var i = this, n = (t.touches ? t.touches[0] : t).clientX, o = (t.touches ? t.touches[0] : t).clientY, s = document.elementFromPoint(n, o); if (te = t, e || this.options.forceAutoScrollFallback || p || d || f) { re(t, this.options, s, e); var a = N(s, !0); !ne || ee && n === Jt && o === $t || (ee && se(), ee = setInterval((function () { var s = N(document.elementFromPoint(n, o), !0); s !== a && (a = s, oe()), re(t, i.options, s, e) }), 10), Jt = n, $t = o) } else { if (!this.options.bubbleScroll || N(s, !0) === I()) return void oe(); re(t, this.options, N(s, !1), !1) } } }, r(t, { pluginName: "scroll", initializeByDefault: !0 }) }), qt.mount(ue, ce), e.default = qt
  }, function (t, e, i) { "use strict"; i.r(e); var n = i(2), o = i.n(n), s = i(34), a = i(40), r = i(131), l = i(36), c = i(133), u = i(137); function h(t) { return h = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, h(t) } var d = s.default.getLogger("Isocurve"), p = o.a.Control.extend({ includes: u.default, options: { position: "topleft", collapsed: !0, methods: ["time", "distance"], graphs: ["Voiture", "Pieton"], exclusions: { toll: !1, tunnel: !1, bridge: !1 }, directions: ["departure", "arrival"], disableReverse: !1, isocurveOptions: {}, autocompleteOptions: {} }, initialize: function (t) { o.a.Util.setOptions(this, t), this._uid = l.default.generate(), this._isDesktop = this._detectSupport(), this._waitingContainer = null, this._showContainer = null, this._pictoContainer = null, this._formContainer = null, this._submitContainer = null, this._currentTransport = null, this._currentDirection = null, this._currentComputation = null, this._currentTimeHour = 0, this._currentTimeMinute = 0, this._currentDistance = 0, this._currentExclusions = [], this._initTransport(), this._initComputation(), this._initDirection(), this._initExclusions(), this._currentPoint = null, this._geojsonIso = null, this._waiting = !1, this._timer = null, this._currentIsoResults = null, this._resources = {}, this._noRightManagement = !1, this._checkRightsManagement() }, onAdd: function (t) { var e = this._container = this._initLayout(t); return o.a.DomEvent.disableClickPropagation(e).disableScrollPropagation(e), e }, onRemove: function () { }, _initTransport: function () { this._currentTransport = "Voiture"; var t = this.options.graphs; t && 0 !== t.length || (this.options.graphs = ["Voiture", "Pieton"]), o.a.Util.isArray(t) && t.length && ("Voiture" !== t[0] && "Pieton" !== t[0] || (this._currentTransport = t[0])); var e = this.options.isocurveOptions; e.graph && (this._currentTransport = e.graph) }, _initDirection: function () { this._currentDirection = "departure"; var t = this.options.directions; t && 0 !== t.length || (this.options.directions = ["departure", "arrival"]), o.a.Util.isArray(t) && t.length && ("departure" !== t[0] && "arrival" !== t[0] || (this._currentDirection = t[0])); var e = this.options.isocurveOptions; e.reverse || (this._currentDirection = "departure"), !0 === e.reverse && (this._currentDirection = "arrival", this.options.directions = ["arrival", "departure"]) }, _initComputation: function () { this._currentComputation = "time"; var t = this.options.methods; t && 0 !== t.length || (this.options.methods = ["time", "distance"]), o.a.Util.isArray(t) && t.length && ("time" !== t[0] && "distance" !== t[0] || (this._currentComputation = t[0])); var e = this.options.isocurveOptions; e.method && (this._currentComputation = e.method), e.time && (this._currentComputation = "time"), e.distance && (this._currentComputation = "distance") }, _initExclusions: function () { this._currentExclusions = []; var t = this.options.exclusions; if ((!t || "object" === h(t) && 0 === Object.keys(t).length) && (this.options.exclusions = { toll: !1, tunnel: !1, bridge: !1 }), t && "object" === h(t) && Object.keys(t).length) for (var e in t) t.hasOwnProperty(e) && t.k && this._currentExclusions.push(e); var i = this.options.isocurveOptions; Array.isArray(i.exclusions) && (this._currentExclusions = i.exclusions) }, _checkRightsManagement: function () { var t = null, e = [], i = null; i = this.options.isocurveOptions.apiKey, (e = (t = this.options.isocurveOptions.filterOptions) ? t.type : []) && 0 !== e.length || (e = ["Voiture", "Pieton"]); var n = r.default.check({ key: i || this.options.apiKey, resources: e, services: ["Isochrone"] }); d.log("rightManagementIsochrone", n), i = this.options.autocompleteOptions.apiKey, (e = (t = this.options.autocompleteOptions.filterOptions) ? t.type : []) && 0 !== e.length || (e = ["PositionOfInterest", "StreetAddress"]); var o = r.default.check({ key: i || this.options.apiKey, resources: e, services: ["AutoCompletion"] }); d.log("rightManagementAutoComplete", o), n || o || (this._noRightManagement = !0), o && (this._resources.AutoCompletion = {}, this._resources.AutoCompletion.resources = o.AutoCompletion, this._resources.AutoCompletion.key = o.key), n && (this._resources.Isochrone = {}, this._resources.Isochrone.resources = n.Isochrone, this._resources.Isochrone.key = n.key) }, _detectSupport: function () { var t = !0, e = window.navigator.userAgent.toLowerCase(); return -1 === e.indexOf("iphone") && -1 === e.indexOf("ipod") && -1 === e.indexOf("ipad") && -1 === e.indexOf("android") && -1 === e.indexOf("mobile") && -1 === e.indexOf("blackberry") && -1 === e.indexOf("tablet") && -1 === e.indexOf("phone") && -1 === e.indexOf("touch") || (t = !1), -1 === e.indexOf("msie") && -1 === e.indexOf("trident") || (t = !0), t }, _initLayout: function (t) { var e = this._createMainContainerElement(), i = this._showContainer = this._createShowIsoElement(); e.appendChild(i), this.options.collapsed || (i.checked = !0); var n = this._pictoContainer = this._createShowIsoPictoElement(); e.appendChild(n); var o = this._createIsoPanelElement(), s = this._createIsoPanelHeaderElement(); o.appendChild(s); var a = this._formContainer = this._createIsoPanelFormElement(), r = this._createIsoPanelFormPointElement(t); a.appendChild(r); for (var l = !1, c = !1, u = this._createIsoPanelFormTypeChoiceElement(), d = 0; d < this.options.methods.length; d++)"time" === this.options.methods[d] && (l = 0 === d, u.appendChild(this._createIsoPanelFormTypeChoiceChronElement(l))), "distance" === this.options.methods[d] && (c = 0 === d, u.appendChild(this._createIsoPanelFormTypeChoiceDistElement(c))); a.appendChild(u), a.appendChild(this._createIsoPanelFormValueIsochronElement(l)), a.appendChild(this._createIsoPanelFormValueIsodistanceElement(c)); var p = this._createIsoPanelFormModeChoiceElement(); if (p.appendChild(this._createIsoPanelFormModeChoiceTransportElement(this.options.graphs)), p.appendChild(this._createIsoPanelFormModeChoiceDirectionElement(this.options.directions)), a.appendChild(p), this.options.exclusions && "object" === h(this.options.exclusions) && 0 !== Object.keys(this.options.exclusions).length) { a.appendChild(this._createShowIsoExclusionsElement()), a.appendChild(this._createShowIsoExclusionsPictoElement()); var m = this._createIsoPanelFormExclusionsElement(); m.appendChild(this._createIsoPanelFormExclusionOptionsElement(this.options.exclusions)), a.appendChild(m) } var f = this._createIsoFormResetElement(); a.appendChild(f); var g = this._submitContainer = this._createIsoSubmitFormElement(); a.appendChild(g), o.appendChild(a); var _ = this._waitingContainer = this._createIsoWaitingElement(); return o.appendChild(_), e.appendChild(o), e }, _createIsoPanelFormPointElement: function (t) { return this._currentPoint = new c.default({ apiKey: this.options.apiKey || null, tag: { id: 0, unique: this._uid, label: "Départ", color: "red", display: !0 }, displayInfo: !0, disableReverse: this.options.disableReverse, autocompleteOptions: this.options.autocompleteOptions || null }), this._currentPoint.setMap(t), this._currentPoint.getContainer() }, onShowIsoPanelClick: function (t) { d.log("onShowIsoPanelClick", t) }, onIsoResetClick: function (t) { d.log("onIsoResetClick", t), this._clear() }, onIsoTypeChoiceChange: function (t) { var e = t.target.value; e && ("isodistance" === e && (this._currentComputation = "distance"), "isochron" === e && (this._currentComputation = "time")) }, onIsoModeTransportChange: function (t) { var e = t.target.value; e && (this._currentTransport = e) }, onIsoModeDirectionChange: function (t) { var e = t.target.value; e && (this._currentDirection = e) }, onIsoValueChronTimeHourChange: function (t) { var e = t.target.value; this._timeHourContainer = t.target, e && (this._currentTimeHour = e) }, onIsoValueChronTimeMinuteChange: function (t) { var e = t.target.value; this._timeMinuteContainer = t.target, e && (this._currentTimeMinute = e) }, onIsoValueDistChange: function (t) { var e = t.target.value; this._distanceContainer = t.target, e && (this._currentDistance = e) }, onIsoExclusionsChange: function (t) { var e = t.target.value, i = t.target.checked; if (e) { for (var n = !1, o = null, s = 0; s < this._currentExclusions.length; s++)m(this._currentExclusions[s], e.toLowerCase()) && (o = s, n = !0); n || i || this._currentExclusions.push(e.toLowerCase()), n && i && this._currentExclusions.splice(o, 1) } }, onIsoComputationSubmit: function () { var t, e; if (this._currentPoint && this._currentPoint.getCoordinate && this._currentPoint.getCoordinate()) if ("time" === this._currentComputation.toLowerCase() && (t = 3600 * this._currentTimeHour + 60 * this._currentTimeMinute, d.log("time : ", t)), "distance" === this._currentComputation.toLowerCase() && (e = 1e3 * this._currentDistance, d.log("distance : ", e)), t || e) { if (!this._noRightManagement) { this._displayWaitingContainer(); var i = this; this._requestIsoCurve({ position: i._currentPoint.getCoordinate(), graph: i._currentTransport, exclusions: i._currentExclusions, method: i._currentComputation, reverse: "arrival" === i._currentDirection.toLowerCase(), time: t, distance: e, smoothing: !0, timeout: 7e3, protocol: "XHR", onSuccess: function (t) { d.log(t), t && i._drawIsoResults(t) }, onFailure: function (t) { i._hideWaitingContainer(), i._clearIsoResultsGeometry(), d.log(t.message) } }) } } else d.log("Missing time or distance parameter") }, _requestIsoCurve: function (t) { if (t && ("object" !== h(t) || 0 !== Object.keys(t).length) && t.position && !this._noRightManagement) { var e = this._resources.Isochrone; if (e) { var i = e.resources; if (i && ("object" !== h(i) || 0 !== Object.keys(i).length)) { var n = {}; o.a.Util.extend(n, t), o.a.Util.extend(n, this.options.isocurveOptions); for (var s = !1, r = 0; r < i.length; r++)i[r] === n.graph && (s = !0); if (s) { var l = this._resources.Isochrone.key; n.apiKey = this.options.isocurveOptions.apiKey || this.options.apiKey || l, n.ssl = this.options.ssl, d.log(n), a.default.Services.isoCurve(n) } else d.log("no rights for this service !?") } } } }, _drawIsoResults: function (t) { if (this._clearIsoResultsGeometry(), this._currentIsoResults = t, t.geometry) { var e = this._map, i = t.geometry; this._geojsonIso = o.a.geoJson(i, { style: { color: "#ff7800", weight: 5, opacity: .65 } }).addTo(e), this._hideWaitingContainer(), this._formContainer.className = "GPisochroComponentHidden" } else this._hideWaitingContainer() }, _clear: function () { this._initTransport(), this._initExclusions(), this._initComputation(), this._initDirection(), this._currentIsoResults = null, this._clearIsoResultsGeometry(), this._currentPoint.clear(), this._timeHourContainer && (this._timeHourContainer.value = 0), this._timeMinuteContainer && (this._timeMinuteContainer.value = 0), this._distanceContainer && (this._distanceContainer.value = 0) }, _clearIsoResultsGeometry: function () { var t = this._map; null != this._geojsonIso && (t.removeLayer(this._geojsonIso), this._geojsonIso = null) }, _displayWaitingContainer: function () { this._waitingContainer.className = "GPisochronCalcWaitingContainerVisible", this._waiting = !0, this._timer && (clearTimeout(this._timer), this._timer = null); var t = this; this._timer = setTimeout((function () { !0 === t._waiting ? t._hideWaitingContainer() : t._timer && clearTimeout(t._timer) }), 16e3) }, _hideWaitingContainer: function () { this._waiting && (this._waitingContainer.className = "GPisochronCalcWaitingContainerHidden", this._waiting = !1, clearTimeout(this._timer), this._timer = null) }, compute: function (t, e, i) { this._showContainer.checked || this._pictoContainer.click(); var n = this._map; if (n) { var s = { direction: "departure", method: "time", transport: "Voiture", exclusions: [] }; if (o.a.Util.extend(s, i), this._currentPoint.setCoordinate(t), o.a.DomUtil.get("GPlocationOrigin_0-" + this._uid).value = t.lng + " , " + t.lat, this._currentTransport = s.transport, "Voiture" === s.transport ? o.a.DomUtil.get("GPisochronTransportCar-" + this._uid).checked = !0 : o.a.DomUtil.get("GPisochronTransportPedestrian-" + this._uid).checked = !0, this._currentExclusions = s.exclusions, this._currentComputation = s.method, "time" === s.method) { var a = e.split("."); this._currentTimeHour = a[0] || 0, o.a.DomUtil.get("GPisochronValueChronInput1-" + this._uid).value = this._currentTimeHour, this._currentTimeMinute = a[1] || 0, o.a.DomUtil.get("GPisochronValueChronInput2-" + this._uid).value = this._currentTimeMinute, o.a.DomUtil.get("GPisochronChoiceAltChron-" + this._uid).click() } else this._currentDistance = e, o.a.DomUtil.get("GPisochronValueDistInput-" + this._uid).value = this._currentDistance, o.a.DomUtil.get("GPisochronChoiceAltDist-" + this._uid).click(); this._currentDirection = s.direction, o.a.DomUtil.get("GPisochronDirectionSelect-" + this._uid).selectedIndex = "departure" === s.direction ? 0 : 1, this.onIsoComputationSubmit(), n.flyTo(t) } } }); e.default = p; var m = function t(e, i) { if (e === i) return !0; if ("object" == h(e) && null != e && "object" == h(i) && null != i) { if (Object.keys(e).length != Object.keys(i).length) return !1; for (var n in e) { if (!i.hasOwnProperty(n)) return !1; if (!t(e[n], i[n])) return !1 } return !0 } return !1 } }, function (t, e, i) { "use strict"; i.r(e), i.d(e, "servicesVersion", (function () { return T })), i.d(e, "servicesDate", (function () { return D })); var n = i(41), o = i(56), s = i(68), a = i(69), r = i(117), l = i(118), c = i(73), u = i(74), h = i(75), d = i(76), p = i(77), m = i(78), f = i(79), g = i(80), _ = i(81), v = i(82), y = i(83), E = i(85), w = i(86), b = i(84), P = i(107), C = i(109), M = i(108), S = i(114), L = i(130), x = i(124), G = i(125), I = i(49), R = i(45), A = i(47), k = i(57); const T = k.version, D = k.date; var O = {}; O.servicesVersion = T, O.servicesDate = D, O.Protocols = {}, O.Protocols.XHR = I.default, O.Services = n.default, O.Services.DefaultUrl = o.default, O.Services.AltiResponse = s.default, O.Services.Alti = {}, O.Services.Alti.Elevation = a.default, O.Services.AutoCompleteResponse = r.default, O.Services.AutoComplete = {}, O.Services.AutoComplete.SuggestedLocation = l.default, O.Services.GetConfigResponse = c.default, O.Services.Config = {}, O.Services.Config.Constraint = u.default, O.Services.Config.Format = h.default, O.Services.Config.Layer = d.default, O.Services.Config.Legend = p.default, O.Services.Config.Metadata = m.default, O.Services.Config.Originator = f.default, O.Services.Config.Service = g.default, O.Services.Config.Style = _.default, O.Services.Config.Territory = v.default, O.Services.Config.Thematic = y.default, O.Services.Config.TileMatrix = E.default, O.Services.Config.TileMatrixLimit = w.default, O.Services.Config.TileMatrixSet = b.default, O.Services.GeocodeResponse = P.default, O.Services.Geocode = {}, O.Services.Geocode.GeocodedLocation = C.default, O.Services.Geocode.DirectGeocodedLocation = M.default, O.Services.Geocode.ReverseGeocodedLocation = S.default, O.Services.IsoCurveResponse = L.default, O.Services.RouteResponse = x.default, O.Services.Route = {}, O.Services.Route.RouteInstruction = G.default, O.Error = R.default, O.Helper = A.default, e.default = O }, function (t, e, i) { "use strict"; i.r(e); var n = i(42), o = i(70), s = i(87), a = i(110), r = i(115), l = i(119), c = i(126), u = { getConfig: function (t) { new o.default(t).call() }, getAltitude: function (t) { new n.default(t).call() }, geocode: function (t) { new s.default(t).call() }, reverseGeocode: function (t) { new a.default(t).call() }, autoComplete: function (t) { new r.default(t).call() }, route: function (t) { new l.default(t).call() }, isoCurve: function (t) { new c.default(t).call() } }; e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(46), r = i(56), l = i(58), c = i(65); function u(t) { if (!(this instanceof u)) throw new TypeError(o.default.getMessage("CLASS_CONSTRUCTOR", "Alti")); if (this.CLASSNAME = "Alti", a.default.apply(this, arguments), this.logger = n.default.getLogger("Gp.Services.Alti"), this.logger.trace("[Constructeur Alti (options)]"), !t.positions) throw new Error(o.default.getMessage("PARAM_MISSING", "positions")); if (0 === t.positions.length) throw new Error(o.default.getMessage("PARAM_EMPTY", "positions")); if (this.options.positions = t.positions, this.options.outputFormat = "string" == typeof t.outputFormat ? t.outputFormat.toLowerCase() : "xml", this.options.sampling = t.sampling || null, this.options.api = "string" == typeof t.api ? t.api.toUpperCase() : "REST", "REST" === this.options.api && (this.options.httpMethod = "GET"), this.options.zonly = t.zonly || !1, !this.options.serverUrl) { var e = r.default.Alti.url(this.options.apiKey), i = null; switch (this.options.api) { case "WPS": i = e.wps; break; case "REST": i = e[(t.sampling ? "profil" : "elevation") + "-" + this.options.outputFormat]; break; default: throw new Error(o.default.getMessage("PARAM_UNKNOWN", "api")) }if (!i) throw new Error("Url by default not found !"); this.options.serverUrl = i, this.logger.trace("Server URL by default : " + this.options.serverUrl) } var s = this.options.serverUrl.lastIndexOf("."); if (-1 !== s) { var l = this.options.serverUrl.substring(s + 1); if (l && l.length < 5) switch (this.logger.trace("Server Extension URL : " + l), l.toLowerCase()) { case "json": case "xml": this.options.outputFormat = l.toLowerCase(); break; default: throw new Error("type of service : unknown or unsupported (json or xml) !") } } } u.prototype = Object.create(a.default.prototype, {}), u.prototype.constructor = u, u.prototype.buildRequest = function (t, e) { var i = { httpMethod: this.options.httpMethod, onSuccess: function (t) { this.request = t, e.call(this, this.request) }, onError: t, scope: this, positions: this.options.positions, outputFormat: this.options.outputFormat, sampling: this.options.sampling, api: this.options.api, zonly: this.options.zonly }; l.default.build(i) }, u.prototype.analyzeResponse = function (t, e) { if (this.response) { var i = { response: this.response, outputFormat: this.options.outputFormat, rawResponse: this.options.rawResponse, onError: t, onSuccess: e, scope: this }; c.default.build(i) } else t.call(this, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) }, e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = i(35), o = { getLogger: function (t) { "false".match(/true/) ? n.disableAll() : n.enableAll(); var e = t || "default"; return n.getLogger(e) } }; e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = { PARAM_MISSING: "Parameter(s) '%var%' missing", PARAM_EMPTY: "Parameter(s) '%var%' empty", PARAM_TYPE: "Wrong type(s) for parameter(s) '%var%'", PARAM_FORMAT: "Parameter(s) '%var%' not correctly formatted", PARAM_NOT_SUPPORT: "Value(s) for parameter(s) '%var%' not supported", PARAM_NOT_SUPPORT_NODEJS: "Value(s) for parameter(s) '%var%' not supported to NodeJS", PARAM_UNKNOWN: "Value(s) for parameter(s) '%var%' unknown", SERVICE_REQUEST_BUILD: "An error occurred during the request building of the service", SERVICE_REQUEST_EMPTY: "The request sent to the service is empty", SERVICE_RESPONSE_EXCEPTION: "The service returned an exception : '%var%'", SERVICE_RESPONSE_EXCEPTION_2: "The service returned an exception", SERVICE_RESPONSE_ANALYSE: "An error occurred while parsing the response '%var%' of the service", SERVICE_RESPONSE_ANALYSE_2: "An unknown error occurred while parsing the response", SERVICE_RESPONSE_EMPTY: "The response of the service is empty", SERVICE_RESPONSE_EMPTY_2: "The response from the service could not be analyzed or is empty", SERVICE_RESPONSE_FORMAT: "The format of the service response is not supported (handled format(s) : '%var%')", SERVICE_RESPONSE_FORMAT_2: "The format of the service response is not supported", SERVICE_RESPONSE_FORMAT_3: "No suggestion matching the search", CLASS_CONSTRUCTOR: "'%var%' constructor cannot be called as a function.", getMessage: function (t, e) { if (0 === Object.keys(arguments).length) return "Message indefined !"; var i = Array.prototype.slice.call(arguments), n = i.shift(), o = i, s = this[n]; try { s = Array.isArray(o) && o.length > 0 ? s.replace("%var%", o.join(" - ")) : s.replace("%var%", "%var% (not specified)") } catch (t) { } return s } }; e.default = n }, function (t, e, i) { "use strict"; function n(t) { if (!(this instanceof n)) throw new TypeError("ErrorService constructor cannot be called as a function."); var e = t; "string" == typeof t || t instanceof String ? (this.message = t, this.status = -1, this.type = n.TYPE_UNKERR) : (this.message = e.message || "undefined!?", this.type = e.type, this.status = e.status || -1), this.name = "ErrorService", this.stack = (new Error).stack } i.r(e), n.TYPE_SRVERR = "SERVICE_ERROR", n.TYPE_USEERR = "USAGE_ERROR", n.TYPE_UNKERR = "UNKNOWN_ERROR", n.prototype = Object.create(Error.prototype, { constructor: { value: n, writable: !0, configurable: !0 } }), e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(47), s = i(44), a = i(48), r = i(45), l = i(56), c = i(57); function u(t) { if (!(this instanceof u)) throw new TypeError(s.default.getMessage("CLASS_CONSTRUCTOR")); for (var e in this.logger = n.default.getLogger("CommonService"), this.logger.trace("[Constructeur CommonService (options)]"), this.options = { protocol: "XHR", ssl: !0, proxyURL: "", callbackSuffix: null, httpMethod: "GET", timeOut: 0, rawResponse: !1, scope: this, onSuccess: function (t) { console.log("onSuccess - la reponse est la suivante : ", t) }, onFailure: function (t) { 200 !== t.status && t.status ? console.log("onFailure - Erreur (", t.status, ") : ", t.message) : console.log("onFailure : ", t.message) } }, t) t.hasOwnProperty(e) && (this.options[e] = t[e]); if (!this.options.apiKey && !this.options.serverUrl) throw new Error(s.default.getMessage("PARAM_MISSING", "apiKey", "serverUrl")); if (this.options.rawResponse && !this.options.onSuccess && (this.options.onSuccess = function (t) { console.log("onSuccess - la réponse brute du service est la suivante : ", t) }), !!(null === this.options.onSuccess || "function" != typeof this.options.onSuccess)) throw new Error(s.default.getMessage("PARAM_MISSING", "onSuccess()")); if (!this.options.serverUrl) { l.default.ssl = this.options.ssl; var i = l.default[this.CLASSNAME].url(this.options.apiKey); "string" == typeof i ? this.options.serverUrl = i : this.logger.trace("URL par defaut à determiner au niveau du composant...") } switch (this.options.httpMethod = "string" == typeof t.httpMethod ? t.httpMethod.toUpperCase() : "GET", this.options.httpMethod) { case "POST": case "GET": break; case "PUT": case "DELETE": case "HEAD": case "OPTIONS": throw new Error(s.default.getMessage("PARAM_NOT_SUPPORT", "httpMethod")); default: throw new Error(s.default.getMessage("PARAM_UNKNOWN", "httpMethod")) }switch (this.options.protocol = "string" == typeof t.protocol ? t.protocol.toUpperCase() : "XHR", this.options.protocol) { case "JSONP": case "XHR": break; default: throw new Error(s.default.getMessage("PARAM_UNKNOWN", "protocol")) }if ("undefined" == typeof window && "JSONP" === this.options.protocol) throw new Error(s.default.getMessage("PARAM_NOT_SUPPORT_NODEJS", "protocol=JSONP (instead use XHR)")); "JSONP" === this.options.protocol && (this.options.httpMethod = "GET"), this.options.nocache = t.nocache || !1, this.options.outputFormat = null, this.request = null, this.response = null } u.prototype = { constructor: u, call: function () { this.logger.trace("CommonService::call ()"); var t = this; function e(e) { this.logger.trace("CommonService::onBuildRequest : ", e), this.callService.call(t, o, i) } function i(e) { this.logger.trace("CommonService::onCallService : ", e), this.analyzeResponse.call(t, o, n) } function n(t) { if (this.logger.trace("CommonService::onAnalyzeResponse : ", t), !t) return o.call(this, new r.default("Analyse de la reponse en échec !?")); this.options.onSuccess.call(this, t) } function o(t) { this.logger.trace("CommonService::onError()"); var e = t; e instanceof r.default || (e = new r.default(t.message)), this.options.onFailure.call(this, e) } (function () { this.logger.trace("CommonService::run ()"), this.buildRequest.call(t, o, e) }).call(t) }, buildRequest: function (t, e) { this.logger.error("overwritten method !"), t && t.call(this, "This method must be overwritten !"), e.call(this, "This method must be overwritten !") }, callService: function (t, e) { var i = null, n = this.request, s = !(!this.options.proxyURL || "XHR" !== this.options.protocol); this.options.serverUrl = o.default.normalyzeUrl(this.options.serverUrl, { "gp-access-lib": c.version }, !1), s && ("GET" === this.options.httpMethod && (i = this.options.proxyURL + o.default.normalyzeUrl(this.options.serverUrl, this.request, !0), n = null), "POST" === this.options.httpMethod && (i = this.options.proxyURL + o.default.normalyzeUrl(this.options.serverUrl, null, !0), n = this.request)); var l = this, u = { url: i || this.options.serverUrl, method: this.options.httpMethod, protocol: this.options.protocol, timeOut: this.options.timeOut || 0, format: this.options.outputFormat, nocache: this.options.nocache || !1, wrap: "XHR" !== this.options.protocol, callbackSuffix: this.options.callbackSuffix, data: n, headers: null, content: this.options.contentType || "application/xml", scope: this.options.scope || this, onResponse: function (i) { l.logger.trace("callService::onResponse()"); var n = null; if ("XHR" === l.options.protocol && (l.logger.trace("Response XHR", i), n = i), "JSONP" === l.options.protocol) { if (l.logger.trace("Response JSON", i), !i) return void t.call(l, new r.default("Le contenu de la reponse est vide !?")); if (i.http) { if (200 !== i.http.status) return void t.call(l, new r.default({ status: i.http.status, message: i.http.error, type: r.default.TYPE_SRVERR })); n = i.xml, l.options.rawResponse && (n = i) } else n = i } if ("function" == typeof l.options.onBeforeParse) { var o = l.options.onBeforeParse(n); "string" == typeof o && (n = o) } l.response = n, e.call(l, n) }, onFailure: function (e) { l.logger.trace("callService::onFailure()"), e.type = r.default.TYPE_SRVERR, t.call(l, new r.default(e)) }, onTimeOut: function () { l.logger.trace("callService::onTimeOut()"), t.call(l, new r.default("TimeOut!")) } }; a.default.send(u) }, analyzeResponse: function (t, e) { this.logger.error("overwritten method !"), t && t.call(this, "This method must be overwritten !"), e.call(this, "This method must be overwritten !") } }, e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = { normalyzeParameters: function (t) { var e = null; if (t) { var i = []; for (var n in t) if (t.hasOwnProperty(n)) { var o = t[n]; o || (o = ""), i.push(n + "=" + o) } e = i.join("&") } return e }, normalyzeUrl: function (t, e, i) { var n = t; if (t) { var o = t.indexOf("?"); -1 === o && (n += "?"), -1 !== o && o !== t.length - 1 && (n += "&") } return e && (n += "string" == typeof e ? e : this.normalyzeParameters(e)), i && (n = encodeURIComponent(n)), n }, indent: function (t, e) { return new Array((t || 0) + 1).join("\t") + e } }; e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(47), o = i(49), s = i(55), a = { send: function (t) { var e = t || { method: "GET", protocol: "XHR", timeOut: 0, format: null, wrap: !0, nocache: !0, output: "json", callback: null, callbackSuffix: null }; if ("undefined" != typeof window || "JSONP" !== t.protocol) { if ("XHR" === t.protocol || "json" === t.format ? e.wrap = !1 : "JSONP" === t.protocol && "xml" === t.format && (e.wrap = !0), e.callback = null, e.output = e.wrap ? "json" : null, e.wrap) { var i = {}; i.output = e.output, i.callback = e.callback, delete i.callback, e.url = n.default.normalyzeUrl(t.url, i) } switch (e.protocol) { case "XHR": "GET" === t.method && t.nocache && (e.url = n.default.normalyzeUrl(e.url, { t: (new Date).getTime() })), o.default.call(e); break; case "JSONP": e.data && (e.url = n.default.normalyzeUrl(e.url, e.data)), s.default.call(e); break; default: throw new Error("protocol not supported (XHR|JSONP) !") } } else console.log("Value (s) for parameter (s) 'protocol=JSONP (instead use XHR)' not supported to NodeJS") } }; e.default = a }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(47), s = i(50), a = i.n(s), r = { call: function (t) { var e = n.default.getLogger("XHR"); if (e.trace("[XHR::call()]"), a.a.polyfill(), !t.url) throw new Error("missing parameter : url is not defined !"); if (!t.method) throw new Error("missing parameter : method is not defined !"); t.format || (t.format = "text"); var i = {}; switch (i.url = t.url, i.data = t.data ? t.data : null, i.method = t.method, i.timeOut = t.timeOut || 0, i.scope = t.scope || this, i.proxy = t.proxy || null, i.content = t.content || null, i.headers = t.headers || { referer: "http://localhost" }, t.method) { case "DELETE": case "GET": break; case "PUT": case "POST": i.content = t.content ? t.content : "application/x-www-form-urlencoded", i.headers = t.headers ? t.headers : { referer: "http://localhost" }; break; case "HEAD": case "OPTIONS": throw new Error("HTTP method not yet supported !"); default: throw new Error("HTTP method unknown !") }switch (t.format) { case "text": this.__call(i).then((function (i) { e.trace(i), t.onResponse.call(this, i) })).catch((function (e) { t.onFailure.call(this, e) })); break; case "json": this.__callJSON(i).then((function (i) { e.trace(i), t.onResponse.call(this, i) })).catch((function (e) { t.onFailure.call(this, e) })); break; case "xml": this.__callXML(i).then((function (i) { e.trace(i), t.onResponse.call(this, i) })).catch((function (e) { t.onFailure.call(this, e) })); break; default: throw new Error("This output Format is not yet supported !") } }, __call: function (t) { var e = n.default.getLogger("XHR"); return e.trace("[XHR::__call()]"), new Promise((function (n, s) { var a = "POST" === t.method || "PUT" === t.method ? 1 : 0; t.data && ("object" == typeof t.data && Object.keys(t.data).length || "string" == typeof t.data && t.data.length) && !a && (t.url = o.default.normalyzeUrl(t.url, t.data)), e.trace("URL = ", t.url); var r = null; if ("undefined" == typeof window) { var l = i(53), c = { headers: { Referer: "https://localhost" } }; return t.data && "string" == typeof t.data && a && (c = { method: t.method, body: t.data, headers: { "Content-Type": t.content, Referer: "https://localhost" } }), l(t.url, c).then((function (t) { if (t.ok) n(t.text()); else { var e = "Errors Occured on Http Request (status : '" + t.statusText + "' | url : '" + t.url + "')", i = t.status; s({ message: e, status: i }) } })).catch((function (t) { s({ message: t, status: -1 }) })) } if (window.XMLHttpRequest) { e.trace("XMLHttpRequest"), (r = new XMLHttpRequest).open(t.method, t.url, !0), r.overrideMimeType = t.content; var u = null; t.timeOut > 0 && (e.trace("XHR - TimeOut actif !"), u = window.setTimeout((function () { s({ message: "TimeOut Occured on Http Request with XMLHttpRequest !", status: -1 }) }), t.timeOut)), a && (e.trace("data = ", t.data), r.setRequestHeader("Content-type", t.content)), r.onerror = function (t) { console.log(t), s(new Error("Errors Occured on Http Request with XMLHttpRequest !")) }, r.ontimeout = function (t) { console.log(t), s(new Error("TimeOut Occured on Http Request with XMLHttpRequest !")) }, r.onreadystatechange = function (t) { if (4 === r.readyState) if (200 === r.status) window.clearTimeout(u), n(r.response); else { var e = "Errors Occured on Http Request (status : '" + t.target.statusText + "' | url : '" + t.target.responseURL + "')", i = t.target.status; s({ message: e, status: i }) } }; var h = t.data && a ? t.data : null; r.send(h) } else { if (!window.XDomainRequest) throw new Error("CORS not supported"); e.trace("XDomainRequest"), (r = new XDomainRequest).open(t.method, t.url), r.overrideMimeType = t.content, t.timeOut > 0 && (r.timeout = t.timeout, e.trace("XHR - TimeOut actif !")), a && r.setRequestHeader("Content-type", t.content), r.onerror = function () { s(new Error("Errors Occured on Http Request with XMLHttpRequest !")) }, r.ontimeout = function () { s(new Error("TimeOut Occured on Http Request with XMLHttpRequest !")) }, r.onload = function (t) { if (200 === r.status) n(r.responseText); else { var e = "Errors Occured on Http Request (status : '" + t.target.statusText + "' | url : '" + t.target.responseURL + "')", i = t.target.status; s({ message: e, status: i }) } }; var d = t.data && a ? t.data : null; r.send(d) } })) }, __callJSON: function (t) { return this.__call(t).then(JSON.parse).catch((function (e) { console.log("_callJSON failed on : ", t.url, e) })) }, __callXML: function (t) { return this.__call(t).then((function (t) { var e; "undefined" == typeof window ? e = (new (0, i(54).DOMParser)).parseFromString(t, "text/xml") : window.DOMParser ? e = (new window.DOMParser).parseFromString(t, "text/xml") : ((e = new window.ActiveXObject("Microsoft.XMLDOM")).async = !1, e.loadXML(t)); return e })).catch((function (e) { console.log("__callXML failed on : ", t.url, e) })) } }; e.default = r }, function (t, e, i) {
    (function (e, i) {
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n; n = function () { "use strict"; function t(t) { return "function" == typeof t } var n = Array.isArray ? Array.isArray : function (t) { return "[object Array]" === Object.prototype.toString.call(t) }, o = 0, s = void 0, a = void 0, r = function (t, e) { m[o] = t, m[o + 1] = e, 2 === (o += 2) && (a ? a(f) : E()) }, l = "undefined" != typeof window ? window : void 0, c = l || {}, u = c.MutationObserver || c.WebKitMutationObserver, h = "undefined" == typeof self && void 0 !== e && "[object process]" === {}.toString.call(e), d = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel; function p() { var t = setTimeout; return function () { return t(f, 1) } } var m = new Array(1e3); function f() { for (var t = 0; t < o; t += 2)(0, m[t])(m[t + 1]), m[t] = void 0, m[t + 1] = void 0; o = 0 } var g, _, v, y, E = void 0; function w(t, e) { var i = this, n = new this.constructor(C); void 0 === n[P] && N(n); var o = i._state; if (o) { var s = arguments[o - 1]; r((function () { return D(o, n, s, i._result) })) } else k(i, n, t, e); return n } function b(t) { if (t && "object" == typeof t && t.constructor === this) return t; var e = new this(C); return G(e, t), e } h ? E = function () { return e.nextTick(f) } : u ? (_ = 0, v = new u(f), y = document.createTextNode(""), v.observe(y, { characterData: !0 }), E = function () { y.data = _ = ++_ % 2 }) : d ? ((g = new MessageChannel).port1.onmessage = f, E = function () { return g.port2.postMessage(0) }) : E = void 0 === l ? function () { try { var t = Function("return this")().require("vertx"); return void 0 !== (s = t.runOnLoop || t.runOnContext) ? function () { s(f) } : p() } catch (t) { return p() } }() : p(); var P = Math.random().toString(36).substring(2); function C() { } var M = void 0, S = 1, L = 2; function x(e, i, n) { i.constructor === e.constructor && n === w && i.constructor.resolve === b ? function (t, e) { e._state === S ? R(t, e._result) : e._state === L ? A(t, e._result) : k(e, void 0, (function (e) { return G(t, e) }), (function (e) { return A(t, e) })) }(e, i) : void 0 === n ? R(e, i) : t(n) ? function (t, e, i) { r((function (t) { var n = !1, o = function (t, e, i, n) { try { t.call(e, i, n) } catch (t) { return t } }(i, e, (function (i) { n || (n = !0, e !== i ? G(t, i) : R(t, i)) }), (function (e) { n || (n = !0, A(t, e)) }), t._label); !n && o && (n = !0, A(t, o)) }), t) }(e, i, n) : R(e, i) } function G(t, e) { if (t === e) A(t, new TypeError("You cannot resolve a promise with itself")); else if (function (t) { var e = typeof t; return null !== t && ("object" === e || "function" === e) }(e)) { var i = void 0; try { i = e.then } catch (e) { return void A(t, e) } x(t, e, i) } else R(t, e) } function I(t) { t._onerror && t._onerror(t._result), T(t) } function R(t, e) { t._state === M && (t._result = e, t._state = S, 0 !== t._subscribers.length && r(T, t)) } function A(t, e) { t._state === M && (t._state = L, t._result = e, r(I, t)) } function k(t, e, i, n) { var o = t._subscribers, s = o.length; t._onerror = null, o[s] = e, o[s + S] = i, o[s + L] = n, 0 === s && t._state && r(T, t) } function T(t) { var e = t._subscribers, i = t._state; if (0 !== e.length) { for (var n = void 0, o = void 0, s = t._result, a = 0; a < e.length; a += 3)n = e[a], o = e[a + i], n ? D(i, n, o, s) : o(s); t._subscribers.length = 0 } } function D(e, i, n, o) { var s = t(n), a = void 0, r = void 0, l = !0; if (s) { try { a = n(o) } catch (t) { l = !1, r = t } if (i === a) return void A(i, new TypeError("A promises callback cannot return that same promise.")) } else a = o; i._state !== M || (s && l ? G(i, a) : !1 === l ? A(i, r) : e === S ? R(i, a) : e === L && A(i, a)) } var O = 0; function N(t) { t[P] = O++, t._state = void 0, t._result = void 0, t._subscribers = [] } var U = function () { function t(t, e) { this._instanceConstructor = t, this.promise = new t(C), this.promise[P] || N(this.promise), n(e) ? (this.length = e.length, this._remaining = e.length, this._result = new Array(this.length), 0 === this.length ? R(this.promise, this._result) : (this.length = this.length || 0, this._enumerate(e), 0 === this._remaining && R(this.promise, this._result))) : A(this.promise, new Error("Array Methods must be provided an Array")) } return t.prototype._enumerate = function (t) { for (var e = 0; this._state === M && e < t.length; e++)this._eachEntry(t[e], e) }, t.prototype._eachEntry = function (t, e) { var i = this._instanceConstructor, n = i.resolve; if (n === b) { var o = void 0, s = void 0, a = !1; try { o = t.then } catch (t) { a = !0, s = t } if (o === w && t._state !== M) this._settledAt(t._state, e, t._result); else if ("function" != typeof o) this._remaining--, this._result[e] = t; else if (i === j) { var r = new i(C); a ? A(r, s) : x(r, t, o), this._willSettleAt(r, e) } else this._willSettleAt(new i((function (e) { return e(t) })), e) } else this._willSettleAt(n(t), e) }, t.prototype._settledAt = function (t, e, i) { var n = this.promise; n._state === M && (this._remaining--, t === L ? A(n, i) : this._result[e] = i), 0 === this._remaining && R(n, this._result) }, t.prototype._willSettleAt = function (t, e) { var i = this; k(t, void 0, (function (t) { return i._settledAt(S, e, t) }), (function (t) { return i._settledAt(L, e, t) })) }, t }(), j = function () { function e(t) { this[P] = O++, this._result = this._state = void 0, this._subscribers = [], C !== t && ("function" != typeof t && function () { throw new TypeError("You must pass a resolver function as the first argument to the promise constructor") }(), this instanceof e ? function (t, e) { try { e((function (e) { G(t, e) }), (function (e) { A(t, e) })) } catch (e) { A(t, e) } }(this, t) : function () { throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.") }()) } return e.prototype.catch = function (t) { return this.then(null, t) }, e.prototype.finally = function (e) { var i = this, n = i.constructor; return t(e) ? i.then((function (t) { return n.resolve(e()).then((function () { return t })) }), (function (t) { return n.resolve(e()).then((function () { throw t })) })) : i.then(e, e) }, e }(); return j.prototype.then = w, j.all = function (t) { return new U(this, t).promise }, j.race = function (t) { var e = this; return n(t) ? new e((function (i, n) { for (var o = t.length, s = 0; s < o; s++)e.resolve(t[s]).then(i, n) })) : new e((function (t, e) { return e(new TypeError("You must pass an array to race.")) })) }, j.resolve = b, j.reject = function (t) { var e = new this(C); return A(e, t), e }, j._setScheduler = function (t) { a = t }, j._setAsap = function (t) { r = t }, j._asap = r, j.polyfill = function () { var t = void 0; if (void 0 !== i) t = i; else if ("undefined" != typeof self) t = self; else try { t = Function("return this")() } catch (t) { throw new Error("polyfill failed because global object is unavailable in this environment") } var e = t.Promise; if (e) { var n = null; try { n = Object.prototype.toString.call(e.resolve()) } catch (t) { } if ("[object Promise]" === n && !e.cast) return } t.Promise = j }, j.Promise = j, j }, t.exports = n()
    }).call(this, i(51), i(52))
  }, function (t, e) { var i, n, o = t.exports = {}; function s() { throw new Error("setTimeout has not been defined") } function a() { throw new Error("clearTimeout has not been defined") } function r(t) { if (i === setTimeout) return setTimeout(t, 0); if ((i === s || !i) && setTimeout) return i = setTimeout, setTimeout(t, 0); try { return i(t, 0) } catch (e) { try { return i.call(null, t, 0) } catch (e) { return i.call(this, t, 0) } } } !function () { try { i = "function" == typeof setTimeout ? setTimeout : s } catch (t) { i = s } try { n = "function" == typeof clearTimeout ? clearTimeout : a } catch (t) { n = a } }(); var l, c = [], u = !1, h = -1; function d() { u && l && (u = !1, l.length ? c = l.concat(c) : h = -1, c.length && p()) } function p() { if (!u) { var t = r(d); u = !0; for (var e = c.length; e;) { for (l = c, c = []; ++h < e;)l && l[h].run(); h = -1, e = c.length } l = null, u = !1, function (t) { if (n === clearTimeout) return clearTimeout(t); if ((n === a || !n) && clearTimeout) return n = clearTimeout, clearTimeout(t); try { return n(t) } catch (e) { try { return n.call(null, t) } catch (e) { return n.call(this, t) } } }(t) } } function m(t, e) { this.fun = t, this.array = e } function f() { } o.nextTick = function (t) { var e = new Array(arguments.length - 1); if (arguments.length > 1) for (var i = 1; i < arguments.length; i++)e[i - 1] = arguments[i]; c.push(new m(t, e)), 1 !== c.length || u || r(p) }, m.prototype.run = function () { this.fun.apply(null, this.array) }, o.title = "browser", o.browser = !0, o.env = {}, o.argv = [], o.version = "", o.versions = {}, o.on = f, o.addListener = f, o.once = f, o.off = f, o.removeListener = f, o.removeAllListeners = f, o.emit = f, o.prependListener = f, o.prependOnceListener = f, o.listeners = function (t) { return [] }, o.binding = function (t) { throw new Error("process.binding is not supported") }, o.cwd = function () { return "/" }, o.chdir = function (t) { throw new Error("process.chdir is not supported") }, o.umask = function () { return 0 } }, function (t, e) { var i; i = function () { return this }(); try { i = i || new Function("return this")() } catch (t) { "object" == typeof window && (i = window) } t.exports = i }, function (t, i) { t.exports = e }, function (t, e) { t.exports = i }, function (t, e, i) { "use strict"; i.r(e); var n, o = i(43), s = { uuid: (n = Math.floor(Date.now()), function () { return n++ }), call: function (t) { var e = o.default.getLogger("JSONP"); if (e.trace("[JSONP::call ()]"), !t) throw e.error("missing parameter : options !"), new Error("missing parameter : options !"); if (!t.url) throw e.error("missing parameter : options.url !"), new Error("missing parameter : options.url !"); if (t.timeOut || (e.info("setting 'options.timeOut' default value"), t.timeOut = 0), !t.onResponse) throw e.error("missing parameter : options.onResponse !"), new Error("missing parameter : options.onResponse !"); var i = "string" == typeof t.callbackSuffix ? t.callbackSuffix : this.uuid(), n = !1, s = !1, a = t.url.indexOf("callback="); if (-1 !== a) { n = !0; var r = t.url.indexOf("&", a); -1 === r && (r = t.url.length); var l = t.url.substring(a + 9, r); l && (s = !0, t.callbackName = l, e.info("setting 'options.callbackName' value (" + t.callbackName + ") from 'options.url' parameter")) } if (!n) { var c = t.url.indexOf("?"); -1 === c ? t.url = t.url + "?callback=" : c === t.url.length ? t.url = t.url + "callback=" : t.url = t.url + "&callback=", e.info("setting callback default key in 'options.url' : " + t.url) } var u = !!t.callbackName || s; if (s || (t.callbackName || (e.info("setting 'options.callbackName' default value"), t.callbackName = "callback", (i || "" === i) && (t.callbackName += i)), t.url = t.url.replace("callback=", "callback=" + t.callbackName), e.info("setting callback function name in 'options.url' : " + t.url)), t.onTimeOut || (e.info("setting 'options.onTimeOut' default value"), t.onTimeOut = function () { console.log("TimeOut while invoking url : " + t.url) }), !u) { var h = this, d = null; t.timeOut > 0 && (d = window.setTimeout((function () { window[t.callbackName] = function () { }, t.onTimeOut(), h._deleteScript(i) }), t.timeOut)), window[t.callbackName] = function (e) { window.clearTimeout(d), t.onResponse(e), h._deleteScript(i) } } this._createScript(i, t.url) }, _createScript: function (t, e) { var i, n = document.getElementById("results" + t); (i = document.createElement("script")).setAttribute("type", "text/javascript"), i.setAttribute("src", e), i.setAttribute("charset", "UTF-8"), i.setAttribute("id", "results" + t), i.setAttribute("async", "true"); var o = document.documentElement || document.getElementsByTagName("head")[0]; null === n ? o.appendChild(i) : o.replaceChild(i, n) }, _deleteScript: function (t) { var e = document.getElementById("results" + t); if (e) { var i = e.parentNode || document.documentElement; if (!i) return; i.removeChild(e) } } }; e.default = s }, function (t, e, i) { "use strict"; i.r(e); var n = { ssl: !0, url: function (t, e) { return (!1 === n.ssl ? "http://" : "https://") + "wxs.ign.fr".concat("/", t, e) }, Alti: { _key: { "elevation-json": "/alti/rest/elevation.json", "elevation-xml": "/alti/rest/elevation.xml", "profil-json": "/alti/rest/elevationLine.json", "profil-xml": "/alti/rest/elevationLine.xml", wps: "/alti/wps" }, url: function (t) { return { "elevation-json": n.url(t, this._key["elevation-json"]), "elevation-xml": n.url(t, this._key["elevation-xml"]), "profil-json": n.url(t, this._key["profil-json"]), "profil-xml": n.url(t, this._key["profil-xml"]), wps: n.url(t, this._key.wps) } } }, ProcessIsoCurve: { _key: "/geoportail/isochrone/rest/1.0.0/isochrone", url: function (t) { return n.url(t, this._key) } }, AutoComplete: { _key: "/ols/apis/completion", url: function (t) { return n.url(t, this._key) } }, ReverseGeocode: { _key: "/geoportail/ols", url: function (t) { return n.url(t, this._key) } }, AutoConf: { _key: { apiKey: "/autoconf", apiKeys: "/autoconf?keys=%KEYS%", aggregate: "/autoconf/id/" }, url: function (t) { var e = ""; if (Array.isArray(t) && t.length > 0) { e = t[0]; for (var i = 1; i < t.length; i++)e += "," + t[i] } return { apiKey: n.url(t, this._key.apiKey), apiKeys: n.url(t[0], this._key.apiKeys).replace("%KEYS%", e), aggregate: n.url(t, this._key.aggregate) } } }, Geocode: { _key: "/geoportail/ols", url: function (t) { return n.url(t, this._key) } }, Route: { _key: "/geoportail/itineraire/rest/1.0.0/route", url: function (t) { return n.url(t, this._key) } } }; e.default = n }, function (t) { t.exports = JSON.parse('{"_from":"geoportal-access-lib@3.1.0","_id":"geoportal-access-lib@3.1.0","_inBundle":false,"_integrity":"sha512-2G24zh3wkfF43++KbCCfG1x4t3QseaiV1x75urlKRhVgFHXTzC8D9MWnaPUeVVyBbgskhr9rV/ZzFFwGPdTBrQ==","_location":"/geoportal-access-lib","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"geoportal-access-lib@3.1.0","name":"geoportal-access-lib","escapedName":"geoportal-access-lib","rawSpec":"3.1.0","saveSpec":null,"fetchSpec":"3.1.0"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/geoportal-access-lib/-/geoportal-access-lib-3.1.0.tgz","_shasum":"8b53fab5865e73917dc16b43dc1ec8889d45235d","_spec":"geoportal-access-lib@3.1.0","_where":"/home/runner/work/geoportal-extensions/geoportal-extensions","author":{"name":"IGNF"},"bugs":{"url":"https://github.com/IGNF/geoportal-access-lib/issues"},"bundleDependencies":false,"date":"23/03/2022","dependencies":{"es6-promise":"^4.2.4","node-fetch":"^2.6.1","xmldom":"^0.1.27"},"deprecated":false,"description":"French Geoportal resources access library","devDependencies":{"@babel/core":"^7.12.10","@babel/plugin-transform-template-literals":"^7.12.1","@babel/preset-env":"^7.12.11","babel-loader":"^8.2.2","chai":"^4.1.2","clean-webpack-plugin":"^3.0.0","copy-webpack-plugin":"^5.1.2","eslint":"^7.18.0","eslint-config-standard":"^16.0.2","eslint-loader":"^4.0.2","eslint-plugin-import":"^2.22.1","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^5.0.0","glob":"^7.1.2","handlebars-layouts":"^3.1.4","handlebars-webpack-plugin":"^1.4.1","html-webpack-plugin":"^4.5.1","istanbul-instrumenter-loader":"^3.0.1","jsdoc-webpack-plugin":"^0.3.0","loglevel":"^1.6.1","mocha":"^7.2.0","mocha-loader":"^5.1.5","mocha-webpack":"^2.0.0-beta.0","mochawesome":"^6.2.1","nyc":"^15.1.0","path":"^0.12.7","replace-bundle-webpack-plugin":"^1.0.0","sinon":"^9.2.4","sinon-es6":"0.0.3","speed-measure-webpack-plugin":"^1.4.2","string-template":"^1.0.0","terser-webpack-plugin":"^2.3.8","webpack":"^4.46.0","webpack-cli":"^3.3.12","webpack-dev-server":"^3.11.2","webpack-node-externals":"^2.5.2","webpack-shell-plugin":"^0.5.0"},"homepage":"https://github.com/IGNF/geoportal-access-lib#readme","keywords":["geoportail","webservice","javascript","es6"],"license":"CECILL-B","main":"dist/GpServices-src.js","module":"src/Gp.js","name":"geoportal-access-lib","nyc":{"include":["src/**/*.js"],"instrument":false,"sourceMap":false},"optionalDependencies":{},"peerDependencies":{},"repository":{"type":"git","url":"git+https://github.com/IGNF/geoportal-access-lib.git"},"scripts":{"build":"webpack --mode=none","build:dev":"webpack --mode=development","build:prod":"webpack --mode=production","clean":"echo \\"Warning: no yet implemented!\\" && exit 0","cover":"nyc --reporter=lcov --reporter=text npm run test","doc":"npm run doc:serve","doc:serve":"webpack-dev-server --content-base jsdoc --port 9001 --open","eslint":"eslint src/","sample":"npm run sample:serve","sample:serve":"webpack-dev-server --mode=none --open-page samples/index-src.html --https --content-base . --output-public-path \'/dist/\' --port 9001 --open","sample:serve:dev":"webpack-dev-server --mode=development --open-page samples/index-map.html --content-base . --output-public-path \'/dist/\' --port 9001 --open","sample:serve:prod":"webpack-dev-server --mode=production --open-page samples/index-prod.html --content-base . --output-public-path \'/dist/\' --port 9001 --open","setup":"npm install","test":"mocha-webpack --reporter mochawesome --reporter-options reportDir=test-report,reportFilename=index --webpack-config ./test/webpack/webpack.test.js --glob \\"test_*.js\\" test/spec/","test:end-to-end:serve":"webpack-dev-server --hot --config ./test/webpack/webpack.end-to-end.serve.js","test:end-to-end:serve:docker":"webpack-dev-server --hot --config ./test/webpack/webpack.end-to-end.serve.docker.js","test:serve":"webpack-dev-server --hot --config ./test/webpack/webpack.test.serve.js","test:serve:docker":"webpack-dev-server --hot --config ./test/webpack/webpack.test.serve.docker.js"},"version":"3.1.0"}') }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(45), s = i(59), a = i(63), r = { build: function (t) { n.default.getLogger("AltiRequestFactory").trace(["AltiRequestFactory::build()"]); var e = null, i = { type: t.sampling ? "Profil" : "Elevation", method: t.httpMethod, param: { positions: null, delimiter: null, indent: null, crs: null, format: null, sampling: null, zonly: null } }; i.param.positions = t.positions, i.param.format = t.outputFormat, i.param.sampling = t.sampling, i.param.zonly = t.zonly; var r = !(null === t.onError || "function" != typeof t.onError), l = !(null === t.onSuccess || "function" != typeof t.onSuccess), c = null; switch (t.api) { case "REST": var u = new s.default(i); if (!u.processRequestString()) { if (c = "Error in process request (rest) !", r) return void t.onError.call(t.scope, new o.default(c)); throw new Error(c) } e = u.requestString; break; case "WPS": if (i.wps = { service: null, version: null, identifier: null, rawdataoutput: null, request: null }, !(e = a.default.build(i))) { if (c = "Error in process request (wps) !", r) return void t.onError.call(t.scope, new o.default(c)); throw new Error(c) } break; default: if (c = "Type of API is not supported by service (REST or WPS) !", r) return void t.onError.call(t.scope, new o.default(c)); throw new Error(c) }return l && t.onSuccess.call(t.scope, e), e } }; e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(60), a = i(62); function r(t) { if (this.logger = n.default.getLogger("AltiRequestREST"), this.logger.trace("[Constructeur AltiRequestREST ()]"), !(this instanceof r)) throw new TypeError("AltiRequestREST constructor cannot be called as a function."); if (this.options = t || {}, !this.options) throw new Error(o.default.getMessage("PARAM_EMPTY", "options")); if (!this.options.type) throw new Error(o.default.getMessage("PARAM_EMPTY", "type (Elevation or Profil)")); switch (this.DataObject = null, this.options.type) { case "Elevation": this.DataObject = new s.default(this.options.param); break; case "Profil": this.DataObject = new a.default(this.options.param); break; default: throw new Error(o.default.getMessage("PARAM_TYPE", "type (Elevation or Profil)")) }this.method = this.options.method || "GET" } r.prototype = { requestString: null, constructor: r, template: { get: { value: "lon=__LON__&lat=__LAT__&indent=__INDENT__&crs='__CRS__'", input: { point: "&zonly=__ZONLY__", profil: "&sampling=__SAMPLING__" } }, post: { value: "lon=__LON__\nlat=__LAT__\nindent=__INDENT__\ncrs='__CRS__'\n", input: { point: "zonly=__ZONLY__", profil: "sampling=__SAMPLING__" } } }, processRequestString: function () { this.logger.trace("AltiRequestREST::processRequestString ()"); var t = ""; return "POST" === this.method ? t = this.template.post.value : "GET" === this.method && (t = this.template.get.value), t = (t = (t = (t = t.replace(/__LON__/g, this.DataObject.getLon())).replace(/__LAT__/g, this.DataObject.getLat())).replace(/__INDENT__/g, this.DataObject.indent)).replace(/__CRS__/g, this.DataObject.crs), t += this.__addDataInputs(), this.logger.trace("traduction tmpl", t), this.requestString = t, this.requestString }, __addDataInputs: function () { var t; if (this.logger.trace("AltiRequestREST::addDataInput ()"), "POST" === this.method) t = this.template.post; else { if ("GET" !== this.method) throw new Error("No other HTTP method supported by the service !"); t = this.template.get } if ("AltiElevationRequest" === this.DataObject.CLASSNAME) return t.input.point.replace(/__ZONLY__/g, this.DataObject.zonly); if ("AltiProfilRequest" === this.DataObject.CLASSNAME) return t.input.profil.replace(/__SAMPLING__/g, this.DataObject.sampling); throw new Error("No other object supported than elevation or profil !?") } }, e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(61); function s(t) { if (!(this instanceof s)) throw new TypeError("AltiElevationRequest constructor cannot be called as a function."); this.CLASSNAME = "AltiElevationRequest", o.default.apply(this, arguments), this.logger = n.default.getLogger(), this.logger.trace("[Constructeur AltiElevationRequest ()]"), this.zonly = this.options.zonly || !1 } s.prototype = Object.create(o.default.prototype, { zonly: { get: function () { return this._zonly }, set: function (t) { this._zonly = t } } }), s.prototype.constructor = s, s.prototype.getData = function () { var t = []; return t.push({ k: "lon", v: this.getLon() }), t.push({ k: "lat", v: this.getLat() }), t.push({ k: "indent", v: this.indent }), t.push({ k: "crs", v: this.crs }), t.push({ k: "zonly", v: this.zonly }), t.push({ k: "format", v: this.format }), t }, e.default = s }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (!(this instanceof o)) throw new TypeError("AltiRequest constructor cannot be called as a function."); this.logger = n.default.getLogger(), this.logger.trace("[Constructeur AltiRequest ()]"), this.options = t || {}, this.positions = this.options.positions || [], this.delimiter = this.options.delimiter || "|", this.indent = this.options.indent || !1, this.crs = this.options.crs || "CRS:84", this.format = this.options.format || "json" } o.CLASSNAME = "AltiRequest", o.prototype = { constructor: o, setPositions: function (t) { for (var e = [], i = 0; i < t.length; i++) { var n = t[i]; n.lon && n.lat && e.push(n) } this.positions = e }, getPositions: function (t) { if (!t) return this.positions; var e = this.positions.length - 1; return t > e || t < e ? (this.logger.warn("index out of range !"), this.positions) : this.positions[t] }, addPositions: function (t) { for (var e = 0; e < t.length; e++) { var i = t[e]; i.lon && i.lat && this.positions.push(t[e]) } }, getLon: function () { for (var t = [], e = 0; e < this.positions.length; e++)t.push(this.positions[e].lon); return this.logger.trace(t), t.join(this.delimiter) }, getLat: function () { for (var t = [], e = 0; e < this.positions.length; e++)t.push(this.positions[e].lat); return this.logger.trace(t), t.join(this.delimiter) } }, o.prototype.getData = function () { var t = []; return t.push({ k: "lon", v: this.getLon() }), t.push({ k: "lat", v: this.getLat() }), t.push({ k: "delimiter", v: this.delimiter }), t.push({ k: "indent", v: this.indent }), t.push({ k: "crs", v: this.crs }), t.push({ k: "format", v: this.format }), t }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(61); function s(t) { if (!(this instanceof s)) throw new TypeError("AltiProfilRequest constructor cannot be called as a function."); this.CLASSNAME = "AltiProfilRequest", o.default.apply(this, arguments), this.logger = n.default.getLogger(), this.logger.trace("[Constructeur AltiProfilRequest ()]"), this.sampling = this.options.sampling || 3 } s.prototype = Object.create(o.default.prototype, { sampling: { get: function () { return this._sampling }, set: function (t) { this._sampling = t } } }), s.prototype.constructor = s, s.prototype.getData = function () { var t = []; return t.push({ k: "lon", v: this.getLon() }), t.push({ k: "lat", v: this.getLat() }), t.push({ k: "indent", v: this.indent }), t.push({ k: "crs", v: this.crs }), t.push({ k: "sampling", v: this.sampling }), t.push({ k: "format", v: this.format }), t }, e.default = s }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(64), a = i(60), r = i(62), l = { build: function (t) { if (n.default.getLogger("AltiRequestWPS").trace(["AltiRequestWPS::build()"]), !t) throw new Error(o.default.getMessage("PARAM_EMPTY", "options")); if (!t.type) throw new Error(o.default.getMessage("PARAM_EMPTY", "type (Elevation or Profil)")); var e = null; switch (t.type) { case "Elevation": t.wps.identifier = "gs:WPSElevation", e = new a.default(t.param); break; case "Profil": t.wps.identifier = "gs:WPSLineElevation", e = new r.default(t.param); break; default: throw new Error(o.default.getMessage("PARAM_TYPE", "type (Elevation or Profil)")) }var i = { data: e, method: t.method, param: t.wps }, l = new s.default(i); if (!l.processRequestString()) throw new Error("Enable to process request !"); return l.requestString } }; e.default = l }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (this.logger = n.default.getLogger(), this.logger.trace("[Constructeur WPS()]"), !(this instanceof o)) throw new TypeError("WPS constructor cannot be called as a function."); if (this.options = t || {}, this.DataObject = this.options.data, !this.DataObject) throw new TypeError("This data object is not defined !"); this.paramservice = this.options.param.service || "WPS", this.paramversion = this.options.param.version || "1.0.0", this.paramidentifier = this.options.param.identifier || "gs:WPS", this.paramrawdataoutput = this.options.param.rawdataoutput || "result", this.paramrequest = this.options.param.request || "Execute", this.method = this.options.method || "GET" } o.prototype = { requestString: null, constructor: o, template: { get: { value: "service=__SERVICE__&version=__VERSION__&rawdataoutput=__RAWDATAOUTPUT__&identifier=__IDENTIFIER__&request=__REQUEST__&datainputs=\x3c!-- __DATAINPUTS__ --\x3e", input: "__KEY__=__DATA__" }, post: { value: '<?xml version="1.0" encoding="UTF-8"?><wps:__REQUEST__ version="__VERSION__" service="__SERVICE__" __NAMESPACE__ __SCHEMALOCATION__><ows:Identifier>__IDENTIFIER__</ows:Identifier><wps:DataInputs>\x3c!-- __DATAINPUTS__ --\x3e</wps:DataInputs><wps:ResponseForm><wps:RawDataOutput><ows:Identifier>__RAWDATAOUTPUT__</ows:Identifier></wps:RawDataOutput></wps:ResponseForm></wps:__REQUEST__>', input: "<wps:Input><ows:Identifier>__KEY__</ows:Identifier><wps:Data><wps:LiteralData>__DATA__</wps:LiteralData></wps:Data></wps:Input>" } }, namespaceByDefault: function () { return ['xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"', 'xmlns="http://www.opengis.net/wps/1.0.0"', 'xmlns:wfs="http://www.opengis.net/wfs"', 'xmlns:wps="http://www.opengis.net/wps/1.0.0"', 'xmlns:ows="http://www.opengis.net/ows/1.1"', 'xmlns:gml="http://www.opengis.net/gml"', 'xmlns:ogc="http://www.opengis.net/ogc"', 'xmlns:wcs="http://www.opengis.net/wcs/1.1.1"', 'xmlns:xlink="http://www.w3.org/1999/xlink"'].join(" ") }, schemaLocationByDefault: function () { return 'xsi:schemaLocation="http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd"' }, processRequestString: function () { this.logger.trace("WPS::processRequestString ()"); var t = ""; if ("POST" === this.method) t = this.template.post.value; else { if ("GET" !== this.method) return this.logger.error("No other method supported by the service !"), !1; t = this.template.get.value } return t = (t = (t = (t = (t = t.replace(/__SERVICE__/g, this.paramservice)).replace(/__VERSION__/g, this.paramversion)).replace(/__RAWDATAOUTPUT__/g, this.paramrawdataoutput)).replace(/__IDENTIFIER__/g, this.paramidentifier)).replace(/__REQUEST__/g, this.paramrequest), "POST" === this.method && (t = (t = t.replace(/__NAMESPACE__/g, this.namespaceByDefault)).replace(/__SCHEMALOCATION__/g, this.schemaLocationByDefault)), (t = t.replace(/<!-- __DATAINPUTS__ -->/g, this.__addDataInputs())) ? (this.requestString = t, this.logger.trace("traduction tmpl", t), !0) : (this.logger.warn("traduction tmpl : empty request !?"), !1) }, __addDataInputs: function () { this.logger.trace("WPS::__addDataInputs ()"); for (var t, e = "GET" === this.method ? this.template.get.input : this.template.post.input, i = "GET" === this.method ? ";" : "", n = "", o = this, s = this.DataObject.getData(), a = 0; a < s.length; a++)t = a, i && (i = t === s.length - 1 ? "" : ";"), n = n.concat(o.__addDataInput(e, s[t].k, s[t].v), i); return n }, __addDataInput: function (t, e, i) { var n = t; return n = (n = n.replace(/__KEY__/g, e)).replace(/__DATA__/g, i) }, setMethod: function (t) { "GET" === t || "POST" === t ? this.method = t : this.logger.warn("support only GET and POST method !") }, getMethod: function () { return this.method } }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(66), r = i(67), l = i(68), c = i(69), u = { build: function (t) { var e = n.default.getLogger("AltiResponseFactory"); e.trace(["AltiResponseFactory::build()"]); var i = null; if (t.response) { if (t.rawResponse) e.trace("analyze response : raw"), i = t.response; else { switch (t.outputFormat) { case "xml": e.trace("analyze response : xml"); try { var u = new a.default({ reader: r.default }); if ("string" == typeof t.response ? u.setXMLString(t.response) : u.setXMLDoc(t.response), !(i = u.parse())) throw new Error(o.default.getMessage("SERVICE_RESPONSE_EXCEPTION_2")) } catch (e) { var h = e.message; return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", h), status: 200, type: s.default.TYPE_SRVERR })) } break; case "json": e.trace("analyze response : json"), e.trace("analyze response : ", typeof t.response); var d = null; if ((d = "string" == typeof t.response ? JSON.parse(t.response) : t.response) && d.error) return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", d.error.description), status: 200, type: s.default.TYPE_SRVERR })); if (d) { var p, m = d.elevations, f = new l.default; if (Array.isArray(m) && m.length) for (var g = 0; g < m.length; g++)p = new c.default, "object" == typeof m[g] ? (m[g].lon && (p.lon = m[g].lon), m[g].lat && (p.lat = m[g].lat), m[g].z && (p.z = m[g].z), m[g].acc && (p.acc = m[g].acc)) : "number" == typeof m[g] && (p.z = m[g]), Array.isArray(f.elevations) && f.elevations.push(p); i = f } if (!i) return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_ANALYSE_2"), type: s.default.TYPE_UNKERR, status: -1 })); break; default: return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_FORMAT_2"), type: s.default.TYPE_UNKERR, status: -1 })) }if (i.exceptionReport) return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", i.exceptionReport), type: s.default.TYPE_SRVERR, status: 200 })); if (i.error) { var _ = i.error.description; return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", _), type: s.default.TYPE_SRVERR, status: 200 })) } } t.onSuccess.call(t.scope, i) } else t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) } }; e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (!(this instanceof o)) throw new TypeError("XML constructor cannot be called as a function."); this.logger = n.default.getLogger(), this.logger.trace("[Constructeur XML ()]"), this.xmlString = null, this.xmlDoc = null, this.reader = null, t && (t.xmlString && "string" == typeof t.xmlString && (this.xmlString = t.xmlString, this.xmlDoc = s(t.xmlString)), t.reader && this.setReader(t.reader)) } function s(t) { if ("undefined" == typeof window) return (new (0, i(54).DOMParser)).parseFromString(t, "text/xml"); var e, n, o = "Erreur lors du parsing de la réponse du service : XML non conforme"; if (window.ActiveXObject) { (n = new window.ActiveXObject("Microsoft.XMLDOM")).async = !1, n.loadXML(t); var s = n.parseError; if (s.errorCode) throw s.line && s.linepos && (o += "( ligne " + s.line + ", colonne " + s.linepos), s.reason && (o += ":  " + s.reason + ")"), new Error(o); return n } if (window.DOMParser) { e = new window.DOMParser; try { n = e.parseFromString(t, "text/xml") } catch (t) { throw "SyntaxError" === t.message ? new Error(o) : new Error("Erreur lors du parsing de la réponse du service : " + t.message) } if (n.getElementsByTagName("parsererror").length > 0) for (var a = n.getElementsByTagName("parsererror"), r = 0; r < a.length; r++) { var l = a[r].innerHTML; if (-1 === l.indexOf("Huge input lookup")) throw o += "(" + l + ")", new Error(o) } else if (!n.documentElement) throw new Error(o); return n } throw new Error("Incompatible DOM Parser pour ce navigateur !") } function a(t) { var e = {}; if (t.attributes.length > 0) { var i = function (t) { if (t.attributes.length > 0) { for (var e = {}, i = t.attributes, n = 0; n < i.length; n++) { var o = i[n]; e[o.nodeName] = o.nodeValue } return e } }(t); e.attributes = i } if (t.hasChildNodes()) for (var n, o = {}, s = t.childNodes, r = 0; r < s.length; r++)if (3 === (n = s[r]).nodeType) e.textContent = n.nodeValue; else if (1 === n.nodeType) if (o = a(n), e[n.nodeName]) { if (!Array.isArray(e[n.nodeName])) { var l = e[n.nodeName]; e[n.nodeName] = [], e[n.nodeName].push(l) } e[n.nodeName].push(o) } else e[n.nodeName] = o; return e } o.prototype = { constructor: o, getXMLString: function () { return this.xmlString }, setXMLString: function (t) { t && "string" == typeof t && (this.xmlString = t, this.xmlDoc = s(t)) }, getReader: function () { return this.reader }, setReader: function (t) { t && t.read && "function" == typeof t.read && (this.reader = t) }, getXMLDoc: function () { return this.xmlDoc }, setXMLDoc: function (t) { this.xmlDoc = t }, parse: function () { if (!this.xmlDoc && this.xmlString && (this.xmlDoc = s(this.xmlString)), this.xmlDoc) { var t, e = function (t) { var e; 9 === t.nodeType ? e = t.documentElement : 1 === t.nodeType && (e = t); return e }(this.xmlDoc); return e ? (this.reader && this.reader.read ? t = this.reader.read(e) : (t = {})[e.nodeName] = a(e), t) : {} } } }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(68), o = i(69), s = {}; s.READERS = { elevations: function (t) { var e = new n.default; if (t.hasChildNodes()) for (var i, o, a = t.childNodes, r = 0; r < a.length; r++)i = a[r], s.READERS[i.nodeName] && (o = s.READERS[i.nodeName](i), e.elevations.push(o)); return e }, elevation: function (t) { var e = new o.default; if (t.hasChildNodes()) for (var i, n = t.childNodes, a = 0; a < n.length; a++)i = n[a], s.READERS[i.nodeName] && s.READERS[i.nodeName](i, e); return e }, lat: function (t, e) { var i = t.firstChild; if (!i || 3 !== i.nodeType) throw new Error("Erreur dans la lecture de la réponse du service : latitude attendue mais absente"); e.lat = parseFloat(i.nodeValue) }, lon: function (t, e) { var i = t.firstChild; if (!i || 3 !== i.nodeType) throw new Error("Erreur dans la lecture de la réponse du service : longitude attendue mais absente"); e.lon = parseFloat(i.nodeValue) }, z: function (t, e) { var i = t.firstChild; if (!i || 3 !== i.nodeType) throw new Error("Erreur dans la lecture de la réponse du service : altitude attendue mais absente"); if (!e) return (e = new o.default).z = parseFloat(i.nodeValue), e; e.z = parseFloat(i.nodeValue) }, acc: function (t, e) { var i = t.firstChild; if (!i || 3 !== i.nodeType) throw new Error("Erreur dans la lecture de la réponse du service : précision (acc) attendue mais absente"); e.acc = parseFloat(i.nodeValue) }, exceptionreport: function (t) { var e = {}; if (t.hasChildNodes()) for (var i, n = t.childNodes, o = 0; o < n.length; o++)"Exception" === (i = n[o]).nodeName && (e.exceptionReport = s.READERS.exception(i)); return e }, exception: function (t) { var e = {}, i = t.getAttribute("exceptionCode"); i && (e.exceptionCode = i); var n = t.firstChild; return n && 3 === n.nodeType && (e.exception = n.nodeValue), e }, error: function (t) { var e = { error: {} }; if (t.hasChildNodes()) for (var i, n = t.childNodes, o = 0; o < n.length; o++) { var s; 1 === (i = n[o]).nodeType && "code" === i.nodeName && (s = i.firstChild) && 3 === s.nodeType && (e.error.code = s.nodeValue), 1 === i.nodeType && "description" === i.nodeName && (s = i.firstChild) && 3 === s.nodeType && (e.error.description = s.nodeValue) } return e } }, s.read = function (t) { if ("elevations" === t.nodeName) return s.READERS.elevations(t); if ("ExceptionReport" === t.nodeName) return s.READERS.exceptionreport(t); if ("error" === t.nodeName) return s.READERS.error(t); throw new Error("Erreur lors de la lecture de la réponse : elle n'est pas au format attendu.") }, e.default = s }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("AltiResponse constructor cannot be called as a function."); this.elevations = [] } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Elevation constructor cannot be called as a function."); this.z = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(47), a = i(45), r = i(56), l = i(46), c = i(71); function u(t) { if (!(this instanceof u)) throw new TypeError(o.default.getMessage("CLASS_CONSTRUCTOR", "AutoConf")); if (this.CLASSNAME = "AutoConf", t || (t = {}), t.protocol = t.protocol || "JSONP", l.default.apply(this, arguments), this.logger = n.default.getLogger("Gp.Services.AutoConf"), this.logger.trace("[Constructeur AutoConf (options)]"), ("string" == typeof this.options.apiKey || this.options.apiKey instanceof String) && Array.isArray(this.options.apiKey.split(",")) && this.options.apiKey.split(",").length > 1 && (this.options.apiKey = this.options.apiKey.split(",")), !this.options.serverUrl && !this.options.serverUrl) { var e = r.default.AutoConf.url(this.options.apiKey); this.options.layerId ? this.options.serverUrl = e.aggregate + this.options.layerId : Array.isArray(this.options.apiKey) && this.options.apiKey.length > 0 ? this.options.serverUrl = e.apiKeys : this.options.serverUrl = e.apiKey } "XHR" === this.options.protocol && "POST" === this.options.httpMethod && (this.logger.warn("Le service ne gére pas le mode d'interrogation en POST, on bascule sur du GET !"), this.options.httpMethod = "GET"), this.options.outputFormat = this.options.rawResponse ? "" : "xml" } u.prototype = Object.create(l.default.prototype, {}), u.prototype.constructor = u, u.prototype.buildRequest = function (t, e) { var i = "undefined" != typeof window ? window : {}; if (i.Gp && i.Gp.Config && i.Gp.Config.generalOptions && i.Gp.Config.layers && i.Gp.Config.generalOptions.apiKeys[this.options.apiKey]) { if (!this.options.layerId) return this.logger.warn("Gp.Config existe déjà pour cette clé"), void this.options.onSuccess.call(this, i.Gp.Config); if (i.Gp.Config.layers[this.options.layerId] && i.Gp.Config.layers[this.options.layerId].aggregatedLayers) return this.logger.warn("Gp.Config existe déjà pour cette clé et cette couche"), void this.options.onSuccess.call(this, i.Gp.Config) } this.request = "", !(-1 === this.options.serverUrl.indexOf("http://")) && this.layerId && (this.request = s.default.normalyzeParameters({ layerId: this.layerId })), this.request || "" === this.request ? e.call(this, this.request) : t.call(this, new a.default(o.default.getMessage("SERVICE_REQUEST_BUILD"))) }, u.prototype.analyzeResponse = function (t, e) { if (this.response) { var i = { layerId: this.options.layerId, response: this.response, rawResponse: this.options.rawResponse, onSuccess: e, onError: t, scope: this }; c.default.build(i) } else t.call(this, new a.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) }, e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(66), r = i(72), l = { build: function (t) { n.default.getLogger("AutoConfResponseFactory").trace(["AutoConfResponseFactory::build()"]); var e = null; if (t.response) { if (t.rawResponse) e = t.response; else { try { var i = new a.default({ reader: r.default }); "string" == typeof t.response ? i.setXMLString(t.response) : i.setXMLDoc(t.response), e = i.parse() } catch (e) { var l = e.message; return "string" == typeof t.response ? l += "\n (raw response service'" + t.response + "')" : l += "\n (raw response service'" + t.response.documentElement.innerHTML + "')", void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", l), status: 200, type: s.default.TYPE_SRVERR })) } var c = !0; for (var u in e) e.hasOwnProperty(u) && (c = !1); if (c) return void t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY_2"))); if (e.exceptionReport) return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", e.exceptionReport), type: s.default.TYPE_SRVERR, status: 200 })) } var h = "undefined" != typeof window ? window : {}; h.Gp || (h.Gp = {}), h.Gp.Config ? this.mergeConfig(h.Gp.Config, e, t.layerId) : h.Gp.Config = e, t.onSuccess.call(t.scope, h.Gp.Config) } else t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) }, mergeConfig: function (t, e, i) { if (e && t) { for (var n in e) if (e.hasOwnProperty(n)) if ("generalOptions" === n) for (var o in e[n].apiKeys) e[n].apiKeys.hasOwnProperty(o) && !t.generalOptions.apiKeys[o] && (t.generalOptions.apiKeys[o] = e[n].apiKeys[o]); else if (t[n]) for (var s in e[n]) e[n].hasOwnProperty(s) && !t[n][s] && (t[n][s] = e[n][s]); if (i) { var a = []; for (var r in e.layers) e.layers.hasOwnProperty(r) && a.push(r); t.layers[i] && (t.layers[i].aggregatedLayers = a) } } } }; e.default = l }, function (t, e, i) { "use strict"; i.r(e); var n = i(73), o = i(74), s = i(75), a = i(76), r = i(77), l = i(78), c = i(79), u = i(80), h = i(81), d = i(82), p = i(83), m = i(84), f = i(85), g = i(86), _ = {}; function v(t, e) { if (t.hasChildNodes()) for (var i, n, o, s = t.childNodes, a = 0; a < s.length; a++) { if (1 === (i = s[a]).nodeType) if (n = i.localName || i.baseName || i.nodeName, o = i.prefix || _.DEFAULTPREFIX, _.READERS[o][n]) (0, _.READERS[o][n])(i, e); else v(i, e) } } function y(t) { var e, i = ""; return t.hasChildNodes() && (3 !== (e = t.firstChild).nodeType && 4 !== e.nodeType || (i = e.nodeValue)), i } _.VERSION = "1.1.0", _.NAMESPACES = { xmlns: "http://www.opengis.net/context", gpp: "http://api.ign.fr/geoportail", ows: "http://www.opengis.net/ows/2.0", sld: "http://www.opengis.net/sld", wmts: "http://www.opengis.net/wmts/1.0", xlink: "http://www.w3.org/1999/xlink", xsi: "http://www.w3.org/2001/XMLSchema-instance" }, _.SCHEMALOCATION = ["http://www.opengis.net/context http://wxs.ign.fr/schemas/extContext.xsd http://api.ign.fr/geoportail http://wxs.ign.fr/schemas/autoconf/autoconf.xsd", "http://www.opengis.net/context http://wxs.ign.fr/schemas/extContext.xsd http://api.ign.fr/geoportail http://wxs.ign.fr/schemas/autoconf.xsd"], _.DEFAULTPREFIX = "context", _.READERS = { context: { ViewContext: function (t) { !function (t) { if (t.attributes.length > 0) { var e = function (t) { if (t.attributes.length > 0) { for (var e = {}, i = t.attributes, n = 0; n < i.length; n++) { var o = i[n]; e[o.nodeName] = o.nodeValue } return e } }(t); for (var i in e) if (e.hasOwnProperty(i)) { if ("version" === i && e.version !== _.VERSION) return void console.log("[AutoConfResponseReader] autoconf version is not the expected one : there may be errors in parsing"); if ("xmlns" === i) { if (e[i] !== _.NAMESPACES.xmlns) return void console.log("[AutoConfResponseReader] autoconf response default namespace is not the expected one"); continue } var n = i.split(":")[0], o = i.split(":")[1]; if ("xmlns" === n && o && _.NAMESPACES[o] && _.NAMESPACES[o] !== e[i]) return void console.log("[AutoConfResponseReader] autoconf response " + i + " namespace is not the expected one"); if ("schemaLocation" === o && e[i] !== _.SCHEMALOCATION[0] && e[i] !== _.SCHEMALOCATION[1]) return void console.log("[AutoConfResponseReader] autoconf response schema location is not the expected one") } } }(t); var e = new n.default; return v(t, e), e }, Title: function (t, e) { e && e.generalOptions ? e.generalOptions.title = y(t) : e && e.lyr && (e.lyr.title = y(t)) }, Abstract: function (t, e) { e && e.lyr && (e.lyr.description = y(t)) }, Server: function (t, e) { var i = t.getAttribute("service"), n = t.getAttribute("title"), o = t.getAttribute("version"); if (i) if (e && e.services && "object" == typeof e.services && !e.services[i]) { var s = new u.default; s.title = n, s.version = o, v(t, s), e.services[i] = s } else e && e.lyr && (e.lyr.serviceParams || (e.lyr.serviceParams = {}), e.lyr.serviceParams.id = i, e.lyr.serviceParams.version = o) }, OnlineResource: function (t, e) { e && e.hasOwnProperty("serverUrl") && (e.serverUrl = t.getAttribute("xlink:href")) }, LayerList: function (t, e) { if (v(t, e), e && e.layers && e.generalOptions && e.services) for (var i in e.layers) if (e.layers.hasOwnProperty(i)) { var n = e.layers[i], o = n.apiKeys; if (o && Array.isArray(o)) for (var s = 0; s < o.length; s++) { var a = o[s]; e.generalOptions.apiKeys && (e.generalOptions.apiKeys[a] && Array.isArray(e.generalOptions.apiKeys[a]) || (e.generalOptions.apiKeys[a] = []), e.generalOptions.apiKeys[a].push(i)) } var r = n.serviceParams; if (r && r.id && !e.services[r.id]) { var l = new u.default; r.serverUrl && (l.serverUrl = r.serverUrl), r.version && (l.version = r.version), e.services[r.id] = l } if (n.wmtsOptions && n.wmtsOptions.tileMatrixSetLink && e.tileMatrixSets) { var c = n.wmtsOptions.tileMatrixSetLink, h = e.tileMatrixSets; for (var d in h) h.hasOwnProperty(d) && d === c && (n.defaultProjection = h[d].projection) } } }, Layer: function (t, e) { if (e && e.layers) { var i = { lyr: new a.default, lyrId: null }, n = t.getAttribute("hidden"); i.lyr.hidden = "1" === n; var o = t.getAttribute("queryable"); if (i.lyr.queryable = "1" === o, v(t, i), i.lyrId) { if (i.lyr.serviceParams && i.lyr.serviceParams.id) { var s = i.lyr.serviceParams.id; if (-1 !== s.toUpperCase().indexOf("OPENLS") || -1 !== s.toUpperCase().indexOf("ELEVATION")) { var r = i.lyrId.split("$")[0]; i.lyrId = r + "$" + s } } i.lyr.layerId = i.lyrId, e.layers[i.lyrId] = i.lyr } } }, Name: function (t, e) { e && e.lyr && (e.lyr.name = y(t)) }, SRS: function (t, e) { e && e.lyr && (e.lyr.defaultProjection = y(t)) }, Format: function (t, e) { if (e && e.lyr) { var i = new s.default, n = t.getAttribute("current"); i.current = "1" === n, i.name = y(t), e.lyr.formats && Array.isArray(e.lyr.formats) || (e.lyr.formats = []), e.lyr.formats.push(i) } }, Style: function (t, e) { if (e && e.lyr) { var i = new h.default, n = t.getAttribute("current"); if (i.current = "1" === n || 1 === n, t.hasChildNodes) for (var o, s, a = t.childNodes, r = 0; r < a.length; r++)1 === (o = a[r]).nodeType && ("Name" === (s = o.localName || o.baseName || o.nodeName) ? i.name = y(o) : "Title" === s ? i.title = y(o) : "URL" === s && (i.url = y(o))); e.lyr.styles && Array.isArray(e.lyr.styles) || (e.lyr.styles = []), e.lyr.styles.push(i) } }, Dimension: function (t, e) { var i = t.getAttribute("name"), n = y(t); e && e.lyr && (e.lyr.dimensions || (e.lyr.dimensions = {}), "Type" === i ? e.lyr.dimensions.type = n : "VisibilityRange" === i ? e.lyr.dimensions.visibilityRange = n : "VisibilityMode " === i ? e.lyr.dimensions.visibilityMode = n : "GeometricType" === i ? e.lyr.dimensions.geometricType = n : "NoDataValue" === i && (e.lyr.dimensions.noDataValue = n)) } }, gpp: { Theme: function (t, e) { e && e.generalOptions && e.generalOptions.hasOwnProperty("theme") && (e.generalOptions.theme = y(t)) }, defaultGMLGFIStyleUrl: function (t, e) { e && e.generalOptions && e.generalOptions.hasOwnProperty("defaultGMLGFIStyle") && (e.generalOptions.defaultGMLGFIStyle = y(t)) }, Territory: function (t, e) { var i = t.getAttribute("id"); if (i) { var n = new d.default, o = t.getAttribute("default"); n.isDefault = "1" === o, v(t, n), e && e.territories && "object" == typeof e.territories && (e.territories[i] = n) } }, defaultCRS: function (t, e) { e && e.hasOwnProperty("defaultCRS") && (e.defaultCRS = y(t)) }, AdditionalCRS: function (t, e) { var i = y(t); i && e && (Array.isArray(e.additionalCRS) ? e.additionalCRS.push(i) : (e.additionalProjections && Array.isArray(e.additionalProjections) || (e.additionalProjections = []), e.additionalProjections.push(i))) }, DefaultLayer: function (t, e) { var i = t.getAttribute("layerId"); i && e && Array.isArray(e.defaultLayers) && e.defaultLayers.push(i) }, BoundingBox: function (t, e) { if (e) { var i = y(t).split(","); if (4 === i.length) { var n = { left: parseFloat(i[0]), right: parseFloat(i[2]), top: parseFloat(i[3]), bottom: parseFloat(i[1]) }, s = t.getAttribute("minT"), a = t.getAttribute("maxT"); if (e.hasOwnProperty("geoBBOX")) e.geoBBOX = n; else if (e.hasOwnProperty("bbox")) if (e.bbox.left || e.bbox.right || e.bbox.top || e.bbox.bottom) { e.multiConstraints || (e.multiConstraints = []); var r = new o.default; r.bbox = n, r.temporalExtent = [s, a], e.multiConstraints.push(r) } else e.bbox = n, e.temporalExtent = [s, a]; else e.globalConstraint || (e.globalConstraint = new o.default), e.globalConstraint.bbox = n, e.globalConstraint.temporalExtent = [s, a] } } }, Resolution: function (t, e) { var i = y(t); i && e && e.defaultOptions && e.defaultOptions.hasOwnProperty("resolution") && (e.defaultOptions.resolution = parseFloat(i)) }, x: function (t, e) { var i = y(t); i && e && e.geoCenter && e.geoCenter.hasOwnProperty("lon") && (e.geoCenter.lon = parseFloat(i)) }, y: function (t, e) { var i = y(t); i && e && e.geoCenter && e.geoCenter.hasOwnProperty("lat") && (e.geoCenter.lat = parseFloat(i)) }, Resolutions: function (t, e) { e && e.generalOptions && e.generalOptions.hasOwnProperty("wgs84Resolutions") && (e.generalOptions.wgs84Resolutions = y(t).split(",")) }, Layer: function (t, e) { if (e && e.hasOwnProperty("lyrId") && e.lyr) { e.lyrId = t.getAttribute("id"); var i = t.getAttribute("aggregate"), n = t.getAttribute("more"); (i || n) && (e.lyr.isAggregate = !0), v(t, e.lyr) } }, Constraint: function (t, e) { var i = new o.default; if (v(t, i), e) if (e.constraints && Array.isArray(e.constraints) || (e.constraints = []), i.multiConstraints && Array.isArray(i.multiConstraints)) { var n = new o.default; n.crs = i.crs, n.bbox = i.bbox, n.minScaleDenominator = i.minScaleDenominator, n.maxScaleDenominator = i.maxScaleDenominator, n.temporalExtent = i.temporalExtent, e.constraints.push(n); for (var s = 0; s < i.multiConstraints.length; s++)(n = new o.default).crs = i.crs, n.minScaleDenominator = i.minScaleDenominator, n.maxScaleDenominator = i.maxScaleDenominator, n.bbox = i.multiConstraints[s].bbox, n.temporalExtent = i.multiConstraints[s].temporalExtent, e.constraints.push(n) } else e.constraints.push(i) }, CRS: function (t, e) { e && e.hasOwnProperty("crs") && (e.crs = y(t)) }, Thematic: function (t, e) { if (e) { var i = new p.default; i.inspire = !1, i.name = y(t), e.thematics && Array.isArray(e.thematics) || (e.thematics = []), e.thematics.push(i) } }, InspireThematic: function (t, e) { if (e) { var i = new p.default; i.inspire = !0, i.name = y(t), e.thematics && Array.isArray(e.thematics) || (e.thematics = []), e.thematics.push(i) } }, Originator: function (t, e) { if (e) { var i = new c.default; i.name = t.getAttribute("name"), v(t, i), e.originators && Array.isArray(e.originators) || (e.originators = []), e.originators.push(i) } }, Attribution: function (t, e) { e && e.hasOwnProperty("attribution") && (e.attribution = y(t)) }, Logo: function (t, e) { e && e.hasOwnProperty("logo") && (e.logo = y(t)) }, URL: function (t, e) { e && e.hasOwnProperty("url") && (e.url = y(t)) }, Legend: function (t, e) { var i = new r.default; v(t, i), e && (e.legends && Array.isArray(e.legends) || (e.legends = []), e.legends.push(i)) }, LegendURL: function (t, e) { if (e && e.hasOwnProperty("format") && (e.format = t.getAttribute("format"), t.hasChildNodes)) { var i = t.childNodes[0]; "OnlineResource" === (i.localName || i.baseName || i.nodeName) && e.hasOwnProperty("url") && (e.url = i.getAttribute("xlink:href")) } }, QuickLook: function (t, e) { if (t.hasChildNodes) { var i = t.childNodes[0]; "OnlineResource" === (i.localName || i.baseName || i.nodeName) && e && (e.quicklookUrl = i.getAttribute("xlink:href")) } }, MetadataURL: function (t, e) { if (e) { var i = new l.default; if (i.format = t.getAttribute("format"), t.hasChildNodes) { var n = t.childNodes[0]; "OnlineResource" === (n.localName || n.baseName || n.nodeName) && (i.url = n.getAttribute("xlink:href")) } e.metadata || (e.metadata = []), e.metadata.push(i) } }, Key: function (t, e) { if (e) { var i = t.getAttribute("id"); e.apiKeys && Array.isArray(e.apiKeys) || (e.apiKeys = []), e.apiKeys.push(i); var n = y(t); e.serviceParams || (e.serviceParams = {}), e.serviceParams.serverUrl || (e.serviceParams.serverUrl = {}), e.serviceParams.serverUrl[i] || (e.serviceParams.serverUrl[i] = n) } } }, ows: { Identifier: function (t, e) { e && e.hasOwnProperty("TMS") ? e.identifier = y(t) : e && e.hasOwnProperty("matrixId") && (e.matrixId = y(t)) }, SupportedCRS: function (t, e) { e && e.TMS && e.TMS.hasOwnProperty("projection") && (e.TMS.projection = y(t)) } }, sld: { MinScaleDenominator: function (t, e) { var i = y(t); i && e && (e.hasOwnProperty("defaultOptions") ? e.defaultOptions.minScaleDenominator = parseFloat(i) : e.lyr ? (e.lyr.globalConstraint || (e.lyr.globalConstraint = new o.default), e.lyr.globalConstraint.minScaleDenominator = parseFloat(i)) : e.hasOwnProperty("minScaleDenominator") && (e.minScaleDenominator = parseFloat(i))) }, MaxScaleDenominator: function (t, e) { var i = y(t); i && e && (e.hasOwnProperty("defaultOptions") ? e.defaultOptions.maxScaleDenominator = parseFloat(i) : e.lyr ? (e.lyr.globalConstraint || (e.lyr.globalConstraint = new o.default), e.lyr.globalConstraint.maxScaleDenominator = parseFloat(i)) : e.hasOwnProperty("maxScaleDenominator") && (e.maxScaleDenominator = parseFloat(i))) } }, wmts: { TileMatrixSetLimits: function (t, e) { if (e) { var i = {}; v(t, i), e.wmtsOptions || (e.wmtsOptions = {}), e.wmtsOptions.tileMatrixSetLimits = i } }, TileMatrixLimits: function (t, e) { var i, n = new g.default; if (t.hasChildNodes) { for (var o = t.childNodes, s = 0; s < o.length; s++) { var a = o[s], r = a.localName || a.baseName || a.nodeName; "TileMatrix" === r ? i = y(a) : "MinTileRow" === r ? n.minTileRow = y(a) : "MaxTileRow" === r ? n.maxTileRow = y(a) : "MinTileCol" === r ? n.minTileCol = y(a) : "MaxTileCol" === r && (n.maxTileCol = y(a)) } i && e && !e[i] && (e[i] = n) } }, TileMatrixSet: function (t, e) { if (e && e.tileMatrixSets) { var i = {}; i.TMS = new m.default, i.resolutions = [], v(t, i); var n = i.TMS.tileMatrices; for (var o in n) n.hasOwnProperty(o) && i.TMS.matrixIds.push(o); if (("IGNF:WGS84G" === i.TMS.getProjection() || "EPSG:4326" === i.TMS.getProjection()) && e.generalOptions && Array.isArray(e.generalOptions.wgs84Resolutions)) for (var s = e.generalOptions.wgs84Resolutions, a = 0; a < s.length; a++)i.resolutions[a] = parseFloat(s[a]); Array.isArray(i.resolutions) && void 0 !== i.resolutions.sort && i.resolutions.sort((function (t, e) { return e - t })), i.TMS.nativeResolutions = i.resolutions, e.tileMatrixSets[i.identifier] = i.TMS } else e && !e.wmtsOptions && (e.wmtsOptions = {}), e.wmtsOptions.tileMatrixSetLink = y(t) }, TileMatrix: function (t, e) { if (e) { var i = new f.default; if (v(t, i), e.TMS && e.TMS.getProjection()) { var n = e.TMS.getProjection(); if ("EPSG:3857" === n || "EPSG:2154" === n) { var o = 28e-5 * i.scaleDenominator; e.resolutions && Array.isArray(e.resolutions) && e.resolutions.push(o) } } e.TMS && e.TMS.tileMatrices && (e.TMS.tileMatrices[i.matrixId] = i) } }, ScaleDenominator: function (t, e) { var i = y(t); i && e && e.hasOwnProperty("scaleDenominator") && (e.scaleDenominator = parseFloat(i)) }, TopLeftCorner: function (t, e) { var i = y(t).split(" "); i && e && (e.topLeftCorner = {}, e.topLeftCorner.x = parseFloat(i[0]), e.topLeftCorner.y = parseFloat(i[1])) }, TileWidth: function (t, e) { var i = y(t); i && e && e.hasOwnProperty("tileWidth") && (e.tileWidth = parseInt(i, 10)) }, TileHeight: function (t, e) { var i = y(t); i && e && e.hasOwnProperty("tileHeight") && (e.tileHeight = parseInt(i, 10)) }, MatrixWidth: function (t, e) { var i = y(t); i && e && e.hasOwnProperty("matrixWidth") && (e.matrixWidth = parseInt(i, 10)) }, MatrixHeight: function (t, e) { var i = y(t); i && e && e.hasOwnProperty("matrixHeight") && (e.matrixHeight = parseInt(i, 10)) } }, serviceException: function (t) { var e = {}; if (t.hasChildNodes()) for (var i, n = t.childNodes, o = 0; o < n.length; o++)"exception" === (i = n[o]).nodeName && (e.exceptionReport = _.READERS.exception(i)); return e }, exception: function (t) { var e = {}, i = t.getAttribute("code"); i && (e.exceptionCode = i); var n = t.firstChild; return n && 3 === n.nodeType && (e.exception = n.nodeValue), e } }, _.read = function (t) { if ("ViewContext" === t.nodeName) { var e = t.prefix || _.DEFAULTPREFIX; return _.READERS[e][t.nodeName](t) } if ("serviceException" === t.nodeName) return _.READERS[t.nodeName](t); throw new Error("Erreur lors de la lecture de la réponse : elle n'est pas au format attendu.") }, e.default = _ }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("AutoConfResponse constructor cannot be called as a function."); this.generalOptions = { apiKeys: {}, title: null, defaultGMLGFIStyle: null, theme: null, wgs84Resolutions: [] }, this.layers = {}, this.territories = {}, this.tileMatrixSets = {}, this.services = {} } i.r(e), n.prototype = { constructor: n, isConfLoaded: function (t) { if (t) return !!this.generalOptions.apiKeys[t] }, getLayersId: function (t) { return this.generalOptions.apiKeys[t] }, getLayersConf: function (t) { var e = {}, i = this.getLayersId(t); if (i) for (var n = 0; n < i.length; n++) { var o = i[n]; e[o] = this.layers[o] } return e }, getLayerConf: function (t) { if (this.layers) return this.layers[t] }, getTileMatrixSets: function () { return this.tileMatrixSets }, getTMSConf: function (t) { if (this.tileMatrixSets) return this.tileMatrixSets[t] }, getTerritories: function () { return this.territories }, getTerritoryConf: function (t) { if (this.territories) return this.territories[t] }, getServices: function () { return this.services }, getServiceConf: function (t) { if (this.services) return this.services[t] } }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Constraint constructor cannot be called as a function."); this.crs = null, this.bbox = { left: null, right: null, top: null, bottom: null }, this.minScaleDenominator = null, this.maxScaleDenominator = null, this.temporalExtent = [null, null] } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Format constructor cannot be called as a function."); this.current = null, this.name = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Layer constructor cannot be called as a function.") } i.r(e), n.prototype = { constructor: n, getName: function () { return this.name }, getTitle: function () { return this.title }, getDescription: function () { return this.description }, getLayerId: function () { return this.layerId }, getQuicklookUrl: function () { return this.quicklookUrl }, getDefaultProjection: function () { return this.defaultProjection }, getProjections: function () { var t = []; return t.push(this.defaultProjection), t.concat(this.additionalProjections) }, getBBOX: function () { if (this.globalConstraint) return this.globalConstraint.bbox }, getMinScaleDenominator: function () { if (this.globalConstraint) return this.globalConstraint.minScaleDenominator }, getMaxScaleDenominator: function () { if (this.globalConstraint) return this.globalConstraint.maxScaleDenominator }, getTMSID: function () { if (this.wmtsOptions) return this.wmtsOptions.tileMatrixSetLink }, getServiceParams: function () { return this.serviceParams }, getServerUrl: function (t) { if (t && this.serviceParams && this.serviceParams.serverUrl) return this.serviceParams.serverUrl[t] }, getLegends: function () { return this.legends }, getMetadata: function () { return this.metadata }, getStyles: function () { return this.styles }, getDefaultStyle: function () { if (this.styles) { for (var t, e = this.styles, i = 0; i < e.length; i++)if (!0 === e[i].current) { t = e[i].name; break } return t } }, getThematics: function () { return this.thematics }, getDefaultFormat: function () { if (this.formats) { for (var t, e = this.formats, i = 0; i < e.length; i++)if (!0 === e[i].current) { t = e[i].name; break } return t } }, getConstraints: function () { return this.constraints }, getOriginators: function () { return this.originators }, getDimensions: function () { return this.dimensions }, getAggregatedLayers: function () { if (this.isAggregate) return this.aggregatedLayers } }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Legend constructor cannot be called as a function."); this.format = null, this.url = null, this.minScaleDenominator = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Metadata constructor cannot be called as a function."); this.format = null, this.url = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Originator constructor cannot be called as a function."); this.name = null, this.attribution = null, this.logo = null, this.url = null, this.constraints = [] } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Service constructor cannot be called as a function."); this.title = null, this.serverUrl = null, this.version = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Style constructor cannot be called as a function."); this.name = null, this.title = null, this.current = null, this.url = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Territory constructor cannot be called as a function."); this.isDefault = null, this.defaultCRS = null, this.additionalCRS = [], this.geoBBOX = { left: null, right: null, top: null, bottom: null }, this.geoCenter = { lon: null, lat: null }, this.defaultOptions = { resolution: null, minScaleDenominator: null, maxScaleDenominator: null }, this.defaultLayers = [] } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("Thematic constructor cannot be called as a function."); this.inspire = null, this.name = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("TileMatrixSet constructor cannot be called as a function."); this.projection = null, this.nativeResolutions = [], this.matrixIds = [], this.tileMatrices = {} } i.r(e), n.prototype = { constructor: n, getResolutions: function () { return this.nativeResolutions }, getMatrixIds: function () { return this.matrixIds }, getProjection: function () { return this.projection }, getTileMatrices: function () { return this.tileMatrices }, getTopLeftCorner: function () { var t, e = this.getTileMatrices(); if (e) for (var i in e) if (e.hasOwnProperty(i)) { t = e[i].topLeftCorner; break } return t } }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("TileMatrix constructor cannot be called as a function."); this.matrixId = null, this.matrixHeight = null, this.matrixWidth = null, this.scaleDenominator = null, this.tileHeight = null, this.tileWidth = null, this.topLeftCorner = null } i.r(e), n.prototype = { constructor: n, getTopLeftCorner: function () { return this.topLeftCorner }, getScaleDenominator: function () { return this.scaleDenominator }, getTileHeight: function () { return this.tileHeight }, getTileWidth: function () { return this.tileWidth }, getMatrixHeight: function () { return this.matrixHeight }, getMatrixWidth: function () { return this.matrixWidth } }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("TileMatrixLimit constructor cannot be called as a function."); this.minTileRow = null, this.maxTileRow = null, this.minTileCol = null, this.maxTileCol = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(46), r = i(88), l = i(105); function c(t) { if (!(this instanceof c)) throw new TypeError(o.default.getMessage("CLASS_CONSTRUCTOR", "Geocode")); if (this.CLASSNAME = "Geocode", a.default.apply(this, arguments), this.logger = n.default.getLogger("Gp.Services.Geocode"), this.logger.trace("[Constructeur Geocode (options)]"), !t.location) throw new Error(o.default.getMessage("PARAM_MISSING", "location")); if ("object" == typeof t.location && 0 === Object.keys(t.location).length) throw new Error(o.default.getMessage("PARAM_EMPTY", "location")); if ("string" == typeof t.location && 0 === t.location.length) throw new Error(o.default.getMessage("PARAM_EMPTY", "location")); this.options.location = t.location, t.filterOptions && "object" == typeof t.filterOptions || (this.options.filterOptions = t.filterOptions = { type: ["StreetAddress"] }), 0 === Object.keys(t.filterOptions).length && (this.options.filterOptions = { type: ["StreetAddress"] }); for (var e = Object.keys(t.filterOptions), i = 0; i < e.length; i++) { var s = e[i]; -1 !== ["department", "number", "postalCode", "insee", "importance", "ID", "IDTR", "absorbedCity", "sheet", "section", "inseeRegion", "inseeDepartment"].indexOf(s) && "string" != typeof t.filterOptions[s] && (t.filterOptions[s] = t.filterOptions[s].toString()), t.filterOptions[s] || delete this.options.filterOptions[s] } this.options.filterOptions.type = t.filterOptions.type || ["StreetAddress"], this.options.maximumResponses = t.maximumResponses || 25, this.options.returnFreeForm = t.returnFreeForm || !1, this.options.srs = t.srs || "EPSG:4326", this.options.outputFormat = this.options.rawResponse ? "" : "xml" } c.prototype = Object.create(a.default.prototype, {}), c.prototype.constructor = c, c.prototype.buildRequest = function (t, e) { var i = { httpMethod: this.options.httpMethod, location: this.options.location, returnFreeForm: this.options.returnFreeForm, filterOptions: this.options.filterOptions, srs: this.options.srs, maximumResponses: this.options.maximumResponses }; this.request = r.default.build(i), this.request ? e.call(this, this.request) : t.call(this, new s.default(o.default.getMessage("SERVICE_REQUEST_BUILD"))) }, c.prototype.analyzeResponse = function (t, e) { if (this.response) { var i = { response: this.response, rawResponse: this.options.rawResponse, onError: t, onSuccess: e, scope: this }; l.default.build(i) } else t.call(this, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) }, e.default = c }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(89), s = i(93), a = i(96), r = i(100), l = i(102), c = i(103), u = i(104), h = { build: function (t) { var e = n.default.getLogger("DirectGeocodeRequestFactory"); e.trace(["DirectGeocodeRequestFactory::build()"]); var i = null, h = new a.default; h.addFilterExtensions(new u.default), h.addFilterExtensions(new r.default), h.addFilterExtensions(new l.default), h.addFilterExtensions(new c.default); var d = new s.default({ location: t.location, returnFreeForm: t.returnFreeForm, filterOptions: t.filterOptions }); d.addFilter(h); var p = new o.default({ srsName: t.srs, maximumResponses: t.maximumResponses }); (p.namespace = !0, p.setService(d), i = p.build(), "GET" === t.httpMethod) && (i = "qxml=" + encodeURIComponent(i).replace(/-/g, "%2D").replace(/_/g, "%5F").replace(/\./g, "%2E").replace(/!/g, "%21").replace(/~/g, "%7E").replace(/\*/g, "%2A").replace(/'/g, "%27").replace(/\(/g, "%28").replace(/\)/g, "%29")); return e.trace(i), i } }; e.default = h }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(90), s = i(91), a = i(92); function r(t) { if (this.logger = n.default.getLogger(), this.logger.trace("[Constructeur XLS()]"), !(this instanceof r)) throw new TypeError("XLS constructor cannot be called as a function."); for (var e in this.options = { srsName: "EPSG:4326", maximumResponses: 25 }, t) t.hasOwnProperty(e) && t[e] && (this.options[e] = t[e]) } r.VERSION = "1.2", r.prototype = { requestString: null, namespace: !1, oService: null, constructor: r, template: '<?xml version="1.0" encoding="UTF-8"?>\n<XLS version="__VERSION__"\n__NAMESPACE__ \n__SCHEMALOCATION__>\n__REQUESTHEADER__\n__REQUEST__\n</XLS>\n', namespaceByDefault: function () { return ['xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"', 'xmlns:xls="http://www.opengis.net/xls"', 'xmlns:gml="http://www.opengis.net/gml"'].join(" ") }, schemaLocationByDefault: function () { return 'xsi:schemaLocation="http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd"' }, setService: function (t) { t ? t instanceof a.default ? this.oService = t : this.logger.error("L'objet n'est pas du type 'LocationUtilityService' ou 'RouteService' !?") : this.logger.trace("L'objet de type Service XSL n'est pas encore defini !?") }, getService: function () { return this.oService } }, r.prototype.addNamespace = function (t, e) { for (var i, n, o = t.key, s = !1, a = this.namespaceByDefault().split(" "), r = 0; r < a.length; r++) { if (a[r].split("=")[0] === "xmlns:" + o) { s = !0; break } } return s ? (i = /<(\w+[\s>])/g, n = "<" + o + ":$1", e = e.replace(i, n), i = /<\/(\w+[\s>])/g, n = "</" + o + ":$1", e = e.replace(i, n), this.logger.trace("namespace", e), e) : (this.logger.warn("L'ajout d'un nouvel namespace n'est pas encore implémenté !"), e) }, r.prototype.build = function () { var t = !!this.getService(), e = ""; e = (e = (e = (e = this.template).replace(/__VERSION__/g, r.VERSION)).replace(/__NAMESPACE__/g, this.namespaceByDefault)).replace(/__SCHEMALOCATION__/g, this.schemaLocationByDefault); var i = new o.default({ srsName: this.options.srsName }); e = e.replace(/__REQUESTHEADER__/g, i.toString()); var n = new s.default({ maximumResponses: this.options.maximumResponses, version: r.VERSION, methodName: t ? this.getService().CLASSTYPE : null }); if (e = e.replace(/__REQUEST__/g, n.toString()), t && (e = e.replace(/<!-- __REQUESTSERVICE__ -->/g, this.getService().toString())), e) return this.namespace && (e = this.addNamespace({ key: "xls", url: "http://www.opengis.net/xls" }, e)), this.requestString = e, this.logger.trace("traduction tmpl", e), this.requestString; this.logger.warn("traduction tmpl : empty request !?") }, e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (this.logger = n.default.getLogger(), this.logger.trace("[Constructeur RequestHeader ()]"), !(this instanceof o)) throw new TypeError("RequestHeader constructor cannot be called as a function."); for (var e in this.options = t || { srsName: "EPSG:4326" }, t) t.hasOwnProperty(e) && (this.options[e] = t[e]) } o.prototype = { requestString: null, template: '<RequestHeader srsName="__SRSNAME__"/>', constructor: o, toString: function () { var t = null; return t = (t = this.template).replace(/__SRSNAME__/g, this.options.srsName), this.requestString = t, this.requestString } }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (this.logger = n.default.getLogger(), this.logger.trace("[Constructeur Request ()]"), !(this instanceof o)) throw new TypeError("Request constructor cannot be called as a function."); for (var e in this.options = t || { maximumResponses: 25, methodName: null, version: "1.2" }, t) t.hasOwnProperty(e) && (this.options[e] = t[e]) } o.prototype = { requestString: null, template: '<Request maximumResponses="__MAXRESPONSES__" methodName="__METHODNAME__" requestID="__UUID__" version="__VERSION__">\x3c!-- __REQUESTSERVICE__ --\x3e</Request>', constructor: o, guid: function () { return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (function (t) { var e = 16 * Math.random() | 0; return ("x" === t ? e : 3 & e | 8).toString(16) })) }, toString: function () { var t = null; return t = (t = (t = (t = (t = this.template).replace(/__MAXRESPONSES__/g, this.options.maximumResponses)).replace(/__METHODNAME__/g, this.options.methodName)).replace(/__UUID__/g, this.guid())).replace(/__VERSION__/g, this.options.version), this.requestString = t, this.requestString } }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (this.logger = n.default.getLogger(), this.logger.trace("[Constructeur AbstractService ()]"), !(this instanceof o)) throw new TypeError("AbstractService constructor cannot be called as a function."); for (var e in this.options = t || {}, t) t.hasOwnProperty(e) && (this.options[e] = t[e]) } o.prototype = { strRequest: null, oRequest: null, oFilter: null, constructor: o, addRequest: function (t) { this.logger.error("overwritten method !") }, addFilter: function (t) { this.logger.error("overwritten method !") }, toString: function () { this.logger.error("overwritten method !") } }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(92), s = i(94), a = i(97), r = i(96); function l(t) { if (this.logger = n.default.getLogger(), this.logger.trace("[Constructeur LocationUtilityService ()]"), !(this instanceof l)) throw new TypeError("LocationUtilityService constructor cannot be called as a function."); this.CLASSNAME = "LocationUtilityService", this.CLASSTYPE = null, o.default.apply(this, arguments), this.options && (this.CLASSTYPE = this.options.location ? "GeocodeRequest" : this.options.position ? "ReverseGeocodeRequest" : null) } l.prototype = Object.create(o.default.prototype, {}), l.prototype.constructor = l, l.prototype.addRequest = function (t) { switch (this.CLASSTYPE = t.CLASSNAME, this.CLASSTYPE) { case "GeocodeRequest": case "ReverseGeocodeRequest": this.oRequest = t; break; default: throw new Error("Ce n'est pas un objet de type 'LUS Request' !?") } }, l.prototype.addFilter = function (t) { t instanceof r.default && (this.oFilter = t) }, l.prototype.toString = function () { if (!this.oRequest) { if (!this.options) throw new Error("Les options ne sont pas renseignées, impossible de construire la requête !"); if ("GeocodeRequest" === this.CLASSTYPE) { var t = { location: this.options.location, returnFreeForm: this.options.returnFreeForm, filterOptions: this.options.filterOptions || {} }; this.oRequest = new s.default(t), this.oFilter && this.oRequest.addFilter(this.oFilter) } else if ("ReverseGeocodeRequest" === this.CLASSTYPE) { var e = { position: this.options.position, returnFreeForm: this.options.returnFreeForm, filterOptions: this.options.filterOptions || {} }; this.oRequest = new a.default(e) } else this.logger.error("impossible de determiner le type de geocodage : Direct ou Inverse !?") } if (!this.oRequest) throw new Error("Type de Geocodage indefini !"); return this.strRequest = this.oRequest.toString(), this.strRequest }, e.default = l }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(95), s = i(96); function a(t) { if (this.logger = n.default.getLogger(), this.logger.trace("[Constructeur GeocodeRequest ()]"), !(this instanceof a)) throw new TypeError("GeocodeRequest constructor cannot be called as a function."); for (var e in this.options = t || {}, t) t.hasOwnProperty(e) && (this.options[e] = t[e]); this.CLASSNAME = "GeocodeRequest" } a.prototype = { strRequest: null, oAddress: null, oFilter: null, template: '<GeocodeRequest returnFreeForm="__RETURNFREEFORM__">__ADDRESS__</GeocodeRequest>', addAddress: function (t) { t instanceof o.default && (this.oAddress = t) }, addFilter: function (t) { t instanceof s.default && (this.oFilter = t) }, constructor: a, toString: function () { var t = ""; if (t = this.template, !this.oAddress) { var e = {}; if (e.location = this.options.location, e.type = this.options.filterOptions.type || ["StreetAddress"], e.filter = this.options.filterOptions, delete e.filter.type, this.oFilter) for (var i in e.filter = {}, e.type) { var n = e.type[i], s = this.oFilter.getFilter(n); if (s) { for (var a = this.options.filterOptions, r = s.attributesList, l = 0; l < r.length; l++) { var c = r[l]; if (a[c]) { var u = s.serviceAttributes[l]; s.placeAttributes[u] = a[c], this.logger.trace("Selection du filtre '" + c + "' sur le type '" + n + "'.") } } var h = s.placeAttributes; for (var d in h) h.hasOwnProperty(d) && (e.filter[d] = h[d]) } else this.logger.warn("Le filtre '" + n + "' n'existe pas !?") } if (this.oAddress = new o.default(e), !this.oAddress) throw new Error("La construction de l'adresse n'est pas correctement definie !?") } return t = (t = t.replace(/__ADDRESS__/g, this.oAddress.toString())).replace(/__RETURNFREEFORM__/g, this.options.returnFreeForm ? "true" : "false"), this.strRequest = t, this.strRequest } }, e.default = a }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (this.logger = n.default.getLogger("Address"), this.logger.trace("[Constructeur Address ()]"), !(this instanceof o)) throw new TypeError("Address constructor cannot be called as a function."); if (this.options = t || { location: {}, type: ["StreetAddress"], filter: {} }, !this.options.location || 0 === Object.keys(this.options.location).length) throw new Error("l'option 'location' n'est pas renseignée !") } o.prototype = { constructor: o, requestString: null, template: { address: '<Address countryCode="__COUNTRYCODE__">__LOCATION____PLACE____POSTALCODE____ENVELOPE__</Address>', location: { freeFormAddress: "<freeFormAddress>__FREEFORMADDRESSVALUE__</freeFormAddress>", streetAddress: { container: "<StreetAddress>__STREET____BUILDING__</StreetAddress>", building: '<Building number="__BUILDINGVALUE__"/>', street: "<Street>__STREETVALUE__</Street>" } }, place: '<Place type="__PLACETYPE__">__PLACEVALUE__</Place>', postalCode: "<PostalCode>__POSTALCODEVALUE__</PostalCode>", envelope: "<gml:Envelope><gml:lowerCorner>__LEFT__ __BOTTOM__</gml:lowerCorner><gml:upperCorner>__RIGHT__ __TOP__</gml:upperCorner></gml:Envelope>" } }, o.prototype.toString = function () { var t = null; if (t = (t = this.template.address).replace(/__COUNTRYCODE__/g, this.options.type), "string" == typeof this.options.location) { var e = this.template.location.freeFormAddress; e = e.replace(/__FREEFORMADDRESSVALUE__/g, this.options.location), t = t.replace(/__LOCATION__/g, e) } else { var i = "", n = ""; this.options.location.number && (i = (i = this.template.location.streetAddress.building).replace(/__BUILDINGVALUE__/g, this.options.location.number)), this.options.location.street && (n = (n = this.template.location.streetAddress.street).replace(/__STREETVALUE__/g, this.options.location.street)); var o = this.template.location.streetAddress.container; o = (o = o.replace(/__STREET__/g, n)).replace(/__BUILDING__/g, i), t = t.replace(/__LOCATION__/g, o) } var s = ""; this.options.location.postalCode && (s = (s = this.template.postalCode).replace(/__POSTALCODEVALUE__/g, this.options.location.postalCode)); var a = ""; if (this.options.filter) { var r = this.options.filter.bbox; r && (a = (a = (a = (a = (a = this.template.envelope).replace(/__LEFT__/g, r.left)).replace(/__BOTTOM__/g, r.bottom)).replace(/__RIGHT__/g, r.right)).replace(/__TOP__/g, r.top)) } var l = [], c = ""; if (this.options.filter) { var u = this.options.filter; for (var h in u) "bbox" !== h && (c = (c = (c = this.template.place).replace(/__PLACETYPE__/g, h)).replace(/__PLACEVALUE__/g, u[h]), l.push(c)) } var d = ""; return this.options.location.city && (d = (d = (d = this.template.place).replace(/__PLACETYPE__/g, "Municipality")).replace(/__PLACEVALUE__/g, this.options.location.city), l.push(d)), t = (t = (t = t.replace(/__POSTALCODE__/g, s)).replace(/__PLACE__/g, l.join("\n"))).replace(/__ENVELOPE__/g, a), this.requestString = t, this.requestString }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o() { if (this.logger = n.default.getLogger("GeocodeFilterExtension"), this.logger.trace("[Constructeur GeocodeFilterExtension ()]"), !(this instanceof o)) throw new TypeError("GeocodeFilterExtension constructor cannot be called as a function."); this.filters = [] } o.prototype = { constructor: o, addFilterExtensions: function (t) { t && this.filters.push(t) }, getNames: function () { var t = []; for (var e in this.filters) t.push(this.filters[e].CLASSNAME); return this.logger.trace(t), t }, getFilter: function (t) { var e = null; for (var i in this.filters) this.filters[i].CLASSNAME === t && (e = this.filters[i]); return this.logger.trace(e), e }, getFilters: function () { return this.logger.trace(this.filters), this.filters }, getAttributs: function (t) { var e = []; for (var i in this.filters) this.filters[i].CLASSNAME === t && (e = this.filters[i].attributesList); return this.logger.trace(e), e }, setPlaceAttributs: function (t, e) { var i = this.getFilter(t), n = this.getAttributs(t); for (var o in n) { var s = n[o]; e[s] && (i.placeAttributes[s] = e[s]) } }, getPlaceAttributs: function (t) { var e = {}; for (var i in this.filters) this.filters[i].CLASSNAME === t && (e = this.filters[i].placeAttributes); return this.logger.trace(e), e } }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(98), s = i(99); function a(t) { if (this.logger = n.default.getLogger(), this.logger.trace("[Constructeur ReverseGeocodeRequest ()]"), !(this instanceof a)) throw new TypeError("ReverseGeocodeRequest constructor cannot be called as a function."); for (var e in this.options = t || {}, t) t.hasOwnProperty(e) && (this.options[e] = t[e]); this.CLASSNAME = "ReverseGeocodeRequest" } a.prototype = { strRequest: null, oPosition: null, oPreference: null, constructor: a, template: '<ReverseGeocodeRequest returnFreeForm="__RETURNFREEFORM__">__POSITION____PREFERENCE__</ReverseGeocodeRequest>', addPosition: function (t) { t instanceof o.default && (this.oPosition = t) }, addPreferences: function (t) { t instanceof s.default && (this.oPreference = t) }, toString: function () { var t = ""; if (t = this.template, !this.oPreference && (this.oPreference = new s.default(this.options.filterOptions.type || ["StreetAddress"]), !this.oPreference)) throw new Error("Les preferences ne sont pas definies !?"); if (t = t.replace(/__PREFERENCE__/g, this.oPreference.toString()), !this.oPosition) { var e = { position: this.options.position, filter: {} }; if (this.options.filterOptions && (e.filter = this.options.filterOptions, delete e.filter.type), this.oPosition = new o.default(e), !this.oPosition) throw new Error("La position et ses filtres ne sont pas definis !?") } return t = (t = t.replace(/__POSITION__/g, this.oPosition.toString())).replace(/__RETURNFREEFORM__/g, this.options.returnFreeForm ? "true" : "false"), this.strRequest = t, this.strRequest } }, e.default = a }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (this.logger = n.default.getLogger("Position"), this.logger.trace("[Constructeur Position ()]"), !(this instanceof o)) throw new TypeError("Position constructor cannot be called as a function."); if (this.options = t || {}, !this.options.position) throw new Error("l'option 'position' n'est pas renseignée !") } o.prototype = { constructor: o, requestString: null, template: { position: "<Position>__GMLPOINT____GMLFILTER__</Position>", gml: { point: '<gml:Point xmlns:gml="http://www.opengis.net/gml"><gml:pos>__X__ __Y__</gml:pos></gml:Point>', pos: null, filter: { bbox: '<gml:Envelope xmlns:gml="http://www.opengis.net/gml"><gml:lowerCorner>__LEFT__ __BOTTOM__</gml:lowerCorner><gml:upperCorner>__RIGHT__ __TOP__</gml:upperCorner></gml:Envelope>', circle: '<gml:CircleByCenterPoint xmlns:gml="http://www.opengis.net/gml"><gml:pos>__X__ __Y__</gml:pos><gml:radius>__RADIUS__</gml:radius></gml:CircleByCenterPoint>', polygon: '<gml:Polygon xmlns:gml="http://www.opengis.net/gml"><gml:exterior><gml:LinearRing><gml:posList>__XY__</gml:posList></gml:LinearRing></gml:exterior></gml:Polygon>', multipolygon: null } } } }, o.prototype.toString = function () { var t = this.template.position, e = this.template.gml.point; e = (e = e.replace(/__X__/g, this.options.position.x)).replace(/__Y__/g, this.options.position.y); var i = ""; if (this.options.filter) { var n = this.options.filter; for (var o in n) switch (o) { case "circle": i = (i = (i = (i = this.template.gml.filter[o]).replace(/__X__/g, n[o].x)).replace(/__Y__/g, n[o].y)).replace(/__RADIUS__/g, n[o].radius); break; case "bbox": i = (i = (i = (i = (i = this.template.gml.filter[o]).replace(/__LEFT__/g, n[o].left)).replace(/__BOTTOM__/g, n[o].bottom)).replace(/__RIGHT__/g, n[o].right)).replace(/__TOP__/g, n[o].top); break; case "polygon": i = this.template.gml.filter[o]; for (var s = "", a = n[o], r = 0; r < a.length; r++) { var l = a[r]; if (Array.isArray(l)) { this.logger.error("Holes are not implemented !"); break } (l.x && l.y || 0 === l.x || 0 === l.y) && (s += l.x + " " + l.y), a.length !== r + 1 && (s += " ") } i = i.replace(/__XY__/g, s); break; case "multipolygon": this.logger.warn("Filter '" + o + "' is not yet implemented !"); break; default: this.logger.error("This filter '" + o + "' is not useful !") } } return t = (t = t.replace(/__GMLPOINT__/g, e)).replace(/__GMLFILTER__/g, i), this.requestString = t, this.requestString }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (this.logger = n.default.getLogger("Preference"), this.logger.trace("[Constructeur Preference ()]"), !(this instanceof o)) throw new TypeError("Preference constructor cannot be called as a function."); this.type = t } o.prototype = { constructor: o, requestString: null, template: "<ReverseGeocodePreference>__TYPE__</ReverseGeocodePreference>" }, o.prototype.toString = function () { for (var t = [], e = "", i = 0; i < this.type.length; i++)e = (e = this.template).replace(/__TYPE__/g, this.type[i]), t.push(e); return this.strRequest = t.join("\n"), this.strRequest }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(101); function o() { if (!(this instanceof o)) throw new TypeError("StreetAddress constructor cannot be called as a function."); n.default.apply(this, arguments), this.CLASSNAME = "StreetAddress", this.attributesList = ["bbox", "ID", "IDTR", "quality", "territory", "commune", "department", "insee", "municipality"], this.serviceAttributes = ["bbox", "ID", "IDTR", "Qualite", "Territoire", "Commune", "Departement", "INSEE", "Municipality"] } o.prototype = Object.create(n.default.prototype), o.prototype.constructor = o, e.default = o }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("GeocodeLocation constructor cannot be called as a function."); this.placeAttributes = {}, this.attributesList = [], this.serviceAttributes = [] } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(101); function o() { if (!(this instanceof o)) throw new TypeError("PositionOfInterest constructor cannot be called as a function."); n.default.apply(this, arguments), this.CLASSNAME = "PositionOfInterest", this.attributesList = ["bbox", "importance", "nature", "territory", "commune", "department", "insee", "municipality"], this.serviceAttributes = ["bbox", "Importance", "Nature", "Territoire", "Commune", "Departement", "INSEE", "Municipality"] } o.prototype = Object.create(n.default.prototype), o.prototype.constructor = o, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(101); function o() { if (!(this instanceof o)) throw new TypeError("CadastralParcel constructor cannot be called as a function."); n.default.apply(this, arguments), this.CLASSNAME = "CadastralParcel", this.attributesList = ["absorbedCity", "sheet", "number", "section", "commune", "department", "insee", "municipality", "origin"], this.serviceAttributes = ["CommuneAbsorbee", "Feuille", "Numero", "Section", "Commune", "Departement", "INSEE", "Municipality", "Type"] } o.prototype = Object.create(n.default.prototype), o.prototype.constructor = o, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(101); function o() { if (!(this instanceof o)) throw new TypeError("Administratif constructor cannot be called as a function."); n.default.apply(this, arguments), this.CLASSNAME = "Administratif", this.attributesList = ["bbox", "prefecture", "inseeRegion", "inseeDepartment", "municipality"], this.serviceAttributes = ["bbox", "Prefecture", "InseeRegion", "InseeDepartement", "Municipality"] } o.prototype = Object.create(n.default.prototype), o.prototype.constructor = o, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(45), o = i(44), s = i(66), a = i(106), r = { build: function (t) { var e = null; if (t.response) { if (t.rawResponse) e = t.response; else { try { var i = new s.default({ reader: a.default }); if ("string" == typeof t.response ? i.setXMLString(t.response) : i.setXMLDoc(t.response), !(e = i.parse())) throw new Error("L'analyse de la réponse du service !?") } catch (e) { var r = e.message; return "string" == typeof t.response ? r += "('" + t.response + "')" : r += "('" + t.response.documentElement.innerHTML + "')", void t.onError.call(t.scope, new n.default({ message: o.default.getMessage("SERVICE_RESPONSE_ANALYSE", r), type: n.default.TYPE_UNKERR, status: -1 })) } if (e.exceptionReport) return void t.onError.call(t.scope, new n.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", e.exceptionReport), type: n.default.TYPE_SRVERR, status: 200 })) } t.onSuccess.call(t.scope, e) } else t.onError.call(t.scope, new n.default({ message: o.default.getMessage("SERVICE_RESPONSE_EMPTY"), type: n.default.TYPE_SRVERR, status: -1 })) } }; e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = i(44), o = i(45), s = i(107), a = i(108), r = {}; function l(t, e) { if (t.hasChildNodes()) for (var i, n, o, s = t.childNodes, a = 0; a < s.length; a++) { if (1 === (i = s[a]).nodeType) if (n = i.localName || i.baseName || i.nodeName, o = i.prefix || r.DEFAULTPREFIX, r.READERS[o][n]) (0, r.READERS[o][n])(i, e); else l(i, e) } } function c(t) { var e, i = ""; return t.hasChildNodes() && 3 === (e = t.firstChild).nodeType && (i = e.nodeValue), i } r.VERSION = "1.2", r.NAMESPACES = { xmlns: "http://www.opengis.net/xls", gml: "http://www.opengis.net/gml", xls: "http://www.opengis.net/xls", xlsext: "http://www.opengis.net/xlsext", xsi: "http://www.w3.org/2001/XMLSchema-instance" }, r.SCHEMALOCATION = "http://wxs.ign.fr/schemas/olsAll.xsd", r.DEFAULTPREFIX = "xls", r.READERS = { xls: { XLS: function (t) { var e = new s.default; return function (t) { if (t.attributes.length > 0) { var e = function (t) { if (t.attributes.length > 0) { for (var e = {}, i = t.attributes, n = 0; n < i.length; n++) { var o = i[n]; e[o.nodeName] = o.nodeValue } return e } }(t); for (var i in e) if (e.hasOwnProperty(i)) { if ("version" === i && e.version !== r.VERSION) return void console.log("[DirectGeocodeResponseReader] geocode version is not the expected one : there may be errors in parsing"); if ("xmlns" === i) { if (e[i] !== r.NAMESPACES[r.DEFAULTPREFIX]) return void console.log("[DirectGeocodeResponseReader] geocode response default namespace is not the expected one"); continue } var n = i.split(":")[0], o = i.split(":")[1]; if ("xmlns" === n && o && r.NAMESPACES[o] && r.NAMESPACES[o] !== e[i]) return void console.log("[DirectGeocodeResponseReader] geocode response " + i + " namespace is not the expected one"); if ("schemaLocation" === o && r.SCHEMALOCATION !== e[i]) return void console.log("[DirectGeocodeResponseReader] geocode response schema location is not the expected one") } } }(t), l(t, e), e }, GeocodedAddress: function (t, e) { var i = new a.default; l(t, i), e && Array.isArray(e.locations) && e.locations.push(i) }, GeocodeMatchCode: function (t, e) { var i = t.getAttribute("accuracy"); i && e && (e.accuracy = parseFloat(i)); var n = t.getAttribute("matchType"); n && e && (e.matchType = n) }, Address: function (t, e) { var i = t.getAttribute("countryCode"); e && i && (e.type = i), l(t, e) }, freeFormAddress: function (t, e) { e && e.hasOwnProperty("placeAttributes") && (e.placeAttributes.freeform = c(t)) }, Building: function (t, e) { var i = t.getAttribute("number"); e && e.hasOwnProperty("placeAttributes") && (i ? e.placeAttributes.number = i : t.getAttribute("buildingName") ? e.placeAttributes.number = t.getAttribute("buildingName") : t.getAttribute("subdivision") && (e.placeAttributes.number = t.getAttribute("subdivision"))) }, Street: function (t, e) { e && e.hasOwnProperty("placeAttributes") && ("StreetAddress" === e.type ? e.placeAttributes.street = c(t) : "CadastralParcel" === e.type && (e.placeAttributes.cadastralParcel = c(t))) }, Place: function (t, e) { var i = t.getAttribute("type"), n = c(t); if (e && e.hasOwnProperty("placeAttributes")) if ("Municipality" === i) e.placeAttributes.municipality = n; else if ("Bbox" === i) { var o = n.split(";"); 4 === o.length && (e.placeAttributes.bbox = { left: parseFloat(o[0]), right: parseFloat(o[2]), top: parseFloat(o[1]), bottom: parseFloat(o[3]) }) } else "Commune" === i ? e.placeAttributes.commune = n : "Departement" === i ? e.placeAttributes.department = n : "INSEE" === i ? e.placeAttributes.insee = n : "Qualite" === i ? e.placeAttributes.quality = n : "Territoire" === i ? e.placeAttributes.territory = n : "ID" === i ? e.placeAttributes.ID = n : "ID_TR" === i ? e.placeAttributes.IDTR = n : "Importance" === i ? e.placeAttributes.importance = parseInt(n, 10) : "Nature" === i ? e.placeAttributes.nature = n : "Numero" === i ? e.placeAttributes.number = n : "Feuille" === i ? e.placeAttributes.sheet = n : "Section" === i ? e.placeAttributes.section = n : "CommuneAbsorbee" === i ? e.placeAttributes.absorbedCity = n : "Arrondissement" === i ? n && (e.placeAttributes.arrondissement = n) : "Type" === i ? e.placeAttributes.origin = n : "Prefecture" === i ? e.placeAttributes.prefecture = n : "InseeRegion" === i ? e.placeAttributes.inseeRegion = n : "InseeDepartment" === i && (e.placeAttributes.inseeDepartment = n) }, PostalCode: function (t, e) { e && e.hasOwnProperty("placeAttributes") && (e.placeAttributes.postalCode = c(t)) }, Error: function (t) { var e = t.getAttribute("message"), i = t.getAttribute("errorCode"), s = n.default.getMessage("SERVICE_RESPONSE_EXCEPTION", "(" + i + ") : " + e); throw new o.default({ message: s, type: o.default.TYPE_SRVERR }) } }, gml: { pos: function (t, e) { var i = c(t); e && i && (e.position = { x: parseFloat(i.split(" ")[0]), y: parseFloat(i.split(" ")[1]) }) } }, ExceptionReport: function (t) { var e = {}; if (t.hasChildNodes()) for (var i, n = t.childNodes, o = 0; o < n.length; o++)"Exception" === (i = n[o]).nodeName && (e.exceptionReport = r.READERS.Exception(i)); return e }, Exception: function (t) { var e = {}, i = t.getAttribute("exceptionCode"); i && (e.exceptionCode = i); var n = t.firstChild; return n && 3 === n.nodeType && (e.exception = n.nodeValue), e } }, r.read = function (t) { if ("XLS" === t.nodeName) { var e = t.prefix; return e || (e = r.DEFAULTPREFIX), r.READERS[e][t.nodeName](t) } if ("ExceptionReport" === t.nodeName) return r.READERS[t.nodeName](t); var i = n.default.getMessage("SERVICE_RESPONSE_ANALYSE", t.nodeName); throw new o.default({ message: i, type: o.default.TYPE_UNKERR, status: 200 }) }, e.default = r }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("GeocodeResponse constructor cannot be called as a function."); this.locations = [] } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(109); function o() { if (!(this instanceof o)) throw new TypeError("DirectGeocodedLocation constructor cannot be called as a function."); n.default.apply(this, arguments), this.CLASSNAME = "DirectGeocodedLocation", this.accuracy = null } o.prototype = Object.create(n.default.prototype), o.prototype.constructor = o, e.default = o }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("GeocodedLocation constructor cannot be called as a function."); this.position = { x: null, y: null }, this.matchType = null, this.placeAttributes = {}, this.type = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(46), r = i(111), l = i(112); function c(t) { if (!(this instanceof c)) throw new TypeError(o.default.getMessage("CLASS_CONSTRUCTOR", "ReverseGeocode")); if (this.CLASSNAME = "ReverseGeocode", a.default.apply(this, arguments), this.logger = n.default.getLogger("Gp.Services.ReverseGeocode"), this.logger.trace("[Constructeur ReverseGeocode (options)]"), !t.position) throw new Error(o.default.getMessage("PARAM_MISSING", "position")); if (null === t.position.x) throw new Error(o.default.getMessage("PARAM_MISSING", "position.x")); if (null === t.position.y) throw new Error(o.default.getMessage("PARAM_MISSING", "position.y")); this.options.position = t.position, t.filterOptions && "object" == typeof t.filterOptions || (this.options.filterOptions = t.filterOptions = { type: ["StreetAddress"] }), 0 === Object.keys(t.filterOptions).length && (this.options.filterOptions = { type: ["StreetAddress"] }); for (var e = Object.keys(t.filterOptions), i = 0; i < e.length; i++) { var s = e[i]; t.filterOptions[s] && 0 !== Object.keys(t.filterOptions[s]).length || delete this.options.filterOptions[s] } if (this.options.filterOptions.type = t.filterOptions.type || ["StreetAddress"], !Array.isArray(this.options.filterOptions.type)) throw new Error(o.default.getMessage("PARAM_TYPE", "filterOptions.type")); if (this.options.maximumResponses = t.maximumResponses || 25, this.options.returnFreeForm = t.returnFreeForm || !1, this.options.srs = t.srs || "CRS:84", -1 === c.geoEPSG.indexOf(this.options.srs)) { if (this.options.position = { x: this.options.position.y, y: this.options.position.x }, this.options.filterOptions && this.options.filterOptions.circle) { var r = this.options.filterOptions.circle; this.options.filterOptions.circle = { x: r.y, y: r.x, radius: r.radius } } if (this.options.filterOptions && this.options.filterOptions.polygon) { var l = this.options.filterOptions.polygon; for (i = 0; i < l.length; i++) { var u = l[i]; this.options.filterOptions.polygon[i] = { x: u.y, y: u.x } } } } this.options.outputFormat = this.options.rawResponse ? "" : "xml" } c.prototype = Object.create(a.default.prototype, {}), c.prototype.constructor = c, c.prototype.buildRequest = function (t, e) { var i = { httpMethod: this.options.httpMethod, position: this.options.position, returnFreeForm: this.options.returnFreeForm, filterOptions: this.options.filterOptions, srs: "EPSG:4326", maximumResponses: this.options.maximumResponses }; this.request = r.default.build(i), this.request ? e.call(this, this.request) : t.call(this, new s.default(o.default.getMessage("SERVICE_REQUEST_BUILD"))) }, c.prototype.analyzeResponse = function (t, e) { if (this.response) { var i = { response: this.response, rawResponse: this.options.rawResponse, onError: t, onSuccess: e, scope: this }; l.default.build(i) } else t.call(this, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) }, c.geoEPSG = ["EPSG:4326"], e.default = c }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(89), s = i(93), a = { build: function (t) { var e = n.default.getLogger("ReverseGeocodeRequestFactory"); e.trace(["ReverseGeocodeRequestFactory::build()"]); var i = t || {}, a = null, r = new s.default({ position: i.position, returnFreeForm: i.returnFreeForm, filterOptions: i.filterOptions }), l = new o.default({ srsName: i.srs, maximumResponses: i.maximumResponses }); (l.namespace = !0, l.setService(r), a = l.build(), "GET" === i.httpMethod) && (a = "qxml=" + encodeURIComponent(a).replace(/-/g, "%2D").replace(/_/g, "%5F").replace(/\./g, "%2E").replace(/!/g, "%21").replace(/~/g, "%7E").replace(/\*/g, "%2A").replace(/'/g, "%27").replace(/\(/g, "%28").replace(/\)/g, "%29")); return e.trace(a), a } }; e.default = a }, function (t, e, i) { "use strict"; i.r(e); var n = i(44), o = i(45), s = i(66), a = i(113), r = { build: function (t) { var e = null; if (t.response) { if (t.rawResponse) e = t.response; else { try { var i = new s.default({ reader: a.default }); if ("string" == typeof t.response ? i.setXMLString(t.response) : i.setXMLDoc(t.response), !(e = i.parse())) throw new Error("L'analyse de la réponse du service !?") } catch (e) { return e.status = 200, void t.onError.call(t.scope, e) } if (e.exceptionReport) return void t.onError.call(t.scope, new o.default({ message: n.default.getMessage("SERVICE_RESPONSE_EXCEPTION", e.exceptionReport), type: o.default.TYPE_SRVERR, status: 200 })); var r, l; if (t.scope && t.scope.options && t.scope.options.srs && "EPSG:4326" !== t.scope.options.srs) if (e.locations) for (var c = 0; c < e.locations.length; c++)(r = e.locations[c]) && (l = r.position) && (r.position = { x: l.y, y: l.x }) } t.onSuccess.call(t.scope, e) } else t.onError.call(t.scope, new o.default({ message: n.default.getMessage("SERVICE_RESPONSE_EMPTY"), type: o.default.TYPE_SRVERR, status: -1 })) } }; e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = i(44), o = i(45), s = i(107), a = i(114), r = {}; function l(t, e) { if (t.hasChildNodes()) for (var i, n, o, s = t.childNodes, a = 0; a < s.length; a++) { if (1 === (i = s[a]).nodeType) if (n = i.localName || i.baseName || i.nodeName, o = i.prefix || r.DEFAULTPREFIX, r.READERS[o][n]) (0, r.READERS[o][n])(i, e); else l(i, e) } } function c(t) { var e, i = ""; return t.hasChildNodes() && 3 === (e = t.firstChild).nodeType && (i = e.nodeValue), i } r.VERSION = "1.2", r.NAMESPACES = { xmlns: "http://www.opengis.net/xls", gml: "http://www.opengis.net/gml", xls: "http://www.opengis.net/xls", xlsext: "http://www.opengis.net/xlsext", xsi: "http://www.w3.org/2001/XMLSchema-instance" }, r.SCHEMALOCATION = "http://wxs.ign.fr/schemas/olsAll.xsd", r.DEFAULTPREFIX = "xls", r.READERS = { xls: { XLS: function (t) { var e = new s.default; return function (t) { if (t.attributes.length > 0) { var e = function (t) { if (t.attributes.length > 0) { for (var e = {}, i = t.attributes, n = 0; n < i.length; n++) { var o = i[n]; e[o.nodeName] = o.nodeValue } return e } }(t); for (var i in e) if (e.hasOwnProperty(i)) { if ("version" === i && e.version !== r.VERSION) return void console.log("[ReverseGeocodeResponseReader] geocode version is not the expected one : there may be errors in parsing"); if ("xmlns" === i) { if (e[i] !== r.NAMESPACES[r.DEFAULTPREFIX]) return void console.log("[ReverseGeocodeResponseReader] geocode response default namespace is not the expected one"); continue } var n = i.split(":")[0], o = i.split(":")[1]; if ("xmlns" === n && o && r.NAMESPACES[o] && r.NAMESPACES[o] !== e[i]) return void console.log("[ReverseGeocodeResponseReader] geocode response " + i + " namespace is not the expected one"); if ("schemaLocation" === o && r.SCHEMALOCATION !== e[i]) return void console.log("[ReverseGeocodeResponseReader] geocode response schema location is not the expected one") } } }(t), l(t, e), e }, ReverseGeocodedLocation: function (t, e) { var i = new a.default; l(t, i), e && Array.isArray(e.locations) && e.locations.push(i) }, Address: function (t, e) { var i = t.getAttribute("countryCode"); e && i && (e.type = i), l(t, e) }, Building: function (t, e) { var i = t.getAttribute("number"); e && e.hasOwnProperty("placeAttributes") && (i ? e.placeAttributes.number = i : t.getAttribute("buildingName") ? e.placeAttributes.number = t.getAttribute("buildingName") : t.getAttribute("subdivision") && (e.placeAttributes.number = t.getAttribute("subdivision"))) }, Street: function (t, e) { "StreetAddress" === e.type ? e.placeAttributes.street = c(t) : "CadastralParcel" === e.type && (e.placeAttributes.cadastralParcel = c(t)) }, Place: function (t, e) { var i = t.getAttribute("type"), n = c(t); if (e && e.hasOwnProperty("placeAttributes")) if ("Municipality" === i) e.placeAttributes.municipality = n; else if ("Bbox" === i) { var o = n.split(";"); 4 === o.length && (e.placeAttributes.bbox = { left: parseFloat(o[0]), right: parseFloat(o[2]), top: parseFloat(o[1]), bottom: parseFloat(o[3]) }) } else "Commune" === i ? e.placeAttributes.commune = n : "Departement" === i ? e.placeAttributes.department = n : "INSEE" === i ? e.placeAttributes.insee = n : "Qualite" === i ? e.placeAttributes.quality = n : "Territoire" === i ? e.placeAttributes.territory = n : "ID" === i ? e.placeAttributes.ID = n : "ID_TR" === i ? e.placeAttributes.IDTR = n : "Importance" === i ? e.placeAttributes.importance = parseInt(n, 10) : "Nature" === i ? e.placeAttributes.nature = n : "Numero" === i ? e.placeAttributes.number = n : "Feuille" === i ? e.placeAttributes.sheet = n : "Section" === i ? e.placeAttributes.section = n : "CommuneAbsorbee" === i ? e.placeAttributes.absorbedCity = n : "Arrondissement" === i ? n && (e.placeAttributes.arrondissement = n) : "Type" === i ? e.placeAttributes.origin = n : "Prefecture" === i ? e.placeAttributes.prefecture = n : "InseeRegion" === i ? e.placeAttributes.inseeRegion = n : "InseeDepartment" === i && (e.placeAttributes.inseeDepartment = n) }, PostalCode: function (t, e) { e && e.hasOwnProperty("placeAttributes") && (e.placeAttributes.postalCode = c(t)) }, SearchCentreDistance: function (t, e) { e && (e.searchCenterDistance = parseFloat(t.getAttribute("value"))) }, Error: function (t) { var e = t.getAttribute("message"), i = t.getAttribute("errorCode"), s = n.default.getMessage("SERVICE_RESPONSE_EXCEPTION", "(" + i + ") : " + e); throw new o.default({ message: s, type: o.default.TYPE_SRVERR }) } }, gml: { pos: function (t, e) { var i = c(t); e && i && (e.position = { x: parseFloat(i.split(" ")[0]), y: parseFloat(i.split(" ")[1]) }) } }, xlsext: { ExtendedGeocodeMatchCode: function (t, e) { e && (e.matchType = c(t)) } }, ExceptionReport: function (t) { var e = {}; if (t.hasChildNodes()) for (var i, n = t.childNodes, o = 0; o < n.length; o++)"Exception" === (i = n[o]).nodeName && (e.exceptionReport = r.READERS.Exception(i)); return e }, Exception: function (t) { var e = {}, i = t.getAttribute("exceptionCode"); i && (e.exceptionCode = i); var n = t.firstChild; return n && 3 === n.nodeType && (e.exception = n.nodeValue), e } }, r.read = function (t) { if ("XLS" === t.nodeName) { var e = t.prefix; return e || (e = r.DEFAULTPREFIX), r.READERS[e][t.nodeName](t) } if ("ExceptionReport" === t.nodeName) return r.READERS[t.nodeName](t); throw new Error("Erreur lors de la lecture de la réponse : elle n'est pas au format attendu.") }, e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = i(109); function o() { if (!(this instanceof o)) throw new TypeError("ReverseGeocodedLocation constructor cannot be called as a function."); n.default.apply(this, arguments), this.CLASSNAME = "ReverseGeocodedLocation", this.searchCenterDistance = null } o.prototype = Object.create(n.default.prototype), o.prototype.constructor = o, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(46), o = i(116), s = i(43), a = i(44), r = i(47), l = i(45); function c(t) { if (!(this instanceof c)) throw new TypeError(a.default.getMessage("CLASS_CONSTRUCTOR", "AutoComplete")); if (this.CLASSNAME = "AutoComplete", n.default.apply(this, arguments), this.logger = s.default.getLogger("Gp.Services.AutoComplete"), this.logger.trace("[Constructeur AutoComplete (options)]"), !t.text) throw new Error(a.default.getMessage("PARAM_MISSING", "text")); this.options.text = t.text, t.filterOptions && "object" == typeof t.filterOptions || (this.options.filterOptions = t.filterOptions = { territory: [], type: ["StreetAddress"] }), 0 === Object.keys(t.filterOptions).length && (this.options.filterOptions = { territory: [], type: ["StreetAddress"] }), this.options.filterOptions.type = t.filterOptions.type || ["StreetAddress"], this.options.filterOptions.territory = t.filterOptions.territory || [], this.options.maximumResponses = t.maximumResponses || 10, "XHR" === this.options.protocol && "POST" === this.options.httpMethod && (this.logger.warn("Le service ne gére pas le mode d'interrogation en POST, on bascule sur du GET !"), this.options.httpMethod = "GET"), this.options.outputFormat = this.options.rawResponse ? "" : "json" } c.prototype = Object.create(n.default.prototype, {}), c.prototype.constructor = c, c.prototype.buildRequest = function (t, e) { var i = ""; this.options.filterOptions.territory && (i = this.options.filterOptions.territory.join(";")); var n = ""; this.options.filterOptions.type && (n = this.options.filterOptions.type.join(",")), this.request = r.default.normalyzeParameters({ text: encodeURIComponent(this.options.text), type: n, terr: i, maximumResponses: this.options.maximumResponses }), this.request ? e.call(this, this.request) : t.call(this, new l.default(a.default.getMessage("SERVICE_REQUEST_BUILD"))) }, c.prototype.analyzeResponse = function (t, e) { if (this.response) { var i = { response: this.response, rawResponse: this.options.rawResponse, onSuccess: e, onError: t, scope: this }; o.default.build(i) } else t.call(this, new l.default(a.default.getMessage("SERVICE_RESPONSE_EMPTY"))) }, e.default = c }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(117), r = i(118), l = { build: function (t) { var e = n.default.getLogger("AutoCompleteResponseFactory"); e.trace(["AutoCompleteResponseFactory::build()"]); var i = null; if (t.response) { if (t.rawResponse) e.trace("analyze response : raw"), i = t.response; else { var l = null; if (l = "string" == typeof t.response ? JSON.parse(t.response) : t.response) { if (l.error) return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", l.error.description), status: l.error.code, type: s.default.TYPE_SRVERR })); if (i = new a.default, !l.results || !Array.isArray(l.results)) return void t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_FORMAT_3"))); for (var c = null, u = 0; u < l.results.length; u++) { var h = l.results[u]; c = new r.default, h && ("StreetAddress" === h.country ? (c.street = h.street, c.type = "StreetAddress") : "PositionOfInterest" === h.country && (c.poi = h.street, c.kind = h.kind, c.type = "PositionOfInterest"), c.position && (c.position.x = h.x, c.position.y = h.y), c.commune = h.city, c.fullText = h.fulltext, c.postalCode = h.zipcode, c.classification = h.classification), i.suggestedLocations.push(c) } if (!i.suggestedLocations.length) return void t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_FORMAT_3"))) } if (!i) return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_ANALYSE_2"), type: s.default.TYPE_UNKERR, status: -1 })); if (i.exceptionReport) return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", i.exceptionReport), type: s.default.TYPE_SRVERR, status: 200 })) } t.onSuccess.call(t.scope, i) } else t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) } }; e.default = l }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("AutoCompleteResponse constructor cannot be called as a function."); this.suggestedLocations = [] } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("SuggestedLocation constructor cannot be called as a function."); this.type = null, this.position = { x: null, y: null }, this.commune = null, this.fullText = null, this.postalCode = null, this.classification = null, this.street = null, this.poi = null, this.kind = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(46), r = i(56), l = i(120), c = i(123); function u(t) { if (!(this instanceof u)) throw new TypeError(o.default.getMessage("CLASS_CONSTRUCTOR", "Route")); if (this.CLASSNAME = "Route", a.default.apply(this, arguments), this.logger = n.default.getLogger("Gp.Services.Route"), this.logger.trace("[Constructeur Route (options)]"), !t.startPoint) throw new Error(o.default.getMessage("PARAM_MISSING", "startPoint")); if (null === t.startPoint.x) throw new Error(o.default.getMessage("PARAM_MISSING", "startPoint.x")); if (null === t.startPoint.y) throw new Error(o.default.getMessage("PARAM_MISSING", "startPoint.y")); if (!t.endPoint) throw new Error(o.default.getMessage("PARAM_MISSING", "endPoint")); if (null === t.endPoint.x) throw new Error(o.default.getMessage("PARAM_MISSING", "endPoint.x")); if (null === t.endPoint.y) throw new Error(o.default.getMessage("PARAM_MISSING", "endPoint.y")); if (t.outputFormat && "json" !== t.outputFormat && this.logger.warn("options.outputFormat could only be json"), this.options.outputFormat = "json", this.options.resource = t.resource || "bdtopo-osrm", this.options.startPoint = t.startPoint, this.options.endPoint = t.endPoint, this.options.viaPoints = t.viaPoints || [], this.options.routePreference = t.routePreference || "fastest", t.graph ? ("Voiture" === t.graph && (this.options.graph = "car"), "Pieton" === t.graph && (this.options.graph = "pedestrian")) : this.options.graph = "car", this.options.constraints = [], t.constraints) { if (!Array.isArray(t.constraints)) throw new Error(o.default.getMessage("PARAM_TYPE", "constraints")); for (var e = 0; e < t.constraints.length; e++)this.options.constraints.push(t.constraints[e]) } var i = {}, s = {}, l = {}; if (t.exclusions && 0 !== t.exclusions.length) { this.logger.warn("options.exclusions is DEPRECATED !!"); for (var c = 0; c < t.exclusions.length; c++)"string" == typeof t.exclusions[c] && (t.exclusions[c] = t.exclusions[c].toLowerCase(), "toll" === t.exclusions[c] && (l.constraintType = "banned", l.key = "wayType", l.operator = "=", l.value = "autoroute", this.options.constraints.push(l)), "tunnel" === t.exclusions[c] && (i.constraintType = "banned", i.key = "wayType", i.operator = "=", i.value = "tunnel", this.options.constraints.push(i)), "bridge" === t.exclusions[c] && (s.constraintType = "banned", s.key = "wayType", s.operator = "=", s.value = "pont", this.options.constraints.push(s))) } if (this.options.geometryInInstructions = t.geometryInInstructions || !1, this.options.provideBbox = t.provideBbox || !0, this.options.distanceUnit = t.distanceUnit || "m", this.options.timeUnit = t.timeUnit || "second", this.options.expectedStartTime = null, this.options.srs = t.srs || "EPSG:4326", this.options.waysAttributes = t.waysAttributes || [], !this.options.serverUrl) { var h = r.default.Route.url(this.options.apiKey); if (!h) throw new Error("Url by default not found !"); this.options.serverUrl = h, this.logger.trace("Serveur URL par defaut : " + this.options.serverUrl) } } u.prototype = Object.create(a.default.prototype, {}), u.prototype.constructor = u, u.prototype.buildRequest = function (t, e) { var i = { resource: this.options.resource, startPoint: this.options.startPoint, endPoint: this.options.endPoint, viaPoints: this.options.viaPoints, provideBbox: this.options.provideBbox, constraints: this.options.constraints, distanceUnit: this.options.distanceUnit, timeUnit: this.options.timeUnit, graph: this.options.graph, geometryInInstructions: this.options.geometryInInstructions, routePreference: this.options.routePreference, srs: this.options.srs, waysAttributes: this.options.waysAttributes }; this.request = l.default.build(i), this.request ? e.call(this, this.request) : t.call(this, new s.default(o.default.getMessage("SERVICE_REQUEST_BUILD"))) }, u.prototype.analyzeResponse = function (t, e) { if (this.response) { var i = { distanceUnit: this.options.distanceUnit, timeUnit: this.options.timeUnit, response: this.response, outputFormat: this.options.outputFormat, rawResponse: this.options.rawResponse, onError: t, onSuccess: e, scope: this, geometryInInstructions: this.options.geometryInInstructions }; c.default.build(i) } else t.call(this, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) }, e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(45), s = i(121), a = { build: function (t) { n.default.getLogger("RouteRequestFactory").trace(["RouteRequestFactory::build()"]); var e = t || {}, i = !(null === t.onError || "function" != typeof t.onError), a = null, r = new s.default(e); if (!r.processRequestString()) { if (a = "Error process request (rest) !", i) return void t.onError.call(t.scope, new o.default(a)); throw new Error(a) } return r.requestString } }; e.default = a }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(122); function a(t) { if (this.logger = n.default.getLogger("RouteRequestREST"), this.logger.trace("[Constructeur RouteRequestREST ()]"), !(this instanceof a)) throw new TypeError("RouteRequestREST constructor cannot be called as a function."); if (!t) throw new Error(o.default.getMessage("PARAM_EMPTY", "options")); this.settings = t } a.prototype = { requestString: null, constructor: a, processRequestString: function () { this.logger.warn(" PROTOTYPE !"); for (var t = new s.default(this.settings).getParams(), e = "", i = 0; i < t.length; i++) { var n = t[i]; e && (e += "&"), e += n.k + "=" + n.v } return this.logger.trace(e), this.requestString = e, this.requestString } }, e.default = a }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (!(this instanceof o)) throw new TypeError("RouteParamREST constructor cannot be called as a function."); this.logger = n.default.getLogger(), this.logger.trace("[Constructeur RouteParamREST ()]"), this.options = t || {}, this.resource = this.options.resource, this.start = this.options.startPoint.x + "," + this.options.startPoint.y, this.end = this.options.endPoint.x + "," + this.options.endPoint.y, this.intermediates = this.options.viaPoints, this.profile = this.options.graph, this.crs = this.options.srs, this.constraints = this.options.constraints, this.optimization = this.options.routePreference, this.getSteps = this.options.geometryInInstructions ? "true" : "false", this.distanceUnit = this.options.distanceUnit, this.timeUnit = this.options.timeUnit, this.waysAttributes = this.options.waysAttributes } o.CLASSNAME = "RouteParamREST", o.prototype = { constructor: o, getIntermediates: function () { var t = []; if (0 !== this.intermediates.length) for (var e = 0; e < this.intermediates.length; e++) { var i = this.intermediates[e]; t.push(i.x + "," + i.y) } return t.join("|") }, getWaysAttributes: function () { return this.waysAttributes.join("|") }, getProfile: function () { return this.profile }, getDistanceUnit: function () { return "m" === this.distanceUnit ? "meter" : "km" === this.distanceUnit ? "kilometer" : "" }, getOptimization: function () { return this.optimization ? this.optimization : "" }, getConstraints: function () { var t = []; if (0 !== this.constraints.length) for (var e = 0; e < this.constraints.length; e++)t.push(JSON.stringify(this.constraints[e])); return t.join("|") } }, o.prototype.getParams = function () { var t = []; return t.push({ k: "resource", v: this.resource }), t.push({ k: "start", v: this.start }), t.push({ k: "end", v: this.end }), t.push({ k: "geometryFormat", v: "geojson" }), this.optimization && t.push({ k: "optimization", v: this.getOptimization() }), this.intermediates && t.push({ k: "intermediates", v: this.getIntermediates() }), this.profile && t.push({ k: "profile", v: this.getProfile() }), this.constraints && t.push({ k: "constraints", v: this.getConstraints() }), this.crs && t.push({ k: "crs", v: this.crs }), this.distanceUnit && t.push({ k: "distanceUnit", v: this.getDistanceUnit() }), this.timeUnit && t.push({ k: "timeUnit", v: this.timeUnit }), this.waysAttributes && t.push({ k: "waysAttributes", v: this.getWaysAttributes() }), t }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(124), r = i(125), l = { build: function (t) { var e = n.default.getLogger("RouteResponseFactory"); e.trace("RouteResponseFactory::build()"); var i = null; if (t.response) { if (t.rawResponse) e.trace("analyze response : raw"), i = t.response; else { var l; if (e.trace("analyze response : json"), l = "string" == typeof t.response ? JSON.parse(t.response) : t.response) { if (l.message) return void t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", l.message))); var c = [], u = [], h = []; if ((i = new a.default).hasOwnProperty("totalTime") && (i.totalTime = parseFloat(l.duration)), i.hasOwnProperty("totalDistance") && (i.totalDistance = parseFloat(l.distance)), i.hasOwnProperty("bbox") && (i.bbox.left = parseFloat(l.bbox[0]), i.bbox.bottom = parseFloat(l.bbox[1]), i.bbox.right = parseFloat(l.bbox[2]), i.bbox.top = parseFloat(l.bbox[3])), i.hasOwnProperty("routeGeometry") && !t.geometryInInstructions && (i.routeGeometry = l.geometry), i.hasOwnProperty("routeInstructions") && t.geometryInInstructions) { var d, p = l.portions; if (Array.isArray(p) && p.length) for (d = 0; d < p.length; d++)c.push(p[d]); if (c.length) for (d = 0; d < c.length; d++)u.push(c[d].steps); if (u.length) for (d = 0; d < u.length; d++)h = h.concat(u[d]); h.forEach((function (t) { switch (i.routeInstructions.push(new r.default), i.routeInstructions[i.routeInstructions.length - 1].duration = t.duration, i.routeInstructions[i.routeInstructions.length - 1].distance = t.distance, i.routeInstructions[i.routeInstructions.length - 1].code = "", i.routeInstructions[i.routeInstructions.length - 1].instruction = "", i.routeInstructions[i.routeInstructions.length - 1].geometry = t.geometry, "Valeur non renseignée" === t.name && (t.name = ""), t.instruction.type) { case "turn": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Tourner"; break; case "new name": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Continuer tout droit"; break; case "depart": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Départ"; break; case "arrive": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Arrivée"; break; case "merge": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Rejoindre"; break; case "ramp": case "on ramp": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Prendre la bretelle"; break; case "off ramp": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Prendre la sortie"; break; case "fork": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Sur la bifurcation, prendre"; break; case "end of road": i.routeInstructions[i.routeInstructions.length - 1].instruction += "À la fin de la route, prendre"; break; case "use lane": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Utiliser la file"; break; case "continue": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Continuer"; break; case "roundabout": case "rotary": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Au rond-point"; break; case "roundabout turn": i.routeInstructions[i.routeInstructions.length - 1].instruction += "Au rond point, tourner"; break; case "notification": i.routeInstructions[i.routeInstructions.length - 1].instruction += ""; break; default: i.routeInstructions[i.routeInstructions.length - 1].instruction += "?" + t.instruction.type + "?" }if (t.instruction.modifier) switch (t.instruction.modifier) { case "uturn": i.routeInstructions[i.routeInstructions.length - 1].instruction = "Faire demi-tour"; break; case "sharp right": i.routeInstructions[i.routeInstructions.length - 1].instruction += " complètement à droite"; break; case "right": i.routeInstructions[i.routeInstructions.length - 1].instruction += " à droite"; break; case "slight right": i.routeInstructions[i.routeInstructions.length - 1].instruction += " légèrement à droite"; break; case "straight": i.routeInstructions[i.routeInstructions.length - 1].instruction = "Continuer tout droit"; break; case "slight left": i.routeInstructions[i.routeInstructions.length - 1].instruction += " lègèrement à gauche"; break; case "left": i.routeInstructions[i.routeInstructions.length - 1].instruction += " à gauche"; break; case "sharp left": i.routeInstructions[i.routeInstructions.length - 1].instruction += " complètement à gauche"; break; default: i.routeInstructions[i.routeInstructions.length - 1].instruction += " ?" + t.instruction.modifier + "?" }t.instruction.exit && (i.routeInstructions[i.routeInstructions.length - 1].instruction += `${t.instruction.exit}e sortie`), t.attributes.name && ((t.attributes.name.nom_1_droite || t.attributes.name.toponyme) && (i.routeInstructions[i.routeInstructions.length - 1].instruction += " sur"), t.attributes.name.nom_1_droite && (i.routeInstructions[i.routeInstructions.length - 1].instruction += ` ${t.attributes.name.nom_1_droite}`), t.attributes.name.toponyme && (i.routeInstructions[i.routeInstructions.length - 1].instruction += ` ${t.attributes.name.toponyme}`)) })) } } if (!i) return void t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_ANALYSE", "json"))); if (i.exceptionReport) return void t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_EXCEPTION_2"))) } t.onSuccess.call(t.scope, i) } else t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) } }; e.default = l }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("RouteResponse constructor cannot be called as a function."); this.totalTime = null, this.totalDistance = null, this.bbox = { left: null, right: null, top: null, bottom: null }, this.routeGeometry = null, this.routeInstructions = [] } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("RouteInstruction constructor cannot be called as a function."); this.duration = null, this.distance = null, this.code = null, this.instruction = null, this.geometry = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(46), r = i(56), l = i(127), c = i(129); function u(t) { if (!(this instanceof u)) throw new TypeError(o.default.getMessage("CLASS_CONSTRUCTOR", "ProcessIsoCurve")); if (this.CLASSNAME = "ProcessIsoCurve", a.default.apply(this, arguments), this.logger = n.default.getLogger("Gp.Services.ProcessIsoCurve"), this.logger.trace("[Constructeur ProcessIsoCurve (options)]"), !t.position) throw new Error(o.default.getMessage("PARAM_MISSING", "position")); if (null === t.position.x) throw new Error(o.default.getMessage("PARAM_MISSING", "position.x")); if (null === t.position.y) throw new Error(o.default.getMessage("PARAM_MISSING", "position.y")); if (!t.time && !t.distance) throw new Error("Parameter (s) 'distance' missing. Parameter time to calculate an isochrone, parameter distance for an isodistance"); if (!t.time && t.distance && (this.options.method = "distance", this.options.time && delete this.options.time), t.time && !t.distance && (this.options.method = "time", this.options.distance && delete this.options.distance), this.options.method = this.options.method || "time", this.options.resource = t.resource || "bdtopo-iso", this.options.exclusions = t.exclusions || [], this.options.reverse = t.reverse || !1, this.options.srs = t.srs || "EPSG:4326", this.options.distanceUnit = t.distanceUnit || "m", this.options.timeUnit = t.timeUnit || "second", t.smoothing && this.logger.warn("options.smoothing is DEPRECATED"), this.options.smoothing = !1, t.holes && this.logger.warn("options.holes is DEPRECATED"), this.options.holes = !1, t.graph ? ("Voiture" === t.graph && (this.options.graph = "car"), "Pieton" === t.graph && (this.options.graph = "pedestrian")) : this.options.graph = "car", this.options.constraints = [], t.constraints) { if (!Array.isArray(t.constraints)) throw new Error(o.default.getMessage("PARAM_TYPE", "constraints")); for (var e = 0; e < t.constraints.length; e++)this.options.constraints.push(t.constraints[e]) } var i = {}, s = {}, l = {}; if (t.exclusions && 0 !== t.exclusions.length) { this.logger.warn("options.exclusions is DEPRECATED !!"); for (var c = 0; c < t.exclusions.length; c++)"string" == typeof t.exclusions[c] && (t.exclusions[c] = t.exclusions[c].toLowerCase(), "toll" === t.exclusions[c] && (l.constraintType = "banned", l.key = "wayType", l.operator = "=", l.value = "autoroute", this.options.constraints.push(l)), "tunnel" === t.exclusions[c] && (i.constraintType = "banned", i.key = "wayType", i.operator = "=", i.value = "tunnel", this.options.constraints.push(i)), "bridge" === t.exclusions[c] && (s.constraintType = "banned", s.key = "wayType", s.operator = "=", s.value = "pont", this.options.constraints.push(s))) } if (this.options.outputFormat = "string" == typeof t.outputFormat ? t.outputFormat.toLowerCase() : "json", t.outputFormat && "json" !== t.outputFormat) throw new Error(o.default.getMessage("PARAM_NOT_SUPPORT", "outputFormat")); if (this.options.outputFormat = "json", !this.options.serverUrl) { var h = r.default.ProcessIsoCurve.url(this.options.apiKey); if (!h) throw new Error("Url by default not found !"); this.options.serverUrl = h, this.logger.trace("Serveur URL par defaut : " + this.options.serverUrl) } } u.prototype = Object.create(a.default.prototype, {}), u.prototype.constructor = u, u.prototype.buildRequest = function (t, e) { try { var i = new l.default(this.options); if (!i.processRequestString()) throw new Error(o.default.getMessage("SERVICE_REQUEST_BUILD")); this.request = i.requestString } catch (e) { return void t.call(this, new s.default(e.message)) } e.call(this, this.request) }, u.prototype.analyzeResponse = function (t, e) { if (this.response) { var i = { response: this.response, outputFormat: this.options.outputFormat, rawResponse: this.options.rawResponse, onSuccess: e, onError: t, scope: this }; c.default.build(i) } else t.call(this, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) }, e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(128); function a(t) { if (this.logger = n.default.getLogger("ProcessIsoCurveRequest"), this.logger.trace("[Constructeur ProcessIsoCurveRequest ()]"), !(this instanceof a)) throw new TypeError("ProcessIsoCurveRequest constructor cannot be called as a function."); if (!t) throw new Error(o.default.getMessage("PARAM_EMPTY", "options")); this.settings = t, this.mode = this.settings.httpMethod || "GET" } a.prototype = { requestString: null, constructor: a, processRequestString: function () { var t = "", e = 0; switch (this.mode) { case "GET": this.logger.trace("Process GET Request"); var i = new s.default(this.settings).getParams(); for (e = 0; e < i.length; e++) { var n = i[e]; t && (t += "&"), t += n.k + "=" + n.v } break; case "POST": this.logger.trace("Process POST Request"); var o = {}; o.resource = this.settings.resource, o.point = this.settings.position.x + "," + this.settings.position.y, "distance" === this.settings.method ? (o.costType = "distance", o.costValue = this.settings.distance) : (o.costType = "time", o.costValue = this.settings.time), o.profile = this.settings.graph, this.settings.reverse ? o.direction = "arrival" : o.direction = "departure", o.constraints = this.settings.constraints, o.distanceUnit = this.settings.distanceUnit, o.timeUnit = this.settings.timeUnit, o.crs = this.settings.srs, t = JSON.stringify(o); break; default: this.logger.error("No other HTTP method supported by the service !") }return this.logger.trace(t), this.requestString = t, this.requestString } }, e.default = a }, function (t, e, i) { "use strict"; i.r(e); var n = i(43); function o(t) { if (!(this instanceof o)) throw new TypeError("ProcessIsoCurveParam constructor cannot be called as a function."); this.logger = n.default.getLogger(), this.logger.trace("[Constructeur ProcessIsoCurveParam ()]"), this.options = t || {}, this.id = this.options.id, this.resource = this.options.resource, this.point = this.options.position, this.crs = this.options.srs, this.profile = this.options.graph, this.constraints = this.options.constraints, this.reverse = this.options.reverse, this.timeUnit = this.options.timeUnit, this.distanceUnit = this.options.distanceUnit, "distance" === this.options.method ? (this.costType = "distance", this.costValue = this.options.distance) : (this.costType = "time", this.costValue = this.options.time) } o.CLASSNAME = "ProcessIsoCurveParam", o.prototype = { constructor: o, getLocation: function () { return this.point.x + "," + this.point.y }, getDistanceUnit: function () { return "m" === this.distanceUnit ? "meter" : "km" === this.distanceUnit ? "kilometer" : "" }, getConstraints: function () { var t = []; if (0 !== this.constraints.length) for (var e = 0; e < this.constraints.length; e++)t.push(JSON.stringify(this.constraints[e])); return t.join("|") }, getDirection: function () { return this.reverse ? "arrival" : "departure" } }, o.prototype.getParams = function () { var t = []; return t.push({ k: "resource", v: this.resource }), t.push({ k: "point", v: this.getLocation() }), t.push({ k: "direction", v: this.getDirection() }), t.push({ k: "costType", v: this.costType }), t.push({ k: "costValue", v: this.costValue }), t.push({ k: "profile", v: this.profile }), t.push({ k: "timeUnit", v: this.timeUnit }), t.push({ k: "distanceUnit", v: this.getDistanceUnit() }), this.crs && t.push({ k: "crs", v: this.crs }), this.constraints && t.push({ k: "constraints", v: this.getConstraints() }), t }, e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(43), o = i(44), s = i(45), a = i(130), r = { build: function (t) { var e = n.default.getLogger("ProcessIsoCurveResponseFactory"); e.trace(["ProcessIsoCurveResponseFactory::build()"]); var i = null; if (t.response) { if (t.rawResponse) e.trace("analyze response : raw"), i = t.response; else { var r; if (e.trace("analyze response : json"), r = "string" == typeof t.response ? JSON.parse(t.response) : t.response, i = new a.default, !r) return void t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_ANALYSE", t.response))); "distance" === r.costType ? (i.time = "", i.distance = r.costValue) : (i.time = r.costValue, i.distance = ""), i.message = "", i.id = "", i.srs = r.crs, i.geometry = r.geometry; var l = r.point.split(","); if (i.location && (i.location.x = l[0], i.location.y = l[1]), i.exceptionReport) return void t.onError.call(t.scope, new s.default({ message: o.default.getMessage("SERVICE_RESPONSE_EXCEPTION", i.exceptionReport), type: s.default.TYPE_SRVERR, status: 200 })) } t.onSuccess.call(t.scope, i) } else t.onError.call(t.scope, new s.default(o.default.getMessage("SERVICE_RESPONSE_EMPTY"))) } }; e.default = r }, function (t, e, i) { "use strict"; function n() { if (!(this instanceof n)) throw new TypeError("ProcessIsoCurveResponse constructor cannot be called as a function."); this.message = null, this.id = null, this.location = {}, this.location.x = null, this.location.y = null, this.srs = null, this.geometry = null, this.time = null, this.distance = null } i.r(e), n.prototype = { constructor: n }, e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(34), o = i(132); e.default = { check: function (t) { var e = n.default.getLogger("checkrightmanagement"); if (t) { var i = t.key, s = t.resources || [], a = t.services || []; if (0 !== s.length) { if (0 !== a.length) { var r = {}; if (!i) { if (!o.default.isConfigLoaded()) return void e.warn("WARNING : The 'apiKey' parameter is missing, and the contract key configuration has not been loaded, so impossible to check yours rights !"); i = Object.keys(o.default.configuration.generalOptions.apiKeys), e.log(i) } if (o.default.isConfigLoaded()) { for (var l = 0; l < s.length; l++)for (var c = s[l], u = 0; u < a.length; u++) { var h = a[u], d = o.default.getServiceParams(c, h, i); d && 0 !== Object.keys(d).length ? (r[h] || (r[h] = []), r[h].push(c)) : e.warn("WARNING : The contract key configuration has no rights to load this geoportal resource (" + c + ") for this service (" + h + ") ") } return 0 === Object.keys(r).length ? void e.warn("WARNING : The contract key configuration has been loaded, and the 'apiKey' parameter has been set, but, there is a problem on the mapping between the contract and the key !") : (r.key = d.key, e.log("right management checked", r), r) } e.warn("WARNING : the contract key configuration has not been loaded, so be carefull !"); for (var p = {}, m = 0; m < a.length; m++) { var f = a[m]; p[f] = []; for (var g = 0; g < s.length; g++) { var _ = s[g]; p[f].push(_) } } return p.key = i, e.log("right management not checked", p), p } e.error("WARNING : no parameter 'services' specified !") } else e.error("WARNING : no parameter 'resources' specified !") } else e.error("WARNING : no parameter specified !") } } }, function (t, e, i) { "use strict"; i.r(e), function (t) { var n = i(34).default.getLogger("config"), o = { configuration: null, isConfigLoaded: function () { var e = "undefined" != typeof window ? window : "undefined" != typeof self ? self : void 0 !== t ? t : {}; return !(!e.Gp || !e.Gp.Config || 0 === Object.keys(e.Gp.Config).length) && (this.configuration = e.Gp.Config, !0) }, getLayerId: function (t, e) { var i = null; if (this.configuration) { var o = this.configuration.layers; for (var s in o) if (o.hasOwnProperty(s)) { var a = s.split("$"); if (t === a[0] && a[1]) { var r = a[1].split(":"); if (a[1].split(";")[1] === e) { i = s; break } if (r[2] === e) { i = s; break } } } } return i || n.error("ERROR layer id (layer name: " + t + " / service: " + e + ") was not found !?"), i }, getLayerParams: function (t, e, i) { var o = {}; if (this.configuration) { var s = this.getLayerId(t, e); if (s) { var a = this.configuration.layers[s], r = a.apiKeys[0]; if (i && i !== r) return void n.error("ERROR different keys (" + i + " !== " + r + ") !?"); i = i || r, o.key = i, o.url = a.getServerUrl(i), o.version = a.getServiceParams().version, o.styles = a.getDefaultStyle(), o.format = a.getDefaultFormat(), o.projection = a.getDefaultProjection(), o.minScale = a.getMinScaleDenominator(), o.maxScale = a.getMaxScaleDenominator(), o.extent = a.getBBOX(), o.legends = a.getLegends(), o.metadata = a.getMetadata(), o.originators = a.getOriginators(), o.title = a.getTitle(), o.description = a.getDescription(), o.quicklookUrl = a.getQuicklookUrl(), a.wmtsOptions && (o.tileMatrixSetLimits = a.wmtsOptions.tileMatrixSetLimits); var l = a.getTMSID(); if (l) { o.TMSLink = l; var c = this.configuration.getTMSConf(l); o.matrixOrigin = c.getTopLeftCorner(), o.nativeResolutions = c.nativeResolutions, o.matrixIds = c.matrixIds, o.tileMatrices = c.tileMatrices } } } return o }, getServiceParams: function (t, e, i) { var n = {}; if (this.configuration) { var o = this.getLayerId(t, e); if (o) { var s = this.configuration.layers[o], a = s.apiKeys[0]; if (i) { Array.isArray(i) || (i = [i]); for (var r = 0; r < i.length; r++)if (i[r] === a) { var l = r; break } if (void 0 === l) return } var c = i[l] || a; n.key = c, n.url = s.getServerUrl(c), n.version = s.getServiceParams().version, n.extent = s.getBBOX(), n.title = s.getTitle(), n.description = s.getDescription() } } return n }, getResolutions: function () { var t = []; return this.configuration && (t = this.configuration.generalOptions.wgs84Resolutions), t }, getTileMatrix: function (t) { var e = {}; return this.configuration && t && (e = this.configuration.tileMatrixSets[t.toUpperCase()]), e }, getGlobalConstraints: function (t) { var e = {}; if (t) { var i = this.configuration.layers[t]; e.projection = i.getDefaultProjection(), e.minScale = i.getMinScaleDenominator(), e.maxScale = i.getMaxScaleDenominator(), e.extent = i.getBBOX() } return e } }; e.default = o }.call(this, i(52)) }, function (t, e, i) { "use strict"; i.r(e); var n = i(40), o = i(2), s = i.n(o), a = i(34), r = i(131), l = i(36), c = i(134), u = i(135), h = i(136), d = a.default.getLogger("locationselector"), p = s.a.Control.extend({ includes: c.default, options: { position: "topleft", tag: { id: 0, unique: null, label: ">", color: "blue", display: !0, addOption: !1, removeOption: !1 }, disableReverse: !1, displayInfo: !0, autocompleteOptions: {}, reverseGeocodeOptions: {} }, initialize: function (t) { s.a.Util.setOptions(this, t), this._uid = this.options.tag.unique || null, this._activeDragAndDrop = !1, this._pressedKeyOnDragAndDrop = !1, this._map = null, this._inputsContainer = null, this._inputLabelContainer = null, this._inputAutoCompleteContainer = null, this._inputShowPointerContainer = null, this._inputCoordinateContainer = null, this._coordinate = null, this._suggestedContainer = null, this._suggestedLocations = [], this._currentLocation = null, this._marker = null, this._resources = {}, this._noRightManagement = !1, this._checkRightsManagement(), this._container = this._uid ? this._initLayout() : null }, onAdd: function () { this._uid = l.default.generate(); var t = this._initLayout(); return s.a.DomEvent.disableClickPropagation(t).disableScrollPropagation(t), t }, onRemove: function () { }, getCoordinate: function () { return this._coordinate }, setCoordinate: function (t) { this._displayResultOfCoordinate(t) }, getCoordinateInverse: function () { if (this._coordinate) return { x: this._coordinate.y, y: this._coordinate.x } }, setMap: function (t) { this._map || (this._map = t) }, clear: function () { this._setCursor(), this._setMarker(), this._clearResults(), this._inputLabelContainer.click() }, dragging: function (t) { this._marker && (t ? this._marker.dragging.enable() : this._marker.dragging.disable()) }, _initLayout: function () { var t = this.options.tag.id, e = this._createMainContainerElement(), i = this._inputsContainer = this._createLocationPointElement(t, this.options.tag.display); e.appendChild(i); var n = this._inputLabelContainer = this._createLocationPointLabelElement(t, this.options.tag.label); i.appendChild(n); var o = this._inputAutoCompleteContainer = this._createLocationAutoCompleteteInputElement(t); i.appendChild(o); var s = this._inputCoordinateContainer = this._createLocationCoordinateInputElement(t); i.appendChild(s); var a = this._inputShowPointerContainer = this._createLocationPointerShowInputElement(t); i.appendChild(a); var r = this._createLocationPointerInputElement(t); if (i.appendChild(r), this.options.tag.addOption) { var l = this._createLocationAddPointElement(); i.appendChild(l) } if (this.options.tag.removeOption) { var c = this._createLocationRemovePointElement(t); i.appendChild(c) } var u = this._suggestedContainer = this._createLocationAutoCompleteResultElement(t); return e.appendChild(u), e }, _checkRightsManagement: function () { var t = null, e = [], i = null; i = this.options.reverseGeocodeOptions.apiKey, (e = (t = this.options.reverseGeocodeOptions.filterOptions) ? t.type : []) && 0 !== e.length || (e = ["PositionOfInterest", "StreetAddress"]); var n = r.default.check({ key: i || this.options.apiKey, resources: e, services: ["ReverseGeocode"] }); i = this.options.autocompleteOptions.apiKey, (e = (t = this.options.autocompleteOptions.filterOptions) ? t.type : []) && 0 !== e.length || (e = ["PositionOfInterest", "StreetAddress"]); var o = r.default.check({ key: i || this.options.apiKey, resources: e, services: ["AutoCompletion"] }); n || o || (this._noRightManagement = !0), o && (this._resources.AutoCompletion = {}, this._resources.AutoCompletion.resources = o.AutoCompletion, this._resources.AutoCompletion.key = o.key), n && (this._resources.ReverseGeocode = {}, this._resources.ReverseGeocode.resources = n.ReverseGeocode, this._resources.ReverseGeocode.key = n.key) }, _setLabel: function (t) { this._inputAutoCompleteContainer.value = t || "" }, _setCoordinate: function (t) { this._coordinate = { x: t.lng, y: t.lat }; var e; e = u.default.roundToDecimal(t.lat, 4); var i = u.default.roundToDecimal(t.lng, 4) + " , " + e; this.GPdisplayCoordinate(i) }, _setPosition: function (t) { d.log("_setPosition()", t), this._map.panTo(s.a.latLng(t.y, t.x)) }, _setMarker: function (t, e, i) { if (d.log("_setMarker()", t, e, i), !this._activeDragAndDrop) { var n = this._map; if (null != this._marker && (this._marker.off("mousedown", this.onMouseDownMarker, this), this._marker.off("dragstart", this.onStartDragMarker, this), this._marker.off("drag", this.onDragMarker, this), this._marker.off("dragend", this.onEndDragMarker, this), n.removeLayer(this._marker), this._marker = null), t) { var o = { icon: new h.default(this.options.tag.color), draggable: !0, clickable: !0, zIndexOffset: 1e3 }; if (this._marker = s.a.marker(s.a.latLng(t.y, t.x), o), this._marker.on("mousedown", this.onMouseDownMarker, this), this._marker.on("dragstart", this.onStartDragMarker, this), this._marker.on("drag", this.onDragMarker, this), this._marker.on("dragend", this.onEndDragMarker, this), this._marker.addTo(n), i) { var a = null; if ("string" != typeof e) if (e.fields.fullText) a = e.fields.fullText; else { var r = []; r.push(e.fields.street || ""), r.push(e.fields.postalCode || ""), r.push(e.fields.commune || ""), "PositionOfInterest" === e.type && (r.push(e.fields.poi || ""), r.push(e.fields.kind || "")), a = r.join(" - ") } else a = e; this._marker.bindPopup(a) } } } }, _setCursor: function (t) { var e = this._map.getContainer(); e.style.cursor = t || null }, _clearResults: function () { this._currentLocation = null, this._coordinate = null, this._clearSuggestedLocation() }, _clearSuggestedLocation: function () { if (this._suggestedLocations = [], this._suggestedContainer) for (; this._suggestedContainer.firstChild;)this._suggestedContainer.removeChild(this._suggestedContainer.firstChild) }, _requestAutoComplete: function (t) { if (d.log("_requestAutoComplete()", t), t && 0 !== Object.keys(t).length && t.text) if (d.log(t), this._noRightManagement) d.log("no rights for all service !?"); else if (this._resources.AutoCompletion) { var e = this._resources.AutoCompletion.resources; if (e && 0 !== Object.keys(e).length) { var i = this._resources.AutoCompletion.key, o = {}; s.a.Util.extend(o, this.options.autocompleteOptions), s.a.Util.extend(o, t), s.a.Util.extend(o, { apiKey: o.apiKey || this.options.apiKey || i }), d.log(o), n.default.Services.autoComplete(o) } } else d.log("no rights for this service !?") }, _fillAutoCompletedLocationListContainer: function (t) { if (d.log("_fillAutoCompletedLocationListContainer()", t), t && 0 !== t.length) { var e = this._suggestedContainer; if (e.childElementCount) for (; e.firstChild;)e.removeChild(e.firstChild); for (var i = 0; i < t.length; i++)this._createLocationAutoCompletedLocationElement(this.options.tag.id, t[i], i); this._suggestedLocations = t } }, _requestReverseGeocode: function (t) { if (d.log("_requestReverseGeocode()", t), t && 0 !== Object.keys(t).length && t.position && 0 !== Object.keys(t.position).length) if (this._noRightManagement) d.log("no rights for all service !?"); else if (this._resources.ReverseGeocode) { var e = this._resources.ReverseGeocode.resources; if (e && 0 !== Object.keys(e).length) { var i = this._resources.ReverseGeocode.key, o = {}; s.a.Util.extend(o, this.options.reverseGeocodeOptions), s.a.Util.extend(o, t), s.a.Util.extend(o, { returnFreeForm: !0, filterOptions: { type: ["StreetAddress"] } }), s.a.Util.extend(o, { apiKey: o.apiKey || this.options.apiKey || i }), d.log(o), n.default.Services.reverseGeocode(o) } } else d.log("no rights for this service !?") }, _displayResultOfCoordinate: function (t) { this._setCoordinate(t), this._setMarker({ x: t.lng, y: t.lat }, null, !1), d.log(this.getCoordinate()), this.onActivateMapPointClick() }, _displayResultOfLabel: function (t) { var e = t.placeAttributes, i = e.number + " " + e.street + ", " + e.postalCode + " " + e.commune; this._setCoordinate({ lat: t.position.x, lng: t.position.y }), this._setLabel(i), this._setMarker({ x: t.position.y, y: t.position.x }, null, !1), this._inputShowPointerContainer.checked = !1, this._inputAutoCompleteContainer.className = "GPlocationOriginVisible", this._inputCoordinateContainer.className = "GPlocationOriginHidden", this.onActivateMapPointClick() }, onAutoCompleteSearchText: function (t) { d.log("onAutoCompleteSearchText()", t); var e = t.target.value; if (e) if (this._noRightManagement) d.log("no rights for this service !?"); else if (this._currentLocation = e, !(e.length < 3)) { var i = this; this._requestAutoComplete({ text: e, maximumResponses: 5, onSuccess: function (t) { if (d.log(t), t) { var e = t.suggestedLocations; i._fillAutoCompletedLocationListContainer(e) } }, onFailure: function (t) { i._clearSuggestedLocation(), d.log(t.message) } }) } }, onAutoCompletedResultsItemClick: function (t) { d.log("onAutoCompletedResultsItemClick()", t); var e = l.default.index(t.target.id); if (d.log(e), d.log(this._suggestedLocations[e]), e) { var i = { x: this._suggestedLocations[e].position.x, y: this._suggestedLocations[e].position.y }, n = { type: this._suggestedLocations[e].type, fields: this._suggestedLocations[e] }, o = this._suggestedLocations[e].fullText; this._setLabel(o), this._setPosition(i), this._setMarker(i, n, this.options.displayInfo), this._coordinate = i } }, onActivateMapPointClick: function (t) { d.trace("onActivateMapPointClick()", t); var e = this._map; this._inputShowPointerContainer.checked ? this._activeDragAndDrop || (e.on("click", this.onMouseMapClick, this), this._setCursor("crosshair"), this._setMarker(), this._clearResults()) : this._activeDragAndDrop || (e.off("click", this.onMouseMapClick, this), this._setCursor()) }, onLocationClearPointClick: function (t) { d.log("onLocationClearPointClick", t), this._setCursor(), this._setMarker(), this._clearResults(), this._inputAutoCompleteContainer.focus() }, onLocationRemovePointClick: function (t) { d.log("onLocationRemovePointClick", t), this._setCursor(), this._setMarker(), this._clearResults() }, onLocationAddPointClick: function (t) { d.log("onLocationAddPointClick", t) }, onMouseMapClick: function (t) { d.log("onMouseMapClick", t); var e = t.latlng; if (this.options.disableReverse || this._noRightManagement) this._displayResultOfCoordinate(e); else { var i = this; this._requestReverseGeocode({ position: { x: e.lat, y: e.lng }, srs: "EPSG:4326", onSuccess: function (t) { if (d.log(t), 0 !== t.locations.length) { var n = t.locations[0]; i._displayResultOfLabel(n) } else i._displayResultOfCoordinate(e) }, onFailure: function (t) { d.log(t.message), i._displayResultOfCoordinate(e) } }) } }, onStartDragMarker: function () { this._marker && (this._activeDragAndDrop = !0, this._inputShowPointerContainer.checked = !0, this._inputAutoCompleteContainer.className = "GPlocationOriginHidden", this._inputCoordinateContainer.className = "GPlocationOriginVisible", this._marker.unbindPopup(), this._setLabel(), this._clearResults()) }, onDragMarker: function () { if (this._marker) { this._activeDragAndDrop = !1, this._inputShowPointerContainer.checked = !0; var t = this._marker.getLatLng(); this._setCoordinate(t) } }, onEndDragMarker: function () { if (this._marker) { this._inputShowPointerContainer.checked = !0; var t = this._marker.getLatLng(); this._pressedKeyOnDragAndDrop ? this._setCoordinate(t) : (d.log("No key pressed, so autocomplete solution !"), this.onMouseMapClick({ latlng: t })), this._activeDragAndDrop = !1, this._pressedKeyOnDragAndDrop = !1 } }, onMouseDownMarker: function (t) { this._marker && (this._pressedKeyOnDragAndDrop = t.originalEvent.ctrlKey) } }); e.default = p }, function (t, e, i) { "use strict"; i.r(e); var n = i(36), o = i(34).default.getLogger("LocationSelectorDOM"), s = { _addUID: function (t) { return this._uid ? t + "-" + this._uid : t }, _createMainContainerElement: function () { var t = document.createElement("div"); return t.className = this._addUID("GPlocationPoint"), t.className += " GPwidget", t }, _createLocationPointElement: function (t, e) { var i = document.createElement("div"); return i.id = this._addUID("GPlocationPoint_" + t), i.className = e ? "GPflexInput GPlocationStageFlexInput" : "GPflexInput GPlocationStageFlexInputHidden", i.style.cssText = "", i }, _createLocationPointLabelElement: function (t, e) { var i = this, o = document.createElement("label"); return o.id = this._addUID("GPlocationOriginLabel_" + t), o.htmlFor = this._addUID("GPlocationOrigin_" + t), o.innerHTML = e, o.addEventListener("click", (function (t) { for (var e = n.default.index(this.id), o = document.getElementsByClassName(i._addUID("GPlocationPoint")), s = 0; s < o.length; s++) { var a = o[s].childNodes[0].id, r = n.default.index(a); document.getElementById(i._addUID("GPlocationPoint_" + r)).style.cssText = "" } document.getElementById(i._addUID("GPlocationOriginCoords_" + e)).value = "", document.getElementById(i._addUID("GPlocationOrigin_" + e)).value = "", document.getElementById(i._addUID("GPlocationPoint_" + e)).style.cssText = "", document.getElementById(i._addUID("GPlocationOriginPointer_" + e)).checked = !1, document.getElementById(i._addUID("GPlocationOrigin_" + e)).className = "GPlocationOriginVisible", document.getElementById(i._addUID("GPlocationOriginCoords_" + e)).className = "GPlocationOriginHidden", document.getElementById(i._addUID("GPlocationStageRemove_" + e)) && (document.getElementById(i._addUID("GPlocationStageRemove_" + e)).className = "GPlocationStageRemove"), document.getElementById(i._addUID("GPlocationStageAdd")) && (document.getElementById(i._addUID("GPlocationStageAdd")).className = ""), i.onLocationClearPointClick(t) })), o }, _createLocationAutoCompleteteInputElement: function (t) { var e = this, i = document.createElement("input"); return i.id = this._addUID("GPlocationOrigin_" + t), i.className = "GPlocationOriginVisible", i.type = "text", i.placeholder = "Saisir une adresse", i.autocomplete = "off", i.addEventListener("keyup", (function (t) { var i = t.which || t.keyCode; if (13 !== i && 10 !== i && 38 !== i && 40 !== i) { var o = n.default.index(this.id); document.getElementById(e._addUID("GPlocationOrigin_" + o)).value.length > 2 ? document.getElementById(e._addUID("GPlocationAutoCompleteList_" + o)).style.display = "block" : document.getElementById(e._addUID("GPlocationAutoCompleteList_" + o)).style.display = "none", e.onAutoCompleteSearchText(t) } })), i.addEventListener("keydown", (function (i) { var s = i.which || i.keyCode, a = document.getElementById(e._addUID("GPlocationAutoCompleteList_" + t)); if (a) { var r = a.getElementsByClassName("GPautoCompleteProposal current"), l = a.getElementsByClassName("GPautoCompleteProposal"), c = l.length; if (c) { var u = null; if (!r.length) return (u = l[0]).className = "GPautoCompleteProposal current", u.style.color = "#000000", void (u.style["background-color"] = "#CEDBEF"); u = r[0]; var h = parseInt(n.default.index(u.id), 10), d = h === c - 1 ? l[0] : l[h + 1], p = 0 === h ? l[c - 1] : l[h - 1]; switch (u.style["background-color"] = "", u.style.color = "", p.style["background-color"] = "", p.style.color = "", d.style["background-color"] = "", d.style.color = "", s) { case 38: o.log("arrow up"), u.className = "GPautoCompleteProposal", p.className = "GPautoCompleteProposal current", p.style.color = "#000000", p.style["background-color"] = "#CEDBEF"; break; case 40: o.log("arrow down"), u.className = "GPautoCompleteProposal", d.className = "GPautoCompleteProposal current", d.style.color = "#000000", d.style["background-color"] = "#CEDBEF"; break; case 13: o.log("enter"), u.click(i) }u.focus() } } })), i }, _createLocationCoordinateInputElement: function (t) { var e = this, i = document.createElement("input"); return i.id = this._addUID("GPlocationOriginCoords_" + t), i.className = "GPlocationOriginHidden", i.type = "text", i.disabled = !1, i.addEventListener("click", (function () { var t = n.default.index(this.id); document.getElementById(e._addUID("GPlocationOriginLabel_" + t)).click() })), i }, _createLocationPointerShowInputElement: function (t) { var e = document.createElement("input"); return e.id = this._addUID("GPlocationOriginPointer_" + t), e.type = "checkbox", e }, _createLocationPointerInputElement: function (t) { var e = this, i = document.createElement("label"); return i.id = this._addUID("GPlocationOriginPointerImg_" + t), i.htmlFor = this._addUID("GPlocationOriginPointer_" + t), i.className = "GPlocationOriginPointerImg", i.title = "Pointer un lieu sur la carte", i.addEventListener("click", (function (t) { t.preventDefault(), t.stopPropagation(); var i, o, s, a = n.default.index(this.id), r = document.getElementsByClassName(e._addUID("GPlocationPoint")); for (i = 0; i < r.length; i++)o = r[i].childNodes[0].id, a !== (s = n.default.index(o)) && (document.getElementById(e._addUID("GPlocationOriginPointer_" + s)).checked = !1, "Pointer un lieu sur la carte" === document.getElementById(e._addUID("GPlocationOriginCoords_" + s)).value && (document.getElementById(e._addUID("GPlocationOriginCoords_" + s)).value = "", document.getElementById(e._addUID("GPlocationOrigin_" + s)).className = "GPlocationOriginVisible", document.getElementById(e._addUID("GPlocationOriginCoords_" + s)).className = "GPlocationOriginHidden")); if (document.getElementById(e._addUID("GPlocationOriginPointer_" + a)).checked) { for (document.getElementById(e._addUID("GPlocationOriginCoords_" + a)).value = "", i = 0; i < r.length; i++)o = r[i].childNodes[0].id, s = n.default.index(o), document.getElementById(e._addUID("GPlocationPoint_" + s)).style.cssText = ""; document.getElementById(e._addUID("GPlocationStageRemove_" + a)) && (document.getElementById(e._addUID("GPlocationStageRemove_" + a)).className = "GPlocationStageRemove"), document.getElementById(e._addUID("GPlocationStageAdd")) && (document.getElementById(e._addUID("GPlocationStageAdd")).className = ""), document.getElementById(e._addUID("GPlocationOriginPointer_" + a)).checked = !1, document.getElementById(e._addUID("GPlocationOrigin_" + a)).className = "GPlocationOriginVisible", document.getElementById(e._addUID("GPlocationOriginCoords_" + a)).className = "GPlocationOriginHidden" } else { for (document.getElementById(e._addUID("GPlocationOriginCoords_" + a)).value = "Pointer un lieu sur la carte", i = 0; i < r.length; i++)o = r[i].childNodes[0].id, a === (s = n.default.index(o)) ? document.getElementById(e._addUID("GPlocationPoint_" + s)).style.cssText = "" : document.getElementById(e._addUID("GPlocationPoint_" + s)).style.display = "none"; document.getElementById(e._addUID("GPlocationStageRemove_" + a)) && (document.getElementById(e._addUID("GPlocationStageRemove_" + a)).className = "GPlocationOriginHidden"), document.getElementById(e._addUID("GPlocationStageAdd")) && (document.getElementById(e._addUID("GPlocationStageAdd")).className = "GPlocationOriginHidden"), document.getElementById(e._addUID("GPlocationOriginPointer_" + a)).checked = !0, document.getElementById(e._addUID("GPlocationOrigin_" + a)).className = "GPlocationOriginHidden", document.getElementById(e._addUID("GPlocationOriginCoords_" + a)).className = "GPlocationOriginVisible", document.getElementById(e._addUID("GPlocationOriginCoords_" + a)).disabled = !0 } e.onActivateMapPointClick(t) })), i }, _createLocationRemovePointElement: function (t) { var e = this, i = document.createElement("div"); return i.id = this._addUID("GPlocationStageRemove_" + t), i.className = "GPlocationStageRemove", i.title = "Supprimer l'étape", i.addEventListener("click", (function (i) { var o = document.getElementsByClassName(e._addUID("GPlocationPoint")), s = o.length - 1, a = o[0].childNodes[0].id, r = o[s].childNodes[0].id, l = n.default.index(a), c = n.default.index(r); if (t !== l && t !== c) { var u = n.default.index(this.id); document.getElementById(e._addUID("GPlocationPoint_" + u)).className = "GPflexInput GPlocationStageFlexInputHidden", document.getElementById(e._addUID("GPlocationOrigin_" + u)).value = "", document.getElementById(e._addUID("GPlocationOrigin_" + u)).className = "GPlocationOriginVisible", document.getElementById(e._addUID("GPlocationOriginCoords_" + u)).value = "", document.getElementById(e._addUID("GPlocationOriginCoords_" + u)).className = "GPlocationOriginHidden", document.getElementById(e._addUID("GPlocationStageAdd")).style.display = "", e.onLocationRemovePointClick(i) } })), i }, _createLocationAddPointElement: function () { var t = this, e = document.createElement("div"); return e.id = this._addUID("GPlocationStageAdd"), e.title = "Ajouter une étape", e.addEventListener("click", (function (e) { for (var i = 1, o = 0, s = document.getElementsByClassName(t._addUID("GPlocationPoint")), a = 1; a < s.length - 1; a++) { var r = s[a].childNodes[0].id, l = n.default.index(r); document.getElementById(t._addUID("GPlocationPoint_" + l)) && ("GPflexInput GPlocationStageFlexInputHidden" === document.getElementById(t._addUID("GPlocationPoint_" + l)).className ? 1 === i && (i = l) : o++) } i < s.length && (document.getElementById(t._addUID("GPlocationPoint_" + i)).className = "GPflexInput GPlocationStageFlexInput"), 4 === o && (document.getElementById(t._addUID("GPlocationStageAdd")).style.display = "none"), t.onLocationAddPointClick(e) })), e }, _createLocationAutoCompleteResultElement: function (t) { var e = this, i = document.createElement("div"); return i.id = this._addUID("GPlocationAutoCompleteList_" + t), i.className = "GPadvancedAutoCompleteList", i.addEventListener ? i.addEventListener("click", (function (i) { e.onAutoCompletedResultsItemClick(i), document.getElementById(e._addUID("GPlocationAutoCompleteList_" + t)).style.display = "none" }), !1) : i.attachEvent && i.attachEvent("onclick", (function (i) { e.onAutoCompletedResultsItemClick(i), document.getElementById(e._addUID("GPlocationAutoCompleteList_" + t)).style.display = "none" })), i }, _createLocationAutoCompletedLocationElement: function (t, e, i) { var n = document.getElementById(this._addUID("GPlocationAutoCompleteList_" + t)), o = document.createElement("div"); o.id = this._addUID("AutoCompletedLocation_" + i), o.className = "GPautoCompleteProposal", o.innerHTML = e.fullText, n.appendChild(o) }, GPdisplayCoordinate: function (t) { for (var e = document.getElementsByClassName(this._addUID("GPlocationPoint")), i = 0; i < e.length; i++) { var o = e[i].childNodes[0].id, s = n.default.index(o); if (document.getElementById(this._addUID("GPlocationOriginPointer_" + s)).checked) { document.getElementById(this._addUID("GPlocationOriginCoords_" + s)).value = t, document.getElementById(this._addUID("GPlocationOriginCoords_" + s)).disabled = !1; for (var a = 0; a < e.length; a++) { o = e[a].childNodes[0].id; var r = n.default.index(o); document.getElementById(this._addUID("GPlocationPoint_" + r)).style.cssText = "", document.getElementById(this._addUID("GPlocationStageRemove_" + r)) && (document.getElementById(this._addUID("GPlocationStageRemove_" + r)).className = "GPlocationStageRemove") } return document.getElementById(this._addUID("GPlocationOriginPointer_" + s)).checked = !1, void (document.getElementById(this._addUID("GPlocationStageAdd")) && (document.getElementById(this._addUID("GPlocationStageAdd")).className = "")) } } } }; e.default = s }, function (t, e, i) { "use strict"; i.r(e); var n = { NORTH: "N", SOUTH: "S", EAST: "E", WEST: "O", digitSecond: 2, digitDecimal: 5, digitRadian: 8, roundToDecimal: function (t, e) { var i = Math.pow(10, e); return Math.round(t * i) / i }, decimalToRadian: function (t) { return this.roundToDecimal(.017453292519943295 * t, this.digitRadian) }, decimalToGrade: function (t) { return this.roundToDecimal(1.1111111111111112 * t, this.digitRadian) }, decimalToDMS: function (t, e, i) { t < 0 && (t *= -1); var n = Math.floor(t), o = 60 * (t - n), s = Math.floor(o), a = 60 * (o - s), r = this.roundToDecimal(a, this.digitSecond), l = n + "° " + s + "' " + r + '" '; return e && (l += e), i ? { d: n, m: s, s: r, direction: e } : l }, decimalLatToDMS: function (t, e) { var i = t < 0 ? this.SOUTH : this.NORTH; return this.decimalToDMS(t, i, e) }, decimalLonToDMS: function (t, e) { var i = t < 0 ? this.WEST : this.EAST; return this.decimalToDMS(t, i, e) }, DMSToDecimal: function (t, e, i, n) { var o = t + e / 60 + i / 3600; return o = n === this.SOUTH || n === this.WEST ? -1 * o : o, this.roundToDecimal(o, this.digitDecimal) } }; e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(2), o = i.n(n), s = i(34).default.getLogger("icondefault"), a = o.a.Icon.Default.extend({ images: { retina: { shadow: "data:image/png;base64,...", color: { blue: "data:image/png;base64,...", orange: "data:image/png;base64,...", red: "data:image/png;base64,...", green: "data:image/png;base64,..." } }, shadow: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII=", color: { blue: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==", orange: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABghJREFUWMOdl1uInGcdxn/feWa+mflmJmZbqVqKigewKK5goHgRSEm8EC88F6tBFLfgZbzJnVdRYWExrVBoXazWlAYL0dVisLBYzEUUSbeNjZQmxGZ3NjO7c57v/P69mNnD7MzuzvrCA8PM+/+e93n+h/cb7c9PzXKE9RHAG36+BXRPP3390CDtT3MHklSA7wKngVOWbaOhA5AkEUqpKnAFePHMM9eX9yeZrMQAzgHni14ln826ZLLu2KY0TfD7XXq9NoHffxX48Zmnr6+MkSyNK6kAl4ql8qlisYxpWagoJA16gIxs1E0bI1cAoNNuslFb94Env/jM9csj+0SEXaiIyN+9cuVU5dhxdEmI23XSoAOoIckOVBISt+vE7Q0KRY8H3v+BbM7Nv7w0Nzs3QrLHopdL5crHyqUKSbdB6ndA1BRIiVs1Mo5NySsD/GJpbvbkjpKds50rFL2T5VKZpNdAkmjiAzXDHOye8FvS2cC2LWZmHjAELv1xbrYyIFGCKKmIkvMlr4iK+0gaDe0ZQHcyWIUyVqGMmDZWvoRVKGO63sg+UMSdGq6bo+R5x0XJuYFdGqDxLa9UzJumQRp0R3y3ChU002Zjc5Pbd+6wGem8e/sO6+vrBGGIVagMTdmJScMepZIHGj/4ww8/a5jDevl63s2h4nAgfbhM1yOMQt67V+WjZ87y+VNPYmXzANz7x19YufQzilFIySsTt+vbcSrsYTlZnEymEgTBCV2U5EXJiUzGJg1aI9I1w6DZbPHoE+f5+Jee2iYAeGj2cR479zyNjo+SFN12xqzLZRxEyWld4EOWbRmIApVuJ1E3LaIwRLkzPPzYl8caUURwZz7Iw1/4Cq1WG8POjBSBCvvYtonAJ3URqeiaNlYpuuXg+wHlRz41kQBAKUX5w5+m1/PHKk7SBF0DEfFMgUjJMGnaro7WFGig0nhfAhEhjQI0TRuL1wwNFSkEfF2Ee3GSjp0kDXq4WZv7b19HJeNEWySrN/5G3nUQlezpJ4MkTRHhni4i1ThOuipNByfakhsHmIZGRnV565WLYyoA1t68RuONq3j5DKnfHiXRdKIoRkTuGl/9zIMCfC7rGJ/I5vOocGsQCoiQz7vc/8+/WH37BrnKgzjFY7RWb/Pu8mVWLv2UmUoOxzYGJFtxmobhZFmrd0hS9SPtpbOPApx0s/ZfH3moRNyujU5aO4eRcWl2AjZbPn6YYFsGXt6h4mUxDX0sxioep9kJeG+9ffVrz994fKsZX+v60bVuPzzhFo6RdHY1VtRDEp9S4RilgjPyMBX2iXu90dIbFsFm20fgJwCm7BTEzzda/u/zrjVspl2JVoq4vc40yyrO0OqGdPvxa9/41Y3XYfQ+udLshO8EQYyZK0454idAKTYafUTkwrblu0Z9KjBfb/pouvl/EZhuma4f0e7H//zm4htXt0n23HaL9VZQS5IU3c4emUTTNOoNH9hRsVcJAr7As7VWgJHJDTp4SpiFMv0oodGLbwm8MkoyescjIgtrm4GvlEI37SOo0Kk1AkTkwhOLK+keEtiDmggv1FshRrYwFYGRLRJEKfV2fFeEF/dW3F67tjB/txamIoKm65N37IJu2dRaEQLz3/71m9E4ybhdiMgtEVna7EQY+Qoial/oTo4oTqk2opqIPDepd/QDzjh/vxmDOtgq3cqy3ogQuPidF97qTiaZrAQRWW776bVOkGIW3jfZJidHqoTVRtwVkYX9psCkxO/GwnojRhvMlvGE2zmqzRgRfnn2Nzdb+5McnNbL9a56x48FI+vtSbaDaPDfjSQSmD9onh1kFyKSishCtZmgW/ZY2a5txojI4vd+e7N6CMmBdiHC4lojrcWpoDsuIGimhYhwp5amIlzgkKUf1gMgXZBnq40Ew8kNBmGuxHozAeSl7//u37cPJTmUYoCLdzdVJMNcgLDWFoTDVUxrFyJURVisNhVGzqPWVvQCWRJhZSqS4Qv3NFhYaw10rbUENC4MansaJYO/DtPgZi+QK7W20OrLsih5XZRMSTJdTrZHzWpzkIut76az62hrueXzHPDqUYL+B8XVKUzuUimfAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDEyLTA4LTE4VDE0OjUwOjU2KzAxOjAwFlCkXwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxMi0wOC0xOFQxNDo1MDo1NiswMTowMGcNHOMAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAAElFTkSuQmCC", red: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABe5JREFUWMOdlWuIXGcZx3/nPbe5ZWbO2c0a8VIEpSq0io2QBT8FUlIFEbzfokUUKfgxIuSbn+JtYTEQqFQCQmkxVIiNFhcLwZoVtrFNt40ESrPEJju7s/eZM+f+Pn6Y2XVnZ3Zn0/fwcA7veZ/ze5//87zPMf56fJIHGB8Far3n20D79Nz1kU7GXw6G+MD3gdPAKdtxMJQFQJZEaK0bwBXg2Sfmrl87AHJi2LwJnAXOVf3xSrFcoVAuDyzKs4yw3SLY2iTqBC8BP31ibnZ+AHJ1MBIfeK7qeaeqno9l2+g4IQ86ILpvoXIczCMVAFob66wuLYXAmc/PXb/cB3nxsRN7AdfrY2MPe+Pj6Cjufnyk6Aa2XyfshLQ21glarae+8OrsxZ3N7JHoj3Xff9jzx8jWN8hbbdB6tOU5aXOVguNQ98YAfnv1+OTJHYgAPTt7pFY76Xk+2fo6kiSg8wEzLLMr25B32eoqjm0x8b5jpsBzLx6f9LsQARF8Ec7Vq1V0J0CSuM9ZFVxsr47t1RHHxq7XsL06Vq06AEqby5RLReq12lERzvbkEkC+VatWKpapyNtt6JERwfY9DMdmdW2NOwsLrCmDdxYWWFpaIopjbN/rarLLJw8C6rUqID/682MnTEsQgK9XSiV0nHQ17g2rViWOI95tLPOxJ89w4sx3sCvdarr3txnmf/kbqnFE3auTrqzu+OkgwC4WcAuuH0XRpBKhIsJkwbHJN9f79TcVG5tbPHruZ3z8qR/vAAA+8PgpPvf737Eehug8Rbn2gHQl10WE00rgw7ZtmdtVspMH2yKJY/TEBA996YsDVSsilD/0QR76ypfZ3GphFgp9AN3p4FgmAp9UIuIrQw2UpXJdwijGe+SRoQAArTXepz9FEEbdfOzylyxHddfWLEESLbpblrtPtM4AQafJvgARIY8iDMMY8DcM6a5BQiUY99I8H9hJHgSUHZvluVfRaToA2obc/8c/qbg2kqV9/oapyPIcwbinRKSRZnlb53l3R9vhRjGWAYV2i7cuXByIAmBx9l+sz8xQK7jkW1v9EKVI0hQRuWt+9dj7Bfhs0VSfKFZK6CDoq/lKucTya69x/+Y8pWPHcMd8Nu8s8M7lF5j/xa+ZKBVwTdWFbPsZBmaxwGIrINP6J8bzj34G4GTZcf7+kXqFtNns77SlMma5xEaUsBbGhFmGY5rUXBu/6GIpNeBjHz3KRpTw7lZ75ms3bzxudQXg5XaSzLbjZLI8Nka2srLrYLWRqEPdH6Pu2n0f050OaRD0l54yQIS1MELg5wDbEIBfrYbRCxW3MvDfkEyTLi+NavjdKMYn2Ixi2mn28jdu3nil1yCFnl3ZiNO3ozjtNb5DtPihbV+z2okRkfPDWn0uMLUSxhim9Z4AlufRThK20uzGN9/498wOhN0HUfSllShuZnmOKhXZ826kGYbBSicG0ed3S7g7EgRCgaebYYxZLvW/GWGW79HJM9bT7LbAn/oh/8/Jtk0vRkmotUY5zqGlMpSi2cvFt+dfz/dEYrDHmoLxh5Uwxjxy5FAAs1olynJWUn1XMJ7dW3FKGHpN3Y2yXEQwTDVSKuU6NKMEQaa+++brySBkUC5E5LaIXF2LE0zfR7Te11SpRJLlNJK8KSLPDDs76oA9Ti3H+UipVLHIUpggcOF7b73RHg4ZHgkicm0r17OtLMc6Oj5cpnKJXAv3U90Wken9uoAaUZzTS1GGIQxPeLFEI04RuPjkrfnN9wq5vKJ5OxTBrNb2JNtFFPw3lURg6qB+dpBciEguItONOEO5zkDZLoYpInLpB7fmGwdDRp/nS4sZzVQEVS6DCIZjIyIspOQC5xkx1O6/4D7WRuTpRpRhlkrdRlirsxRnIPL8D//z5p2RkH0O497rwt2cRBBUwQWExVwQZGQUPchAWxlmDcG41Eg0Zq1GM9EEoq4KxvyhIA/QaacXs+5z736+O3+YSEamZMduBaKuNFNhU9Q1EV6RwzEOnZOdxnk/7eZie+aQcj3QuLaJegZ46UGc/gcUeTtzDg/o4wAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMi0wOC0xOFQxNDo1MDo1NiswMTowMBZQpF8AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTItMDgtMThUMTQ6NTA6NTYrMDE6MDBnDRzjAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAABJRU5ErkJggg==", green: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wJCgoDDgqHD/MAAAZVSURBVFjDpZZtiFxXGcd/c+69M7PzurvdTTZNGvxQTCJqFSok+MmFQPSDUlsQhBaxWNhorQlWPxSKTYqsFLYGA8VCISDESIpCILYQW4xJNtHGGBooZtl16UrKNrMvM7N3Xu6555zHD7OZ7OzsW/Be/nBnznnO/zzP83/OcxKPv/IOW32KXzj2KFBc/nm7cuvl8IOXD21ql3j8lT9vsOjxfuB7wCHgoAoUCV8BYJsWRGaBc8DpvzwxfnF9kl90kxQ+f9wDXgReyg9kc8VkH4Wg2DUvdpqyXqRcKxOH5l3gZ+89OX5rDZLzqwhe7QfOZAcyB4fSO0h6KbSNqNt6F0lSJcn4WQA+bcyycHehATzz3pPjb6+cp0SEe8jvOdYvsRvPDmQOPpLZjRXLYjRPzYSIuC5EtsliNE9ZL7ItvY2dD+/sSRaDs8Nn9o90kLQ92HvcA87mduT27Mw8QiWuUDMhVuymMC5mPpoj42UYyu0A+M3wmf3D90lEQATgxfT29PDDPTup6jKx08gar6+CNf8XhEW9QEqlGNw16AFnhs/s72+FC6Gw79V+4KXtPUPUbZ3IRR07DVSSQlCkEBRRCdX+zvn5Lq/mohKFoEh2KDO4LB4ULUe+mxpI5RSKMA5xIm0Ug16SKsknjTtMfTxFGIdMfTzFzOIMoVmiGPQCdNjUTY3B9HZEeO5rv9/v+YggwncK6QKxxB3qyQU5aibk7iclvv3YUzz91WfJ+wUALsy+w+sf/opGusFgahuLerFt17BN0l4PQc7v10vmgJ/f98sccCDjZ5mP5jpIvITHYljm+QNH+NaupzrGDg59nc/m9/KDC08TD8UEyqdhG+1xh8PP+eglc0jhZLeXUp4V2yFPPxFQNzWymWwXAYAg7M5+hm/s+yZzzRIpL91hXzc1kioAJ59TQH9C3WOXNlJeitCEfLH3S2sSAFgxPNb7ZXQl7rJ3IiRaCxd9caLFgXUGcdJeyDiDiKBdtC6BE6FhGygv0WUvnsOKRZw0FHDHRg6HdCzWtHXyQZ4bn17HrBKEFdNaAMel0l/xcz5WbOd5hcI4A3BHiWPWaReKuNYOjEOMw2hDggQudpyceL3DC9cqXsZLl7g+9Q8KQYEls9S2FePwEgrbsIhjxuvb+2tJDYx/RXJuXzbI0dRR+xBwypDtyXLrvx9yLbzC9vR2HkoO8J9wkrMzp/nt+Bv0DKbwVUCj0VxxeEAQJKneDRErz/siAk5ONueiJzI7MrAirroe4zJC70NFphem+PnkUWzkUH6CZG9A364iXsKjulTprK98nqV6Fde0F/72/Q8+8hGh8u+fvl/Y89rVWn/tQDaXI6wu3e8ZYYzxLflsjlymU2UN2yAO4zUbVXNeIyLHAHzuJ/w1XY7/mN7mWKUBJHZUy9UttehsMUtYD7EN8/6lZ69fBmiFCxDLuWhBT0b90aN+zm9r/0EfEdfywjLaddRXJ45aYCxa0PjKp53FB0CqN0mzGWFC88/Lz12/sKIzrpjn5FRzLioZZ/B6fMTxQFAkiBY04mS0szOuYKlOHG0g8mazFOGlFGJly0jmfXQ9Rpf1bUT+tG6PX87PiWg+aiDgpbyWpLeARKCIyjHA6JWRG3ZVjxdWojJxpAT8rjkX4We9LSU7KATYhiWu6Bng9OpxtVYCxTHWLEX2XmE6tzGUnyAqx4hj7MrIDd1FsjpcIkJl4oXbYuW8rhqSfUkkduvCSymsdkRzUUmsvLWWp2o9OYqTsWhRb6pcP+ujyzHi5OTVH/8rXJNkLU9EhOrUCxdNzVw1NUN6ILlmsv2MhxhHcy4KgRPr5awr8Z3ghC7r5Uru3oif8YgWNMAb135ys7I+yYbx4O24aiZt5Ej2JjsvGSkPBKJ5rRHGNlLfuuESESqTP7IiLW+UrxBLG0E+aFW3cOrakZuzG5JsHC4BOKUrpuRM64ojTlB+AhGhOa8tMLpZHanN1FOZ/GEIvBlXYvweBSIk+wJ0q7r/8PejN6c3JdnSCevkZLSgtdhWLsSBLmtYdRD+H+ESKlOHZ8XJqbgaExQC4iWD0+58Zerwra2RbM7B8qX8hK7EiBN0WSPC6OoOun5O2NpbnT78kdXunKlbbOQuVqcPX5YtsqgH636M6bIGYbTj/rN5Trb+VKdHLtqme6s6PfLug9j9D/FCc1g2qf7VAAAAAElFTkSuQmCC" } }, initialize: function (t, e) { o.a.Util.extend(this.options, e); var i = null, n = this.images; switch (t) { case "red": i = n.color.red; break; case "green": i = n.color.green; break; case "orange": i = n.color.orange; break; default: i = n.color.blue }this.options.iconUrl = i, this.options.shadowUrl = n.shadow, o.a.Browser.retina && (this.options.iconRetinaUrl = i, this.options.shadowRetinaUrl = n.shadow) }, _getIconUrl: function (t) { return s.trace("OVERWRITTEN L.Icon.Default._getIconUrl(" + t + ")"), o.a.Icon.prototype._getIconUrl.call(this, t) } }); e.default = a }, function (t, e, i) { "use strict"; i.r(e); var n = { _addUID: function (t) { return this._uid ? t + "-" + this._uid : t }, _createMainContainerElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPisochron"), t.className = "GPwidget", t }, _createShowIsoElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPshowIsochron"), t.type = "checkbox", t }, _createShowIsoPictoElement: function () { var t = this, e = document.createElement("label"); e.id = this._addUID("GPshowIsochronPicto"), e.className = "GPshowAdvancedToolPicto", e.htmlFor = this._addUID("GPshowIsochron"), e.title = "Calculer une isochrone", e.addEventListener ? e.addEventListener("click", (function (e) { t.onShowIsoPanelClick(e) })) : e.attachEvent && e.attachEvent("onclick", (function (e) { t.onShowIsoPanelClick(e) })); var i = document.createElement("span"); return i.id = this._addUID("GPshowIsochronOpen"), i.className = "GPshowAdvancedToolOpen", e.appendChild(i), e }, _createIsoPanelElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPisochronPanel"), t.className = "GPpanel", t }, _createIsoPanelHeaderElement: function () { var t = this, e = document.createElement("div"); e.className = "GPpanelHeader"; var i = document.createElement("div"); i.className = "GPpanelTitle", i.innerHTML = "Calcul d'isochrone", e.appendChild(i); var n = document.createElement("div"); return n.id = this._addUID("GPisochronPanelClose"), n.className = "GPpanelClose", n.title = "Fermer le panneau", n.addEventListener ? n.addEventListener("click", (function () { document.getElementById(t._addUID("GPshowIsochronPicto")).click() }), !1) : n.attachEvent && n.attachEvent("onclick", (function () { document.getElementById(t._addUID("GPshowIsochronPicto")).click() })), e.appendChild(n), e }, _createIsoPanelFormElement: function () { var t = this, e = document.createElement("form"); return e.id = this._addUID("GPisochronForm"), e.addEventListener("submit", (function (e) { return e.preventDefault(), t.onIsoComputationSubmit(e), !1 })), e }, _createIsoWaitingElement: function () { var t = document.createElement("div"); t.id = this._addUID("GPisochronCalcWaitingContainer"), t.className = "GPisochronCalcWaitingContainerHidden"; var e = document.createElement("p"); return e.className = "GPisochronCalcWaiting", e.innerHTML = "Calcul en cours...", t.appendChild(e), t }, _createIsoPanelFormTypeChoiceElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPisochronChoice"), t }, _createIsoPanelFormTypeChoiceChronElement: function (t) { var e = this, i = document.createElement("div"); i.className = "GPisochronChoiceAlt"; var n = document.createElement("input"); n.id = this._addUID("GPisochronChoiceAltChron"), n.name = "GPisochronChoiceMode", n.type = "radio", n.checked = !!t, n.addEventListener ? n.addEventListener("change", (function (t) { document.getElementById(e._addUID("GPisochronValueChron")).className = "GPflexInput", document.getElementById(e._addUID("GPisochronValueDist")).className = "GPisochronValueHidden", e.onIsoTypeChoiceChange(t) }), !1) : n.attachEvent && n.attachEvent("onchange", (function () { document.getElementById(e._addUID("GPisochronValueChron")).className = "GPflexInput", document.getElementById(e._addUID("GPisochronValueDist")).className = "GPisochronValueHidden", e.onIsoTypeChoiceChange() })), n.value = "isochron", i.appendChild(n); var o = document.createElement("label"); o.className = "GPisochronChoiceAltImg", o.htmlFor = this._addUID("GPisochronChoiceAltChron"), i.appendChild(o); var s = document.createElement("span"); return s.id = this._addUID("GPisochronChoiceAltChronTxt"), s.innerHTML = "isochrone", s.addEventListener ? s.addEventListener("click", (function () { document.getElementById(e._addUID("GPisochronChoiceAltChron")).click() }), !1) : s.attachEvent && s.attachEvent("onclick", (function () { document.getElementById(e._addUID("GPisochronChoiceAltChron")).click() })), i.appendChild(s), i }, _createIsoPanelFormTypeChoiceDistElement: function (t) { var e = this, i = document.createElement("div"); i.className = "GPisochronChoiceAlt"; var n = document.createElement("input"); n.id = this._addUID("GPisochronChoiceAltDist"), n.name = "GPisochronChoiceMode", n.type = "radio", n.checked = !!t, n.addEventListener ? n.addEventListener("change", (function (t) { document.getElementById(e._addUID("GPisochronValueDist")).className = "GPflexInput", document.getElementById(e._addUID("GPisochronValueChron")).className = "GPisochronValueHidden", e.onIsoTypeChoiceChange(t) }), !1) : n.attachEvent && n.attachEvent("onchange", (function () { document.getElementById(e._addUID("GPisochronValueDist")).className = "GPflexInput", document.getElementById(e._addUID("GPisochronValueChron")).className = "GPisochronValueHidden", e.onIsoTypeChoiceChange() })), n.value = "isodistance", i.appendChild(n); var o = document.createElement("label"); o.className = "GPisochronChoiceAltImg", o.htmlFor = this._addUID("GPisochronChoiceAltDist"), i.appendChild(o); var s = document.createElement("span"); return s.id = this._addUID("GPisochronChoiceAltDistTxt"), s.innerHTML = "isodistance", s.addEventListener ? s.addEventListener("click", (function () { document.getElementById(e._addUID("GPisochronChoiceAltDist")).click() }), !1) : s.attachEvent && s.attachEvent("onclick", (function () { document.getElementById(e._addUID("GPisochronChoiceAltDist")).click() })), i.appendChild(s), i }, _createIsoPanelFormValueIsochronElement: function (t) { var e = this, i = document.createElement("div"); i.id = this._addUID("GPisochronValueChron"), i.className = t ? "GPflexInput" : "GPisochronValueHidden"; var n = document.createElement("label"); n.id = this._addUID("GPisochronValueChronLabel"), n.htmlFor = this._addUID("GPisochronValueChronInput"), n.innerHTML = "Temps", i.appendChild(n); var o = document.createElement("input"); o.id = this._addUID("GPisochronValueChronInput1"), o.min = "0", o.step = "1", o.value = "0", o.type = "number", o.addEventListener ? o.addEventListener("change", (function (t) { "function" == typeof e.onIsoValueChronTimeMinuteChange && e.onIsoValueChronTimeHourChange(t) })) : o.attachEvent && o.attachEvent("onchange", (function (t) { "function" == typeof e.onIsoValueChronTimeMinuteChange && e.onIsoValueChronTimeHourChange(t) })), i.appendChild(o); var s = document.createElement("label"); s.innerHTML = "h", i.appendChild(s); var a = document.createElement("input"); a.id = this._addUID("GPisochronValueChronInput2"), a.min = "0", a.max = "59", a.step = "1", a.value = "0", a.type = "number", a.addEventListener ? a.addEventListener("change", (function (t) { "function" == typeof e.onIsoValueChronTimeMinuteChange && e.onIsoValueChronTimeMinuteChange(t) })) : a.attachEvent && a.attachEvent("onchange", (function (t) { "function" == typeof e.onIsoValueChronTimeMinuteChange && e.onIsoValueChronTimeMinuteChange(t) })), i.appendChild(a); var r = document.createElement("label"); return r.innerHTML = "min", i.appendChild(r), i }, _createIsoPanelFormValueIsodistanceElement: function (t) { var e = this, i = document.createElement("div"); i.id = this._addUID("GPisochronValueDist"), i.className = t ? "GPflexInput" : "GPisochronValueHidden"; var n = document.createElement("label"); n.id = this._addUID("GPisochronValueDistLabel"), n.htmlFor = this._addUID("GPisochronValueDistInput"), n.innerHTML = "Distance", i.appendChild(n); var o = document.createElement("input"); o.id = this._addUID("GPisochronValueDistInput"), o.min = "0", o.step = "any", o.value = "0", o.type = "number", o.addEventListener ? o.addEventListener("change", (function (t) { "function" == typeof e.onIsoValueDistChange && e.onIsoValueDistChange(t) })) : o.attachEvent && o.attachEvent("onchange", (function (t) { "function" == typeof e.onIsoValueDistChange && e.onIsoValueDistChange(t) })), i.appendChild(o); var s = document.createElement("label"); return s.innerHTML = "km", i.appendChild(s), i }, _createIsoPanelFormModeChoiceElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPisochronModeChoice"), t }, _createIsoPanelFormModeChoiceTransportElement: function (t) { var e = this, i = document.createElement("div"); i.id = this._addUID("GPisochronTransportChoice"); var n = document.createElement("span"); n.className = "GPisochronModeLabel", n.innerHTML = "Mode de transport", i.appendChild(n); for (var o = 0; o < t.length; o++) { var s = t[o]; if ("Voiture" === s) { var a = document.createElement("input"); a.id = this._addUID("GPisochronTransportCar"), a.type = "radio", a.name = "GPisochronTransport", 0 === o && (a.checked = !0), a.addEventListener ? a.addEventListener("change", (function (t) { e.onIsoModeTransportChange(t) })) : a.attachEvent && a.attachEvent("onchange", (function (t) { e.onIsoModeTransportChange(t) })), a.value = "Voiture", i.appendChild(a); var r = document.createElement("label"); r.className = "GPisochronTransportImg", r.htmlFor = this._addUID("GPisochronTransportCar"), r.title = "Voiture", i.appendChild(r) } if ("Pieton" === s) { var l = document.createElement("input"); l.id = this._addUID("GPisochronTransportPedestrian"), l.type = "radio", l.name = "GPisochronTransport", 0 === o && (l.checked = !0), l.addEventListener ? l.addEventListener("change", (function (t) { e.onIsoModeTransportChange(t) })) : l.attachEvent && l.attachEvent("onchange", (function (t) { e.onIsoModeTransportChange(t) })), l.value = "Pieton", i.appendChild(l); var c = document.createElement("label"); c.className = "GPisochronTransportImg", c.htmlFor = this._addUID("GPisochronTransportPedestrian"), c.title = "Piéton", i.appendChild(c) } } return i }, _createIsoPanelFormModeChoiceDirectionElement: function (t) { var e = this, i = document.createElement("div"); i.id = this._addUID("GPisochronDirectionChoice"); var n = document.createElement("span"); n.className = "GPisochronModeLabel", n.innerHTML = "Sens de parcours", i.appendChild(n); var o = document.createElement("select"); o.id = this._addUID("GPisochronDirectionSelect"), o.className = "GPinputSelect", o.addEventListener("change", (function (t) { e.onIsoModeDirectionChange(t) })); for (var s = 0; s < t.length; s++) { var a = t[s]; if ("departure" === a.toLowerCase()) { var r = document.createElement("option"); 0 === s && (r.selected = "selected"), r.value = "departure", r.text = "Départ", o.appendChild(r) } if ("arrival" === a.toLowerCase()) { var l = document.createElement("option"); 0 === s && (l.selected = "selected"), l.value = "arrival", l.text = "Arrivée", o.appendChild(l) } } return i.appendChild(o), i }, _createShowIsoExclusionsElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPshowIsoExclusions"), t.type = "checkbox", t }, _createShowIsoExclusionsPictoElement: function () { var t = document.createElement("label"); return t.id = this._addUID("GPshowIsoExclusionsPicto"), t.className = "GPshowMoreOptionsImage GPshowMoreOptions GPshowIsoExclusionsPicto", t.htmlFor = this._addUID("GPshowIsoExclusions"), t.title = "Exclusions", t.style.top = "240px", t }, _createIsoPanelFormExclusionsElement: function () { var t = document.createElement("div"); t.id = this._addUID("GPisoExclusions"); var e = document.createElement("span"); return e.className = "GPisoExclusionsLabel", e.innerHTML = "Passages autorisés", t.appendChild(e), t }, _createIsoPanelFormExclusionOptionsElement: function (t) { var e = this, i = document.createElement("div"); for (var n in i.className = "GPisoExclusionsOptions", t) if (t.hasOwnProperty(n)) { var o = t[n]; switch (n) { case "toll": var s = document.createElement("input"); s.id = this._addUID("GPisoExclusionsToll"), s.type = "checkbox", s.checked = !o, s.addEventListener ? s.addEventListener("change", (function (t) { e.onIsoExclusionsChange(t) })) : s.attachEvent && s.attachEvent("onchange", (function (t) { e.onIsoExclusionsChange(t) })), s.value = "Toll", i.appendChild(s); var a = document.createElement("label"); a.className = "GPisoExclusionsOption", a.htmlFor = this._addUID("GPisoExclusionsToll"), a.innerHTML = "Péages", i.appendChild(a); break; case "tunnel": var r = document.createElement("input"); r.id = this._addUID("GPisoExclusionsTunnel"), r.type = "checkbox", r.checked = !o, r.addEventListener ? r.addEventListener("change", (function (t) { e.onIsoExclusionsChange(t) })) : r.attachEvent && r.attachEvent("onchange", (function (t) { e.onIsoExclusionsChange(t) })), r.value = "Tunnel", i.appendChild(r); var l = document.createElement("label"); l.className = "GPisoExclusionsOption", l.htmlFor = this._addUID("GPisoExclusionsTunnel"), l.innerHTML = "Tunnels", i.appendChild(l); break; case "bridge": var c = document.createElement("input"); c.id = this._addUID("GPisoExclusionsBridge"), c.type = "checkbox", c.checked = !o, c.addEventListener ? c.addEventListener("change", (function (t) { e.onIsoExclusionsChange(t) })) : c.attachEvent && c.attachEvent("onchange", (function (t) { e.onIsoExclusionsChange(t) })), c.value = "Bridge", i.appendChild(c); var u = document.createElement("label"); u.className = "GPisoExclusionsOption", u.htmlFor = this._addUID("GPisoExclusionsBridge"), u.innerHTML = "Ponts", i.appendChild(u) } } return i }, _createIsoSubmitFormElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPisochronSubmit"), t.className = "GPinputSubmit", t.type = "submit", t.value = "Calculer", t }, _createIsoFormResetElement: function () { var t = this, e = document.createElement("div"); return e.id = this._addUID("GPisochronReset"), e.title = "Réinitialiser les paramètres", e.addEventListener("click", (function (e) { t.onIsoResetClick(e) })), e } }; e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(40), o = i(2), s = i.n(o), a = i(34), r = i(131), l = i(36), c = i(139), u = i(140), h = i(135), d = i(141); function p(t) { return p = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, p(t) } var m = a.default.getLogger("mouseposition"), f = s.a.Control.extend({ includes: u.default, options: { position: "bottomleft", collapsed: !0, units: [], systems: [], displayAltitude: !0, displayCoordinates: !0, editCoordinates: !1, altitude: { triggerDelay: 200, responseDelay: 500, noDataValue: -99999, noDataValueTolerance: 9e4, serviceOptions: {} } }, initialize: function (t) { s.a.Util.extend(this.options, t), this._uid = l.default.generate(), this._projectionSystems = [], this._initProjectionSystems(), this._projectionUnits = {}, this._initProjectionUnits(), this._isDesktop = this._detectSupport(), this.options.altitude.triggerDelay < 100 && (this.options.altitude.triggerDelay = 100), this._timer = this.options.altitude.triggerDelay, this._currentProjectionSystems = this._projectionSystems[0], this._projectionSystemsContainer = null, this._currentProjectionType = this._projectionSystems[0].type, this._currentProjectionUnits = this._projectionUnits[this._currentProjectionType][0].code, this._projectionUnitsContainer = null, this._showContainer = null, this._pictoContainer = null, this._panelContainer = null, this._panelHeaderContainer = null, this.options.displayAltitude || this.options.displayCoordinates || (this.options.displayCoordinates = !0), this.options.displayCoordinates || (this.options.editCoordinates = !1), this._isEditing = !1, this._noRightManagement = !1, this.options.displayAltitude && this._checkRightsManagement(), s.a.Util.setOptions(this, this.options) }, onAdd: function (t) { var e = this._container = this._initLayout(); return this.options.collapsed || (this._isDesktop ? t.on("mousemove", this.onMouseMove, this) : t.on("move", this.onMapMove, this)), s.a.DomEvent.disableClickPropagation(e).disableScrollPropagation(e), s.a.DomEvent.addListener(e, "mousemove", s.a.DomEvent.stopPropagation).addListener(e, "mousemove", s.a.DomEvent.preventDefault), e }, onRemove: function (t) { t.off("mousemove", this.onMouseMove) }, _initProjectionSystems: function () { for (var t = [{ label: "Géographique", crs: s.a.CRS.Simple, type: "Geographical" }, { label: "Web Mercator", crs: s.a.CRS.EPSG3395, type: "Metric" }, { label: "Lambert 93", crs: d.default.EPSG2154, type: "Metric", geoBBox: { left: -9.86, bottom: 41.15, right: 10.38, top: 51.56 } }, { label: "Lambert II étendu", crs: d.default.EPSG27572, type: "Metric", geoBBox: { left: -4.87, bottom: 42.33, right: 8.23, top: 51.14 } }], e = this.options.systems, i = 0; i < e.length; i++) { var n = e[i]; if (n.label) if (n.crs) { n.type || (m.warn("type srs not defined, use 'Metric' by default !"), n.type = "Metric"), this._projectionSystems.push(e[i]); for (var o = !1, a = 0; a < t.length; a++) { var r = t[a]; n.crs === r.crs && (o = !0, m.info("crs '{}' already configured by default", r.code)) } o || m.info("crs '{}' not found, it's a new projection", n.code || n.label) } else m.error("crs not defined !"); else m.error("not defined !") } 0 === this._projectionSystems.length && (this._projectionSystems = t); for (var l = 0; l < this._projectionSystems.length; ++l)this._projectionSystems[l].code = l }, _initProjectionUnits: function () { var t = { Geographical: [{ code: "DEC", label: "degrés décimaux", format: this._displayDEC }, { code: "DMS", label: "degrés sexagésimaux", format: this._displayDMS }, { code: "RAD", label: "radians", format: this._displayRAD }, { code: "GON", label: "grades", format: this._displayGON }], Metric: [{ code: "M", label: "mètres", format: this._displayMeter }, { code: "KM", label: "kilomètres", format: this._displayKMeter }] }, e = this.options.units; for (var i in t) if (t.hasOwnProperty(i)) { for (var n = !1, o = 0; o < t[i].length; o++)for (var s = t[i][o], a = 0; a < e.length; a++) { var r = e[a]; s.code === r && (n = !0, this._projectionUnits[i] || (this._projectionUnits[i] = []), this._projectionUnits[i].push(s)) } n || (this._projectionUnits[i] = t[i]) } 0 === Object.keys(this._projectionUnits).length && (this._projectionUnits = t) }, _checkRightsManagement: function () { var t = r.default.check({ key: this.options.apiKey, resources: ["SERVICE_CALCUL_ALTIMETRIQUE_RSC"], services: ["Elevation"] }); this._noRightManagement = !t, this.options.apiKey || (this.options.apiKey = t ? t.key : null) }, _detectSupport: function () { var t = !0, e = window.navigator.userAgent.toLowerCase(); return -1 === e.indexOf("iphone") && -1 === e.indexOf("ipod") && -1 === e.indexOf("ipad") && -1 === e.indexOf("android") && -1 === e.indexOf("mobile") && -1 === e.indexOf("blackberry") && -1 === e.indexOf("tablet") && -1 === e.indexOf("phone") && -1 === e.indexOf("touch") || (t = !1), -1 === e.indexOf("msie") && -1 === e.indexOf("trident") || (t = !0), t }, _initLayout: function () { var t = this._createMainContainerElement(), e = this._showContainer = this._createShowMousePositionElement(); t.appendChild(e), this.options.collapsed || (e.checked = !0); var i = this._pictoContainer = this._createShowMousePositionPictoElement(this._isDesktop); t.appendChild(i); var n = this._panelContainer = this._createMousePositionPanelElement(), o = this._panelHeaderContainer = this._createMousePositionPanelHeaderElement(); n.appendChild(o); var s = this._createMousePositionPanelBasicElement(this.options.displayAltitude, this.options.displayCoordinates, this.options.editCoordinates); n.appendChild(s); for (var a = this._createShowMousePositionSettingsElement(this.options.displayCoordinates), r = 0; r < a.length; r++)n.appendChild(a[r]); var l = this._createMousePositionSettingsElement(), c = this._projectionSystemsContainer = this._createMousePositionSettingsSystemsElement(this._projectionSystems), u = this._projectionUnitsContainer = this._createMousePositionSettingsUnitsElement(this._projectionUnits[this._currentProjectionType]); l.appendChild(c), l.appendChild(u), n.appendChild(l), t.appendChild(n); var h = this._createMapCenter(); return this._map.getContainer().appendChild(h), t }, _setElevationPanel: function (t) { t || (s.a.DomUtil.get(this._addUID("GPmousePositionAltitude")).style.display = "none"), t && this._noRightManagement && (s.a.DomUtil.get(this._addUID("GPmousePositionAlt")).innerHTML = "no right !") }, _setCoordinatePanel: function (t) { t || (s.a.DomUtil.get(this._addUID("GPmousePositionCoordinate")).style.display = "none") }, _setSettingsPanel: function (t) { if (!t) { var e = s.a.DomUtil.get("GPshowMousePositionSettingsPicto"), i = s.a.DomUtil.get(this._addUID("GPmousePositionSettings")); e.style.display = "none", i.style.display = "none" } }, _setTypeUnitsPanel: function (t) { for (var e = this._projectionUnitsContainer; e.firstChild;)e.removeChild(e.firstChild); for (var i = this._projectionUnits[t], n = 0; n < i.length; n++) { var o = i[n], s = document.createElement("option"); s.value = o.code ? o.code : n, s.text = o.label || n, e.appendChild(s) } var a = this._projectionUnits[t][0].code; "DMS" !== this._currentProjectionUnits && "DMS" !== a || (this._resetCoordinateElements(this.options.editCoordinates, t, a), this._setEditMode(this._isEditing)), this._currentProjectionType = t, this._resetLabelElements(t), this._resetUnitElements(a), this._currentProjectionUnits = this._projectionUnits[t][0].code }, _displayDEC: function (t) { var e = {}; return e.lat = h.default.roundToDecimal(t.lat, 6), e.lng = h.default.roundToDecimal(t.lng, 6), e.unit = "°", e }, _displayDMS: function (t) { var e = {}; return e.lat = h.default.decimalLatToDMS(t.lat, !0), e.lng = h.default.decimalLonToDMS(t.lng, !0), e }, _displayRAD: function (t) { var e = {}; return e.lat = h.default.decimalToRadian(t.lat), e.lng = h.default.decimalToRadian(t.lng), e.unit = "rad", e }, _displayGON: function (t) { var e = {}; return e.lat = h.default.decimalToGrade(t.lat), e.lng = h.default.decimalToGrade(t.lng), e.unit = "gon", e }, _displayMeter: function (t) { var e = {}; return e.x = s.a.Util.formatNum(t.x, 2), e.y = s.a.Util.formatNum(t.y, 2), e.unit = "m", e }, _displayKMeter: function (t) { var e = {}; return e.x = s.a.Util.formatNum(t.x / 1e3, 2), e.y = s.a.Util.formatNum(t.y / 1e3, 2), e.unit = "km", e }, _project: function (t, e) { if ("function" == typeof e && (e = e()), "object" === p(e)) { if (e === s.a.CRS.Simple) return t; if (e.projection && "object" === p(e.projection)) { var i = e.projection.project(t); return "Geographical" === this._currentProjectionType && (i.lat = i.y, i.lng = i.x), i && 0 !== Object.keys(i).length || m.error("Failed to project with crs code : " + e.code), i } m.error("projection is not an object !") } else m.log("crs is not an object !") }, _unproject: function (t) { var e = this._currentProjectionSystems.crs; if (e) if ("function" == typeof e && (e = e()), "object" === p(e)) { if (e === s.a.CRS.Simple) return { lat: t.y, lng: t.x }; if ("Geographical" === this._currentProjectionType) return { lat: t.y, lng: t.x }; if (e.projection && "object" === p(e.projection)) { var i = e.projection.unproject(t); return i && 0 !== Object.keys(i).length || m.error("Failed to unproject coordinate"), i } m.error("projection is not an object !") } else m.log("crs is not an object !"); else m.log("system crs not found") }, _setCoordinate: function (t) { for (var e = this._currentProjectionSystems.type, i = null, n = this._projectionUnits[e], o = 0; o < n.length; o++)if (n[o].code === this._currentProjectionUnits) { i = n[o].format; break } var s, a = this._currentProjectionSystems.crs; a ? (s = i(this._project(t, a))) && 0 !== Object.keys(s).length && this.GPdisplayCoords(s) : m.error("crs not found !") }, _setElevation: function (t) { var e = this.options.altitude.responseDelay, i = this.options.altitude.noDataValue, n = this.options.altitude.noDataValueTolerance; this.GPdisplayElevation(t, e, i, n) }, onMoveStopped: function (t) { this._noRightManagement || this._setElevation(t) }, onMouseMove: function (t) { var e = this, i = t.latlng; this._setCoordinate(i), clearTimeout(this._timer), this._timer = setTimeout((function () { e.onMoveStopped(i) }), this.options.altitude.triggerDelay) }, onMapMove: function () { var t = this, e = this._map.getCenter(); this._setCoordinate(e), clearTimeout(this._timer), this._timer = setTimeout((function () { t.onMoveStopped(e) }), this.options.altitude.triggerDelay) }, onRequestAltitude: function (t, e) { if (m.log("onRequestAltitude"), t && 0 !== Object.keys(t).length && this.options.displayAltitude && !this._noRightManagement) { m.log(t); var i = {}; s.a.Util.extend(i, this.options.altitude.serviceOptions), s.a.Util.extend(i, { zonly: !0, positions: [{ lon: t.lon || t.lng, lat: t.lat }] }), s.a.Util.extend(i, { scope: this, onSuccess: function (t) { m.log(t), t && Object.keys(t).length && e.call(this, t.elevations[0].z) }, onFailure: function (t) { m.error(t.message) } }), s.a.Util.extend(i, { apiKey: i.apiKey || this.options.apiKey }), s.a.Util.extend(i, { ssl: this.options.ssl }), m.log(i), n.default.Services.getAltitude(i) } }, onShowMousePositionClick: function (t) { m.log(t); var e = this._map; this._showContainer.checked ? this._isDesktop ? e.off("mousemove", this.onMouseMove, this) : e.off("move", this.onMapMove, this) : this._isDesktop ? e.on("mousemove", this.onMouseMove, this) : e.on("move", this.onMapMove, this), this._setElevationPanel(this.options.displayAltitude), this._setCoordinatePanel(this.options.displayCoordinates), this.options.displayCoordinates || this._setSettingsPanel(!1) }, onMousePositionEditModeClick: function (t) { if (this.options.editCoordinates && this._isEditing !== t) { this._isEditing = t, this._setEditMode(this._isEditing); var e = this._map; this._isDesktop ? this._isEditing ? e.off("mousemove", this.onMouseMove, this) : e.on("mousemove", this.onMouseMove, this) : this._isEditing ? e.off("move", this.onMapMove, this) : e.on("move", this.onMapMove, this) } }, _convertCoordinate: function (t, e) { var i; if ("DEC" === e || "DMS" === e) i = t; else if ("M" === e) i = t; else if ("KM" === e) i = 1e3 * t; else if ("RAD" === e) { i = (t * (180 / Math.PI).toFixed(20)).toFixed(20) } else if ("GON" === e) { i = (t * .9.toFixed(20)).toFixed(20) } return i }, validateExtentCoordinate: function (t, e, i) { if (void 0 !== i) return !0; if (-1 === ["Lon", "Lat"].indexOf(t)) return !1; var n = this._currentProjectionSystems.geoBBox; if (void 0 === n) return !0; if (n) { var o = [n.left, n.bottom, n.right, n.top], s = this._currentProjectionUnits, a = this._unproject({ x: "Lon" === t ? this._convertCoordinate(e, s) : 0, y: "Lat" === t ? this._convertCoordinate(e, s) : 0 }); if ("Lon" === t && (a.lng < o[0] || a.lng > o[2])) return m.warn("coordinates (lon) out of extent !?"), !1; if ("Lat" === t && (a.lat < o[1] || a.lat > o[3])) return m.warn("coordinates (lat) out of extent !?"), !1 } return !0 }, _getCoordinate: function (t) { var e = s.a.DomUtil.get(this._addUID("GPmousePosition" + t + "Degrees")), i = e.value; if (!i) return null; if (i = i.replace(",", "."), !c.default.isInteger(i)) return null; var n = c.default.toInteger(i); if (n < Number(e.dataset.min) || n > Number(e.dataset.max)) return null; var o = s.a.DomUtil.get(this._addUID("GPmousePosition" + t + "Direction")).value, a = s.a.DomUtil.get(this._addUID("GPmousePosition" + t + "Minutes")), r = a.value; if (r && (r = r.replace(",", "."), c.default.isInteger(r))) { var l = c.default.toInteger(r); l >= Number(a.dataset.min) && l <= Number(a.dataset.max) && (n += l / 60) } var u = s.a.DomUtil.get(this._addUID("GPmousePosition" + t + "Seconds")), h = u.value; if (h) { h = h.replace(",", "."); var d = c.default.toFloat(h); d && d >= Number(u.dataset.min) && d <= Number(u.dataset.max) && (n += d / 3600) } return "O" !== o && "S" !== o || (n = -n), n }, _locateDMSCoordinates: function () { var t = { lat: this._getCoordinate("Lat"), lng: this._getCoordinate("Lon") }; this.validateExtentCoordinate("Lon", t.lng) && (this.validateExtentCoordinate("Lat", t.lat) && this._map.panTo(t)) }, _locateCoordinates: function () { var t = s.a.DomUtil.get(this._addUID("GPmousePositionLon")).value; if (t = t.replace(",", "."), t = parseFloat(t), !isNaN(t)) { var e = s.a.DomUtil.get(this._addUID("GPmousePositionLat")).value; if (e = e.replace(",", "."), e = parseFloat(e), !isNaN(e)) { var i = null, n = null, o = null, a = null; if ("Geographical" === this._currentProjectionType ? (i = t, n = e) : (o = e, a = t), this.validateExtentCoordinate("Lon", i || o) && this.validateExtentCoordinate("Lat", n || a)) { var r = this._currentProjectionUnits, l = this._unproject({ x: this._convertCoordinate(null !== i ? i : o, r), y: this._convertCoordinate(null !== n ? n : a, r) }); this._map.panTo(l) } } } }, onMousePositionEditModeLocateClick: function () { this.options.editCoordinates && (this._isEditing ? "DMS" === this._currentProjectionUnits ? this._locateDMSCoordinates() : this._locateCoordinates() : this.onMousePositionEditModeClick(!0)) }, onMousePositionProjectionSystemChange: function (t) { m.log("onMousePositionProjectionSystemChange", t); var e = t.target.selectedIndex, i = t.target.options[e].value, n = t.target.options[e].label; m.log(e, i, n), this._setCurrentSystem(i) }, _setCurrentSystem: function (t) { for (var e = null, i = 0; i < this._projectionSystems.length; ++i)if (this._projectionSystems[i].code === Number(t)) { e = this._projectionSystems[i].type; break } e ? (e !== this._currentProjectionType && this._setTypeUnitsPanel(e), this._currentProjectionSystems = this._projectionSystems[Number(t)], this._isDesktop || this.onMapMove()) : m.log("system not found in projection systems container") }, onMousePositionProjectionSystemMouseOver: function (t) { m.log("onMousePositionProjectionSystemMouseOver", t); var e = this._map; if (e) { var i = s.a.DomUtil.get(this._addUID("GPmousePositionProjectionSystem")); i.innerHTML = ""; for (var n = 0; n < this._projectionSystems.length; n++) { var o = this._projectionSystems[n], a = null; o.geoBBox && (e.getBounds()._southWest.lng > o.geoBBox.right || e.getBounds()._southWest.lat > o.geoBBox.top || e.getBounds()._northEast.lng < o.geoBBox.left || e.getBounds()._northEast.lat < o.geoBBox.bottom) ? o === this._currentProjectionSystems && ((a = document.createElement("option")).value = o.code, a.text = o.label || n, a.setAttribute("selected", "selected"), a.setAttribute("disabled", "disabled"), i.appendChild(a)) : ((a = document.createElement("option")).value = o.code, a.text = o.label || n, o === this._currentProjectionSystems && a.setAttribute("selected", "selected"), i.appendChild(a)) } } }, onMousePositionProjectionUnitsChange: function (t) { m.log("onMousePositionProjectionUnitsChange", t); var e = t.target.selectedIndex, i = t.target.options[e].value, n = t.target.options[e].label; m.log(e, i, n); var o = this._currentProjectionUnits, s = this._currentProjectionUnits = i, a = this._currentProjectionType; this._resetLabelElements(a), this._resetUnitElements(s), "DMS" !== o && "DMS" !== s || (this._resetCoordinateElements(this.options.editCoordinates, a, s), this._setEditMode(this._isEditing)), this._isDesktop || this.onMapMove() }, moveTo: function (t, e, i) { this._showContainer.checked || this._pictoContainer.click(); var n = this._map; n && (this.onMouseMove({ latlng: t }), n.flyTo(t, e || 10, i || {})) } }); e.default = f }, function (t, e, i) { "use strict"; i.r(e); var n = { modulo: function (t, e) { var i = t % e; return i * e < 0 ? i + e : i }, decimalToDMS: function (t, e, i) { var n = this.modulo(t + 180, 360) - 180, o = Math.abs(3600 * n), s = i || 0, a = Math.pow(10, s), r = Math.floor(o / 3600), l = Math.floor((o - 3600 * r) / 60), c = o - 3600 * r - 60 * l; return (c = Math.ceil(c * a) / a) >= 60 && (c = 0, l += 1), l >= 60 && (l = 0, r += 1), { d: r, m: l, s: c, direction: e.charAt(n < 0 ? 1 : 0) } }, toInteger: function (t, e) { var i = parseInt(t, e || 10); return !isNaN(i) && isFinite(i) ? i : null }, isInteger: function (t) { if (isNaN(t)) return !1; var e = parseFloat(t); return (0 | e) === e }, toFloat: function (t) { var e = parseFloat(t); return !isNaN(e) && isFinite(e) ? e : null } }; e.default = n }, function (t, e, i) { "use strict"; function n(t) { return n = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, n(t) } i.r(e); var o = { _addUID: function (t) { return this._uid ? t + "-" + this._uid : t }, _createMainContainerElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPmousePosition"), t.className = "GPwidget", t }, _createShowMousePositionElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPshowMousePosition"), t.type = "checkbox", t }, _createShowMousePositionPictoElement: function (t) { var e = this, i = document.createElement("label"); i.id = this._addUID("GPshowMousePositionPicto"), i.className = "GPshowAdvancedToolPicto", i.htmlFor = this._addUID("GPshowMousePosition"), i.title = "Afficher les coordonnées du curseur", i.addEventListener("click", (function (i) { var n = ""; document.getElementById(e._addUID("GPshowMousePosition")).checked || t || (n = "GPmapCenterVisible"), document.getElementById("GPmapCenter").className = n, e.onShowMousePositionClick(i) })); var n = document.createElement("span"); return n.id = this._addUID("GPshowMousePositionOpen"), n.className = "GPshowAdvancedToolOpen", i.appendChild(n), i }, _createMousePositionPanelElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPmousePositionPanel"), t.className = "GPpanel", t }, _createMapCenter: function () { var t = document.createElement("div"); return t.id = "GPmapCenter", t.className = "", t }, _createMousePositionPanelHeaderElement: function () { var t = document.createElement("div"); t.className = "GPpanelHeader"; var e = document.createElement("div"); e.className = "GPpanelTitle", e.innerHTML = "Coordonnées", t.appendChild(e); var i = document.createElement("div"); i.id = "GPmousePositionPanelClose", i.className = "GPpanelClose", i.title = "Fermer le panneau"; var n = this; return i.addEventListener ? i.addEventListener("click", (function () { document.getElementById(n._addUID("GPshowMousePositionPicto")).click() }), !1) : i.attachEvent && i.attachEvent("onclick", (function () { document.getElementById(n._addUID("GPshowMousePositionPicto")).click() })), t.appendChild(i), t }, _createMousePositionPanelBasicElement: function (t, e, i, n) { t = void 0 === t || t, e = void 0 === e || e, i = void 0 !== i && i; var o = document.createElement("div"); return o.id = this._addUID("GPmousePositionBasicPanel"), o.appendChild(this._createMousePositionPanelBasicCoordinateElement(e, i, n)), o.appendChild(this._createMousePositionPanelEditToolsElement(i)), o.appendChild(this._createMousePositionPanelBasicAltitudeElement(t)), o }, _createCoordinateElement: function (t, e) { var i = this; if (-1 === ["Lon", "Lat"].indexOf(t)) return []; var n = [], o = document.createElement("input"); o.id = this._addUID("GPmousePosition" + t), o.title = !0 === e ? "Cliquer pour saisir des coordonnées" : "", o.readOnly = !0, e && (o.addEventListener("click", (function () { i.onMousePositionEditModeClick(!0) })), o.addEventListener("change", (function (e) { this.classList.remove("error"), i.validateExtentCoordinate(t, this.value, e) ? this.classList.remove("error") : this.classList.add("error") }))), n.push(o); var s = document.createElement("span"); return s.className = "GPmousePositionUnits", n.push(s), n }, _createDMSCoordinateElement: function (t, e) { if (-1 === ["Lon", "Lat"].indexOf(t)) return []; var i = this, n = [], o = document.createElement("input"); o.id = this._addUID("GPmousePosition" + t + "Degrees"), o.className = "GPSexagesimal", o.setAttribute("name", "degrees"), o.title = !0 === e ? "Cliquer pour saisir des coordonnées" : "", o.readOnly = !0, o.dataset.min = 0, o.dataset.max = "Lon" === t ? 180 : 90, e && (o.addEventListener("click", (function () { i.onMousePositionEditModeClick(!0) })), o.addEventListener("change", (function () { this.classList.remove("error"), i._checkDMSDegrees(t, this) ? this.classList.remove("error") : this.classList.add("error") }))), n.push(o); var s = document.createElement("span"); s.className = "GPmousePositionSexagesimalLabel", s.innerHTML = "°", n.push(s); var a = document.createElement("input"); a.id = this._addUID("GPmousePosition" + t + "Minutes"), a.className = "GPSexagesimal", a.setAttribute("name", "minutes"), a.title = !0 === e ? "Cliquer pour saisir des coordonnées" : "", a.readOnly = !0, a.dataset.min = 0, a.dataset.max = 59, e && (a.addEventListener("click", (function () { i.onMousePositionEditModeClick(!0) })), a.addEventListener("change", (function () { this.classList.remove("error"), i._checkDMSElement(this) ? this.classList.remove("error") : this.classList.add("error") }))), n.push(a); var r = document.createElement("span"); r.className = "GPmousePositionSexagesimalLabel", r.innerHTML = "'", n.push(r); var l = document.createElement("input"); l.id = this._addUID("GPmousePosition" + t + "Seconds"), l.className = "GPSexagesimalsec", l.setAttribute("name", "seconds"), l.title = !0 === e ? "Cliquer pour saisir des coordonnées" : "", l.readOnly = !0, l.dataset.min = 0, l.dataset.max = 59, e && (l.addEventListener("click", (function () { i.onMousePositionEditModeClick(!0) })), l.addEventListener("change", (function () { this.classList.remove("error"), i._checkDMSElement(this, !0) ? this.classList.remove("error") : this.classList.add("error") }))), n.push(l); var c = document.createElement("span"); c.className = "GPmousePositionSexagesimalLabel", c.innerHTML = "''", n.push(c); var u = document.createElement("select"); u.id = this._addUID("GPmousePosition" + t + "Direction"), u.className = "GPmousePositionDirection", u.setAttribute("name", "direction"), u.disabled = !0; var h = document.createElement("option"); h.value = "Lon" === t ? "E" : "N", h.innerHTML = "Lon" === t ? "E" : "N", u.appendChild(h); var d = document.createElement("option"); return d.value = "Lon" === t ? "O" : "S", d.innerHTML = "Lon" === t ? "O" : "S", u.appendChild(d), n.push(u), n }, _createMousePositionPanelBasicCoordinateElement: function (t, e, i) { var n = document.createElement("div"); n.id = this._addUID("GPmousePositionCoordinate"), n.style.display = t ? "block" : "none"; var o = document.createElement("div"), s = document.createElement("span"); s.className = "GPmousePositionLabel", s.id = this._addUID("GPmousePositionLatLabel"), s.innerHTML = "Latitude : ", o.appendChild(s); var a, r = document.createElement("span"); r.id = this._addUID("GPmousePositionLatCoordinate"), a = "DMS" === i ? this._createDMSCoordinateElement("Lat", e) : this._createCoordinateElement("Lat", e); for (var l = 0; l < a.length; l++)r.appendChild(a[l]); o.appendChild(r), n.appendChild(o); var c = document.createElement("div"), u = document.createElement("span"); u.className = "GPmousePositionLabel", u.id = this._addUID("GPmousePositionLonLabel"), u.innerHTML = "Longitude : ", c.appendChild(u); var h, d = document.createElement("span"); d.id = this._addUID("GPmousePositionLonCoordinate"), h = "DMS" === i ? this._createDMSCoordinateElement("Lon", e) : this._createCoordinateElement("Lon", e); for (var p = 0; p < h.length; p++)d.appendChild(h[p]); return c.appendChild(d), n.appendChild(c), n }, _createMousePositionPanelBasicAltitudeElement: function (t) { var e = document.createElement("div"); e.id = this._addUID("GPmousePositionAltitude"), e.style.display = t ? "block" : "none"; var i = document.createElement("span"); i.className = "GPmousePositionLabel", i.innerHTML = "Altitude : ", e.appendChild(i); var n = document.createElement("span"); n.className = "GPmousePositionCoords", n.id = this._addUID("GPmousePositionAlt"), n.innerHTML = "...", e.appendChild(n); var o = document.createElement("span"); return o.className = "GPmousePositionAltitudeUnits", o.innerHTML = "m", e.appendChild(o), e }, _createMousePositionPanelEditToolsElement: function (t) { var e = this, i = document.createElement("div"); i.className = "GPmousePositionPanelEditTools", i.id = this._addUID("GPmousePositionPanelEditTools"), t || (i.style.display = "none"); var n = document.createElement("span"); n.className = "GPmousePositionEditTool", n.id = this._addUID("GPmousePositionLocate"), n.title = !0 === t ? "Cliquer pour saisir des coordonnées" : "", t && n.addEventListener("click", (function () { e.onMousePositionEditModeLocateClick() })), i.appendChild(n); var o = document.createElement("span"); return o.className = "GPmousePositionEditTool", o.id = this._addUID("GPmousePositionCloseEdit"), o.title = "Quitter la saisie des coordonnées", o.style.display = "none", t && o.addEventListener("click", (function () { e.onMousePositionEditModeClick(!1) })), i.appendChild(o), i }, _createShowMousePositionSettingsElement: function (t) { var e = [], i = this, n = document.createElement("input"); n.type = "checkbox", n.id = this._addUID("GPshowMousePositionSettings"); var o = document.createElement("label"); return o.id = this._addUID("GPshowMousePositionSettingsPicto"), o.htmlFor = this._addUID("GPshowMousePositionSettings"), o.title = "Réglages", o.className = "GPshowMoreOptionsImage GPshowMoreOptions GPshowMousePositionSettingsPicto", o.style.display = t ? "block" : "none", o.addEventListener ? o.addEventListener("click", (function (t) { "function" == typeof i.onShowMousePositionSettingsClick && i.onShowMousePositionSettingsClick(t) }), !1) : o.attachEvent && o.attachEvent("onclick", (function (t) { "function" == typeof i.onShowMousePositionSettingsClick && i.onShowMousePositionSettingsClick(t) })), e.push(n), e.push(o), e }, _createMousePositionSettingsElement: function (t) { var e = document.createElement("div"); e.id = this._addUID("GPmousePositionSettings"), e.style.display = void 0 === t || t ? "block" : "none"; var i = document.createElement("span"); return i.className = "GPmousePositionSettingsLabel", i.innerHTML = "Système de référence", e.appendChild(i), e }, _createMousePositionSettingsSystemsElement: function (t) { var e = this, i = document.createElement("select"); i.id = this._addUID("GPmousePositionProjectionSystem"), i.className = "GPinputSelect GPmousePositionSettingsSelect", i.addEventListener("change", (function (t) { e.onMousePositionProjectionSystemChange(t) })), i.addEventListener("mouseover", (function (t) { "OPTION" !== t.target.nodeName && e.onMousePositionProjectionSystemMouseOver(t) })); for (var n = 0; n < t.length; n++) { var o = t[n], s = document.createElement("option"); s.value = o.code, s.text = o.label || n, i.appendChild(s) } return i }, _createMousePositionSettingsUnitsElement: function (t) { var e = this, i = document.createElement("select"); i.id = this._addUID("GPmousePositionProjectionUnits"), i.className = "GPinputSelect GPmousePositionSettingsSelect", i.addEventListener("change", (function (t) { e.onMousePositionProjectionUnitsChange(t) })); for (var n = 0; n < t.length; n++) { var o = t[n], s = document.createElement("option"); s.value = o.code ? o.code : n, s.text = o.label || n, i.appendChild(s) } return i }, _resetLabelElements: function (t) { document.getElementById(this._addUID("GPmousePositionLatLabel")).innerHTML = "Geographical" === t ? "Latitude :" : "X :", document.getElementById(this._addUID("GPmousePositionLonLabel")).innerHTML = "Geographical" === t ? "Longitude :" : "Y :" }, _resetUnitElements: function (t) { var e = ""; "M" !== t && "KM" !== t || (e = t.toLowerCase()); for (var i = document.getElementsByClassName("GPmousePositionUnits"), n = 0; n < i.length; n++)i[n].innerHTML = e }, _resetCoordinateElements: function (t, e, i) { for (var n, o = document.getElementById(this._addUID("GPmousePositionLatCoordinate")); o.firstChild;)o.removeChild(o.firstChild); n = "DMS" === i ? this._createDMSCoordinateElement("Lat", t) : this._createCoordinateElement("Lat", t); for (var s = 0; s < n.length; s++)o.appendChild(n[s]); for (var a, r = document.getElementById(this._addUID("GPmousePositionLonCoordinate")); r.firstChild;)r.removeChild(r.firstChild); a = "DMS" === i ? this._createDMSCoordinateElement("Lon", t) : this._createCoordinateElement("Lon", t); for (var l = 0; l < a.length; l++)r.appendChild(a[l]) }, _setEditMode: function (t) { document.getElementById(this._addUID("GPmousePositionLocate")).title = t ? "Aller à la position ..." : "Cliquer pour saisir des coordonnées", document.getElementById(this._addUID("GPmousePositionCloseEdit")).style.display = t ? "inline-block" : "none"; for (var e = "div[id^=" + this._addUID("GPmousePositionCoordinate") + "]", i = document.querySelectorAll(e + " input"), n = 0; n < i.length; n++)i[n].readOnly = !t, t && (i[n].value = "", i[n].classList.remove("error")); for (var o = document.querySelectorAll(e + " select"), s = 0; s < o.length; s++)o[s].disabled = !t }, _checkDMSElement: function (t, e) { var i = void 0 !== e, n = t.value; if (i && (n = n.replace(",", ".")), isNaN(n)) return !1; var o = parseFloat(n); if (!i && (0 | o) !== o) return !1; var s = Number(t.dataset.min), a = Number(t.dataset.max); return o >= s && o <= a }, _checkDMSDegrees: function (t, e) { if (isNaN(e.value)) return !1; var i = parseFloat(e.value); if ((0 | i) !== i) return !1; var n = Number(e.dataset.min), o = Number(e.dataset.max); if (i < n || i > o) return !1; var s = document.getElementById(this._addUID("GPmousePosition" + t + "Minutes")), a = document.getElementById(this._addUID("GPmousePosition" + t + "Seconds")); return i >= o ? (s.dataset.max = 0, a.dataset.max = 0) : (s.dataset.max = 59, a.dataset.max = 59.9999), !0 }, GPdisplayCoords: function (t) { if (t) { var e = document.getElementById(this._addUID("GPmousePositionLonLabel")), i = document.getElementById(this._addUID("GPmousePositionLatLabel")); if (t.x || t.y ? (i.innerHTML = "X : ", e.innerHTML = "Y : ") : t.e || t.n ? (i.innerHTML = "E : ", e.innerHTML = "N : ") : (i.innerHTML = "Latitude : ", e.innerHTML = "Longitude : "), "object" === n(t.lat) && "object" === n(t.lng)) { var o = { lng: "Lon", lat: "Lat" }, s = ["Degrees", "Minutes", "Seconds"]; for (var a in o) for (var r = 0; r < s.length; ++r) { var l = "GPmousePosition" + o[a] + s[r], c = document.getElementById(this._addUID(l)), u = s[r].charAt(0).toLowerCase(); c.value = t[a][u] } document.getElementById(this._addUID("GPmousePositionLonDirection")).value = t.lng.direction, document.getElementById(this._addUID("GPmousePositionLatDirection")).value = t.lat.direction } else { var h = document.getElementById(this._addUID("GPmousePositionLat")), d = document.getElementById(this._addUID("GPmousePositionLon")); h.value = t.x || t.lat || t.e || "0", d.value = t.y || t.lng || t.lon || t.n || "0"; for (var p = void 0 === t.unit ? "" : t.unit, m = document.getElementsByClassName("GPmousePositionUnits"), f = 0; f < m.length; ++f)m[f].innerHTML = p } } }, GPdisplayElevation: function (t, e, i, n) { var o, s = this; e || (e = 500), clearTimeout(o), document.getElementById(this._addUID("GPmousePositionAlt")).innerHTML = "...", null == i && (i = -99999), null == n && (n = 99980); var a = i + n, r = i - n; t && document.getElementById(this._addUID("GPmousePositionAltitude")) && (o = setTimeout((function () { s.onRequestAltitude(t, (function (t) { r < t && t < a ? s.GPresetElevation() : document.getElementById(s._addUID("GPmousePositionAlt")).innerHTML = t })) }), e)) }, GPresetElevation: function () { document.getElementById(this._addUID("GPmousePositionAltitude")) && (document.getElementById(this._addUID("GPmousePositionAlt")).innerHTML = "---") } }; e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(142), o = i.n(n), s = (i(144), i(145)), a = i(146), r = i(147), l = i(148); s.default.load(o.a); var c = { EPSG2154: function () { return a.default.build() }, EPSG27572: function () { return r.default.build() }, EPSG4326: function () { return l.default.build() } }; e.default = c }, function (t, e, i) { (function (e) { t.exports = e.proj4 = i(143) }).call(this, i(52)) }, function (t, e, i) { t.exports = function () { "use strict"; var t = function (t) { t("EPSG:4326", "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"), t("EPSG:4269", "+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"), t("EPSG:3857", "+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"), t.WGS84 = t["EPSG:4326"], t["EPSG:3785"] = t["EPSG:3857"], t.GOOGLE = t["EPSG:3857"], t["EPSG:900913"] = t["EPSG:3857"], t["EPSG:102113"] = t["EPSG:3857"] }, e = 1, i = 2, n = 3, o = 4, s = 5, a = 6378137, r = 6356752.314, l = .0066943799901413165, c = 484813681109536e-20, u = Math.PI / 2, h = .16666666666666666, d = .04722222222222222, p = .022156084656084655, m = 1e-10, f = .017453292519943295, g = 57.29577951308232, _ = Math.PI / 4, v = 2 * Math.PI, y = 3.14159265359, E = { greenwich: 0, lisbon: -9.131906111111, paris: 2.337229166667, bogota: -74.080916666667, madrid: -3.687938888889, rome: 12.452333333333, bern: 7.439583333333, jakarta: 106.807719444444, ferro: -17.666666666667, brussels: 4.367975, stockholm: 18.058277777778, athens: 23.7163375, oslo: 10.722916666667 }, w = { ft: { to_meter: .3048 }, "us-ft": { to_meter: 1200 / 3937 } }, b = /[\s_\-\/\(\)]/g; function P(t, e) { if (t[e]) return t[e]; for (var i, n = Object.keys(t), o = e.toLowerCase().replace(b, ""), s = -1; ++s < n.length;)if ((i = n[s]).toLowerCase().replace(b, "") === o) return t[i] } var C = function (t) { var e, i, n, o = {}, s = t.split("+").map((function (t) { return t.trim() })).filter((function (t) { return t })).reduce((function (t, e) { var i = e.split("="); return i.push(!0), t[i[0].toLowerCase()] = i[1], t }), {}), a = { proj: "projName", datum: "datumCode", rf: function (t) { o.rf = parseFloat(t) }, lat_0: function (t) { o.lat0 = t * f }, lat_1: function (t) { o.lat1 = t * f }, lat_2: function (t) { o.lat2 = t * f }, lat_ts: function (t) { o.lat_ts = t * f }, lon_0: function (t) { o.long0 = t * f }, lon_1: function (t) { o.long1 = t * f }, lon_2: function (t) { o.long2 = t * f }, alpha: function (t) { o.alpha = parseFloat(t) * f }, gamma: function (t) { o.rectified_grid_angle = parseFloat(t) }, lonc: function (t) { o.longc = t * f }, x_0: function (t) { o.x0 = parseFloat(t) }, y_0: function (t) { o.y0 = parseFloat(t) }, k_0: function (t) { o.k0 = parseFloat(t) }, k: function (t) { o.k0 = parseFloat(t) }, a: function (t) { o.a = parseFloat(t) }, b: function (t) { o.b = parseFloat(t) }, r_a: function () { o.R_A = !0 }, zone: function (t) { o.zone = parseInt(t, 10) }, south: function () { o.utmSouth = !0 }, towgs84: function (t) { o.datum_params = t.split(",").map((function (t) { return parseFloat(t) })) }, to_meter: function (t) { o.to_meter = parseFloat(t) }, units: function (t) { o.units = t; var e = P(w, t); e && (o.to_meter = e.to_meter) }, from_greenwich: function (t) { o.from_greenwich = t * f }, pm: function (t) { var e = P(E, t); o.from_greenwich = (e || parseFloat(t)) * f }, nadgrids: function (t) { "@null" === t ? o.datumCode = "none" : o.nadgrids = t }, axis: function (t) { var e = "ewnsud"; 3 === t.length && -1 !== e.indexOf(t.substr(0, 1)) && -1 !== e.indexOf(t.substr(1, 1)) && -1 !== e.indexOf(t.substr(2, 1)) && (o.axis = t) }, approx: function () { o.approx = !0 } }; for (e in s) i = s[e], e in a ? "function" == typeof (n = a[e]) ? n(i) : o[n] = i : o[e] = i; return "string" == typeof o.datumCode && "WGS84" !== o.datumCode && (o.datumCode = o.datumCode.toLowerCase()), o }, M = 1, S = 2, L = 3, x = 4, G = 5, I = -1, R = /\s/, A = /[A-Za-z]/, k = /[A-Za-z84]/, T = /[,\]]/, D = /[\d\.E\-\+]/; function O(t) { if ("string" != typeof t) throw new Error("not a string"); this.text = t.trim(), this.level = 0, this.place = 0, this.root = null, this.stack = [], this.currentObject = null, this.state = M } function N(t) { return new O(t).output() } function U(t, e, i) { Array.isArray(e) && (i.unshift(e), e = null); var n = e ? {} : t, o = i.reduce((function (t, e) { return j(e, t), t }), n); e && (t[e] = o) } function j(t, e) { if (Array.isArray(t)) { var i = t.shift(); if ("PARAMETER" === i && (i = t.shift()), 1 === t.length) return Array.isArray(t[0]) ? (e[i] = {}, void j(t[0], e[i])) : void (e[i] = t[0]); if (t.length) if ("TOWGS84" !== i) { if ("AXIS" === i) return i in e || (e[i] = []), void e[i].push(t); var n; switch (Array.isArray(i) || (e[i] = {}), i) { case "UNIT": case "PRIMEM": case "VERT_DATUM": return e[i] = { name: t[0].toLowerCase(), convert: t[1] }, void (3 === t.length && j(t[2], e[i])); case "SPHEROID": case "ELLIPSOID": return e[i] = { name: t[0], a: t[1], rf: t[2] }, void (4 === t.length && j(t[3], e[i])); case "PROJECTEDCRS": case "PROJCRS": case "GEOGCS": case "GEOCCS": case "PROJCS": case "LOCAL_CS": case "GEODCRS": case "GEODETICCRS": case "GEODETICDATUM": case "EDATUM": case "ENGINEERINGDATUM": case "VERT_CS": case "VERTCRS": case "VERTICALCRS": case "COMPD_CS": case "COMPOUNDCRS": case "ENGINEERINGCRS": case "ENGCRS": case "FITTED_CS": case "LOCAL_DATUM": case "DATUM": return t[0] = ["name", t[0]], void U(e, i, t); default: for (n = -1; ++n < t.length;)if (!Array.isArray(t[n])) return j(t, e[i]); return U(e, i, t) } } else e[i] = t; else e[i] = !0 } else e[t] = !0 } O.prototype.readCharicter = function () { var t = this.text[this.place++]; if (this.state !== x) for (; R.test(t);) { if (this.place >= this.text.length) return; t = this.text[this.place++] } switch (this.state) { case M: return this.neutral(t); case S: return this.keyword(t); case x: return this.quoted(t); case G: return this.afterquote(t); case L: return this.number(t); case I: return } }, O.prototype.afterquote = function (t) { if ('"' === t) return this.word += '"', void (this.state = x); if (T.test(t)) return this.word = this.word.trim(), void this.afterItem(t); throw new Error("havn't handled \"" + t + '" in afterquote yet, index ' + this.place) }, O.prototype.afterItem = function (t) { return "," === t ? (null !== this.word && this.currentObject.push(this.word), this.word = null, void (this.state = M)) : "]" === t ? (this.level--, null !== this.word && (this.currentObject.push(this.word), this.word = null), this.state = M, this.currentObject = this.stack.pop(), void (this.currentObject || (this.state = I))) : void 0 }, O.prototype.number = function (t) { if (!D.test(t)) { if (T.test(t)) return this.word = parseFloat(this.word), void this.afterItem(t); throw new Error("havn't handled \"" + t + '" in number yet, index ' + this.place) } this.word += t }, O.prototype.quoted = function (t) { '"' !== t ? this.word += t : this.state = G }, O.prototype.keyword = function (t) { if (k.test(t)) this.word += t; else { if ("[" === t) { var e = []; return e.push(this.word), this.level++, null === this.root ? this.root = e : this.currentObject.push(e), this.stack.push(this.currentObject), this.currentObject = e, void (this.state = M) } if (!T.test(t)) throw new Error("havn't handled \"" + t + '" in keyword yet, index ' + this.place); this.afterItem(t) } }, O.prototype.neutral = function (t) { if (A.test(t)) return this.word = t, void (this.state = S); if ('"' === t) return this.word = "", void (this.state = x); if (D.test(t)) return this.word = t, void (this.state = L); if (!T.test(t)) throw new Error("havn't handled \"" + t + '" in neutral yet, index ' + this.place); this.afterItem(t) }, O.prototype.output = function () { for (; this.place < this.text.length;)this.readCharicter(); if (this.state === I) return this.root; throw new Error('unable to parse string "' + this.text + '". State is ' + this.state) }; var F = .017453292519943295; function B(t, e) { var i = e[0], n = e[1]; !(i in t) && n in t && (t[i] = t[n], 3 === e.length && (t[i] = e[2](t[i]))) } function z(t) { return t * F } function q(t) { if ("GEOGCS" === t.type ? t.projName = "longlat" : "LOCAL_CS" === t.type ? (t.projName = "identity", t.local = !0) : "object" == typeof t.PROJECTION ? t.projName = Object.keys(t.PROJECTION)[0] : t.projName = t.PROJECTION, t.AXIS) { for (var e = "", i = 0, n = t.AXIS.length; i < n; ++i) { var o = [t.AXIS[i][0].toLowerCase(), t.AXIS[i][1].toLowerCase()]; -1 !== o[0].indexOf("north") || ("y" === o[0] || "lat" === o[0]) && "north" === o[1] ? e += "n" : -1 !== o[0].indexOf("south") || ("y" === o[0] || "lat" === o[0]) && "south" === o[1] ? e += "s" : -1 !== o[0].indexOf("east") || ("x" === o[0] || "lon" === o[0]) && "east" === o[1] ? e += "e" : -1 === o[0].indexOf("west") && ("x" !== o[0] && "lon" !== o[0] || "west" !== o[1]) || (e += "w") } 2 === e.length && (e += "u"), 3 === e.length && (t.axis = e) } t.UNIT && (t.units = t.UNIT.name.toLowerCase(), "metre" === t.units && (t.units = "meter"), t.UNIT.convert && ("GEOGCS" === t.type ? t.DATUM && t.DATUM.SPHEROID && (t.to_meter = t.UNIT.convert * t.DATUM.SPHEROID.a) : t.to_meter = t.UNIT.convert)); var s = t.GEOGCS; function a(e) { return e * (t.to_meter || 1) } "GEOGCS" === t.type && (s = t), s && (s.DATUM ? t.datumCode = s.DATUM.name.toLowerCase() : t.datumCode = s.name.toLowerCase(), "d_" === t.datumCode.slice(0, 2) && (t.datumCode = t.datumCode.slice(2)), "new_zealand_geodetic_datum_1949" !== t.datumCode && "new_zealand_1949" !== t.datumCode || (t.datumCode = "nzgd49"), "wgs_1984" !== t.datumCode && "world_geodetic_system_1984" !== t.datumCode || ("Mercator_Auxiliary_Sphere" === t.PROJECTION && (t.sphere = !0), t.datumCode = "wgs84"), "_ferro" === t.datumCode.slice(-6) && (t.datumCode = t.datumCode.slice(0, -6)), "_jakarta" === t.datumCode.slice(-8) && (t.datumCode = t.datumCode.slice(0, -8)), ~t.datumCode.indexOf("belge") && (t.datumCode = "rnb72"), s.DATUM && s.DATUM.SPHEROID && (t.ellps = s.DATUM.SPHEROID.name.replace("_19", "").replace(/[Cc]larke\_18/, "clrk"), "international" === t.ellps.toLowerCase().slice(0, 13) && (t.ellps = "intl"), t.a = s.DATUM.SPHEROID.a, t.rf = parseFloat(s.DATUM.SPHEROID.rf, 10)), s.DATUM && s.DATUM.TOWGS84 && (t.datum_params = s.DATUM.TOWGS84), ~t.datumCode.indexOf("osgb_1936") && (t.datumCode = "osgb36"), ~t.datumCode.indexOf("osni_1952") && (t.datumCode = "osni52"), (~t.datumCode.indexOf("tm65") || ~t.datumCode.indexOf("geodetic_datum_of_1965")) && (t.datumCode = "ire65"), "ch1903+" === t.datumCode && (t.datumCode = "ch1903"), ~t.datumCode.indexOf("israel") && (t.datumCode = "isr93")), t.b && !isFinite(t.b) && (t.b = t.a), [["standard_parallel_1", "Standard_Parallel_1"], ["standard_parallel_1", "Latitude of 1st standard parallel"], ["standard_parallel_2", "Standard_Parallel_2"], ["standard_parallel_2", "Latitude of 2nd standard parallel"], ["false_easting", "False_Easting"], ["false_easting", "False easting"], ["false-easting", "Easting at false origin"], ["false_northing", "False_Northing"], ["false_northing", "False northing"], ["false_northing", "Northing at false origin"], ["central_meridian", "Central_Meridian"], ["central_meridian", "Longitude of natural origin"], ["central_meridian", "Longitude of false origin"], ["latitude_of_origin", "Latitude_Of_Origin"], ["latitude_of_origin", "Central_Parallel"], ["latitude_of_origin", "Latitude of natural origin"], ["latitude_of_origin", "Latitude of false origin"], ["scale_factor", "Scale_Factor"], ["k0", "scale_factor"], ["latitude_of_center", "Latitude_Of_Center"], ["latitude_of_center", "Latitude_of_center"], ["lat0", "latitude_of_center", z], ["longitude_of_center", "Longitude_Of_Center"], ["longitude_of_center", "Longitude_of_center"], ["longc", "longitude_of_center", z], ["x0", "false_easting", a], ["y0", "false_northing", a], ["long0", "central_meridian", z], ["lat0", "latitude_of_origin", z], ["lat0", "standard_parallel_1", z], ["lat1", "standard_parallel_1", z], ["lat2", "standard_parallel_2", z], ["azimuth", "Azimuth"], ["alpha", "azimuth", z], ["srsCode", "name"]].forEach((function (e) { return B(t, e) })), t.long0 || !t.longc || "Albers_Conic_Equal_Area" !== t.projName && "Lambert_Azimuthal_Equal_Area" !== t.projName || (t.long0 = t.longc), t.lat_ts || !t.lat1 || "Stereographic_South_Pole" !== t.projName && "Polar Stereographic (variant B)" !== t.projName || (t.lat0 = z(t.lat1 > 0 ? 90 : -90), t.lat_ts = t.lat1) } var H = function (t) { var e = N(t), i = e.shift(), n = e.shift(); e.unshift(["name", n]), e.unshift(["type", i]); var o = {}; return j(e, o), q(o), o }; function W(t) { var e = this; if (2 === arguments.length) { var i = arguments[1]; "string" == typeof i ? "+" === i.charAt(0) ? W[t] = C(arguments[1]) : W[t] = H(arguments[1]) : W[t] = i } else if (1 === arguments.length) { if (Array.isArray(t)) return t.map((function (t) { Array.isArray(t) ? W.apply(e, t) : W(t) })); if ("string" == typeof t) { if (t in W) return W[t] } else "EPSG" in t ? W["EPSG:" + t.EPSG] = t : "ESRI" in t ? W["ESRI:" + t.ESRI] = t : "IAU2000" in t ? W["IAU2000:" + t.IAU2000] = t : console.log(t); return } } function V(t) { return "string" == typeof t } function Y(t) { return t in W } t(W); var K = ["PROJECTEDCRS", "PROJCRS", "GEOGCS", "GEOCCS", "PROJCS", "LOCAL_CS", "GEODCRS", "GEODETICCRS", "GEODETICDATUM", "ENGCRS", "ENGINEERINGCRS"]; function X(t) { return K.some((function (e) { return t.indexOf(e) > -1 })) } var Z = ["3857", "900913", "3785", "102113"]; function Q(t) { var e = P(t, "authority"); if (e) { var i = P(e, "epsg"); return i && Z.indexOf(i) > -1 } } function J(t) { var e = P(t, "extension"); if (e) return P(e, "proj4") } function $(t) { return "+" === t[0] } function tt(t) { if (!V(t)) return t; if (Y(t)) return W[t]; if (X(t)) { var e = H(t); if (Q(e)) return W["EPSG:3857"]; var i = J(e); return i ? C(i) : e } return $(t) ? C(t) : void 0 } var et = function (t, e) { var i, n; if (t = t || {}, !e) return t; for (n in e) void 0 !== (i = e[n]) && (t[n] = i); return t }, it = function (t, e, i) { var n = t * e; return i / Math.sqrt(1 - n * n) }, nt = function (t) { return t < 0 ? -1 : 1 }, ot = function (t) { return Math.abs(t) <= y ? t : t - nt(t) * v }, st = function (t, e, i) { var n = t * i, o = .5 * t; return n = Math.pow((1 - n) / (1 + n), o), Math.tan(.5 * (u - e)) / n }, at = function (t, e) { for (var i, n, o = .5 * t, s = u - 2 * Math.atan(e), a = 0; a <= 15; a++)if (i = t * Math.sin(s), s += n = u - 2 * Math.atan(e * Math.pow((1 - i) / (1 + i), o)) - s, Math.abs(n) <= 1e-10) return s; return -9999 }; function rt() { var t = this.b / this.a; this.es = 1 - t * t, "x0" in this || (this.x0 = 0), "y0" in this || (this.y0 = 0), this.e = Math.sqrt(this.es), this.lat_ts ? this.sphere ? this.k0 = Math.cos(this.lat_ts) : this.k0 = it(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) : this.k0 || (this.k ? this.k0 = this.k : this.k0 = 1) } function lt(t) { var e, i, n = t.x, o = t.y; if (o * g > 90 && o * g < -90 && n * g > 180 && n * g < -180) return null; if (Math.abs(Math.abs(o) - u) <= m) return null; if (this.sphere) e = this.x0 + this.a * this.k0 * ot(n - this.long0), i = this.y0 + this.a * this.k0 * Math.log(Math.tan(_ + .5 * o)); else { var s = Math.sin(o), a = st(this.e, o, s); e = this.x0 + this.a * this.k0 * ot(n - this.long0), i = this.y0 - this.a * this.k0 * Math.log(a) } return t.x = e, t.y = i, t } function ct(t) { var e, i, n = t.x - this.x0, o = t.y - this.y0; if (this.sphere) i = u - 2 * Math.atan(Math.exp(-o / (this.a * this.k0))); else { var s = Math.exp(-o / (this.a * this.k0)); if (-9999 === (i = at(this.e, s))) return null } return e = ot(this.long0 + n / (this.a * this.k0)), t.x = e, t.y = i, t } function ut() { } function ht(t) { return t } var dt = [{ init: rt, forward: lt, inverse: ct, names: ["Mercator", "Popular Visualisation Pseudo Mercator", "Mercator_1SP", "Mercator_Auxiliary_Sphere", "merc"] }, { init: ut, forward: ht, inverse: ht, names: ["longlat", "identity"] }], pt = {}, mt = []; function ft(t, e) { var i = mt.length; return t.names ? (mt[i] = t, t.names.forEach((function (t) { pt[t.toLowerCase()] = i })), this) : (console.log(e), !0) } function gt(t) { if (!t) return !1; var e = t.toLowerCase(); return void 0 !== pt[e] && mt[pt[e]] ? mt[pt[e]] : void 0 } function _t() { dt.forEach(ft) } var vt = { start: _t, add: ft, get: gt }, yt = { MERIT: { a: 6378137, rf: 298.257, ellipseName: "MERIT 1983" }, SGS85: { a: 6378136, rf: 298.257, ellipseName: "Soviet Geodetic System 85" }, GRS80: { a: 6378137, rf: 298.257222101, ellipseName: "GRS 1980(IUGG, 1980)" }, IAU76: { a: 6378140, rf: 298.257, ellipseName: "IAU 1976" }, airy: { a: 6377563.396, b: 6356256.91, ellipseName: "Airy 1830" }, APL4: { a: 6378137, rf: 298.25, ellipseName: "Appl. Physics. 1965" }, NWL9D: { a: 6378145, rf: 298.25, ellipseName: "Naval Weapons Lab., 1965" }, mod_airy: { a: 6377340.189, b: 6356034.446, ellipseName: "Modified Airy" }, andrae: { a: 6377104.43, rf: 300, ellipseName: "Andrae 1876 (Den., Iclnd.)" }, aust_SA: { a: 6378160, rf: 298.25, ellipseName: "Australian Natl & S. Amer. 1969" }, GRS67: { a: 6378160, rf: 298.247167427, ellipseName: "GRS 67(IUGG 1967)" }, bessel: { a: 6377397.155, rf: 299.1528128, ellipseName: "Bessel 1841" }, bess_nam: { a: 6377483.865, rf: 299.1528128, ellipseName: "Bessel 1841 (Namibia)" }, clrk66: { a: 6378206.4, b: 6356583.8, ellipseName: "Clarke 1866" }, clrk80: { a: 6378249.145, rf: 293.4663, ellipseName: "Clarke 1880 mod." }, clrk58: { a: 6378293.645208759, rf: 294.2606763692654, ellipseName: "Clarke 1858" }, CPM: { a: 6375738.7, rf: 334.29, ellipseName: "Comm. des Poids et Mesures 1799" }, delmbr: { a: 6376428, rf: 311.5, ellipseName: "Delambre 1810 (Belgium)" }, engelis: { a: 6378136.05, rf: 298.2566, ellipseName: "Engelis 1985" }, evrst30: { a: 6377276.345, rf: 300.8017, ellipseName: "Everest 1830" }, evrst48: { a: 6377304.063, rf: 300.8017, ellipseName: "Everest 1948" }, evrst56: { a: 6377301.243, rf: 300.8017, ellipseName: "Everest 1956" }, evrst69: { a: 6377295.664, rf: 300.8017, ellipseName: "Everest 1969" }, evrstSS: { a: 6377298.556, rf: 300.8017, ellipseName: "Everest (Sabah & Sarawak)" }, fschr60: { a: 6378166, rf: 298.3, ellipseName: "Fischer (Mercury Datum) 1960" }, fschr60m: { a: 6378155, rf: 298.3, ellipseName: "Fischer 1960" }, fschr68: { a: 6378150, rf: 298.3, ellipseName: "Fischer 1968" }, helmert: { a: 6378200, rf: 298.3, ellipseName: "Helmert 1906" }, hough: { a: 6378270, rf: 297, ellipseName: "Hough" }, intl: { a: 6378388, rf: 297, ellipseName: "International 1909 (Hayford)" }, kaula: { a: 6378163, rf: 298.24, ellipseName: "Kaula 1961" }, lerch: { a: 6378139, rf: 298.257, ellipseName: "Lerch 1979" }, mprts: { a: 6397300, rf: 191, ellipseName: "Maupertius 1738" }, new_intl: { a: 6378157.5, b: 6356772.2, ellipseName: "New International 1967" }, plessis: { a: 6376523, rf: 6355863, ellipseName: "Plessis 1817 (France)" }, krass: { a: 6378245, rf: 298.3, ellipseName: "Krassovsky, 1942" }, SEasia: { a: 6378155, b: 6356773.3205, ellipseName: "Southeast Asia" }, walbeck: { a: 6376896, b: 6355834.8467, ellipseName: "Walbeck" }, WGS60: { a: 6378165, rf: 298.3, ellipseName: "WGS 60" }, WGS66: { a: 6378145, rf: 298.25, ellipseName: "WGS 66" }, WGS7: { a: 6378135, rf: 298.26, ellipseName: "WGS 72" } }, Et = yt.WGS84 = { a: 6378137, rf: 298.257223563, ellipseName: "WGS 84" }; function wt(t, e, i, n) { var o = t * t, s = e * e, a = (o - s) / o, r = 0; return n ? (o = (t *= 1 - a * (h + a * (d + a * p))) * t, a = 0) : r = Math.sqrt(a), { es: a, e: r, ep2: (o - s) / s } } function bt(t, e, i, n, o) { if (!t) { var s = P(yt, n); s || (s = Et), t = s.a, e = s.b, i = s.rf } return i && !e && (e = (1 - 1 / i) * t), (0 === i || Math.abs(t - e) < m) && (o = !0, e = t), { a: t, b: e, rf: i, sphere: o } } yt.sphere = { a: 6370997, b: 6370997, ellipseName: "Normal Sphere (r=6370997)" }; var Pt = {}; function Ct(t, a, r, l, u, h, d) { var p = {}; return p.datum_type = void 0 === t || "none" === t ? s : o, a && (p.datum_params = a.map(parseFloat), 0 === p.datum_params[0] && 0 === p.datum_params[1] && 0 === p.datum_params[2] || (p.datum_type = e), p.datum_params.length > 3 && (0 === p.datum_params[3] && 0 === p.datum_params[4] && 0 === p.datum_params[5] && 0 === p.datum_params[6] || (p.datum_type = i, p.datum_params[3] *= c, p.datum_params[4] *= c, p.datum_params[5] *= c, p.datum_params[6] = p.datum_params[6] / 1e6 + 1))), d && (p.datum_type = n, p.grids = d), p.a = r, p.b = l, p.es = u, p.ep2 = h, p } Pt.wgs84 = { towgs84: "0,0,0", ellipse: "WGS84", datumName: "WGS84" }, Pt.ch1903 = { towgs84: "674.374,15.056,405.346", ellipse: "bessel", datumName: "swiss" }, Pt.ggrs87 = { towgs84: "-199.87,74.79,246.62", ellipse: "GRS80", datumName: "Greek_Geodetic_Reference_System_1987" }, Pt.nad83 = { towgs84: "0,0,0", ellipse: "GRS80", datumName: "North_American_Datum_1983" }, Pt.nad27 = { nadgrids: "@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat", ellipse: "clrk66", datumName: "North_American_Datum_1927" }, Pt.potsdam = { towgs84: "598.1,73.7,418.2,0.202,0.045,-2.455,6.7", ellipse: "bessel", datumName: "Potsdam Rauenberg 1950 DHDN" }, Pt.carthage = { towgs84: "-263.0,6.0,431.0", ellipse: "clark80", datumName: "Carthage 1934 Tunisia" }, Pt.hermannskogel = { towgs84: "577.326,90.129,463.919,5.137,1.474,5.297,2.4232", ellipse: "bessel", datumName: "Hermannskogel" }, Pt.osni52 = { towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15", ellipse: "airy", datumName: "Irish National" }, Pt.ire65 = { towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15", ellipse: "mod_airy", datumName: "Ireland 1965" }, Pt.rassadiran = { towgs84: "-133.63,-157.5,-158.62", ellipse: "intl", datumName: "Rassadiran" }, Pt.nzgd49 = { towgs84: "59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993", ellipse: "intl", datumName: "New Zealand Geodetic Datum 1949" }, Pt.osgb36 = { towgs84: "446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894", ellipse: "airy", datumName: "Airy 1830" }, Pt.s_jtsk = { towgs84: "589,76,480", ellipse: "bessel", datumName: "S-JTSK (Ferro)" }, Pt.beduaram = { towgs84: "-106,-87,188", ellipse: "clrk80", datumName: "Beduaram" }, Pt.gunung_segara = { towgs84: "-403,684,41", ellipse: "bessel", datumName: "Gunung Segara Jakarta" }, Pt.rnb72 = { towgs84: "106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1", ellipse: "intl", datumName: "Reseau National Belge 1972" }; var Mt = {}; function St(t, e) { var i = new DataView(e), n = It(i), o = Rt(i, n); o.nSubgrids > 1 && console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored"); var s = { header: o, subgrids: kt(i, o, n) }; return Mt[t] = s, s } function Lt(t) { return void 0 === t ? null : t.split(",").map(xt) } function xt(t) { if (0 === t.length) return null; var e = "@" === t[0]; return e && (t = t.slice(1)), "null" === t ? { name: "null", mandatory: !e, grid: null, isNull: !0 } : { name: t, mandatory: !e, grid: Mt[t] || null, isNull: !1 } } function Gt(t) { return t / 3600 * Math.PI / 180 } function It(t) { var e = t.getInt32(8, !1); return 11 !== e && (11 !== (e = t.getInt32(8, !0)) && console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"), !0) } function Rt(t, e) { return { nFields: t.getInt32(8, e), nSubgridFields: t.getInt32(24, e), nSubgrids: t.getInt32(40, e), shiftType: At(t, 56, 64).trim(), fromSemiMajorAxis: t.getFloat64(120, e), fromSemiMinorAxis: t.getFloat64(136, e), toSemiMajorAxis: t.getFloat64(152, e), toSemiMinorAxis: t.getFloat64(168, e) } } function At(t, e, i) { return String.fromCharCode.apply(null, new Uint8Array(t.buffer.slice(e, i))) } function kt(t, e, i) { for (var n = 176, o = [], s = 0; s < e.nSubgrids; s++) { var a = Dt(t, n, i), r = Ot(t, n, a, i), l = Math.round(1 + (a.upperLongitude - a.lowerLongitude) / a.longitudeInterval), c = Math.round(1 + (a.upperLatitude - a.lowerLatitude) / a.latitudeInterval); o.push({ ll: [Gt(a.lowerLongitude), Gt(a.lowerLatitude)], del: [Gt(a.longitudeInterval), Gt(a.latitudeInterval)], lim: [l, c], count: a.gridNodeCount, cvs: Tt(r) }) } return o } function Tt(t) { return t.map((function (t) { return [Gt(t.longitudeShift), Gt(t.latitudeShift)] })) } function Dt(t, e, i) { return { name: At(t, e + 8, e + 16).trim(), parent: At(t, e + 24, e + 24 + 8).trim(), lowerLatitude: t.getFloat64(e + 72, i), upperLatitude: t.getFloat64(e + 88, i), lowerLongitude: t.getFloat64(e + 104, i), upperLongitude: t.getFloat64(e + 120, i), latitudeInterval: t.getFloat64(e + 136, i), longitudeInterval: t.getFloat64(e + 152, i), gridNodeCount: t.getInt32(e + 168, i) } } function Ot(t, e, i, n) { for (var o = e + 176, s = 16, a = [], r = 0; r < i.gridNodeCount; r++) { var l = { latitudeShift: t.getFloat32(o + r * s, n), longitudeShift: t.getFloat32(o + r * s + 4, n), latitudeAccuracy: t.getFloat32(o + r * s + 8, n), longitudeAccuracy: t.getFloat32(o + r * s + 12, n) }; a.push(l) } return a } function Nt(t, e) { if (!(this instanceof Nt)) return new Nt(t); e = e || function (t) { if (t) throw t }; var i = tt(t); if ("object" == typeof i) { var n = Nt.projections.get(i.projName); if (n) { if (i.datumCode && "none" !== i.datumCode) { var o = P(Pt, i.datumCode); o && (i.datum_params = i.datum_params || (o.towgs84 ? o.towgs84.split(",") : null), i.ellps = o.ellipse, i.datumName = o.datumName ? o.datumName : i.datumCode) } i.k0 = i.k0 || 1, i.axis = i.axis || "enu", i.ellps = i.ellps || "wgs84", i.lat1 = i.lat1 || i.lat0; var s = bt(i.a, i.b, i.rf, i.ellps, i.sphere), a = wt(s.a, s.b, s.rf, i.R_A), r = Lt(i.nadgrids), l = i.datum || Ct(i.datumCode, i.datum_params, s.a, s.b, a.es, a.ep2, r); et(this, i), et(this, n), this.a = s.a, this.b = s.b, this.rf = s.rf, this.sphere = s.sphere, this.es = a.es, this.e = a.e, this.ep2 = a.ep2, this.datum = l, this.init(), e(null, this) } else e(t) } else e(t) } function Ut(t, n) { return t.datum_type === n.datum_type && !(t.a !== n.a || Math.abs(t.es - n.es) > 5e-11) && (t.datum_type === e ? t.datum_params[0] === n.datum_params[0] && t.datum_params[1] === n.datum_params[1] && t.datum_params[2] === n.datum_params[2] : t.datum_type !== i || t.datum_params[0] === n.datum_params[0] && t.datum_params[1] === n.datum_params[1] && t.datum_params[2] === n.datum_params[2] && t.datum_params[3] === n.datum_params[3] && t.datum_params[4] === n.datum_params[4] && t.datum_params[5] === n.datum_params[5] && t.datum_params[6] === n.datum_params[6]) } function jt(t, e, i) { var n, o, s, a, r = t.x, l = t.y, c = t.z ? t.z : 0; if (l < -u && l > -1.001 * u) l = -u; else if (l > u && l < 1.001 * u) l = u; else { if (l < -u) return { x: -1 / 0, y: -1 / 0, z: t.z }; if (l > u) return { x: 1 / 0, y: 1 / 0, z: t.z } } return r > Math.PI && (r -= 2 * Math.PI), o = Math.sin(l), a = Math.cos(l), s = o * o, { x: ((n = i / Math.sqrt(1 - e * s)) + c) * a * Math.cos(r), y: (n + c) * a * Math.sin(r), z: (n * (1 - e) + c) * o } } function Ft(t, e, i, n) { var o, s, a, r, l, c, u, h, d, p, m, f, g, _, v, y = 1e-12, E = y * y, w = 30, b = t.x, P = t.y, C = t.z ? t.z : 0; if (o = Math.sqrt(b * b + P * P), s = Math.sqrt(b * b + P * P + C * C), o / i < y) { if (_ = 0, s / i < y) return v = -n, { x: t.x, y: t.y, z: t.z } } else _ = Math.atan2(P, b); a = C / s, h = (r = o / s) * (1 - e) * (l = 1 / Math.sqrt(1 - e * (2 - e) * r * r)), d = a * l, g = 0; do { g++, c = e * (u = i / Math.sqrt(1 - e * d * d)) / (u + (v = o * h + C * d - u * (1 - e * d * d))), f = (m = a * (l = 1 / Math.sqrt(1 - c * (2 - c) * r * r))) * h - (p = r * (1 - c) * l) * d, h = p, d = m } while (f * f > E && g < w); return { x: _, y: Math.atan(m / Math.abs(p)), z: v } } function Bt(t, n, o) { if (n === e) return { x: t.x + o[0], y: t.y + o[1], z: t.z + o[2] }; if (n === i) { var s = o[0], a = o[1], r = o[2], l = o[3], c = o[4], u = o[5], h = o[6]; return { x: h * (t.x - u * t.y + c * t.z) + s, y: h * (u * t.x + t.y - l * t.z) + a, z: h * (-c * t.x + l * t.y + t.z) + r } } } function zt(t, n, o) { if (n === e) return { x: t.x - o[0], y: t.y - o[1], z: t.z - o[2] }; if (n === i) { var s = o[0], a = o[1], r = o[2], l = o[3], c = o[4], u = o[5], h = o[6], d = (t.x - s) / h, p = (t.y - a) / h, m = (t.z - r) / h; return { x: d + u * p - c * m, y: -u * d + p + l * m, z: c * d - l * p + m } } } function qt(t) { return t === e || t === i } Nt.projections = vt, Nt.projections.start(); var Ht = function (t, e, i) { if (Ut(t, e)) return i; if (t.datum_type === s || e.datum_type === s) return i; var o = t.a, c = t.es; if (t.datum_type === n) { if (0 !== Wt(t, !1, i)) return; o = a, c = l } var u = e.a, h = e.b, d = e.es; return e.datum_type === n && (u = a, h = r, d = l), c !== d || o !== u || qt(t.datum_type) || qt(e.datum_type) ? (i = jt(i, c, o), qt(t.datum_type) && (i = Bt(i, t.datum_type, t.datum_params)), qt(e.datum_type) && (i = zt(i, e.datum_type, e.datum_params)), i = Ft(i, d, u, h), e.datum_type !== n || 0 === Wt(e, !0, i) ? i : void 0) : i }; function Wt(t, e, i) { if (null === t.grids || 0 === t.grids.length) return console.log("Grid shift grids not found"), -1; for (var n = { x: -i.x, y: i.y }, o = { x: Number.NaN, y: Number.NaN }, s = [], a = 0; a < t.grids.length; a++) { var r = t.grids[a]; if (s.push(r.name), r.isNull) { o = n; break } if (null !== r.grid) { var l = r.grid.subgrids[0], c = (Math.abs(l.del[1]) + Math.abs(l.del[0])) / 1e4, u = l.ll[0] - c, h = l.ll[1] - c, d = l.ll[0] + (l.lim[0] - 1) * l.del[0] + c, p = l.ll[1] + (l.lim[1] - 1) * l.del[1] + c; if (!(h > n.y || u > n.x || p < n.y || d < n.x || (o = Vt(n, e, l), isNaN(o.x)))) break } else if (r.mandatory) return console.log("Unable to find mandatory grid '" + r.name + "'"), -1 } return isNaN(o.x) ? (console.log("Failed to find a grid shift table for location '" + -n.x * g + " " + n.y * g + " tried: '" + s + "'"), -1) : (i.x = -o.x, i.y = o.y, 0) } function Vt(t, e, i) { var n = { x: Number.NaN, y: Number.NaN }; if (isNaN(t.x)) return n; var o = { x: t.x, y: t.y }; o.x -= i.ll[0], o.y -= i.ll[1], o.x = ot(o.x - Math.PI) + Math.PI; var s = Yt(o, i); if (e) { if (isNaN(s.x)) return n; s.x = o.x - s.x, s.y = o.y - s.y; var a, r, l = 9, c = 1e-12; do { if (r = Yt(s, i), isNaN(r.x)) { console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation."); break } a = { x: o.x - (r.x + s.x), y: o.y - (r.y + s.y) }, s.x += a.x, s.y += a.y } while (l-- && Math.abs(a.x) > c && Math.abs(a.y) > c); if (l < 0) return console.log("Inverse grid shift iterator failed to converge."), n; n.x = ot(s.x + i.ll[0]), n.y = s.y + i.ll[1] } else isNaN(s.x) || (n.x = t.x + s.x, n.y = t.y + s.y); return n } function Yt(t, e) { var i, n = { x: t.x / e.del[0], y: t.y / e.del[1] }, o = { x: Math.floor(n.x), y: Math.floor(n.y) }, s = { x: n.x - 1 * o.x, y: n.y - 1 * o.y }, a = { x: Number.NaN, y: Number.NaN }; if (o.x < 0 || o.x >= e.lim[0]) return a; if (o.y < 0 || o.y >= e.lim[1]) return a; i = o.y * e.lim[0] + o.x; var r = { x: e.cvs[i][0], y: e.cvs[i][1] }; i++; var l = { x: e.cvs[i][0], y: e.cvs[i][1] }; i += e.lim[0]; var c = { x: e.cvs[i][0], y: e.cvs[i][1] }; i--; var u = { x: e.cvs[i][0], y: e.cvs[i][1] }, h = s.x * s.y, d = s.x * (1 - s.y), p = (1 - s.x) * (1 - s.y), m = (1 - s.x) * s.y; return a.x = p * r.x + d * l.x + m * u.x + h * c.x, a.y = p * r.y + d * l.y + m * u.y + h * c.y, a } var Kt = function (t, e, i) { var n, o, s, a = i.x, r = i.y, l = i.z || 0, c = {}; for (s = 0; s < 3; s++)if (!e || 2 !== s || void 0 !== i.z) switch (0 === s ? (n = a, o = -1 !== "ew".indexOf(t.axis[s]) ? "x" : "y") : 1 === s ? (n = r, o = -1 !== "ns".indexOf(t.axis[s]) ? "y" : "x") : (n = l, o = "z"), t.axis[s]) { case "e": case "n": c[o] = n; break; case "w": case "s": c[o] = -n; break; case "u": void 0 !== i[o] && (c.z = n); break; case "d": void 0 !== i[o] && (c.z = -n); break; default: return null }return c }, Xt = function (t) { var e = { x: t[0], y: t[1] }; return t.length > 2 && (e.z = t[2]), t.length > 3 && (e.m = t[3]), e }, Zt = function (t) { Qt(t.x), Qt(t.y) }; function Qt(t) { if ("function" == typeof Number.isFinite) { if (Number.isFinite(t)) return; throw new TypeError("coordinates must be finite numbers") } if ("number" != typeof t || t != t || !isFinite(t)) throw new TypeError("coordinates must be finite numbers") } function Jt(t, n) { return (t.datum.datum_type === e || t.datum.datum_type === i) && "WGS84" !== n.datumCode || (n.datum.datum_type === e || n.datum.datum_type === i) && "WGS84" !== t.datumCode } function $t(t, e, i, n) { var o; if (Array.isArray(i) && (i = Xt(i)), Zt(i), t.datum && e.datum && Jt(t, e) && (i = $t(t, o = new Nt("WGS84"), i, n), t = o), n && "enu" !== t.axis && (i = Kt(t, !1, i)), "longlat" === t.projName) i = { x: i.x * f, y: i.y * f, z: i.z || 0 }; else if (t.to_meter && (i = { x: i.x * t.to_meter, y: i.y * t.to_meter, z: i.z || 0 }), !(i = t.inverse(i))) return; if (t.from_greenwich && (i.x += t.from_greenwich), i = Ht(t.datum, e.datum, i)) return e.from_greenwich && (i = { x: i.x - e.from_greenwich, y: i.y, z: i.z || 0 }), "longlat" === e.projName ? i = { x: i.x * g, y: i.y * g, z: i.z || 0 } : (i = e.forward(i), e.to_meter && (i = { x: i.x / e.to_meter, y: i.y / e.to_meter, z: i.z || 0 })), n && "enu" !== e.axis ? Kt(e, !0, i) : i } var te = Nt("WGS84"); function ee(t, e, i, n) { var o, s, a; return Array.isArray(i) ? (o = $t(t, e, i, n) || { x: NaN, y: NaN }, i.length > 2 ? void 0 !== t.name && "geocent" === t.name || void 0 !== e.name && "geocent" === e.name ? "number" == typeof o.z ? [o.x, o.y, o.z].concat(i.splice(3)) : [o.x, o.y, i[2]].concat(i.splice(3)) : [o.x, o.y].concat(i.splice(2)) : [o.x, o.y]) : (s = $t(t, e, i, n), 2 === (a = Object.keys(i)).length || a.forEach((function (n) { if (void 0 !== t.name && "geocent" === t.name || void 0 !== e.name && "geocent" === e.name) { if ("x" === n || "y" === n || "z" === n) return } else if ("x" === n || "y" === n) return; s[n] = i[n] })), s) } function ie(t) { return t instanceof Nt ? t : t.oProj ? t.oProj : Nt(t) } function ne(t, e, i) { t = ie(t); var n, o = !1; return void 0 === e ? (e = t, t = te, o = !0) : (void 0 !== e.x || Array.isArray(e)) && (i = e, e = t, t = te, o = !0), e = ie(e), i ? ee(t, e, i) : (n = { forward: function (i, n) { return ee(t, e, i, n) }, inverse: function (i, n) { return ee(e, t, i, n) } }, o && (n.oProj = e), n) } var oe = 6, se = "AJSAJS", ae = "AFAFAF", re = 65, le = 73, ce = 79, ue = 86, he = 90, de = { forward: pe, inverse: me, toPoint: fe }; function pe(t, e) { return e = e || 5, we(ve({ lat: t[1], lon: t[0] }), e) } function me(t) { var e = ye(Me(t.toUpperCase())); return e.lat && e.lon ? [e.lon, e.lat, e.lon, e.lat] : [e.left, e.bottom, e.right, e.top] } function fe(t) { var e = ye(Me(t.toUpperCase())); return e.lat && e.lon ? [e.lon, e.lat] : [(e.left + e.right) / 2, (e.top + e.bottom) / 2] } function ge(t) { return t * (Math.PI / 180) } function _e(t) { return t / Math.PI * 180 } function ve(t) { var e, i, n, o, s, a, r, l = t.lat, c = t.lon, u = 6378137, h = .00669438, d = .9996, p = ge(l), m = ge(c); r = Math.floor((c + 180) / 6) + 1, 180 === c && (r = 60), l >= 56 && l < 64 && c >= 3 && c < 12 && (r = 32), l >= 72 && l < 84 && (c >= 0 && c < 9 ? r = 31 : c >= 9 && c < 21 ? r = 33 : c >= 21 && c < 33 ? r = 35 : c >= 33 && c < 42 && (r = 37)), a = ge(6 * (r - 1) - 180 + 3), e = h / (1 - h), i = u / Math.sqrt(1 - h * Math.sin(p) * Math.sin(p)), n = Math.tan(p) * Math.tan(p), o = e * Math.cos(p) * Math.cos(p); var f = d * i * ((s = Math.cos(p) * (m - a)) + (1 - n + o) * s * s * s / 6 + (5 - 18 * n + n * n + 72 * o - 58 * e) * s * s * s * s * s / 120) + 5e5, g = d * (u * ((1 - h / 4 - 3 * h * h / 64 - 5 * h * h * h / 256) * p - (3 * h / 8 + 3 * h * h / 32 + 45 * h * h * h / 1024) * Math.sin(2 * p) + (15 * h * h / 256 + 45 * h * h * h / 1024) * Math.sin(4 * p) - 35 * h * h * h / 3072 * Math.sin(6 * p)) + i * Math.tan(p) * (s * s / 2 + (5 - n + 9 * o + 4 * o * o) * s * s * s * s / 24 + (61 - 58 * n + n * n + 600 * o - 330 * e) * s * s * s * s * s * s / 720)); return l < 0 && (g += 1e7), { northing: Math.round(g), easting: Math.round(f), zoneNumber: r, zoneLetter: Ee(l) } } function ye(t) { var e = t.northing, i = t.easting, n = t.zoneLetter, o = t.zoneNumber; if (o < 0 || o > 60) return null; var s, a, r, l, c, u, h, d, p, m = .9996, f = 6378137, g = .00669438, _ = (1 - Math.sqrt(1 - g)) / (1 + Math.sqrt(1 - g)), v = i - 5e5, y = e; n < "N" && (y -= 1e7), h = 6 * (o - 1) - 180 + 3, s = g / (1 - g), p = (d = y / m / (f * (1 - g / 4 - 3 * g * g / 64 - 5 * g * g * g / 256))) + (3 * _ / 2 - 27 * _ * _ * _ / 32) * Math.sin(2 * d) + (21 * _ * _ / 16 - 55 * _ * _ * _ * _ / 32) * Math.sin(4 * d) + 151 * _ * _ * _ / 96 * Math.sin(6 * d), a = f / Math.sqrt(1 - g * Math.sin(p) * Math.sin(p)), r = Math.tan(p) * Math.tan(p), l = s * Math.cos(p) * Math.cos(p), c = f * (1 - g) / Math.pow(1 - g * Math.sin(p) * Math.sin(p), 1.5), u = v / (a * m); var E = p - a * Math.tan(p) / c * (u * u / 2 - (5 + 3 * r + 10 * l - 4 * l * l - 9 * s) * u * u * u * u / 24 + (61 + 90 * r + 298 * l + 45 * r * r - 252 * s - 3 * l * l) * u * u * u * u * u * u / 720); E = _e(E); var w, b = (u - (1 + 2 * r + l) * u * u * u / 6 + (5 - 2 * l + 28 * r - 3 * l * l + 8 * s + 24 * r * r) * u * u * u * u * u / 120) / Math.cos(p); if (b = h + _e(b), t.accuracy) { var P = ye({ northing: t.northing + t.accuracy, easting: t.easting + t.accuracy, zoneLetter: t.zoneLetter, zoneNumber: t.zoneNumber }); w = { top: P.lat, right: P.lon, bottom: E, left: b } } else w = { lat: E, lon: b }; return w } function Ee(t) { var e = "Z"; return 84 >= t && t >= 72 ? e = "X" : 72 > t && t >= 64 ? e = "W" : 64 > t && t >= 56 ? e = "V" : 56 > t && t >= 48 ? e = "U" : 48 > t && t >= 40 ? e = "T" : 40 > t && t >= 32 ? e = "S" : 32 > t && t >= 24 ? e = "R" : 24 > t && t >= 16 ? e = "Q" : 16 > t && t >= 8 ? e = "P" : 8 > t && t >= 0 ? e = "N" : 0 > t && t >= -8 ? e = "M" : -8 > t && t >= -16 ? e = "L" : -16 > t && t >= -24 ? e = "K" : -24 > t && t >= -32 ? e = "J" : -32 > t && t >= -40 ? e = "H" : -40 > t && t >= -48 ? e = "G" : -48 > t && t >= -56 ? e = "F" : -56 > t && t >= -64 ? e = "E" : -64 > t && t >= -72 ? e = "D" : -72 > t && t >= -80 && (e = "C"), e } function we(t, e) { var i = "00000" + t.easting, n = "00000" + t.northing; return t.zoneNumber + t.zoneLetter + be(t.easting, t.northing, t.zoneNumber) + i.substr(i.length - 5, e) + n.substr(n.length - 5, e) } function be(t, e, i) { var n = Pe(i); return Ce(Math.floor(t / 1e5), Math.floor(e / 1e5) % 20, n) } function Pe(t) { var e = t % oe; return 0 === e && (e = oe), e } function Ce(t, e, i) { var n = i - 1, o = se.charCodeAt(n), s = ae.charCodeAt(n), a = o + t - 1, r = s + e, l = !1; return a > he && (a = a - he + re - 1, l = !0), (a === le || o < le && a > le || (a > le || o < le) && l) && a++, (a === ce || o < ce && a > ce || (a > ce || o < ce) && l) && ++a === le && a++, a > he && (a = a - he + re - 1), r > ue ? (r = r - ue + re - 1, l = !0) : l = !1, (r === le || s < le && r > le || (r > le || s < le) && l) && r++, (r === ce || s < ce && r > ce || (r > ce || s < ce) && l) && ++r === le && r++, r > ue && (r = r - ue + re - 1), String.fromCharCode(a) + String.fromCharCode(r) } function Me(t) { if (t && 0 === t.length) throw "MGRSPoint coverting from nothing"; for (var e, i = t.length, n = null, o = "", s = 0; !/[A-Z]/.test(e = t.charAt(s));) { if (s >= 2) throw "MGRSPoint bad conversion from: " + t; o += e, s++ } var a = parseInt(o, 10); if (0 === s || s + 3 > i) throw "MGRSPoint bad conversion from: " + t; var r = t.charAt(s++); if (r <= "A" || "B" === r || "Y" === r || r >= "Z" || "I" === r || "O" === r) throw "MGRSPoint zone letter " + r + " not handled: " + t; n = t.substring(s, s += 2); for (var l = Pe(a), c = Se(n.charAt(0), l), u = Le(n.charAt(1), l); u < xe(r);)u += 2e6; var h = i - s; if (h % 2 != 0) throw "MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters" + t; var d, p, m, f = h / 2, g = 0, _ = 0; return f > 0 && (d = 1e5 / Math.pow(10, f), p = t.substring(s, s + f), g = parseFloat(p) * d, m = t.substring(s + f), _ = parseFloat(m) * d), { easting: g + c, northing: _ + u, zoneLetter: r, zoneNumber: a, accuracy: d } } function Se(t, e) { for (var i = se.charCodeAt(e - 1), n = 1e5, o = !1; i !== t.charCodeAt(0);) { if (++i === le && i++, i === ce && i++, i > he) { if (o) throw "Bad character: " + t; i = re, o = !0 } n += 1e5 } return n } function Le(t, e) { if (t > "V") throw "MGRSPoint given invalid Northing " + t; for (var i = ae.charCodeAt(e - 1), n = 0, o = !1; i !== t.charCodeAt(0);) { if (++i === le && i++, i === ce && i++, i > ue) { if (o) throw "Bad character: " + t; i = re, o = !0 } n += 1e5 } return n } function xe(t) { var e; switch (t) { case "C": e = 11e5; break; case "D": e = 2e6; break; case "E": e = 28e5; break; case "F": e = 37e5; break; case "G": e = 46e5; break; case "H": e = 55e5; break; case "J": e = 64e5; break; case "K": e = 73e5; break; case "L": e = 82e5; break; case "M": e = 91e5; break; case "N": e = 0; break; case "P": e = 8e5; break; case "Q": e = 17e5; break; case "R": e = 26e5; break; case "S": e = 35e5; break; case "T": e = 44e5; break; case "U": e = 53e5; break; case "V": e = 62e5; break; case "W": e = 7e6; break; case "X": e = 79e5; break; default: e = -1 }if (e >= 0) return e; throw "Invalid zone letter: " + t } function Ge(t, e, i) { if (!(this instanceof Ge)) return new Ge(t, e, i); if (Array.isArray(t)) this.x = t[0], this.y = t[1], this.z = t[2] || 0; else if ("object" == typeof t) this.x = t.x, this.y = t.y, this.z = t.z || 0; else if ("string" == typeof t && void 0 === e) { var n = t.split(","); this.x = parseFloat(n[0], 10), this.y = parseFloat(n[1], 10), this.z = parseFloat(n[2], 10) || 0 } else this.x = t, this.y = e, this.z = i || 0; console.warn("proj4.Point will be removed in version 3, use proj4.toPoint") } Ge.fromMGRS = function (t) { return new Ge(fe(t)) }, Ge.prototype.toMGRS = function (t) { return pe([this.x, this.y], t) }; var Ie = 1, Re = .25, Ae = .046875, ke = .01953125, Te = .01068115234375, De = .75, Oe = .46875, Ne = .013020833333333334, Ue = .007120768229166667, je = .3645833333333333, Fe = .005696614583333333, Be = .3076171875, ze = function (t) { var e = []; e[0] = Ie - t * (Re + t * (Ae + t * (ke + t * Te))), e[1] = t * (De - t * (Ae + t * (ke + t * Te))); var i = t * t; return e[2] = i * (Oe - t * (Ne + t * Ue)), i *= t, e[3] = i * (je - t * Fe), e[4] = i * t * Be, e }, qe = function (t, e, i, n) { return i *= e, e *= e, n[0] * t - i * (n[1] + e * (n[2] + e * (n[3] + e * n[4]))) }, He = 20, We = function (t, e, i) { for (var n = 1 / (1 - e), o = t, s = He; s; --s) { var a = Math.sin(o), r = 1 - e * a * a; if (o -= r = (qe(o, a, Math.cos(o), i) - t) * (r * Math.sqrt(r)) * n, Math.abs(r) < m) return o } return o }; function Ve() { this.x0 = void 0 !== this.x0 ? this.x0 : 0, this.y0 = void 0 !== this.y0 ? this.y0 : 0, this.long0 = void 0 !== this.long0 ? this.long0 : 0, this.lat0 = void 0 !== this.lat0 ? this.lat0 : 0, this.es && (this.en = ze(this.es), this.ml0 = qe(this.lat0, Math.sin(this.lat0), Math.cos(this.lat0), this.en)) } function Ye(t) { var e, i, n, o = t.x, s = t.y, a = ot(o - this.long0), r = Math.sin(s), l = Math.cos(s); if (this.es) { var c = l * a, u = Math.pow(c, 2), h = this.ep2 * Math.pow(l, 2), d = Math.pow(h, 2), p = Math.abs(l) > m ? Math.tan(s) : 0, f = Math.pow(p, 2), g = Math.pow(f, 2); e = 1 - this.es * Math.pow(r, 2), c /= Math.sqrt(e); var _ = qe(s, r, l, this.en); i = this.a * (this.k0 * c * (1 + u / 6 * (1 - f + h + u / 20 * (5 - 18 * f + g + 14 * h - 58 * f * h + u / 42 * (61 + 179 * g - g * f - 479 * f))))) + this.x0, n = this.a * (this.k0 * (_ - this.ml0 + r * a * c / 2 * (1 + u / 12 * (5 - f + 9 * h + 4 * d + u / 30 * (61 + g - 58 * f + 270 * h - 330 * f * h + u / 56 * (1385 + 543 * g - g * f - 3111 * f)))))) + this.y0 } else { var v = l * Math.sin(a); if (Math.abs(Math.abs(v) - 1) < m) return 93; if (i = .5 * this.a * this.k0 * Math.log((1 + v) / (1 - v)) + this.x0, n = l * Math.cos(a) / Math.sqrt(1 - Math.pow(v, 2)), (v = Math.abs(n)) >= 1) { if (v - 1 > m) return 93; n = 0 } else n = Math.acos(n); s < 0 && (n = -n), n = this.a * this.k0 * (n - this.lat0) + this.y0 } return t.x = i, t.y = n, t } function Ke(t) { var e, i, n, o, s = (t.x - this.x0) * (1 / this.a), a = (t.y - this.y0) * (1 / this.a); if (this.es) if (e = this.ml0 + a / this.k0, i = We(e, this.es, this.en), Math.abs(i) < u) { var r = Math.sin(i), l = Math.cos(i), c = Math.abs(l) > m ? Math.tan(i) : 0, h = this.ep2 * Math.pow(l, 2), d = Math.pow(h, 2), p = Math.pow(c, 2), f = Math.pow(p, 2); e = 1 - this.es * Math.pow(r, 2); var g = s * Math.sqrt(e) / this.k0, _ = Math.pow(g, 2); n = i - (e *= c) * _ / (1 - this.es) * .5 * (1 - _ / 12 * (5 + 3 * p - 9 * h * p + h - 4 * d - _ / 30 * (61 + 90 * p - 252 * h * p + 45 * f + 46 * h - _ / 56 * (1385 + 3633 * p + 4095 * f + 1574 * f * p)))), o = ot(this.long0 + g * (1 - _ / 6 * (1 + 2 * p + h - _ / 20 * (5 + 28 * p + 24 * f + 8 * h * p + 6 * h - _ / 42 * (61 + 662 * p + 1320 * f + 720 * f * p)))) / l) } else n = u * nt(a), o = 0; else { var v = Math.exp(s / this.k0), y = .5 * (v - 1 / v), E = this.lat0 + a / this.k0, w = Math.cos(E); e = Math.sqrt((1 - Math.pow(w, 2)) / (1 + Math.pow(y, 2))), n = Math.asin(e), a < 0 && (n = -n), o = 0 === y && 0 === w ? 0 : ot(Math.atan2(y, w) + this.long0) } return t.x = o, t.y = n, t } var Xe = { init: Ve, forward: Ye, inverse: Ke, names: ["Fast_Transverse_Mercator", "Fast Transverse Mercator"] }, Ze = function (t) { var e = Math.exp(t); return e = (e - 1 / e) / 2 }, Qe = function (t, e) { t = Math.abs(t), e = Math.abs(e); var i = Math.max(t, e), n = Math.min(t, e) / (i || 1); return i * Math.sqrt(1 + Math.pow(n, 2)) }, Je = function (t) { var e = 1 + t, i = e - 1; return 0 === i ? t : t * Math.log(e) / i }, $e = function (t) { var e = Math.abs(t); return e = Je(e * (1 + e / (Qe(1, e) + 1))), t < 0 ? -e : e }, ti = function (t, e) { for (var i, n = 2 * Math.cos(2 * e), o = t.length - 1, s = t[o], a = 0; --o >= 0;)i = n * s - a + t[o], a = s, s = i; return e + i * Math.sin(2 * e) }, ei = function (t, e) { for (var i, n = 2 * Math.cos(e), o = t.length - 1, s = t[o], a = 0; --o >= 0;)i = n * s - a + t[o], a = s, s = i; return Math.sin(e) * i }, ii = function (t) { var e = Math.exp(t); return e = (e + 1 / e) / 2 }, ni = function (t, e, i) { for (var n, o, s = Math.sin(e), a = Math.cos(e), r = Ze(i), l = ii(i), c = 2 * a * l, u = -2 * s * r, h = t.length - 1, d = t[h], p = 0, m = 0, f = 0; --h >= 0;)n = m, o = p, d = c * (m = d) - n - u * (p = f) + t[h], f = u * m - o + c * p; return [(c = s * l) * d - (u = a * r) * f, c * f + u * d] }; function oi() { if (!this.approx && (isNaN(this.es) || this.es <= 0)) throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.'); this.approx && (Xe.init.apply(this), this.forward = Xe.forward, this.inverse = Xe.inverse), this.x0 = void 0 !== this.x0 ? this.x0 : 0, this.y0 = void 0 !== this.y0 ? this.y0 : 0, this.long0 = void 0 !== this.long0 ? this.long0 : 0, this.lat0 = void 0 !== this.lat0 ? this.lat0 : 0, this.cgb = [], this.cbg = [], this.utg = [], this.gtu = []; var t = this.es / (1 + Math.sqrt(1 - this.es)), e = t / (2 - t), i = e; this.cgb[0] = e * (2 + e * (-2 / 3 + e * (e * (116 / 45 + e * (26 / 45 + e * (-2854 / 675))) - 2))), this.cbg[0] = e * (e * (2 / 3 + e * (4 / 3 + e * (-82 / 45 + e * (32 / 45 + e * (4642 / 4725))))) - 2), i *= e, this.cgb[1] = i * (7 / 3 + e * (e * (-227 / 45 + e * (2704 / 315 + e * (2323 / 945))) - 1.6)), this.cbg[1] = i * (5 / 3 + e * (-16 / 15 + e * (-13 / 9 + e * (904 / 315 + e * (-1522 / 945))))), i *= e, this.cgb[2] = i * (56 / 15 + e * (-136 / 35 + e * (-1262 / 105 + e * (73814 / 2835)))), this.cbg[2] = i * (-26 / 15 + e * (34 / 21 + e * (1.6 + e * (-12686 / 2835)))), i *= e, this.cgb[3] = i * (4279 / 630 + e * (-332 / 35 + e * (-399572 / 14175))), this.cbg[3] = i * (1237 / 630 + e * (e * (-24832 / 14175) - 2.4)), i *= e, this.cgb[4] = i * (4174 / 315 + e * (-144838 / 6237)), this.cbg[4] = i * (-734 / 315 + e * (109598 / 31185)), i *= e, this.cgb[5] = i * (601676 / 22275), this.cbg[5] = i * (444337 / 155925), i = Math.pow(e, 2), this.Qn = this.k0 / (1 + e) * (1 + i * (1 / 4 + i * (1 / 64 + i / 256))), this.utg[0] = e * (e * (2 / 3 + e * (-37 / 96 + e * (1 / 360 + e * (81 / 512 + e * (-96199 / 604800))))) - .5), this.gtu[0] = e * (.5 + e * (-2 / 3 + e * (5 / 16 + e * (41 / 180 + e * (-127 / 288 + e * (7891 / 37800)))))), this.utg[1] = i * (-1 / 48 + e * (-1 / 15 + e * (437 / 1440 + e * (-46 / 105 + e * (1118711 / 3870720))))), this.gtu[1] = i * (13 / 48 + e * (e * (557 / 1440 + e * (281 / 630 + e * (-1983433 / 1935360))) - .6)), i *= e, this.utg[2] = i * (-17 / 480 + e * (37 / 840 + e * (209 / 4480 + e * (-5569 / 90720)))), this.gtu[2] = i * (61 / 240 + e * (-103 / 140 + e * (15061 / 26880 + e * (167603 / 181440)))), i *= e, this.utg[3] = i * (-4397 / 161280 + e * (11 / 504 + e * (830251 / 7257600))), this.gtu[3] = i * (49561 / 161280 + e * (-179 / 168 + e * (6601661 / 7257600))), i *= e, this.utg[4] = i * (-4583 / 161280 + e * (108847 / 3991680)), this.gtu[4] = i * (34729 / 80640 + e * (-3418889 / 1995840)), i *= e, this.utg[5] = i * (-20648693 / 638668800), this.gtu[5] = .6650675310896665 * i; var n = ti(this.cbg, this.lat0); this.Zb = -this.Qn * (n + ei(this.gtu, 2 * n)) } function si(t) { var e = ot(t.x - this.long0), i = t.y; i = ti(this.cbg, i); var n = Math.sin(i), o = Math.cos(i), s = Math.sin(e), a = Math.cos(e); i = Math.atan2(n, a * o), e = Math.atan2(s * o, Qe(n, o * a)), e = $e(Math.tan(e)); var r, l, c = ni(this.gtu, 2 * i, 2 * e); return i += c[0], e += c[1], Math.abs(e) <= 2.623395162778 ? (r = this.a * (this.Qn * e) + this.x0, l = this.a * (this.Qn * i + this.Zb) + this.y0) : (r = 1 / 0, l = 1 / 0), t.x = r, t.y = l, t } function ai(t) { var e, i, n = (t.x - this.x0) * (1 / this.a), o = (t.y - this.y0) * (1 / this.a); if (o = (o - this.Zb) / this.Qn, n /= this.Qn, Math.abs(n) <= 2.623395162778) { var s = ni(this.utg, 2 * o, 2 * n); o += s[0], n += s[1], n = Math.atan(Ze(n)); var a = Math.sin(o), r = Math.cos(o), l = Math.sin(n), c = Math.cos(n); o = Math.atan2(a * c, Qe(l, c * r)), n = Math.atan2(l, c * r), e = ot(n + this.long0), i = ti(this.cgb, o) } else e = 1 / 0, i = 1 / 0; return t.x = e, t.y = i, t } var ri = { init: oi, forward: si, inverse: ai, names: ["Extended_Transverse_Mercator", "Extended Transverse Mercator", "etmerc", "Transverse_Mercator", "Transverse Mercator", "tmerc"] }, li = function (t, e) { if (void 0 === t) { if ((t = Math.floor(30 * (ot(e) + Math.PI) / Math.PI) + 1) < 0) return 0; if (t > 60) return 60 } return t }; function ci() { var t = li(this.zone, this.long0); if (void 0 === t) throw new Error("unknown utm zone"); this.lat0 = 0, this.long0 = (6 * Math.abs(t) - 183) * f, this.x0 = 5e5, this.y0 = this.utmSouth ? 1e7 : 0, this.k0 = .9996, ri.init.apply(this), this.forward = ri.forward, this.inverse = ri.inverse } var ui = { init: ci, names: ["Universal Transverse Mercator System", "utm"], dependsOn: "etmerc" }, hi = function (t, e) { return Math.pow((1 - t) / (1 + t), e) }, di = 20; function pi() { var t = Math.sin(this.lat0), e = Math.cos(this.lat0); e *= e, this.rc = Math.sqrt(1 - this.es) / (1 - this.es * t * t), this.C = Math.sqrt(1 + this.es * e * e / (1 - this.es)), this.phic0 = Math.asin(t / this.C), this.ratexp = .5 * this.C * this.e, this.K = Math.tan(.5 * this.phic0 + _) / (Math.pow(Math.tan(.5 * this.lat0 + _), this.C) * hi(this.e * t, this.ratexp)) } function mi(t) { var e = t.x, i = t.y; return t.y = 2 * Math.atan(this.K * Math.pow(Math.tan(.5 * i + _), this.C) * hi(this.e * Math.sin(i), this.ratexp)) - u, t.x = this.C * e, t } function fi(t) { for (var e = 1e-14, i = t.x / this.C, n = t.y, o = Math.pow(Math.tan(.5 * n + _) / this.K, 1 / this.C), s = di; s > 0 && (n = 2 * Math.atan(o * hi(this.e * Math.sin(t.y), -.5 * this.e)) - u, !(Math.abs(n - t.y) < e)); --s)t.y = n; return s ? (t.x = i, t.y = n, t) : null } var gi = { init: pi, forward: mi, inverse: fi, names: ["gauss"] }; function _i() { gi.init.apply(this), this.rc && (this.sinc0 = Math.sin(this.phic0), this.cosc0 = Math.cos(this.phic0), this.R2 = 2 * this.rc, this.title || (this.title = "Oblique Stereographic Alternative")) } function vi(t) { var e, i, n, o; return t.x = ot(t.x - this.long0), gi.forward.apply(this, [t]), e = Math.sin(t.y), i = Math.cos(t.y), n = Math.cos(t.x), o = this.k0 * this.R2 / (1 + this.sinc0 * e + this.cosc0 * i * n), t.x = o * i * Math.sin(t.x), t.y = o * (this.cosc0 * e - this.sinc0 * i * n), t.x = this.a * t.x + this.x0, t.y = this.a * t.y + this.y0, t } function yi(t) { var e, i, n, o, s; if (t.x = (t.x - this.x0) / this.a, t.y = (t.y - this.y0) / this.a, t.x /= this.k0, t.y /= this.k0, s = Math.sqrt(t.x * t.x + t.y * t.y)) { var a = 2 * Math.atan2(s, this.R2); e = Math.sin(a), i = Math.cos(a), o = Math.asin(i * this.sinc0 + t.y * e * this.cosc0 / s), n = Math.atan2(t.x * e, s * this.cosc0 * i - t.y * this.sinc0 * e) } else o = this.phic0, n = 0; return t.x = n, t.y = o, gi.inverse.apply(this, [t]), t.x = ot(t.x + this.long0), t } var Ei = { init: _i, forward: vi, inverse: yi, names: ["Stereographic_North_Pole", "Oblique_Stereographic", "Polar_Stereographic", "sterea", "Oblique Stereographic Alternative", "Double_Stereographic"] }; function wi(t, e, i) { return e *= i, Math.tan(.5 * (u + t)) * Math.pow((1 - e) / (1 + e), .5 * i) } function bi() { this.coslat0 = Math.cos(this.lat0), this.sinlat0 = Math.sin(this.lat0), this.sphere ? 1 === this.k0 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= m && (this.k0 = .5 * (1 + nt(this.lat0) * Math.sin(this.lat_ts))) : (Math.abs(this.coslat0) <= m && (this.lat0 > 0 ? this.con = 1 : this.con = -1), this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e)), 1 === this.k0 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= m && (this.k0 = .5 * this.cons * it(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / st(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts))), this.ms1 = it(this.e, this.sinlat0, this.coslat0), this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - u, this.cosX0 = Math.cos(this.X0), this.sinX0 = Math.sin(this.X0)) } function Pi(t) { var e, i, n, o, s, a, r = t.x, l = t.y, c = Math.sin(l), h = Math.cos(l), d = ot(r - this.long0); return Math.abs(Math.abs(r - this.long0) - Math.PI) <= m && Math.abs(l + this.lat0) <= m ? (t.x = NaN, t.y = NaN, t) : this.sphere ? (e = 2 * this.k0 / (1 + this.sinlat0 * c + this.coslat0 * h * Math.cos(d)), t.x = this.a * e * h * Math.sin(d) + this.x0, t.y = this.a * e * (this.coslat0 * c - this.sinlat0 * h * Math.cos(d)) + this.y0, t) : (i = 2 * Math.atan(this.ssfn_(l, c, this.e)) - u, o = Math.cos(i), n = Math.sin(i), Math.abs(this.coslat0) <= m ? (s = st(this.e, l * this.con, this.con * c), a = 2 * this.a * this.k0 * s / this.cons, t.x = this.x0 + a * Math.sin(r - this.long0), t.y = this.y0 - this.con * a * Math.cos(r - this.long0), t) : (Math.abs(this.sinlat0) < m ? (e = 2 * this.a * this.k0 / (1 + o * Math.cos(d)), t.y = e * n) : (e = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * n + this.cosX0 * o * Math.cos(d))), t.y = e * (this.cosX0 * n - this.sinX0 * o * Math.cos(d)) + this.y0), t.x = e * o * Math.sin(d) + this.x0, t)) } function Ci(t) { var e, i, n, o, s; t.x -= this.x0, t.y -= this.y0; var a = Math.sqrt(t.x * t.x + t.y * t.y); if (this.sphere) { var r = 2 * Math.atan(a / (2 * this.a * this.k0)); return e = this.long0, i = this.lat0, a <= m ? (t.x = e, t.y = i, t) : (i = Math.asin(Math.cos(r) * this.sinlat0 + t.y * Math.sin(r) * this.coslat0 / a), e = Math.abs(this.coslat0) < m ? this.lat0 > 0 ? ot(this.long0 + Math.atan2(t.x, -1 * t.y)) : ot(this.long0 + Math.atan2(t.x, t.y)) : ot(this.long0 + Math.atan2(t.x * Math.sin(r), a * this.coslat0 * Math.cos(r) - t.y * this.sinlat0 * Math.sin(r))), t.x = e, t.y = i, t) } if (Math.abs(this.coslat0) <= m) { if (a <= m) return i = this.lat0, e = this.long0, t.x = e, t.y = i, t; t.x *= this.con, t.y *= this.con, n = a * this.cons / (2 * this.a * this.k0), i = this.con * at(this.e, n), e = this.con * ot(this.con * this.long0 + Math.atan2(t.x, -1 * t.y)) } else o = 2 * Math.atan(a * this.cosX0 / (2 * this.a * this.k0 * this.ms1)), e = this.long0, a <= m ? s = this.X0 : (s = Math.asin(Math.cos(o) * this.sinX0 + t.y * Math.sin(o) * this.cosX0 / a), e = ot(this.long0 + Math.atan2(t.x * Math.sin(o), a * this.cosX0 * Math.cos(o) - t.y * this.sinX0 * Math.sin(o)))), i = -1 * at(this.e, Math.tan(.5 * (u + s))); return t.x = e, t.y = i, t } var Mi = { init: bi, forward: Pi, inverse: Ci, names: ["stere", "Stereographic_South_Pole", "Polar Stereographic (variant B)"], ssfn_: wi }; function Si() { var t = this.lat0; this.lambda0 = this.long0; var e = Math.sin(t), i = this.a, n = 1 / this.rf, o = 2 * n - Math.pow(n, 2), s = this.e = Math.sqrt(o); this.R = this.k0 * i * Math.sqrt(1 - o) / (1 - o * Math.pow(e, 2)), this.alpha = Math.sqrt(1 + o / (1 - o) * Math.pow(Math.cos(t), 4)), this.b0 = Math.asin(e / this.alpha); var a = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2)), r = Math.log(Math.tan(Math.PI / 4 + t / 2)), l = Math.log((1 + s * e) / (1 - s * e)); this.K = a - this.alpha * r + this.alpha * s / 2 * l } function Li(t) { var e = Math.log(Math.tan(Math.PI / 4 - t.y / 2)), i = this.e / 2 * Math.log((1 + this.e * Math.sin(t.y)) / (1 - this.e * Math.sin(t.y))), n = -this.alpha * (e + i) + this.K, o = 2 * (Math.atan(Math.exp(n)) - Math.PI / 4), s = this.alpha * (t.x - this.lambda0), a = Math.atan(Math.sin(s) / (Math.sin(this.b0) * Math.tan(o) + Math.cos(this.b0) * Math.cos(s))), r = Math.asin(Math.cos(this.b0) * Math.sin(o) - Math.sin(this.b0) * Math.cos(o) * Math.cos(s)); return t.y = this.R / 2 * Math.log((1 + Math.sin(r)) / (1 - Math.sin(r))) + this.y0, t.x = this.R * a + this.x0, t } function xi(t) { for (var e = t.x - this.x0, i = t.y - this.y0, n = e / this.R, o = 2 * (Math.atan(Math.exp(i / this.R)) - Math.PI / 4), s = Math.asin(Math.cos(this.b0) * Math.sin(o) + Math.sin(this.b0) * Math.cos(o) * Math.cos(n)), a = Math.atan(Math.sin(n) / (Math.cos(this.b0) * Math.cos(n) - Math.sin(this.b0) * Math.tan(o))), r = this.lambda0 + a / this.alpha, l = 0, c = s, u = -1e3, h = 0; Math.abs(c - u) > 1e-7;) { if (++h > 20) return; l = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + s / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(c)) / 2)), u = c, c = 2 * Math.atan(Math.exp(l)) - Math.PI / 2 } return t.x = r, t.y = c, t } var Gi = { init: Si, forward: Li, inverse: xi, names: ["somerc"] }, Ii = 1e-7; function Ri(t) { var e = ["Hotine_Oblique_Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin"], i = "object" == typeof t.PROJECTION ? Object.keys(t.PROJECTION)[0] : t.PROJECTION; return "no_uoff" in t || "no_off" in t || -1 !== e.indexOf(i) } function Ai() { var t, e, i, n, o, s, a, r, l, c, h, d = 0, p = 0, g = 0, y = 0, E = 0, w = 0, b = 0; this.no_off = Ri(this), this.no_rot = "no_rot" in this; var P = !1; "alpha" in this && (P = !0); var C = !1; if ("rectified_grid_angle" in this && (C = !0), P && (b = this.alpha), C && (d = this.rectified_grid_angle * f), P || C) p = this.longc; else if (g = this.long1, E = this.lat1, y = this.long2, w = this.lat2, Math.abs(E - w) <= Ii || (t = Math.abs(E)) <= Ii || Math.abs(t - u) <= Ii || Math.abs(Math.abs(this.lat0) - u) <= Ii || Math.abs(Math.abs(w) - u) <= Ii) throw new Error; var M = 1 - this.es; e = Math.sqrt(M), Math.abs(this.lat0) > m ? (r = Math.sin(this.lat0), i = Math.cos(this.lat0), t = 1 - this.es * r * r, this.B = i * i, this.B = Math.sqrt(1 + this.es * this.B * this.B / M), this.A = this.B * this.k0 * e / t, (o = (n = this.B * e / (i * Math.sqrt(t))) * n - 1) <= 0 ? o = 0 : (o = Math.sqrt(o), this.lat0 < 0 && (o = -o)), this.E = o += n, this.E *= Math.pow(st(this.e, this.lat0, r), this.B)) : (this.B = 1 / e, this.A = this.k0, this.E = n = o = 1), P || C ? (P ? (h = Math.asin(Math.sin(b) / n), C || (d = b)) : (h = d, b = Math.asin(n * Math.sin(h))), this.lam0 = p - Math.asin(.5 * (o - 1 / o) * Math.tan(h)) / this.B) : (s = Math.pow(st(this.e, E, Math.sin(E)), this.B), a = Math.pow(st(this.e, w, Math.sin(w)), this.B), o = this.E / s, l = (a - s) / (a + s), c = ((c = this.E * this.E) - a * s) / (c + a * s), (t = g - y) < -Math.pi ? y -= v : t > Math.pi && (y += v), this.lam0 = ot(.5 * (g + y) - Math.atan(c * Math.tan(.5 * this.B * (g - y)) / l) / this.B), h = Math.atan(2 * Math.sin(this.B * ot(g - this.lam0)) / (o - 1 / o)), d = b = Math.asin(n * Math.sin(h))), this.singam = Math.sin(h), this.cosgam = Math.cos(h), this.sinrot = Math.sin(d), this.cosrot = Math.cos(d), this.rB = 1 / this.B, this.ArB = this.A * this.rB, this.BrA = 1 / this.ArB, this.no_off ? this.u_0 = 0 : (this.u_0 = Math.abs(this.ArB * Math.atan(Math.sqrt(n * n - 1) / Math.cos(b))), this.lat0 < 0 && (this.u_0 = -this.u_0)), o = .5 * h, this.v_pole_n = this.ArB * Math.log(Math.tan(_ - o)), this.v_pole_s = this.ArB * Math.log(Math.tan(_ + o)) } function ki(t) { var e, i, n, o, s, a, r, l, c = {}; if (t.x = t.x - this.lam0, Math.abs(Math.abs(t.y) - u) > m) { if (e = .5 * ((s = this.E / Math.pow(st(this.e, t.y, Math.sin(t.y)), this.B)) - (a = 1 / s)), i = .5 * (s + a), o = Math.sin(this.B * t.x), n = (e * this.singam - o * this.cosgam) / i, Math.abs(Math.abs(n) - 1) < m) throw new Error; l = .5 * this.ArB * Math.log((1 - n) / (1 + n)), a = Math.cos(this.B * t.x), r = Math.abs(a) < Ii ? this.A * t.x : this.ArB * Math.atan2(e * this.cosgam + o * this.singam, a) } else l = t.y > 0 ? this.v_pole_n : this.v_pole_s, r = this.ArB * t.y; return this.no_rot ? (c.x = r, c.y = l) : (r -= this.u_0, c.x = l * this.cosrot + r * this.sinrot, c.y = r * this.cosrot - l * this.sinrot), c.x = this.a * c.x + this.x0, c.y = this.a * c.y + this.y0, c } function Ti(t) { var e, i, n, o, s, a, r, l = {}; if (t.x = (t.x - this.x0) * (1 / this.a), t.y = (t.y - this.y0) * (1 / this.a), this.no_rot ? (i = t.y, e = t.x) : (i = t.x * this.cosrot - t.y * this.sinrot, e = t.y * this.cosrot + t.x * this.sinrot + this.u_0), o = .5 * ((n = Math.exp(-this.BrA * i)) - 1 / n), s = .5 * (n + 1 / n), r = ((a = Math.sin(this.BrA * e)) * this.cosgam + o * this.singam) / s, Math.abs(Math.abs(r) - 1) < m) l.x = 0, l.y = r < 0 ? -u : u; else { if (l.y = this.E / Math.sqrt((1 + r) / (1 - r)), l.y = at(this.e, Math.pow(l.y, 1 / this.B)), l.y === 1 / 0) throw new Error; l.x = -this.rB * Math.atan2(o * this.cosgam - a * this.singam, Math.cos(this.BrA * e)) } return l.x += this.lam0, l } var Di = { init: Ai, forward: ki, inverse: Ti, names: ["Hotine_Oblique_Mercator", "Hotine Oblique Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin", "Hotine_Oblique_Mercator_Two_Point_Natural_Origin", "Hotine_Oblique_Mercator_Azimuth_Center", "Oblique_Mercator", "omerc"] }; function Oi() { if (this.lat2 || (this.lat2 = this.lat1), this.k0 || (this.k0 = 1), this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, !(Math.abs(this.lat1 + this.lat2) < m)) { var t = this.b / this.a; this.e = Math.sqrt(1 - t * t); var e = Math.sin(this.lat1), i = Math.cos(this.lat1), n = it(this.e, e, i), o = st(this.e, this.lat1, e), s = Math.sin(this.lat2), a = Math.cos(this.lat2), r = it(this.e, s, a), l = st(this.e, this.lat2, s), c = st(this.e, this.lat0, Math.sin(this.lat0)); Math.abs(this.lat1 - this.lat2) > m ? this.ns = Math.log(n / r) / Math.log(o / l) : this.ns = e, isNaN(this.ns) && (this.ns = e), this.f0 = n / (this.ns * Math.pow(o, this.ns)), this.rh = this.a * this.f0 * Math.pow(c, this.ns), this.title || (this.title = "Lambert Conformal Conic") } } function Ni(t) { var e = t.x, i = t.y; Math.abs(2 * Math.abs(i) - Math.PI) <= m && (i = nt(i) * (u - 2 * m)); var n, o, s = Math.abs(Math.abs(i) - u); if (s > m) n = st(this.e, i, Math.sin(i)), o = this.a * this.f0 * Math.pow(n, this.ns); else { if ((s = i * this.ns) <= 0) return null; o = 0 } var a = this.ns * ot(e - this.long0); return t.x = this.k0 * (o * Math.sin(a)) + this.x0, t.y = this.k0 * (this.rh - o * Math.cos(a)) + this.y0, t } function Ui(t) { var e, i, n, o, s, a = (t.x - this.x0) / this.k0, r = this.rh - (t.y - this.y0) / this.k0; this.ns > 0 ? (e = Math.sqrt(a * a + r * r), i = 1) : (e = -Math.sqrt(a * a + r * r), i = -1); var l = 0; if (0 !== e && (l = Math.atan2(i * a, i * r)), 0 !== e || this.ns > 0) { if (i = 1 / this.ns, n = Math.pow(e / (this.a * this.f0), i), -9999 === (o = at(this.e, n))) return null } else o = -u; return s = ot(l / this.ns + this.long0), t.x = s, t.y = o, t } var ji = { init: Oi, forward: Ni, inverse: Ui, names: ["Lambert Tangential Conformal Conic Projection", "Lambert_Conformal_Conic", "Lambert_Conformal_Conic_1SP", "Lambert_Conformal_Conic_2SP", "lcc"] }; function Fi() { this.a = 6377397.155, this.es = .006674372230614, this.e = Math.sqrt(this.es), this.lat0 || (this.lat0 = .863937979737193), this.long0 || (this.long0 = .4334234309119251), this.k0 || (this.k0 = .9999), this.s45 = .785398163397448, this.s90 = 2 * this.s45, this.fi0 = this.lat0, this.e2 = this.es, this.e = Math.sqrt(this.e2), this.alfa = Math.sqrt(1 + this.e2 * Math.pow(Math.cos(this.fi0), 4) / (1 - this.e2)), this.uq = 1.04216856380474, this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa), this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2), this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g, this.k1 = this.k0, this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2)), this.s0 = 1.37008346281555, this.n = Math.sin(this.s0), this.ro0 = this.k1 * this.n0 / Math.tan(this.s0), this.ad = this.s90 - this.uq } function Bi(t) { var e, i, n, o, s, a, r, l = t.x, c = t.y, u = ot(l - this.long0); return e = Math.pow((1 + this.e * Math.sin(c)) / (1 - this.e * Math.sin(c)), this.alfa * this.e / 2), i = 2 * (Math.atan(this.k * Math.pow(Math.tan(c / 2 + this.s45), this.alfa) / e) - this.s45), n = -u * this.alfa, o = Math.asin(Math.cos(this.ad) * Math.sin(i) + Math.sin(this.ad) * Math.cos(i) * Math.cos(n)), s = Math.asin(Math.cos(i) * Math.sin(n) / Math.cos(o)), a = this.n * s, r = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(o / 2 + this.s45), this.n), t.y = r * Math.cos(a) / 1, t.x = r * Math.sin(a) / 1, this.czech || (t.y *= -1, t.x *= -1), t } function zi(t) { var e, i, n, o, s, a, r, l = t.x; t.x = t.y, t.y = l, this.czech || (t.y *= -1, t.x *= -1), s = Math.sqrt(t.x * t.x + t.y * t.y), o = Math.atan2(t.y, t.x) / Math.sin(this.s0), n = 2 * (Math.atan(Math.pow(this.ro0 / s, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45), e = Math.asin(Math.cos(this.ad) * Math.sin(n) - Math.sin(this.ad) * Math.cos(n) * Math.cos(o)), i = Math.asin(Math.cos(n) * Math.sin(o) / Math.cos(e)), t.x = this.long0 - i / this.alfa, a = e, r = 0; var c = 0; do { t.y = 2 * (Math.atan(Math.pow(this.k, -1 / this.alfa) * Math.pow(Math.tan(e / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(a)) / (1 - this.e * Math.sin(a)), this.e / 2)) - this.s45), Math.abs(a - t.y) < 1e-10 && (r = 1), a = t.y, c += 1 } while (0 === r && c < 15); return c >= 15 ? null : t } var qi = { init: Fi, forward: Bi, inverse: zi, names: ["Krovak", "krovak"] }, Hi = function (t, e, i, n, o) { return t * o - e * Math.sin(2 * o) + i * Math.sin(4 * o) - n * Math.sin(6 * o) }, Wi = function (t) { return 1 - .25 * t * (1 + t / 16 * (3 + 1.25 * t)) }, Vi = function (t) { return .375 * t * (1 + .25 * t * (1 + .46875 * t)) }, Yi = function (t) { return .05859375 * t * t * (1 + .75 * t) }, Ki = function (t) { return t * t * t * (35 / 3072) }, Xi = function (t, e, i) { var n = e * i; return t / Math.sqrt(1 - n * n) }, Zi = function (t) { return Math.abs(t) < u ? t : t - nt(t) * Math.PI }, Qi = function (t, e, i, n, o) { var s, a; s = t / e; for (var r = 0; r < 15; r++)if (s += a = (t - (e * s - i * Math.sin(2 * s) + n * Math.sin(4 * s) - o * Math.sin(6 * s))) / (e - 2 * i * Math.cos(2 * s) + 4 * n * Math.cos(4 * s) - 6 * o * Math.cos(6 * s)), Math.abs(a) <= 1e-10) return s; return NaN }; function Ji() { this.sphere || (this.e0 = Wi(this.es), this.e1 = Vi(this.es), this.e2 = Yi(this.es), this.e3 = Ki(this.es), this.ml0 = this.a * Hi(this.e0, this.e1, this.e2, this.e3, this.lat0)) } function $i(t) { var e, i, n = t.x, o = t.y; if (n = ot(n - this.long0), this.sphere) e = this.a * Math.asin(Math.cos(o) * Math.sin(n)), i = this.a * (Math.atan2(Math.tan(o), Math.cos(n)) - this.lat0); else { var s = Math.sin(o), a = Math.cos(o), r = Xi(this.a, this.e, s), l = Math.tan(o) * Math.tan(o), c = n * Math.cos(o), u = c * c, h = this.es * a * a / (1 - this.es); e = r * c * (1 - u * l * (1 / 6 - (8 - l + 8 * h) * u / 120)), i = this.a * Hi(this.e0, this.e1, this.e2, this.e3, o) - this.ml0 + r * s / a * u * (.5 + (5 - l + 6 * h) * u / 24) } return t.x = e + this.x0, t.y = i + this.y0, t } function tn(t) { t.x -= this.x0, t.y -= this.y0; var e, i, n = t.x / this.a, o = t.y / this.a; if (this.sphere) { var s = o + this.lat0; e = Math.asin(Math.sin(s) * Math.cos(n)), i = Math.atan2(Math.tan(n), Math.cos(s)) } else { var a = this.ml0 / this.a + o, r = Qi(a, this.e0, this.e1, this.e2, this.e3); if (Math.abs(Math.abs(r) - u) <= m) return t.x = this.long0, t.y = u, o < 0 && (t.y *= -1), t; var l = Xi(this.a, this.e, Math.sin(r)), c = l * l * l / this.a / this.a * (1 - this.es), h = Math.pow(Math.tan(r), 2), d = n * this.a / l, p = d * d; e = r - l * Math.tan(r) / c * d * d * (.5 - (1 + 3 * h) * d * d / 24), i = d * (1 - p * (h / 3 + (1 + 3 * h) * h * p / 15)) / Math.cos(r) } return t.x = ot(i + this.long0), t.y = Zi(e), t } var en = { init: Ji, forward: $i, inverse: tn, names: ["Cassini", "Cassini_Soldner", "cass"] }, nn = function (t, e) { var i; return t > 1e-7 ? (1 - t * t) * (e / (1 - (i = t * e) * i) - .5 / t * Math.log((1 - i) / (1 + i))) : 2 * e }; function on() { var t, e = Math.abs(this.lat0); if (Math.abs(e - u) < m ? this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE : Math.abs(e) < m ? this.mode = this.EQUIT : this.mode = this.OBLIQ, this.es > 0) switch (this.qp = nn(this.e, 1), this.mmf = .5 / (1 - this.es), this.apa = pn(this.es), this.mode) { case this.N_POLE: case this.S_POLE: this.dd = 1; break; case this.EQUIT: this.rq = Math.sqrt(.5 * this.qp), this.dd = 1 / this.rq, this.xmf = 1, this.ymf = .5 * this.qp; break; case this.OBLIQ: this.rq = Math.sqrt(.5 * this.qp), t = Math.sin(this.lat0), this.sinb1 = nn(this.e, t) / this.qp, this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1), this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * t * t) * this.rq * this.cosb1), this.ymf = (this.xmf = this.rq) / this.dd, this.xmf *= this.dd } else this.mode === this.OBLIQ && (this.sinph0 = Math.sin(this.lat0), this.cosph0 = Math.cos(this.lat0)) } function sn(t) { var e, i, n, o, s, a, r, l, c, h, d = t.x, p = t.y; if (d = ot(d - this.long0), this.sphere) { if (s = Math.sin(p), h = Math.cos(p), n = Math.cos(d), this.mode === this.OBLIQ || this.mode === this.EQUIT) { if ((i = this.mode === this.EQUIT ? 1 + h * n : 1 + this.sinph0 * s + this.cosph0 * h * n) <= m) return null; e = (i = Math.sqrt(2 / i)) * h * Math.sin(d), i *= this.mode === this.EQUIT ? s : this.cosph0 * s - this.sinph0 * h * n } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) { if (this.mode === this.N_POLE && (n = -n), Math.abs(p + this.lat0) < m) return null; i = _ - .5 * p, e = (i = 2 * (this.mode === this.S_POLE ? Math.cos(i) : Math.sin(i))) * Math.sin(d), i *= n } } else { switch (r = 0, l = 0, c = 0, n = Math.cos(d), o = Math.sin(d), s = Math.sin(p), a = nn(this.e, s), this.mode !== this.OBLIQ && this.mode !== this.EQUIT || (r = a / this.qp, l = Math.sqrt(1 - r * r)), this.mode) { case this.OBLIQ: c = 1 + this.sinb1 * r + this.cosb1 * l * n; break; case this.EQUIT: c = 1 + l * n; break; case this.N_POLE: c = u + p, a = this.qp - a; break; case this.S_POLE: c = p - u, a = this.qp + a }if (Math.abs(c) < m) return null; switch (this.mode) { case this.OBLIQ: case this.EQUIT: c = Math.sqrt(2 / c), i = this.mode === this.OBLIQ ? this.ymf * c * (this.cosb1 * r - this.sinb1 * l * n) : (c = Math.sqrt(2 / (1 + l * n))) * r * this.ymf, e = this.xmf * c * l * o; break; case this.N_POLE: case this.S_POLE: a >= 0 ? (e = (c = Math.sqrt(a)) * o, i = n * (this.mode === this.S_POLE ? c : -c)) : e = i = 0 } } return t.x = this.a * e + this.x0, t.y = this.a * i + this.y0, t } function an(t) { t.x -= this.x0, t.y -= this.y0; var e, i, n, o, s, a, r, l = t.x / this.a, c = t.y / this.a; if (this.sphere) { var h, d = 0, p = 0; if ((i = .5 * (h = Math.sqrt(l * l + c * c))) > 1) return null; switch (i = 2 * Math.asin(i), this.mode !== this.OBLIQ && this.mode !== this.EQUIT || (p = Math.sin(i), d = Math.cos(i)), this.mode) { case this.EQUIT: i = Math.abs(h) <= m ? 0 : Math.asin(c * p / h), l *= p, c = d * h; break; case this.OBLIQ: i = Math.abs(h) <= m ? this.lat0 : Math.asin(d * this.sinph0 + c * p * this.cosph0 / h), l *= p * this.cosph0, c = (d - Math.sin(i) * this.sinph0) * h; break; case this.N_POLE: c = -c, i = u - i; break; case this.S_POLE: i -= u }e = 0 !== c || this.mode !== this.EQUIT && this.mode !== this.OBLIQ ? Math.atan2(l, c) : 0 } else { if (r = 0, this.mode === this.OBLIQ || this.mode === this.EQUIT) { if (l /= this.dd, c *= this.dd, (a = Math.sqrt(l * l + c * c)) < m) return t.x = this.long0, t.y = this.lat0, t; o = 2 * Math.asin(.5 * a / this.rq), n = Math.cos(o), l *= o = Math.sin(o), this.mode === this.OBLIQ ? (r = n * this.sinb1 + c * o * this.cosb1 / a, s = this.qp * r, c = a * this.cosb1 * n - c * this.sinb1 * o) : (r = c * o / a, s = this.qp * r, c = a * n) } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) { if (this.mode === this.N_POLE && (c = -c), !(s = l * l + c * c)) return t.x = this.long0, t.y = this.lat0, t; r = 1 - s / this.qp, this.mode === this.S_POLE && (r = -r) } e = Math.atan2(l, c), i = mn(Math.asin(r), this.apa) } return t.x = ot(this.long0 + e), t.y = i, t } var rn = .3333333333333333, ln = .17222222222222222, cn = .10257936507936508, un = .06388888888888888, hn = .0664021164021164, dn = .016415012942191543; function pn(t) { var e, i = []; return i[0] = t * rn, e = t * t, i[0] += e * ln, i[1] = e * un, e *= t, i[0] += e * cn, i[1] += e * hn, i[2] = e * dn, i } function mn(t, e) { var i = t + t; return t + e[0] * Math.sin(i) + e[1] * Math.sin(i + i) + e[2] * Math.sin(i + i + i) } var fn = { init: on, forward: sn, inverse: an, names: ["Lambert Azimuthal Equal Area", "Lambert_Azimuthal_Equal_Area", "laea"], S_POLE: 1, N_POLE: 2, EQUIT: 3, OBLIQ: 4 }, gn = function (t) { return Math.abs(t) > 1 && (t = t > 1 ? 1 : -1), Math.asin(t) }; function _n() { Math.abs(this.lat1 + this.lat2) < m || (this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e3 = Math.sqrt(this.es), this.sin_po = Math.sin(this.lat1), this.cos_po = Math.cos(this.lat1), this.t1 = this.sin_po, this.con = this.sin_po, this.ms1 = it(this.e3, this.sin_po, this.cos_po), this.qs1 = nn(this.e3, this.sin_po, this.cos_po), this.sin_po = Math.sin(this.lat2), this.cos_po = Math.cos(this.lat2), this.t2 = this.sin_po, this.ms2 = it(this.e3, this.sin_po, this.cos_po), this.qs2 = nn(this.e3, this.sin_po, this.cos_po), this.sin_po = Math.sin(this.lat0), this.cos_po = Math.cos(this.lat0), this.t3 = this.sin_po, this.qs0 = nn(this.e3, this.sin_po, this.cos_po), Math.abs(this.lat1 - this.lat2) > m ? this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1) : this.ns0 = this.con, this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1, this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0) } function vn(t) { var e = t.x, i = t.y; this.sin_phi = Math.sin(i), this.cos_phi = Math.cos(i); var n = nn(this.e3, this.sin_phi, this.cos_phi), o = this.a * Math.sqrt(this.c - this.ns0 * n) / this.ns0, s = this.ns0 * ot(e - this.long0), a = o * Math.sin(s) + this.x0, r = this.rh - o * Math.cos(s) + this.y0; return t.x = a, t.y = r, t } function yn(t) { var e, i, n, o, s, a; return t.x -= this.x0, t.y = this.rh - t.y + this.y0, this.ns0 >= 0 ? (e = Math.sqrt(t.x * t.x + t.y * t.y), n = 1) : (e = -Math.sqrt(t.x * t.x + t.y * t.y), n = -1), o = 0, 0 !== e && (o = Math.atan2(n * t.x, n * t.y)), n = e * this.ns0 / this.a, this.sphere ? a = Math.asin((this.c - n * n) / (2 * this.ns0)) : (i = (this.c - n * n) / this.ns0, a = this.phi1z(this.e3, i)), s = ot(o / this.ns0 + this.long0), t.x = s, t.y = a, t } function En(t, e) { var i, n, o, s, a = gn(.5 * e); if (t < m) return a; for (var r = t * t, l = 1; l <= 25; l++)if (a += s = .5 * (o = 1 - (n = t * (i = Math.sin(a))) * n) * o / Math.cos(a) * (e / (1 - r) - i / o + .5 / t * Math.log((1 - n) / (1 + n))), Math.abs(s) <= 1e-7) return a; return null } var wn = { init: _n, forward: vn, inverse: yn, names: ["Albers_Conic_Equal_Area", "Albers", "aea"], phi1z: En }; function bn() { this.sin_p14 = Math.sin(this.lat0), this.cos_p14 = Math.cos(this.lat0), this.infinity_dist = 1e3 * this.a, this.rc = 1 } function Pn(t) { var e, i, n, o, s, a, r, l, c = t.x, u = t.y; return n = ot(c - this.long0), e = Math.sin(u), i = Math.cos(u), o = Math.cos(n), s = 1, (a = this.sin_p14 * e + this.cos_p14 * i * o) > 0 || Math.abs(a) <= m ? (r = this.x0 + this.a * s * i * Math.sin(n) / a, l = this.y0 + this.a * s * (this.cos_p14 * e - this.sin_p14 * i * o) / a) : (r = this.x0 + this.infinity_dist * i * Math.sin(n), l = this.y0 + this.infinity_dist * (this.cos_p14 * e - this.sin_p14 * i * o)), t.x = r, t.y = l, t } function Cn(t) { var e, i, n, o, s, a; return t.x = (t.x - this.x0) / this.a, t.y = (t.y - this.y0) / this.a, t.x /= this.k0, t.y /= this.k0, (e = Math.sqrt(t.x * t.x + t.y * t.y)) ? (o = Math.atan2(e, this.rc), i = Math.sin(o), n = Math.cos(o), a = gn(n * this.sin_p14 + t.y * i * this.cos_p14 / e), s = Math.atan2(t.x * i, e * this.cos_p14 * n - t.y * this.sin_p14 * i), s = ot(this.long0 + s)) : (a = this.phic0, s = 0), t.x = s, t.y = a, t } var Mn = { init: bn, forward: Pn, inverse: Cn, names: ["gnom"] }, Sn = function (t, e) { var i = 1 - (1 - t * t) / (2 * t) * Math.log((1 - t) / (1 + t)); if (Math.abs(Math.abs(e) - i) < 1e-6) return e < 0 ? -1 * u : u; for (var n, o, s, a, r = Math.asin(.5 * e), l = 0; l < 30; l++)if (o = Math.sin(r), s = Math.cos(r), a = t * o, r += n = Math.pow(1 - a * a, 2) / (2 * s) * (e / (1 - t * t) - o / (1 - a * a) + .5 / t * Math.log((1 - a) / (1 + a))), Math.abs(n) <= 1e-10) return r; return NaN }; function Ln() { this.sphere || (this.k0 = it(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts))) } function xn(t) { var e, i, n = t.x, o = t.y, s = ot(n - this.long0); if (this.sphere) e = this.x0 + this.a * s * Math.cos(this.lat_ts), i = this.y0 + this.a * Math.sin(o) / Math.cos(this.lat_ts); else { var a = nn(this.e, Math.sin(o)); e = this.x0 + this.a * this.k0 * s, i = this.y0 + this.a * a * .5 / this.k0 } return t.x = e, t.y = i, t } function Gn(t) { var e, i; return t.x -= this.x0, t.y -= this.y0, this.sphere ? (e = ot(this.long0 + t.x / this.a / Math.cos(this.lat_ts)), i = Math.asin(t.y / this.a * Math.cos(this.lat_ts))) : (i = Sn(this.e, 2 * t.y * this.k0 / this.a), e = ot(this.long0 + t.x / (this.a * this.k0))), t.x = e, t.y = i, t } var In = { init: Ln, forward: xn, inverse: Gn, names: ["cea"] }; function Rn() { this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, this.lat0 = this.lat0 || 0, this.long0 = this.long0 || 0, this.lat_ts = this.lat_ts || 0, this.title = this.title || "Equidistant Cylindrical (Plate Carre)", this.rc = Math.cos(this.lat_ts) } function An(t) { var e = t.x, i = t.y, n = ot(e - this.long0), o = Zi(i - this.lat0); return t.x = this.x0 + this.a * n * this.rc, t.y = this.y0 + this.a * o, t } function kn(t) { var e = t.x, i = t.y; return t.x = ot(this.long0 + (e - this.x0) / (this.a * this.rc)), t.y = Zi(this.lat0 + (i - this.y0) / this.a), t } var Tn = { init: Rn, forward: An, inverse: kn, names: ["Equirectangular", "Equidistant_Cylindrical", "eqc"] }, Dn = 20; function On() { this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = Wi(this.es), this.e1 = Vi(this.es), this.e2 = Yi(this.es), this.e3 = Ki(this.es), this.ml0 = this.a * Hi(this.e0, this.e1, this.e2, this.e3, this.lat0) } function Nn(t) { var e, i, n, o = t.x, s = t.y, a = ot(o - this.long0); if (n = a * Math.sin(s), this.sphere) Math.abs(s) <= m ? (e = this.a * a, i = -1 * this.a * this.lat0) : (e = this.a * Math.sin(n) / Math.tan(s), i = this.a * (Zi(s - this.lat0) + (1 - Math.cos(n)) / Math.tan(s))); else if (Math.abs(s) <= m) e = this.a * a, i = -1 * this.ml0; else { var r = Xi(this.a, this.e, Math.sin(s)) / Math.tan(s); e = r * Math.sin(n), i = this.a * Hi(this.e0, this.e1, this.e2, this.e3, s) - this.ml0 + r * (1 - Math.cos(n)) } return t.x = e + this.x0, t.y = i + this.y0, t } function Un(t) { var e, i, n, o, s, a, r, l, c; if (n = t.x - this.x0, o = t.y - this.y0, this.sphere) if (Math.abs(o + this.a * this.lat0) <= m) e = ot(n / this.a + this.long0), i = 0; else { var u; for (a = this.lat0 + o / this.a, r = n * n / this.a / this.a + a * a, l = a, s = Dn; s; --s)if (l += c = -1 * (a * (l * (u = Math.tan(l)) + 1) - l - .5 * (l * l + r) * u) / ((l - a) / u - 1), Math.abs(c) <= m) { i = l; break } e = ot(this.long0 + Math.asin(n * Math.tan(l) / this.a) / Math.sin(i)) } else if (Math.abs(o + this.ml0) <= m) i = 0, e = ot(this.long0 + n / this.a); else { var h, d, p, f, g; for (a = (this.ml0 + o) / this.a, r = n * n / this.a / this.a + a * a, l = a, s = Dn; s; --s)if (g = this.e * Math.sin(l), h = Math.sqrt(1 - g * g) * Math.tan(l), d = this.a * Hi(this.e0, this.e1, this.e2, this.e3, l), p = this.e0 - 2 * this.e1 * Math.cos(2 * l) + 4 * this.e2 * Math.cos(4 * l) - 6 * this.e3 * Math.cos(6 * l), l -= c = (a * (h * (f = d / this.a) + 1) - f - .5 * h * (f * f + r)) / (this.es * Math.sin(2 * l) * (f * f + r - 2 * a * f) / (4 * h) + (a - f) * (h * p - 2 / Math.sin(2 * l)) - p), Math.abs(c) <= m) { i = l; break } h = Math.sqrt(1 - this.es * Math.pow(Math.sin(i), 2)) * Math.tan(i), e = ot(this.long0 + Math.asin(n * h / this.a) / Math.sin(i)) } return t.x = e, t.y = i, t } var jn = { init: On, forward: Nn, inverse: Un, names: ["Polyconic", "poly"] }; function Fn() { this.A = [], this.A[1] = .6399175073, this.A[2] = -.1358797613, this.A[3] = .063294409, this.A[4] = -.02526853, this.A[5] = .0117879, this.A[6] = -.0055161, this.A[7] = .0026906, this.A[8] = -.001333, this.A[9] = 67e-5, this.A[10] = -34e-5, this.B_re = [], this.B_im = [], this.B_re[1] = .7557853228, this.B_im[1] = 0, this.B_re[2] = .249204646, this.B_im[2] = .003371507, this.B_re[3] = -.001541739, this.B_im[3] = .04105856, this.B_re[4] = -.10162907, this.B_im[4] = .01727609, this.B_re[5] = -.26623489, this.B_im[5] = -.36249218, this.B_re[6] = -.6870983, this.B_im[6] = -1.1651967, this.C_re = [], this.C_im = [], this.C_re[1] = 1.3231270439, this.C_im[1] = 0, this.C_re[2] = -.577245789, this.C_im[2] = -.007809598, this.C_re[3] = .508307513, this.C_im[3] = -.112208952, this.C_re[4] = -.15094762, this.C_im[4] = .18200602, this.C_re[5] = 1.01418179, this.C_im[5] = 1.64497696, this.C_re[6] = 1.9660549, this.C_im[6] = 2.5127645, this.D = [], this.D[1] = 1.5627014243, this.D[2] = .5185406398, this.D[3] = -.03333098, this.D[4] = -.1052906, this.D[5] = -.0368594, this.D[6] = .007317, this.D[7] = .0122, this.D[8] = .00394, this.D[9] = -.0013 } function Bn(t) { var e, i = t.x, n = t.y - this.lat0, o = i - this.long0, s = n / c * 1e-5, a = o, r = 1, l = 0; for (e = 1; e <= 10; e++)r *= s, l += this.A[e] * r; var u, h = l, d = a, p = 1, m = 0, f = 0, g = 0; for (e = 1; e <= 6; e++)u = m * h + p * d, p = p * h - m * d, m = u, f = f + this.B_re[e] * p - this.B_im[e] * m, g = g + this.B_im[e] * p + this.B_re[e] * m; return t.x = g * this.a + this.x0, t.y = f * this.a + this.y0, t } function zn(t) { var e, i, n = t.x, o = t.y, s = n - this.x0, a = (o - this.y0) / this.a, r = s / this.a, l = 1, u = 0, h = 0, d = 0; for (e = 1; e <= 6; e++)i = u * a + l * r, l = l * a - u * r, u = i, h = h + this.C_re[e] * l - this.C_im[e] * u, d = d + this.C_im[e] * l + this.C_re[e] * u; for (var p = 0; p < this.iterations; p++) { var m, f = h, g = d, _ = a, v = r; for (e = 2; e <= 6; e++)m = g * h + f * d, f = f * h - g * d, g = m, _ += (e - 1) * (this.B_re[e] * f - this.B_im[e] * g), v += (e - 1) * (this.B_im[e] * f + this.B_re[e] * g); f = 1, g = 0; var y = this.B_re[1], E = this.B_im[1]; for (e = 2; e <= 6; e++)m = g * h + f * d, f = f * h - g * d, g = m, y += e * (this.B_re[e] * f - this.B_im[e] * g), E += e * (this.B_im[e] * f + this.B_re[e] * g); var w = y * y + E * E; h = (_ * y + v * E) / w, d = (v * y - _ * E) / w } var b = h, P = d, C = 1, M = 0; for (e = 1; e <= 9; e++)C *= b, M += this.D[e] * C; var S = this.lat0 + M * c * 1e5, L = this.long0 + P; return t.x = L, t.y = S, t } var qn = { init: Fn, forward: Bn, inverse: zn, names: ["New_Zealand_Map_Grid", "nzmg"] }; function Hn() { } function Wn(t) { var e = t.x, i = t.y, n = ot(e - this.long0), o = this.x0 + this.a * n, s = this.y0 + this.a * Math.log(Math.tan(Math.PI / 4 + i / 2.5)) * 1.25; return t.x = o, t.y = s, t } function Vn(t) { t.x -= this.x0, t.y -= this.y0; var e = ot(this.long0 + t.x / this.a), i = 2.5 * (Math.atan(Math.exp(.8 * t.y / this.a)) - Math.PI / 4); return t.x = e, t.y = i, t } var Yn = { init: Hn, forward: Wn, inverse: Vn, names: ["Miller_Cylindrical", "mill"] }, Kn = 20; function Xn() { this.sphere ? (this.n = 1, this.m = 0, this.es = 0, this.C_y = Math.sqrt((this.m + 1) / this.n), this.C_x = this.C_y / (this.m + 1)) : this.en = ze(this.es) } function Zn(t) { var e, i, n = t.x, o = t.y; if (n = ot(n - this.long0), this.sphere) { if (this.m) for (var s = this.n * Math.sin(o), a = Kn; a; --a) { var r = (this.m * o + Math.sin(o) - s) / (this.m + Math.cos(o)); if (o -= r, Math.abs(r) < m) break } else o = 1 !== this.n ? Math.asin(this.n * Math.sin(o)) : o; e = this.a * this.C_x * n * (this.m + Math.cos(o)), i = this.a * this.C_y * o } else { var l = Math.sin(o), c = Math.cos(o); i = this.a * qe(o, l, c, this.en), e = this.a * n * c / Math.sqrt(1 - this.es * l * l) } return t.x = e, t.y = i, t } function Qn(t) { var e, i, n, o; return t.x -= this.x0, n = t.x / this.a, t.y -= this.y0, e = t.y / this.a, this.sphere ? (e /= this.C_y, n /= this.C_x * (this.m + Math.cos(e)), this.m ? e = gn((this.m * e + Math.sin(e)) / this.n) : 1 !== this.n && (e = gn(Math.sin(e) / this.n)), n = ot(n + this.long0), e = Zi(e)) : (e = We(t.y / this.a, this.es, this.en), (o = Math.abs(e)) < u ? (o = Math.sin(e), i = this.long0 + t.x * Math.sqrt(1 - this.es * o * o) / (this.a * Math.cos(e)), n = ot(i)) : o - m < u && (n = this.long0)), t.x = n, t.y = e, t } var Jn = { init: Xn, forward: Zn, inverse: Qn, names: ["Sinusoidal", "sinu"] }; function $n() { } function to(t) { for (var e = t.x, i = t.y, n = ot(e - this.long0), o = i, s = Math.PI * Math.sin(i); ;) { var a = -(o + Math.sin(o) - s) / (1 + Math.cos(o)); if (o += a, Math.abs(a) < m) break } o /= 2, Math.PI / 2 - Math.abs(i) < m && (n = 0); var r = .900316316158 * this.a * n * Math.cos(o) + this.x0, l = 1.4142135623731 * this.a * Math.sin(o) + this.y0; return t.x = r, t.y = l, t } function eo(t) { var e, i; t.x -= this.x0, t.y -= this.y0, i = t.y / (1.4142135623731 * this.a), Math.abs(i) > .999999999999 && (i = .999999999999), e = Math.asin(i); var n = ot(this.long0 + t.x / (.900316316158 * this.a * Math.cos(e))); n < -Math.PI && (n = -Math.PI), n > Math.PI && (n = Math.PI), i = (2 * e + Math.sin(2 * e)) / Math.PI, Math.abs(i) > 1 && (i = 1); var o = Math.asin(i); return t.x = n, t.y = o, t } var io = { init: $n, forward: to, inverse: eo, names: ["Mollweide", "moll"] }; function no() { Math.abs(this.lat1 + this.lat2) < m || (this.lat2 = this.lat2 || this.lat1, this.temp = this.b / this.a, this.es = 1 - Math.pow(this.temp, 2), this.e = Math.sqrt(this.es), this.e0 = Wi(this.es), this.e1 = Vi(this.es), this.e2 = Yi(this.es), this.e3 = Ki(this.es), this.sinphi = Math.sin(this.lat1), this.cosphi = Math.cos(this.lat1), this.ms1 = it(this.e, this.sinphi, this.cosphi), this.ml1 = Hi(this.e0, this.e1, this.e2, this.e3, this.lat1), Math.abs(this.lat1 - this.lat2) < m ? this.ns = this.sinphi : (this.sinphi = Math.sin(this.lat2), this.cosphi = Math.cos(this.lat2), this.ms2 = it(this.e, this.sinphi, this.cosphi), this.ml2 = Hi(this.e0, this.e1, this.e2, this.e3, this.lat2), this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1)), this.g = this.ml1 + this.ms1 / this.ns, this.ml0 = Hi(this.e0, this.e1, this.e2, this.e3, this.lat0), this.rh = this.a * (this.g - this.ml0)) } function oo(t) { var e, i = t.x, n = t.y; if (this.sphere) e = this.a * (this.g - n); else { var o = Hi(this.e0, this.e1, this.e2, this.e3, n); e = this.a * (this.g - o) } var s = this.ns * ot(i - this.long0), a = this.x0 + e * Math.sin(s), r = this.y0 + this.rh - e * Math.cos(s); return t.x = a, t.y = r, t } function so(t) { var e, i, n, o; t.x -= this.x0, t.y = this.rh - t.y + this.y0, this.ns >= 0 ? (i = Math.sqrt(t.x * t.x + t.y * t.y), e = 1) : (i = -Math.sqrt(t.x * t.x + t.y * t.y), e = -1); var s = 0; if (0 !== i && (s = Math.atan2(e * t.x, e * t.y)), this.sphere) return o = ot(this.long0 + s / this.ns), n = Zi(this.g - i / this.a), t.x = o, t.y = n, t; var a = this.g - i / this.a; return n = Qi(a, this.e0, this.e1, this.e2, this.e3), o = ot(this.long0 + s / this.ns), t.x = o, t.y = n, t } var ao = { init: no, forward: oo, inverse: so, names: ["Equidistant_Conic", "eqdc"] }; function ro() { this.R = this.a } function lo(t) { var e, i, n = t.x, o = t.y, s = ot(n - this.long0); Math.abs(o) <= m && (e = this.x0 + this.R * s, i = this.y0); var a = gn(2 * Math.abs(o / Math.PI)); (Math.abs(s) <= m || Math.abs(Math.abs(o) - u) <= m) && (e = this.x0, i = o >= 0 ? this.y0 + Math.PI * this.R * Math.tan(.5 * a) : this.y0 + Math.PI * this.R * -Math.tan(.5 * a)); var r = .5 * Math.abs(Math.PI / s - s / Math.PI), l = r * r, c = Math.sin(a), h = Math.cos(a), d = h / (c + h - 1), p = d * d, f = d * (2 / c - 1), g = f * f, _ = Math.PI * this.R * (r * (d - g) + Math.sqrt(l * (d - g) * (d - g) - (g + l) * (p - g))) / (g + l); s < 0 && (_ = -_), e = this.x0 + _; var v = l + d; return _ = Math.PI * this.R * (f * v - r * Math.sqrt((g + l) * (l + 1) - v * v)) / (g + l), i = o >= 0 ? this.y0 + _ : this.y0 - _, t.x = e, t.y = i, t } function co(t) { var e, i, n, o, s, a, r, l, c, u, h, d; return t.x -= this.x0, t.y -= this.y0, h = Math.PI * this.R, s = (n = t.x / h) * n + (o = t.y / h) * o, h = 3 * (o * o / (l = -2 * (a = -Math.abs(o) * (1 + s)) + 1 + 2 * o * o + s * s) + (2 * (r = a - 2 * o * o + n * n) * r * r / l / l / l - 9 * a * r / l / l) / 27) / (c = (a - r * r / 3 / l) / l) / (u = 2 * Math.sqrt(-c / 3)), Math.abs(h) > 1 && (h = h >= 0 ? 1 : -1), d = Math.acos(h) / 3, i = t.y >= 0 ? (-u * Math.cos(d + Math.PI / 3) - r / 3 / l) * Math.PI : -(-u * Math.cos(d + Math.PI / 3) - r / 3 / l) * Math.PI, e = Math.abs(n) < m ? this.long0 : ot(this.long0 + Math.PI * (s - 1 + Math.sqrt(1 + 2 * (n * n - o * o) + s * s)) / 2 / n), t.x = e, t.y = i, t } var uo = { init: ro, forward: lo, inverse: co, names: ["Van_der_Grinten_I", "VanDerGrinten", "vandg"] }; function ho() { this.sin_p12 = Math.sin(this.lat0), this.cos_p12 = Math.cos(this.lat0) } function po(t) { var e, i, n, o, s, a, r, l, c, h, d, p, f, g, _, v, y, E, w, b, P, C, M = t.x, S = t.y, L = Math.sin(t.y), x = Math.cos(t.y), G = ot(M - this.long0); return this.sphere ? Math.abs(this.sin_p12 - 1) <= m ? (t.x = this.x0 + this.a * (u - S) * Math.sin(G), t.y = this.y0 - this.a * (u - S) * Math.cos(G), t) : Math.abs(this.sin_p12 + 1) <= m ? (t.x = this.x0 + this.a * (u + S) * Math.sin(G), t.y = this.y0 + this.a * (u + S) * Math.cos(G), t) : (E = this.sin_p12 * L + this.cos_p12 * x * Math.cos(G), y = (v = Math.acos(E)) ? v / Math.sin(v) : 1, t.x = this.x0 + this.a * y * x * Math.sin(G), t.y = this.y0 + this.a * y * (this.cos_p12 * L - this.sin_p12 * x * Math.cos(G)), t) : (e = Wi(this.es), i = Vi(this.es), n = Yi(this.es), o = Ki(this.es), Math.abs(this.sin_p12 - 1) <= m ? (s = this.a * Hi(e, i, n, o, u), a = this.a * Hi(e, i, n, o, S), t.x = this.x0 + (s - a) * Math.sin(G), t.y = this.y0 - (s - a) * Math.cos(G), t) : Math.abs(this.sin_p12 + 1) <= m ? (s = this.a * Hi(e, i, n, o, u), a = this.a * Hi(e, i, n, o, S), t.x = this.x0 + (s + a) * Math.sin(G), t.y = this.y0 + (s + a) * Math.cos(G), t) : (r = L / x, l = Xi(this.a, this.e, this.sin_p12), c = Xi(this.a, this.e, L), h = Math.atan((1 - this.es) * r + this.es * l * this.sin_p12 / (c * x)), w = 0 === (d = Math.atan2(Math.sin(G), this.cos_p12 * Math.tan(h) - this.sin_p12 * Math.cos(G))) ? Math.asin(this.cos_p12 * Math.sin(h) - this.sin_p12 * Math.cos(h)) : Math.abs(Math.abs(d) - Math.PI) <= m ? -Math.asin(this.cos_p12 * Math.sin(h) - this.sin_p12 * Math.cos(h)) : Math.asin(Math.sin(G) * Math.cos(h) / Math.sin(d)), p = this.e * this.sin_p12 / Math.sqrt(1 - this.es), v = l * w * (1 - (b = w * w) * (_ = (f = this.e * this.cos_p12 * Math.cos(d) / Math.sqrt(1 - this.es)) * f) * (1 - _) / 6 + (P = b * w) / 8 * (g = p * f) * (1 - 2 * _) + (C = P * w) / 120 * (_ * (4 - 7 * _) - 3 * p * p * (1 - 7 * _)) - C * w / 48 * g), t.x = this.x0 + v * Math.sin(d), t.y = this.y0 + v * Math.cos(d), t)) } function mo(t) { var e, i, n, o, s, a, r, l, c, h, d, p, f, g, _, v, y, E, w, b, P, C, M; if (t.x -= this.x0, t.y -= this.y0, this.sphere) { if ((e = Math.sqrt(t.x * t.x + t.y * t.y)) > 2 * u * this.a) return; return i = e / this.a, n = Math.sin(i), o = Math.cos(i), s = this.long0, Math.abs(e) <= m ? a = this.lat0 : (a = gn(o * this.sin_p12 + t.y * n * this.cos_p12 / e), r = Math.abs(this.lat0) - u, s = Math.abs(r) <= m ? this.lat0 >= 0 ? ot(this.long0 + Math.atan2(t.x, -t.y)) : ot(this.long0 - Math.atan2(-t.x, t.y)) : ot(this.long0 + Math.atan2(t.x * n, e * this.cos_p12 * o - t.y * this.sin_p12 * n))), t.x = s, t.y = a, t } return l = Wi(this.es), c = Vi(this.es), h = Yi(this.es), d = Ki(this.es), Math.abs(this.sin_p12 - 1) <= m ? (p = this.a * Hi(l, c, h, d, u), e = Math.sqrt(t.x * t.x + t.y * t.y), a = Qi((p - e) / this.a, l, c, h, d), s = ot(this.long0 + Math.atan2(t.x, -1 * t.y)), t.x = s, t.y = a, t) : Math.abs(this.sin_p12 + 1) <= m ? (p = this.a * Hi(l, c, h, d, u), e = Math.sqrt(t.x * t.x + t.y * t.y), a = Qi((e - p) / this.a, l, c, h, d), s = ot(this.long0 + Math.atan2(t.x, t.y)), t.x = s, t.y = a, t) : (e = Math.sqrt(t.x * t.x + t.y * t.y), _ = Math.atan2(t.x, t.y), f = Xi(this.a, this.e, this.sin_p12), v = Math.cos(_), E = -(y = this.e * this.cos_p12 * v) * y / (1 - this.es), w = 3 * this.es * (1 - E) * this.sin_p12 * this.cos_p12 * v / (1 - this.es), C = 1 - E * (P = (b = e / f) - E * (1 + E) * Math.pow(b, 3) / 6 - w * (1 + 3 * E) * Math.pow(b, 4) / 24) * P / 2 - b * P * P * P / 6, g = Math.asin(this.sin_p12 * Math.cos(P) + this.cos_p12 * Math.sin(P) * v), s = ot(this.long0 + Math.asin(Math.sin(_) * Math.sin(P) / Math.cos(g))), M = Math.sin(g), a = Math.atan2((M - this.es * C * this.sin_p12) * Math.tan(g), M * (1 - this.es)), t.x = s, t.y = a, t) } var fo = { init: ho, forward: po, inverse: mo, names: ["Azimuthal_Equidistant", "aeqd"] }; function go() { this.sin_p14 = Math.sin(this.lat0), this.cos_p14 = Math.cos(this.lat0) } function _o(t) { var e, i, n, o, s, a, r, l, c = t.x, u = t.y; return n = ot(c - this.long0), e = Math.sin(u), i = Math.cos(u), o = Math.cos(n), s = 1, ((a = this.sin_p14 * e + this.cos_p14 * i * o) > 0 || Math.abs(a) <= m) && (r = this.a * s * i * Math.sin(n), l = this.y0 + this.a * s * (this.cos_p14 * e - this.sin_p14 * i * o)), t.x = r, t.y = l, t } function vo(t) { var e, i, n, o, s, a, r; return t.x -= this.x0, t.y -= this.y0, e = Math.sqrt(t.x * t.x + t.y * t.y), i = gn(e / this.a), n = Math.sin(i), o = Math.cos(i), a = this.long0, Math.abs(e) <= m ? (r = this.lat0, t.x = a, t.y = r, t) : (r = gn(o * this.sin_p14 + t.y * n * this.cos_p14 / e), s = Math.abs(this.lat0) - u, Math.abs(s) <= m ? (a = this.lat0 >= 0 ? ot(this.long0 + Math.atan2(t.x, -t.y)) : ot(this.long0 - Math.atan2(-t.x, t.y)), t.x = a, t.y = r, t) : (a = ot(this.long0 + Math.atan2(t.x * n, e * this.cos_p14 * o - t.y * this.sin_p14 * n)), t.x = a, t.y = r, t)) } var yo = { init: go, forward: _o, inverse: vo, names: ["ortho"] }, Eo = { FRONT: 1, RIGHT: 2, BACK: 3, LEFT: 4, TOP: 5, BOTTOM: 6 }, wo = { AREA_0: 1, AREA_1: 2, AREA_2: 3, AREA_3: 4 }; function bo() { this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, this.lat0 = this.lat0 || 0, this.long0 = this.long0 || 0, this.lat_ts = this.lat_ts || 0, this.title = this.title || "Quadrilateralized Spherical Cube", this.lat0 >= u - _ / 2 ? this.face = Eo.TOP : this.lat0 <= -(u - _ / 2) ? this.face = Eo.BOTTOM : Math.abs(this.long0) <= _ ? this.face = Eo.FRONT : Math.abs(this.long0) <= u + _ ? this.face = this.long0 > 0 ? Eo.RIGHT : Eo.LEFT : this.face = Eo.BACK, 0 !== this.es && (this.one_minus_f = 1 - (this.a - this.b) / this.a, this.one_minus_f_squared = this.one_minus_f * this.one_minus_f) } function Po(t) { var e, i, n, o, s, a, r = { x: 0, y: 0 }, l = { value: 0 }; if (t.x -= this.long0, e = 0 !== this.es ? Math.atan(this.one_minus_f_squared * Math.tan(t.y)) : t.y, i = t.x, this.face === Eo.TOP) o = u - e, i >= _ && i <= u + _ ? (l.value = wo.AREA_0, n = i - u) : i > u + _ || i <= -(u + _) ? (l.value = wo.AREA_1, n = i > 0 ? i - y : i + y) : i > -(u + _) && i <= -_ ? (l.value = wo.AREA_2, n = i + u) : (l.value = wo.AREA_3, n = i); else if (this.face === Eo.BOTTOM) o = u + e, i >= _ && i <= u + _ ? (l.value = wo.AREA_0, n = -i + u) : i < _ && i >= -_ ? (l.value = wo.AREA_1, n = -i) : i < -_ && i >= -(u + _) ? (l.value = wo.AREA_2, n = -i - u) : (l.value = wo.AREA_3, n = i > 0 ? -i + y : -i - y); else { var c, h, d, p, m, f; this.face === Eo.RIGHT ? i = So(i, +u) : this.face === Eo.BACK ? i = So(i, +y) : this.face === Eo.LEFT && (i = So(i, -u)), p = Math.sin(e), m = Math.cos(e), f = Math.sin(i), c = m * Math.cos(i), h = m * f, d = p, this.face === Eo.FRONT ? n = Mo(o = Math.acos(c), d, h, l) : this.face === Eo.RIGHT ? n = Mo(o = Math.acos(h), d, -c, l) : this.face === Eo.BACK ? n = Mo(o = Math.acos(-c), d, -h, l) : this.face === Eo.LEFT ? n = Mo(o = Math.acos(-h), d, c, l) : (o = n = 0, l.value = wo.AREA_0) } return a = Math.atan(12 / y * (n + Math.acos(Math.sin(n) * Math.cos(_)) - u)), s = Math.sqrt((1 - Math.cos(o)) / (Math.cos(a) * Math.cos(a)) / (1 - Math.cos(Math.atan(1 / Math.cos(n))))), l.value === wo.AREA_1 ? a += u : l.value === wo.AREA_2 ? a += y : l.value === wo.AREA_3 && (a += 1.5 * y), r.x = s * Math.cos(a), r.y = s * Math.sin(a), r.x = r.x * this.a + this.x0, r.y = r.y * this.a + this.y0, t.x = r.x, t.y = r.y, t } function Co(t) { var e, i, n, o, s, a, r, l, c, h, d, p, m = { lam: 0, phi: 0 }, f = { value: 0 }; if (t.x = (t.x - this.x0) / this.a, t.y = (t.y - this.y0) / this.a, i = Math.atan(Math.sqrt(t.x * t.x + t.y * t.y)), e = Math.atan2(t.y, t.x), t.x >= 0 && t.x >= Math.abs(t.y) ? f.value = wo.AREA_0 : t.y >= 0 && t.y >= Math.abs(t.x) ? (f.value = wo.AREA_1, e -= u) : t.x < 0 && -t.x >= Math.abs(t.y) ? (f.value = wo.AREA_2, e = e < 0 ? e + y : e - y) : (f.value = wo.AREA_3, e += u), c = y / 12 * Math.tan(e), s = Math.sin(c) / (Math.cos(c) - 1 / Math.sqrt(2)), a = Math.atan(s), (r = 1 - (n = Math.cos(e)) * n * (o = Math.tan(i)) * o * (1 - Math.cos(Math.atan(1 / Math.cos(a))))) < -1 ? r = -1 : r > 1 && (r = 1), this.face === Eo.TOP) l = Math.acos(r), m.phi = u - l, f.value === wo.AREA_0 ? m.lam = a + u : f.value === wo.AREA_1 ? m.lam = a < 0 ? a + y : a - y : f.value === wo.AREA_2 ? m.lam = a - u : m.lam = a; else if (this.face === Eo.BOTTOM) l = Math.acos(r), m.phi = l - u, f.value === wo.AREA_0 ? m.lam = -a + u : f.value === wo.AREA_1 ? m.lam = -a : f.value === wo.AREA_2 ? m.lam = -a - u : m.lam = a < 0 ? -a - y : -a + y; else { var g, _, v; c = (g = r) * g, _ = (c += (v = c >= 1 ? 0 : Math.sqrt(1 - c) * Math.sin(a)) * v) >= 1 ? 0 : Math.sqrt(1 - c), f.value === wo.AREA_1 ? (c = _, _ = -v, v = c) : f.value === wo.AREA_2 ? (_ = -_, v = -v) : f.value === wo.AREA_3 && (c = _, _ = v, v = -c), this.face === Eo.RIGHT ? (c = g, g = -_, _ = c) : this.face === Eo.BACK ? (g = -g, _ = -_) : this.face === Eo.LEFT && (c = g, g = _, _ = -c), m.phi = Math.acos(-v) - u, m.lam = Math.atan2(_, g), this.face === Eo.RIGHT ? m.lam = So(m.lam, -u) : this.face === Eo.BACK ? m.lam = So(m.lam, -y) : this.face === Eo.LEFT && (m.lam = So(m.lam, +u)) } return 0 !== this.es && (h = m.phi < 0 ? 1 : 0, d = Math.tan(m.phi), p = this.b / Math.sqrt(d * d + this.one_minus_f_squared), m.phi = Math.atan(Math.sqrt(this.a * this.a - p * p) / (this.one_minus_f * p)), h && (m.phi = -m.phi)), m.lam += this.long0, t.x = m.lam, t.y = m.phi, t } function Mo(t, e, i, n) { var o; return t < m ? (n.value = wo.AREA_0, o = 0) : (o = Math.atan2(e, i), Math.abs(o) <= _ ? n.value = wo.AREA_0 : o > _ && o <= u + _ ? (n.value = wo.AREA_1, o -= u) : o > u + _ || o <= -(u + _) ? (n.value = wo.AREA_2, o = o >= 0 ? o - y : o + y) : (n.value = wo.AREA_3, o += u)), o } function So(t, e) { var i = t + e; return i < -y ? i += v : i > +y && (i -= v), i } var Lo = { init: bo, forward: Po, inverse: Co, names: ["Quadrilateralized Spherical Cube", "Quadrilateralized_Spherical_Cube", "qsc"] }, xo = [[1, 22199e-21, -715515e-10, 31103e-10], [.9986, -482243e-9, -24897e-9, -13309e-10], [.9954, -83103e-8, -448605e-10, -9.86701e-7], [.99, -.00135364, -59661e-9, 36777e-10], [.9822, -.00167442, -449547e-11, -572411e-11], [.973, -.00214868, -903571e-10, 1.8736e-8], [.96, -.00305085, -900761e-10, 164917e-11], [.9427, -.00382792, -653386e-10, -26154e-10], [.9216, -.00467746, -10457e-8, 481243e-11], [.8962, -.00536223, -323831e-10, -543432e-11], [.8679, -.00609363, -113898e-9, 332484e-11], [.835, -.00698325, -640253e-10, 9.34959e-7], [.7986, -.00755338, -500009e-10, 9.35324e-7], [.7597, -.00798324, -35971e-9, -227626e-11], [.7186, -.00851367, -701149e-10, -86303e-10], [.6732, -.00986209, -199569e-9, 191974e-10], [.6213, -.010418, 883923e-10, 624051e-11], [.5722, -.00906601, 182e-6, 624051e-11], [.5322, -.00677797, 275608e-9, 624051e-11]], Go = [[-520417e-23, .0124, 121431e-23, -845284e-16], [.062, .0124, -1.26793e-9, 4.22642e-10], [.124, .0124, 5.07171e-9, -1.60604e-9], [.186, .0123999, -1.90189e-8, 6.00152e-9], [.248, .0124002, 7.10039e-8, -2.24e-8], [.31, .0123992, -2.64997e-7, 8.35986e-8], [.372, .0124029, 9.88983e-7, -3.11994e-7], [.434, .0123893, -369093e-11, -4.35621e-7], [.4958, .0123198, -102252e-10, -3.45523e-7], [.5571, .0121916, -154081e-10, -5.82288e-7], [.6176, .0119938, -241424e-10, -5.25327e-7], [.6769, .011713, -320223e-10, -5.16405e-7], [.7346, .0113541, -397684e-10, -6.09052e-7], [.7903, .0109107, -489042e-10, -104739e-11], [.8435, .0103431, -64615e-9, -1.40374e-9], [.8936, .00969686, -64636e-9, -8547e-9], [.9394, .00840947, -192841e-9, -42106e-10], [.9761, .00616527, -256e-6, -42106e-10], [1, .00328947, -319159e-9, -42106e-10]], Io = .8487, Ro = 1.3523, Ao = g / 5, ko = 1 / Ao, To = 18, Do = function (t, e) { return t[0] + e * (t[1] + e * (t[2] + e * t[3])) }, Oo = function (t, e) { return t[1] + e * (2 * t[2] + 3 * e * t[3]) }; function No(t, e, i, n) { for (var o = e; n; --n) { var s = t(o); if (o -= s, Math.abs(s) < i) break } return o } function Uo() { this.x0 = this.x0 || 0, this.y0 = this.y0 || 0, this.long0 = this.long0 || 0, this.es = 0, this.title = this.title || "Robinson" } function jo(t) { var e = ot(t.x - this.long0), i = Math.abs(t.y), n = Math.floor(i * Ao); n < 0 ? n = 0 : n >= To && (n = To - 1), i = g * (i - ko * n); var o = { x: Do(xo[n], i) * e, y: Do(Go[n], i) }; return t.y < 0 && (o.y = -o.y), o.x = o.x * this.a * Io + this.x0, o.y = o.y * this.a * Ro + this.y0, o } function Fo(t) { var e = { x: (t.x - this.x0) / (this.a * Io), y: Math.abs(t.y - this.y0) / (this.a * Ro) }; if (e.y >= 1) e.x /= xo[To][0], e.y = t.y < 0 ? -u : u; else { var i = Math.floor(e.y * To); for (i < 0 ? i = 0 : i >= To && (i = To - 1); ;)if (Go[i][0] > e.y) --i; else { if (!(Go[i + 1][0] <= e.y)) break; ++i } var n = Go[i], o = 5 * (e.y - n[0]) / (Go[i + 1][0] - n[0]); o = No((function (t) { return (Do(n, t) - e.y) / Oo(n, t) }), o, m, 100), e.x /= Do(xo[i], o), e.y = (5 * i + o) * f, t.y < 0 && (e.y = -e.y) } return e.x = ot(e.x + this.long0), e } var Bo = { init: Uo, forward: jo, inverse: Fo, names: ["Robinson", "robin"] }; function zo() { this.name = "geocent" } function qo(t) { return jt(t, this.es, this.a) } function Ho(t) { return Ft(t, this.es, this.a, this.b) } var Wo = { init: zo, forward: qo, inverse: Ho, names: ["Geocentric", "geocentric", "geocent", "Geocent"] }, Vo = { N_POLE: 0, S_POLE: 1, EQUIT: 2, OBLIQ: 3 }, Yo = { h: { def: 1e5, num: !0 }, azi: { def: 0, num: !0, degrees: !0 }, tilt: { def: 0, num: !0, degrees: !0 }, long0: { def: 0, num: !0 }, lat0: { def: 0, num: !0 } }; function Ko() { if (Object.keys(Yo).forEach(function (t) { if (void 0 === this[t]) this[t] = Yo[t].def; else { if (Yo[t].num && isNaN(this[t])) throw new Error("Invalid parameter value, must be numeric " + t + " = " + this[t]); Yo[t].num && (this[t] = parseFloat(this[t])) } Yo[t].degrees && (this[t] = this[t] * f) }.bind(this)), Math.abs(Math.abs(this.lat0) - u) < m ? this.mode = this.lat0 < 0 ? Vo.S_POLE : Vo.N_POLE : Math.abs(this.lat0) < m ? this.mode = Vo.EQUIT : (this.mode = Vo.OBLIQ, this.sinph0 = Math.sin(this.lat0), this.cosph0 = Math.cos(this.lat0)), this.pn1 = this.h / this.a, this.pn1 <= 0 || this.pn1 > 1e10) throw new Error("Invalid height"); this.p = 1 + this.pn1, this.rp = 1 / this.p, this.h1 = 1 / this.pn1, this.pfact = (this.p + 1) * this.h1, this.es = 0; var t = this.tilt, e = this.azi; this.cg = Math.cos(e), this.sg = Math.sin(e), this.cw = Math.cos(t), this.sw = Math.sin(t) } function Xo(t) { t.x -= this.long0; var e, i, n, o, s = Math.sin(t.y), a = Math.cos(t.y), r = Math.cos(t.x); switch (this.mode) { case Vo.OBLIQ: i = this.sinph0 * s + this.cosph0 * a * r; break; case Vo.EQUIT: i = a * r; break; case Vo.S_POLE: i = -s; break; case Vo.N_POLE: i = s }switch (e = (i = this.pn1 / (this.p - i)) * a * Math.sin(t.x), this.mode) { case Vo.OBLIQ: i *= this.cosph0 * s - this.sinph0 * a * r; break; case Vo.EQUIT: i *= s; break; case Vo.N_POLE: i *= -a * r; break; case Vo.S_POLE: i *= a * r }return o = 1 / ((n = i * this.cg + e * this.sg) * this.sw * this.h1 + this.cw), e = (e * this.cg - i * this.sg) * this.cw * o, i = n * o, t.x = e * this.a, t.y = i * this.a, t } function Zo(t) { t.x /= this.a, t.y /= this.a; var e, i, n, o = { x: t.x, y: t.y }; n = 1 / (this.pn1 - t.y * this.sw), e = this.pn1 * t.x * n, i = this.pn1 * t.y * this.cw * n, t.x = e * this.cg + i * this.sg, t.y = i * this.cg - e * this.sg; var s = Qe(t.x, t.y); if (Math.abs(s) < m) o.x = 0, o.y = t.y; else { var a, r; switch (r = 1 - s * s * this.pfact, r = (this.p - Math.sqrt(r)) / (this.pn1 / s + s / this.pn1), a = Math.sqrt(1 - r * r), this.mode) { case Vo.OBLIQ: o.y = Math.asin(a * this.sinph0 + t.y * r * this.cosph0 / s), t.y = (a - this.sinph0 * Math.sin(o.y)) * s, t.x *= r * this.cosph0; break; case Vo.EQUIT: o.y = Math.asin(t.y * r / s), t.y = a * s, t.x *= r; break; case Vo.N_POLE: o.y = Math.asin(a), t.y = -t.y; break; case Vo.S_POLE: o.y = -Math.asin(a) }o.x = Math.atan2(t.x, t.y) } return t.x = o.x + this.long0, t.y = o.y, t } var Qo = { init: Ko, forward: Xo, inverse: Zo, names: ["Tilted_Perspective", "tpers"] }, Jo = function (t) { t.Proj.projections.add(Xe), t.Proj.projections.add(ri), t.Proj.projections.add(ui), t.Proj.projections.add(Ei), t.Proj.projections.add(Mi), t.Proj.projections.add(Gi), t.Proj.projections.add(Di), t.Proj.projections.add(ji), t.Proj.projections.add(qi), t.Proj.projections.add(en), t.Proj.projections.add(fn), t.Proj.projections.add(wn), t.Proj.projections.add(Mn), t.Proj.projections.add(In), t.Proj.projections.add(Tn), t.Proj.projections.add(jn), t.Proj.projections.add(qn), t.Proj.projections.add(Yn), t.Proj.projections.add(Jn), t.Proj.projections.add(io), t.Proj.projections.add(ao), t.Proj.projections.add(uo), t.Proj.projections.add(fo), t.Proj.projections.add(yo), t.Proj.projections.add(Lo), t.Proj.projections.add(Bo), t.Proj.projections.add(Wo), t.Proj.projections.add(Qo) }; return ne.defaultDatum = "WGS84", ne.Proj = Nt, ne.WGS84 = new ne.Proj("WGS84"), ne.Point = Ge, ne.toPoint = Xt, ne.defs = W, ne.nadgrid = St, ne.transform = $t, ne.mgrs = de, ne.version = "2.7.5", Jo(ne), ne }() }, function (t, e, i) { var n, o, s; o = [i(2), i(142)], void 0 === (s = "function" == typeof (n = function (t, e) { return e.__esModule && e.default && (e = e.default), t.Proj = {}, t.Proj._isProj4Obj = function (t) { return void 0 !== t.inverse && void 0 !== t.forward }, t.Proj.Projection = t.Class.extend({ initialize: function (e, i, n) { var o = t.Proj._isProj4Obj(e); this._proj = o ? e : this._projFromCodeDef(e, i), this.bounds = o ? i : n }, project: function (e) { var i = this._proj.forward([e.lng, e.lat]); return new t.Point(i[0], i[1]) }, unproject: function (e, i) { var n = this._proj.inverse([e.x, e.y]); return new t.LatLng(n[1], n[0], i) }, _projFromCodeDef: function (t, i) { if (i) e.defs(t, i); else if (void 0 === e.defs[t]) { var n = t.split(":"); if (n.length > 3 && (t = n[n.length - 3] + ":" + n[n.length - 1]), void 0 === e.defs[t]) throw "No projection definition for code " + t } return e(t) } }), t.Proj.CRS = t.Class.extend({ includes: t.CRS, options: { transformation: new t.Transformation(1, 0, -1, 0) }, initialize: function (e, i, n) { var o, s, a, r; if (t.Proj._isProj4Obj(e) ? (o = (s = e).srsCode, r = i || {}, this.projection = new t.Proj.Projection(s, r.bounds)) : (o = e, a = i, r = n || {}, this.projection = new t.Proj.Projection(o, a, r.bounds)), t.Util.setOptions(this, r), this.code = o, this.transformation = this.options.transformation, this.options.origin && (this.transformation = new t.Transformation(1, -this.options.origin[0], -1, this.options.origin[1])), this.options.scales) this._scales = this.options.scales; else if (this.options.resolutions) { this._scales = []; for (var l = this.options.resolutions.length - 1; l >= 0; l--)this.options.resolutions[l] && (this._scales[l] = 1 / this.options.resolutions[l]) } this.infinite = !this.options.bounds }, scale: function (t) { var e, i = Math.floor(t); return t === i ? this._scales[t] : (e = this._scales[i]) + (this._scales[i + 1] - e) * (t - i) }, zoom: function (t) { var e, i, n = this._closestElement(this._scales, t), o = this._scales.indexOf(n); return t === n ? o : void 0 === n ? -1 / 0 : (i = o + 1, void 0 === (e = this._scales[i]) ? 1 / 0 : (t - n) / (e - n) + o) }, distance: t.CRS.Earth.distance, R: t.CRS.Earth.R, _closestElement: function (t, e) { for (var i, n = t.length; n--;)t[n] <= e && (void 0 === i || i < t[n]) && (i = t[n]); return i } }), t.Proj.GeoJSON = t.GeoJSON.extend({ initialize: function (e, i) { this._callLevel = 0, t.GeoJSON.prototype.initialize.call(this, e, i) }, addData: function (e) { var i; e && (e.crs && "name" === e.crs.type ? i = new t.Proj.CRS(e.crs.properties.name) : e.crs && e.crs.type && (i = new t.Proj.CRS(e.crs.type + ":" + e.crs.properties.code)), void 0 !== i && (this.options.coordsToLatLng = function (e) { var n = t.point(e[0], e[1]); return i.projection.unproject(n) })), this._callLevel++; try { t.GeoJSON.prototype.addData.call(this, e) } finally { this._callLevel--, 0 === this._callLevel && delete this.options.coordsToLatLng } } }), t.Proj.geoJson = function (e, i) { return new t.Proj.GeoJSON(e, i) }, t.Proj.ImageOverlay = t.ImageOverlay.extend({ initialize: function (e, i, n) { t.ImageOverlay.prototype.initialize.call(this, e, null, n), this._projectedBounds = i }, _animateZoom: function (e) { var i = this._map.getZoomScale(e.zoom), n = t.point(this._projectedBounds.min.x, this._projectedBounds.max.y), o = this._projectedToNewLayerPoint(n, e.zoom, e.center); t.DomUtil.setTransform(this._image, o, i) }, _reset: function () { var e = this._map.getZoom(), i = this._map.getPixelOrigin(), n = t.bounds(this._transform(this._projectedBounds.min, e)._subtract(i), this._transform(this._projectedBounds.max, e)._subtract(i)), o = n.getSize(); t.DomUtil.setPosition(this._image, n.min), this._image.style.width = o.x + "px", this._image.style.height = o.y + "px" }, _projectedToNewLayerPoint: function (t, e, i) { var n = this._map.getSize()._divideBy(2), o = this._map.project(i, e)._subtract(n)._round().add(this._map._getMapPanePos()); return this._transform(t, e)._subtract(o) }, _transform: function (t, e) { var i = this._map.options.crs, n = i.transformation, o = i.scale(e); return n.transform(t, o) } }), t.Proj.imageOverlay = function (e, i, n) { return new t.Proj.ImageOverlay(e, i, n) }, t.Proj }) ? n.apply(e, o) : n) || (t.exports = s) }, function (t, e, i) { "use strict"; i.r(e); var n = { isLoaded: !1, get: function (t) { if ("" !== t && null != t) { var e = t.split(":"); if (2 === e.length) { var i = e[0], n = e[1]; if (this.hasOwnProperty(i) && this[i].hasOwnProperty(n)) return this[i][n] } } }, exist: function (t) { if ("" === t || null == t) return !1; var e = t.split(":"); if (2 !== e.length) return !1; var i = e[0], n = e[1]; return !!this.hasOwnProperty(i) && !!this[i].hasOwnProperty(n) }, load: function (t) { if (!this.isLoaded) { for (var e = ["IGNF", "EPSG", "CRS"], i = 0; i < e.length; i++) { var n = e[i], o = this[n]; for (var s in o) if (o.hasOwnProperty(s)) { var a = n + ":" + s; t.defs(a, this.get(a)) } } this.isLoaded = !0 } }, loadByDefault: function (t) { var e = { EPSG: { 2154: n.EPSG[2154], 27571: n.EPSG[27571], 27572: n.EPSG[27572], 27573: n.EPSG[27573], 27574: n.EPSG[27574] }, CRS: { 84: n.CRS[84] }, IGNF: { LAMB93: n.IGNF.LAMB93, LAMBE: n.IGNF.LAMBE, LAMB1: n.IGNF.LAMB1, LAMB2: n.IGNF.LAMB2, LAMB3: n.IGNF.LAMB3, LAMB4: n.IGNF.LAMB4, RGF93G: n.IGNF.RGF93G, WGS84G: n.IGNF.WGS84G } }; for (var i in e) if (e.hasOwnProperty(i)) { var o = e[i]; for (var s in o) if (o.hasOwnProperty(s)) { var a = i + ":" + s; t.defs(a, o[s]) } } }, loadByName: function (t, e) { if (!this.exist(e)) return !1; try { t.defs(e, this.get(e)) } catch (t) { return !1 } return !0 }, EPSG: { 4978: "+proj=geocent +datum=WGS84 +units=m +no_defs ", 3857: "+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs", 3785: "+title=WGS 84 / Pseudo-Mercator (deprecated) +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs", 4149: "+title=CH1903 +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs ", 4150: "+title=CH1903plus +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs ", 4151: "+title=CHTRF95 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ", 4171: "+title=RGF93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ", 4230: "+title=ED50 +proj=longlat +ellps=intl +no_defs ", 4235: "+title=Guyane Francaise +proj=longlat +ellps=intl +no_defs ", 4258: "+title=ETRS89 +proj=longlat +ellps=GRS80 +no_defs ", 4275: "+title=NTF +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +no_defs ", 4322: "+title=WGS 72 +proj=longlat +ellps=WGS72 +no_defs ", 4326: "+title=WGS 84 +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs ", 4467: "+proj=utm +zone=21 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 4470: "+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ", 4471: "+proj=utm +zone=38 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 4474: "+proj=utm +zone=38 +south +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +units=m +no_defs ", 4558: "+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ", 4559: "+proj=utm +zone=20 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 4621: "+title=Fort Marigot +proj=longlat +ellps=intl +towgs84=137,248,-430,0,0,0,0 +no_defs ", 4622: "+title=Guadeloupe 1948 +proj=longlat +ellps=intl +no_defs ", 4623: "+title=CSG67 +proj=longlat +ellps=intl +towgs84=-186,230,110,0,0,0,0 +no_defs ", 4624: "+title=RGFG95 +proj=longlat +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +no_defs ", 4625: "+title=Martinique 1938 +proj=longlat +ellps=intl +no_defs ", 4626: "+title=Reunion 1947 +proj=longlat +ellps=intl +no_defs ", 4627: "+title=RGR92 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ", 4628: "+title=Tahiti 52 +proj=longlat +ellps=intl +towgs84=162,117,154,0,0,0,0 +no_defs ", 4629: "+title=Tahaa 54 +proj=longlat +ellps=intl +no_defs ", 4630: "+title=IGN72 Nuku Hiva +proj=longlat +ellps=intl +no_defs ", 4632: "+title=Combani 1950 +proj=longlat +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +no_defs ", 4633: "+title=IGN56 Lifou +proj=longlat +ellps=intl +no_defs ", 4634: "+title=IGN72 Grand Terre +proj=longlat +ellps=intl +no_defs ", 4637: "+title=Perroud 1950 +proj=longlat +ellps=intl +towgs84=325,154,172,0,0,0,0 +no_defs ", 4638: "+title=Saint Pierre et Miquelon 1950 +proj=longlat +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +no_defs ", 4640: "+title=RRAF 1991 +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs ", 4641: "+title=IGN53 Mare +proj=longlat +ellps=intl +no_defs ", 4645: "+title=RGNC 1991 +proj=longlat +ellps=intl +towgs84=0,0,0,0,0,0,0 +no_defs ", 4687: "+proj=longlat +ellps=GRS80 +no_defs ", 4662: "+title=IGN72 Grande Terre +proj=longlat +ellps=intl +no_defs ", 4689: "+title=IGN63 Hiva Oa +proj=longlat +ellps=intl +no_defs ", 4690: "+title=Tahiti 79 +proj=longlat +ellps=intl +no_defs ", 4691: "+title=Moorea 87 +proj=longlat +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +no_defs ", 4692: "+title=Maupiti 83 +proj=longlat +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +no_defs ", 4698: "+title=IGN 1962 Kerguelen +proj=longlat +ellps=intl +towgs84=145,-187,103,0,0,0,0 +no_defs ", 4749: "+title=RGNC91-93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ", 4750: "+title=ST87 Ouvea +proj=longlat +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +no_defs ", 4807: "+title=NTF (Paris) +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +no_defs ", 2056: "+title=CH1903+ / LV95 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=2600000 +y_0=1200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs ", 2154: "+title=RGF93 / Lambert-93 +proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 2213: "+title=ETRS89 / TM 30 NE +proj=tmerc +lat_0=0 +lon_0=30 +k=0.9996 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs ", 2969: "+title=Fort Marigot / UTM zone 20N +proj=utm +zone=20 +ellps=intl +towgs84=137,248,-430,0,0,0,0 +units=m +no_defs ", 2970: "+title=Guadeloupe 1948 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs ", 2971: "+title=CSG67 / UTM zone 22N +proj=utm +zone=22 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs ", 2972: "+title=RGFG95 / UTM zone 22N +proj=utm +zone=22 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs ", 2973: "+title=Martinique 1938 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs ", 2975: "+title=RGR92 / UTM zone 40S +proj=utm +zone=40 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 2976: "+title=Tahiti 52 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=162,117,154,0,0,0,0 +units=m +no_defs ", 2977: "+title=Tahaa 54 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +units=m +no_defs ", 2978: "+title=IGN72 Nuku Hiva / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs ", 2980: "+title=Combani 1950 / UTM zone 38S +proj=utm +zone=38 +south +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +units=m +no_defs ", 2981: "+title=IGN56 Lifou / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ", 2982: "+title=IGN72 Grand Terre / UTM zone 58S (deprecated) +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ", 2984: "+title=RGNC 1991 / Lambert New Caledonia (deprecated) +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=intl +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 2986: "+title=Terre Adelie 1950 +proj=stere +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-90.000000000 +lon_0=140.000000000 +lat_ts=-67.000000000 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs", 2987: "+title=Saint Pierre et Miquelon 1950 / UTM zone 21N +proj=utm +zone=21 +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +units=m +no_defs ", 2989: "+title=RRAF 1991 / UTM zone 20N +proj=utm +zone=20 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 2990: "+title=Reunion 1947 / TM Reunion (deprecated) +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=50000 +y_0=160000 +ellps=intl +units=m +no_defs ", 2995: "+title=IGN53 Mare / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ", 3038: "+proj=utm +zone=26 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3039: "+proj=utm +zone=27 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3040: "+proj=utm +zone=28 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3041: "+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3045: "+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3046: "+proj=utm +zone=34 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3047: "+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3048: "+proj=utm +zone=36 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3049: "+proj=utm +zone=37 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3050: "+proj=utm +zone=38 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3051: "+proj=utm +zone=39 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3034: "+title=ETRS89 / ETRS-LCC +proj=lcc +lat_1=35 +lat_2=65 +lat_0=52 +lon_0=10 +x_0=4000000 +y_0=2800000 +ellps=GRS80 +units=m +no_defs ", 3035: "+title=ETRS89 / ETRS-LAEA +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs ", 3042: "+title=ETRS89 / ETRS-TM30 +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs ", 3043: "+title=ETRS89 / ETRS-TM31 +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs ", 3044: "+title=ETRS89 / ETRS-TM32 +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs ", 25828: "+proj=utm +zone=28 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 25829: "+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 25833: "+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 25834: "+proj=utm +zone=34 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 25835: "+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 25836: "+proj=utm +zone=36 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 25837: "+proj=utm +zone=37 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 25838: "+proj=utm +zone=38 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3060: "+title=IGN72 Grande Terre / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ", 3163: "+title=RGNC91-93 / Lambert New Caledonia +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3164: "+title=ST87 Ouvea / UTM zone 58S +proj=utm +zone=58 +south +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +units=m +no_defs ", 3165: "+title=NEA74 Noumea / Noumea Lambert +proj=lcc +lat_1=-22.24469175 +lat_2=-22.29469175 +lat_0=-22.26969175 +lon_0=166.44242575 +x_0=0.66 +y_0=1.02 +ellps=intl +units=m +no_defs ", 3166: "+title=NEA74 Noumea / Noumea Lambert 2 +proj=lcc +lat_1=-22.24472222222222 +lat_2=-22.29472222222222 +lat_0=-22.26972222222222 +lon_0=166.4425 +x_0=8.313000000000001 +y_0=-2.354 +ellps=intl +units=m +no_defs ", 3169: "+title=RGNC91-93 / UTM zone 57S +proj=utm +zone=57 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3170: "+title=RGNC91-93 / UTM zone 58S +proj=utm +zone=58 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3171: "+title=RGNC91-93 / UTM zone 59S +proj=utm +zone=59 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ", 3172: "+title=IGN53 Mare / UTM zone 59S +proj=utm +zone=59 +south +ellps=intl +units=m +no_defs ", 3296: "+title=RGPF / UTM zone 5S +proj=utm +zone=5 +south +ellps=GRS80 +units=m +no_defs ", 3297: "+title=RGPF / UTM zone 6S +proj=utm +zone=6 +south +ellps=GRS80 +units=m +no_defs ", 3298: "+title=RGPF / UTM zone 7S +proj=utm +zone=7 +south +ellps=GRS80 +units=m +no_defs ", 3299: "+title=RGPF / UTM zone 8S +proj=utm +zone=8 +south +ellps=GRS80 +units=m +no_defs ", 3302: "+title=IGN63 Hiva Oa / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs ", 3303: "+title=Fatu Iva 72 / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +towgs84=347.103,1078.12,2623.92,-33.8875,70.6773,-9.3943,186.074 +units=m +no_defs ", 3304: "+title=Tahiti 79 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +units=m +no_defs ", 3305: "+title=Moorea 87 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +units=m +no_defs ", 3306: "+title=Maupiti 83 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +units=m +no_defs ", 3312: "+title=CSG67 / UTM zone 21N +proj=utm +zone=21 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs ", 3313: "+title=RGFG95 / UTM zone 21N +proj=utm +zone=21 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs ", 3336: "+title=IGN 1962 Kerguelen / UTM zone 42S +proj=utm +zone=42 +south +ellps=intl +towgs84=145,-187,103,0,0,0,0 +units=m +no_defs ", 3395: "+title=WGS 84 / World Mercator +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 3727: "+title=Reunion 1947 / TM Reunion +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=160000 +y_0=50000 +ellps=intl +units=m +no_defs ", 21781: "+title=CH1903 / LV03 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs ", 25830: "+title=ETRS89 / UTM zone 30N +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs ", 25831: "+title=ETRS89 / UTM zone 31N +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs ", 25832: "+title=ETRS89 / UTM zone 32N +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs ", 27561: "+title=NTF (Paris) / Lambert Nord France +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27562: "+title=NTF (Paris) / Lambert Centre France +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27563: "+title=NTF (Paris) / Lambert Sud France +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27564: "+title=NTF (Paris) / Lambert Corse +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27571: "+title=NTF (Paris) / Lambert zone I +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27572: "+title=NTF (Paris) / Lambert zone II +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27573: "+title=NTF (Paris) / Lambert zone III +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27574: "+title=NTF (Paris) / Lambert zone IV +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27581: "+title=NTF (Paris) / France I (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27582: "+title=NTF (Paris) / France II (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27583: "+title=NTF (Paris) / France III (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27584: "+title=NTF (Paris) / France IV (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27591: "+title=NTF (Paris) / Nord France (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27592: "+title=NTF (Paris) / Centre France (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27593: "+title=NTF (Paris) / Sud France (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 27594: "+title=NTF (Paris) / Corse (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ", 32601: "+proj=utm +zone=1 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32602: "+proj=utm +zone=2 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32603: "+proj=utm +zone=3 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32604: "+proj=utm +zone=4 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32605: "+proj=utm +zone=5 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32606: "+proj=utm +zone=6 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32607: "+proj=utm +zone=7 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32608: "+proj=utm +zone=8 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32609: "+proj=utm +zone=9 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32610: "+proj=utm +zone=10 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32611: "+proj=utm +zone=11 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32612: "+proj=utm +zone=12 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32613: "+proj=utm +zone=13 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32614: "+proj=utm +zone=14 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32615: "+proj=utm +zone=15 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32616: "+proj=utm +zone=16 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32617: "+proj=utm +zone=17 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32618: "+proj=utm +zone=18 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32619: "+proj=utm +zone=19 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32620: "+proj=utm +zone=20 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32621: "+proj=utm +zone=21 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32622: "+proj=utm +zone=22 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32623: "+proj=utm +zone=23 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32624: "+proj=utm +zone=24 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32625: "+proj=utm +zone=25 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32626: "+proj=utm +zone=26 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32627: "+proj=utm +zone=27 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32628: "+proj=utm +zone=28 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32629: "+proj=utm +zone=29 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32630: "+proj=utm +zone=30 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32631: "+proj=utm +zone=31 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32632: "+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32633: "+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32634: "+proj=utm +zone=34 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32635: "+proj=utm +zone=35 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32636: "+proj=utm +zone=36 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32637: "+proj=utm +zone=37 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32638: "+proj=utm +zone=38 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32639: "+proj=utm +zone=39 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32640: "+proj=utm +zone=40 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32641: "+proj=utm +zone=41 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32642: "+proj=utm +zone=42 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32643: "+proj=utm +zone=43 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32644: "+proj=utm +zone=44 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32645: "+proj=utm +zone=45 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32646: "+proj=utm +zone=46 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32647: "+proj=utm +zone=47 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32648: "+proj=utm +zone=48 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32649: "+proj=utm +zone=49 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32650: "+proj=utm +zone=50 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32651: "+proj=utm +zone=51 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32652: "+proj=utm +zone=52 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32653: "+proj=utm +zone=53 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32654: "+proj=utm +zone=54 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32655: "+proj=utm +zone=55 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32656: "+proj=utm +zone=56 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32657: "+proj=utm +zone=57 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32658: "+proj=utm +zone=58 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32659: "+proj=utm +zone=59 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32660: "+proj=utm +zone=60 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32661: "+proj=stere +lat_0=90 +lat_ts=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32662: "+title=WGS 84 / Plate Carree +proj=eqc +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32701: "+proj=utm +zone=1 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32702: "+proj=utm +zone=2 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32703: "+proj=utm +zone=3 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32704: "+proj=utm +zone=4 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32705: "+proj=utm +zone=5 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32706: "+proj=utm +zone=6 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32707: "+proj=utm +zone=7 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32708: "+proj=utm +zone=8 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32709: "+proj=utm +zone=9 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32710: "+proj=utm +zone=10 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32711: "+proj=utm +zone=11 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32712: "+proj=utm +zone=12 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32713: "+proj=utm +zone=13 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32714: "+proj=utm +zone=14 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32715: "+proj=utm +zone=15 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32716: "+proj=utm +zone=16 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32717: "+proj=utm +zone=17 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32718: "+proj=utm +zone=18 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32719: "+proj=utm +zone=19 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32720: "+proj=utm +zone=20 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32721: "+proj=utm +zone=21 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32722: "+proj=utm +zone=22 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32723: "+proj=utm +zone=23 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32724: "+proj=utm +zone=24 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32725: "+proj=utm +zone=25 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32726: "+proj=utm +zone=26 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32727: "+proj=utm +zone=27 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32728: "+proj=utm +zone=28 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32729: "+proj=utm +zone=29 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32730: "+proj=utm +zone=30 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32731: "+proj=utm +zone=31 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32732: "+proj=utm +zone=32 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32733: "+proj=utm +zone=33 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32734: "+proj=utm +zone=34 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32735: "+proj=utm +zone=35 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32736: "+proj=utm +zone=36 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32737: "+proj=utm +zone=37 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32738: "+proj=utm +zone=38 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32739: "+proj=utm +zone=39 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32740: "+proj=utm +zone=40 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32741: "+proj=utm +zone=41 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32742: "+proj=utm +zone=42 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32743: "+proj=utm +zone=43 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32744: "+proj=utm +zone=44 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32745: "+proj=utm +zone=45 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32746: "+proj=utm +zone=46 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32747: "+proj=utm +zone=47 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32748: "+proj=utm +zone=48 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32749: "+proj=utm +zone=49 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32750: "+proj=utm +zone=50 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32751: "+proj=utm +zone=51 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32752: "+proj=utm +zone=52 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32753: "+proj=utm +zone=53 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32754: "+proj=utm +zone=54 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32755: "+proj=utm +zone=55 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32756: "+proj=utm +zone=56 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32757: "+proj=utm +zone=57 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32758: "+proj=utm +zone=58 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32759: "+proj=utm +zone=59 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32760: "+proj=utm +zone=60 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 32761: "+proj=stere +lat_0=-90 +lat_ts=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ", 310024802: "+title=Geoportail - France metropolitaine +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=46.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310915814: "+title=Geoportail - Antilles francaises +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310486805: "+title=Geoportail - Guyane +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=4.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310700806: "+title=Geoportail - Reunion et dependances +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-21.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310702807: "+title=Geoportail - Mayotte +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-12.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310706808: "+title=Geoportail - Saint-Pierre et Miquelon +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=47.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310547809: "+title=Geoportail - Nouvelle-Caledonie +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-22.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310642810: "+title=Geoportail - Wallis et Futuna +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-14.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310032811: "+title=Geoportail - Polynesie francaise +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310642812: "+title=Geoportail - Kerguelen +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-49.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310642801: "+title=Geoportail - Crozet +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-46.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310642813: "+title=Geoportail - Amsterdam et Saint-Paul +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 310642901: "+title=Geoportail - Monde +proj=mill +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lon_0=0.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", 5489: "+title=RGAF09 geographiques (dms) +proj=longlat +nadgrids=@null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137 +rf=298.257222101 +units=m +no_defs", 5490: "+title=RGAF09 UTM Nord Fuseau 20 +proj=tmerc +nadgrids=@null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137 +rf=298.257222101 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs" }, CRS: { 84: "+title=WGS 84 longitude-latitude +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs " }, IGNF: { AMST63: "+title=Amsterdam 1963 +proj=geocent +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", CROZ63: "+title=Crozet 1963 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", CSG67: "+title=Guyane CSG67 +proj=geocent +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", ED50: "+title=ED50 +proj=geocent +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", ETRS89: "+title=Systeme de reference terrestre Europeen (1989) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", GUAD48: "+title=Guadeloupe Ste Anne +proj=geocent +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", GUADFM49: "+title=Guadeloupe Fort Marigot +proj=geocent +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", IGN63: "+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=geocent +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", IGN72: "+title=IGN 1972 Grande-Terre / Ile des Pins +proj=geocent +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", KERG62CAR: "+title=Kerguelen - K0 +proj=geocent +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", MART38: "+title=Martinique Fort-Desaix +proj=geocent +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", MAYO50: "+title=Mayotte Combani +proj=geocent +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", MOOREA87: "+title=Moorea 1987 +proj=geocent +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", NTF: "+title=Nouvelle Triangulation Francaise +proj=geocent +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs", NUKU72: "+title=IGN 1972 Nuku Hiva +proj=geocent +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", REUN47: "+title=Reunion 1947 +proj=geocent +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", RGF93: "+title=Reseau geodesique francais 1993 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGFG95: "+title=Reseau geodesique francais de Guyane 1995 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGM04: "+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGNC: "+title=Reseau Geodesique de Nouvelle-Caledonie +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGPF: "+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGR92: "+title=Reseau geodesique Reunion 1992 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGSPM06: "+title=Reseau Geodesique Saint-Pierre-et-Miquelon (2006) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGTAAF07: "+title=Reseau Geodesique des TAAF (2007) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RRAF91: "+title=RRAF 1991 (Reseau de Reference des Antilles Francaises) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", STPL69: "+title=Saint-Paul 1969 +proj=geocent +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", STPM50: "+title=St Pierre et Miquelon 1950 +proj=geocent +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs", TAHAA: "+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=geocent +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", TAHI79: "+title=IGN79 (Tahiti) Iles de la Societe +proj=geocent +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", TERA50: "+title=Pointe Geologie - Perroud 1950 +proj=geocent +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", WALL78: "+title=Wallis-Uvea 1978 (MOP78) +proj=geocent +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", WGS72: "+title=World Geodetic System 1972 +proj=geocent +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs", WGS84: "+title=World Geodetic System 1984 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", AMST63GEO: "+title=Amsterdam 1963 +proj=longlat +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", CROZ63GEO: "+title=Crozet 1963 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", CSG67GEO: "+title=Guyane CSG67 +proj=longlat +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", ED50G: "+title=ED50 +proj=longlat +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", GUAD48GEO: "+title=Guadeloupe Ste Anne +proj=longlat +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", GUADFM49GEO: "+title=Guadeloupe Fort Marigot +proj=longlat +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", IGN63GEO: "+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=longlat +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", IGN72GEO: "+title=IGN 1972 Grande-Terre / Ile des Pins +proj=longlat +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", KERG62GEO: "+title=Kerguelen - K0 +proj=longlat +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", MART38GEO: "+title=Martinique Fort-Desaix +proj=longlat +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", MAYO50GEO: "+title=Mayotte Combani +proj=longlat +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", MOOREA87GEO: "+title=Moorea 1987 +proj=longlat +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", NTFG: "+title=Nouvelle Triangulation Francaise Greenwich degres sexagesimaux +proj=longlat +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs", NTFP: "+title=Nouvelle Triangulation Francaise Paris grades +proj=longlat +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +units=m +no_defs", NUKU72GEO: "+title=IGN 1972 Nuku Hiva +proj=longlat +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", REUN47GEO: "+title=Reunion 1947 +proj=longlat +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", RGF93G: "+title=Reseau geodesique francais 1993 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGFG95GEO: "+title=Reseau geodesique francais de Guyane 1995 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGM04GEO: "+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGNCGEO: "+title=Reseau Geodesique de Nouvelle-Caledonie +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGPFGEO: "+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGR92GEO: "+title=Reseau geodesique de la Reunion 1992 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGSPM06GEO: "+title=Saint-Pierre-et-Miquelon (2006) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", RGTAAF07G: "+title=Reseau Geodesique des TAAF (2007) (dms) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", STPL69GEO: "+title=Saint-Paul 1969 +proj=longlat +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", STPM50GEO: "+title=St Pierre et Miquelon 1950  +proj=longlat +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs", TAHAAGEO: "+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=longlat +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", TAHI79GEO: "+title=IGN79 (Tahiti) Iles de la Societe +proj=longlat +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", TERA50G: "+title=Pointe Geologie - Perroud 1950 +proj=longlat +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", WALL78GEO: "+title=Wallis - Uvea 1978 (MOP78) +proj=longlat +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs", WGS72G: "+title=WGS72 +proj=longlat +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs", WGS84G: "+title=World Geodetic System 1984 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", WGS84RRAFGEO: "+title=Reseau de reference des Antilles francaises (1988-1991) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", XGEO: "+title=Systeme CIO-BIH +proj=longlat +towgs84=0.0000,0.0000,0.5000,0.0000,0.0000,0.0140,-0.100000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", AMST63UTM43S: "+title=Amsterdam 1963 UTM fuseau 43 Sud +proj=tmerc +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", CROZ63UTM39S: "+title=Crozet 1963 +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", CSG67UTM21: "+title=Guyane CSG67 UTM fuseau 21 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", CSG67UTM22: "+title=Guyane CSG67 UTM fuseau 22 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", GEOPORTALANF: "+title=Geoportail - Antilles francaises +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALASP: "+title=Geoportail - Amsterdam et Saint-Paul +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALCRZ: "+title=Geoportail - Crozet +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-46.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALFXX: "+title=Geoportail - France metropolitaine +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=46.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALGUF: "+title=Geoportail - Guyane +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=4.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALKER: "+title=Geoportail - Kerguelen +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-49.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALMYT: "+title=Geoportail - Mayotte +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-12.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALNCL: "+title=Geoportail - Nouvelle-Caledonie +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-22.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALPYF: "+title=Geoportail - Polynesie francaise +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALREU: "+title=Geoportail - Reunion et dependances +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-21.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALSPM: "+title=Geoportail - Saint-Pierre et Miquelon +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=47.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GEOPORTALWLF: "+title=Geoportail - Wallis et Futuna +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-14.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", GUAD48UTM20: "+title=Guadeloupe Ste Anne +proj=tmerc +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", GUADFM49U20: "+title=Guadeloupe Fort Marigot  +proj=tmerc +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", IGN63UTM7S: "+title=IGN 1963 - Hiva Oa, Tahuata, Mohotani - UTM fuseau 7 Sud +proj=tmerc +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", IGN72UTM58S: "+title=IGN 1972 - UTM fuseau 58 Sud +proj=tmerc +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", KERG62UTM42S: "+title=Kerguelen 1962 +proj=tmerc +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", LAMB1: "+title=Lambert I +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs", LAMB1C: "+title=Lambert I Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=1200000.000 +units=m +no_defs", LAMB2: "+title=Lambert II +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs", LAMB2C: "+title=Lambert II Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs", LAMB3: "+title=Lambert III +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs", LAMB3C: "+title=Lambert III Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=3200000.000 +units=m +no_defs", LAMB4: "+title=Lambert IV +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=185861.369 +units=m +no_defs", LAMB4C: "+title=Lambert IV Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=4185861.369 +units=m +no_defs", LAMB93: "+title=Lambert 93 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.500000000 +lon_0=3.000000000 +lat_1=44.000000000 +lat_2=49.000000000 +x_0=700000.000 +y_0=6600000.000 +units=m +no_defs", RGF93CC42: "+title=Lambert conique conforme Zone 1 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=42.000000000 +lon_0=3.000000000 +lat_1=41.200000000 +lat_2=42.800000000 +x_0=1700000.000 +y_0=1200000.000 +units=m +no_defs", RGF93CC43: "+title=Lambert conique conforme Zone 2 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=43.000000000 +lon_0=3.000000000 +lat_1=42.200000000 +lat_2=43.800000000 +x_0=1700000.000 +y_0=2200000.000 +units=m +no_defs", RGF93CC44: "+title=Lambert conique conforme Zone 3 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=44.000000000 +lon_0=3.000000000 +lat_1=43.200000000 +lat_2=44.800000000 +x_0=1700000.000 +y_0=3200000.000 +units=m +no_defs", RGF93CC45: "+title=Lambert conique conforme Zone 4 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=45.000000000 +lon_0=3.000000000 +lat_1=44.200000000 +lat_2=45.800000000 +x_0=1700000.000 +y_0=4200000.000 +units=m +no_defs", RGF93CC46: "+title=Lambert conique conforme Zone 5 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.000000000 +lon_0=3.000000000 +lat_1=45.200000000 +lat_2=46.800000000 +x_0=1700000.000 +y_0=5200000.000 +units=m +no_defs", RGF93CC47: "+title=Lambert conique conforme Zone 6 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=47.000000000 +lon_0=3.000000000 +lat_1=46.200000000 +lat_2=47.800000000 +x_0=1700000.000 +y_0=6200000.000 +units=m +no_defs", RGF93CC48: "+title=Lambert conique conforme Zone 7 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=48.000000000 +lon_0=3.000000000 +lat_1=47.200000000 +lat_2=48.800000000 +x_0=1700000.000 +y_0=7200000.000 +units=m +no_defs", RGF93CC49: "+title=Lambert conique conforme Zone 8 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=49.000000000 +lon_0=3.000000000 +lat_1=48.200000000 +lat_2=49.800000000 +x_0=1700000.000 +y_0=8200000.000 +units=m +no_defs", RGF93CC50: "+title=Lambert conique conforme Zone 9 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=50.000000000 +lon_0=3.000000000 +lat_1=49.200000000 +lat_2=50.800000000 +x_0=1700000.000 +y_0=9200000.000 +units=m +no_defs", LAMBE: "+title=Lambert II etendu +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs", MART38UTM20: "+title=Martinique Fort-Desaix +proj=tmerc +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", MAYO50UTM38S: "+title=Mayotte Combani +proj=tmerc +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", MILLER: "+title=Geoportail - Monde +proj=mill +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lon_0=0.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs", MOOREA87U6S: "+title=Moorea 1987 - UTM fuseau 6 Sud +proj=tmerc +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", NUKU72U7S: "+title=IGN 1972 Nuku Hiva - UTM fuseau 7 Sud +proj=tmerc +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", RGM04UTM38S: "+title=UTM fuseau 38 Sud (Reseau Geodesique de Mayotte 2004) +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", RGNCUTM57S: "+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 57 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=159.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", RGNCUTM58S: "+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 58 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", RGNCUTM59S: "+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 59 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=171.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", RGPFUTM5S: "+title=RGPF - UTM fuseau 5 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", RGPFUTM6S: "+title=RGPF - UTM fuseau 6 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", RGPFUTM7S: "+title=RGPF - UTM fuseau 7 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", RGR92UTM40S: "+title=RGR92 UTM fuseau 40 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", RGSPM06U21: "+title=Saint-Pierre-et-Miquelon (2006) UTM Fuseau 21 Nord +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", STPL69UTM43S: "+title=Saint-Paul 1969 UTM fuseau 43 Sud +proj=tmerc +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", STPM50UTM21: "+title=St Pierre et Miquelon 1950 +proj=tmerc +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", TAHAAUTM05S: "+title=Tahaa 1951 +proj=tmerc +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", TAHI51UTM06S: "+title=Tahiti-Terme Nord UTM fuseau 6 Sud +proj=tmerc +towgs84=162.0000,117.0000,154.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", TAHI79UTM6S: "+title=Tahiti 1979 +proj=tmerc +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", TERA50STEREO: "+title=Terre Adelie 1950 +proj=stere +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-90.000000000 +lon_0=140.000000000 +lat_ts=-67 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs", UTM01SW84: "+title=World Geodetic System 1984 UTM fuseau 01 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", UTM20W84GUAD: "+title=World Geodetic System 1984 UTM fuseau 20 Nord-Guadeloupe +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM20W84MART: "+title=World Geodetic System 1984 UTM fuseau 20 Nord-Martinique +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM22RGFG95: "+title=RGFG95 UTM fuseau 22 Nord-Guyane +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM39SW84: "+title=World Geodetic System 1984 UTM fuseau 39 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", UTM42SW84: "+title=World Geodetic System 1984 UTM fuseau 42 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", UTM43SW84: "+title=World Geodetic System 1984 UTM fuseau 43 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", WALL78UTM1S: "+title=Wallis-Uvea 1978 (MOP78) UTM 1 SUD +proj=tmerc +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs", ETRS89GEO: "+title=ETRS89 geographiques (dms) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs", ETRS89LAEA: "+title=ETRS89 Lambert Azimutal Equal Area +proj=laea +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=52.000000000 +lon_0=10.000000000 +x_0=4321000.000 +y_0=3210000.000 +units=m +no_defs", ETRS89LCC: "+title=ETRS89 Lambert Conformal Conic +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=52.000000000 +lon_0=9.999999995 +lat_1=35.000000000 +lat_2=65.000000000 +x_0=4000000.000 +y_0=2800000.000 +units=m +no_defs", UTM26ETRS89: "+title=Europe - de 30d a 24d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-27.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM27ETRS89: "+title=Europe - de 24d a 18d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-21.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM28ETRS89: "+title=Europe - de 18d a 12d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-15.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM29ETRS89: "+title=Europe - de 12d a 6d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-9.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM30ETRS89: "+title=Europe - de -6d a 0d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-3.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM31ETRS89: "+title=Europe - de 0d a 6d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=3.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM32ETRS89: "+title=Europe - de 6d a 12d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=9.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM33ETRS89: "+title=Europe - de 12d a 18d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=15.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM34ETRS89: "+title=Europe - de 18d a 24d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=21.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM35ETRS89: "+title=Europe - de 24d a 30d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=27.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM36ETRS89: "+title=Europe - de 30d a 36d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=33.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM37ETRS89: "+title=Europe - de 36d a 42d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=39.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs", UTM38ETRS89: "+title=Europe - de 42d a 48d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs" } }; e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(2), o = i.n(n), s = i(132), a = i(145), r = { instance: null, build: function () { if (!this.instance) { var t = new o.a.Proj.CRS("EPSG:2154", a.default.get("EPSG:2154"), { resolutions: this._getResolutions(), origin: this._getOrigin() }); this.instance = t } return this.instance }, _getResolutions: function () { var t = []; s.default.isConfigLoaded() && (t = s.default.getTileMatrix("LAMB93").nativeResolutions); return t.length ? t : [104579.22454989408, 52277.53235379051, 26135.487078595408, 13066.891381800004, 6533.228604113456, 3266.5595244626675, 1633.2660045974187, 816.6295549860224, 408.31391467683596, 204.15674151090204, 102.07831678324082, 51.0391448966112, 25.519569074269395, 12.759783693647506, 6.379891635966491, 3.18994576530532, 1.5949728694977277, .7974864315474559, .398743214900604, .19937160727567999, .099685803696052, .049842901818919996] }, _getOrigin: function () { return [0, 12e6] } }; e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = i(2), o = i.n(n), s = i(132), a = i(145), r = { instance: null, build: function () { if (!this.instance) { var t = new o.a.Proj.CRS("EPSG:27572", a.default.get("EPSG:27572"), { resolutions: this._getResolutions(), origin: this._getOrigin() }); this.instance = t } return this.instance }, _getResolutions: function () { var t = []; if (s.default.isConfigLoaded()) { var e = s.default.getTileMatrix("LAMB2E"); e && Object.keys(e).length && (t = e.nativeResolutions) } return t.length ? t : [104579.22454989408, 52277.53235379051, 26135.487078595408, 13066.891381800004, 6533.228604113456, 3266.5595244626675, 1633.2660045974187, 816.6295549860224, 408.31391467683596, 204.15674151090204, 102.07831678324082, 51.0391448966112, 25.519569074269395, 12.759783693647506, 6.379891635966491, 3.18994576530532, 1.5949728694977277, .7974864315474559, .398743214900604, .19937160727567999, .099685803696052, .049842901818919996] }, _getOrigin: function () { return [0, 12e6] } }; e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = i(2), o = i.n(n), s = i(132), a = i(145), r = { instance: null, build: function () { if (!this.instance) { var t = new o.a.Proj.CRS("EPSG:4326", a.default.get("EPSG:4326"), { resolutions: this._getResolutions(), origin: [-180, 90] }); this.instance = t } return this.instance }, _getResolutions: function () { var t = []; return s.default.isConfigLoaded() && (t = s.default.getResolutions()), t.length ? t : [1.40625, .703125, .3515625, .17578125, .087890625, .0439453125, .02197265625, .010986328125, .0054931640625, .00274658203125, .001373291015625, .0006866455078125, .00034332275390625, .000171661376953126, 858306884765628e-19, 429153442382813e-19, 214576721191407e-19, 107288360595703e-19, 536441802978517e-20, 268220901489259e-20, 13411045074463e-19, 6.70552253723145e-7, 3.3527612686157e-7] }, _getOrigin: function () { } }; e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = i(40), o = i(2), s = i.n(o), a = (i(150), i(34)), r = i(131), l = i(36), c = i(136), u = i(151), h = a.default.getLogger("reversegeocoding"), d = s.a.Control.extend({ includes: u.default, options: { position: "bottomleft", collapsed: !0, resources: ["StreetAddress", "PositionOfInterest"], delimitations: ["Point", "Circle", "Extent"], reverseGeocodeOptions: {} }, initialize: function (t) { s.a.Util.extend(this.options, t), this._noRightManagement = !1, this._servicesRightManagement = {}, this._checkRightsManagement(), this._checkInputOptions(), this._uid = l.default.generate(), this._currentGeocodingType = null, this._initGeocodingType(), this._currentGeocodingDelimitation = null, this._initGeocodingDelimitation(), this._showReverseGeocodingContainer = null, this._panelHeaderContainer = null, this._panelTitleContainer = null, this._returnPictoContainer = null, this._formContainer = null, this._resultsContainer = null, this._resultsListContainer = null, this._waitingContainer = null, this._inputFeaturesLayer = null, this._inputResultsLayer = null, this._lastIdLayer = 0, this._currentIdLayer = 0, this._currentFeature = null, this._requestPosition = null, this._requestCircleFilter = null, this._requestBboxFilter = null, this._waiting = !1, this._timer = null, this._reverseGeocodingLocations = [] }, onAdd: function (t) { var e = this._container = this._initLayout(); return s.a.DomEvent.disableClickPropagation(e).disableScrollPropagation(e), t && (this.options.collapsed || this._activateMapInteraction(t)), e }, onRemove: function (t) { this._clearLocations(), this._clearLocationsFeature(t), this._clearInputRequest(), this._removeMapInteraction(t) }, _checkRightsManagement: function () { var t, e, i = []; t = this.options.reverseGeocodeOptions.apiKey, (i = (e = this.options.reverseGeocodeOptions.filterOptions) ? e.type : []) && 0 !== i.length || (i = this.options.resources), i && 0 !== i.length || (i = ["StreetAddress", "PositionOfInterest"]); var n = r.default.check({ key: t || this.options.apiKey, resources: i, services: ["Geocode"] }); h.log("rightManagementGeocode", n), n ? (this.options.apiKey || (this.options.apiKey = n.key), this._servicesRightManagement.Geocode = n.Geocode) : this._noRightManagement = !0 }, _checkInputOptions: function () { var t; if (this.options.resources) { var e = this.options.resources; if (Array.isArray(e)) { var i = ["StreetAddress", "PositionOfInterest", "CadastralParcel", "Administratif"]; for (t = 0; t < e.length; t++)-1 === i.indexOf(e[t]) && h.log("[ReverseGeocoding] options.resources : " + e[t] + " is not a resource for reverse geocode") } else h.log("[ReverseGeocoding] 'options.resources' parameter should be an array"), e = null } if (this.options.delimitations) { var n = this.options.delimitations; if (Array.isArray(n)) { var o = ["Circle", "Point", "Extent"]; for (t = 0; t < n.length; t++)-1 === o.indexOf(n[t]) && h.log("[ReverseGeocoding] options.delimitations : " + n[t] + " is not a delimitation for reverse geocode") } else h.log("[ReverseGeocoding] 'options.delimitations' parameter should be an array"), n = null } }, _initGeocodingType: function () { this._currentGeocodingType = "StreetAddress"; var t = this.options.resources; if (t && 0 !== t.length || (this.options.resources = ["StreetAddress", "PositionOfInterest", "CadastralParcel"]), Array.isArray(t) && t.length) { for (var e = [], i = 0; i < t.length; i++)this._servicesRightManagement.Geocode.indexOf(t[i]) < 0 && (e.push(i), h.log("[ReverseGeocode] no rights for options.resources : " + t[i])); if (0 !== e.length) for (var n = 0; n < e.length; n++)t.splice(e[n], 1); "StreetAddress" !== t[0] && "PositionOfInterest" !== t[0] && "CadastralParcel" !== t[0] && "Administratif" !== t[0] || (this._currentGeocodingType = t[0]) } var o = this.options.reverseGeocodeOptions; o.filterOptions && Array.isArray(o.filterOptions.type) && 0 !== o.filterOptions.type.length && (this._currentGeocodingType = o.filterOptions.type[0]) }, _initGeocodingDelimitation: function () { this._currentGeocodingDelimitation = "Point"; var t = this.options.delimitations; if (t && 0 !== t.length || (this.options.delimitations = ["Point", "Circle", "Extent"]), Array.isArray(t) && t.length) { var e = t[0].toLowerCase(); "point" !== e && "circle" !== e && "extent" !== e || (this._currentGeocodingDelimitation = t[0]) } }, _initLayout: function () { var t = this._createMainContainerElement(), e = this._showReverseGeocodingContainer = this._createShowReverseGeocodingElement(); t.appendChild(e), this.options.collapsed || (e.checked = !0); var i = this._createShowReverseGeocodingPictoElement(); t.appendChild(i); var n = this._createReverseGeocodingPanelElement(), o = this._panelHeaderContainer = this._createReverseGeocodingPanelHeaderElement(), s = this._returnPictoContainer = this._createReverseGeocodingPanelReturnPictoElement(); o.appendChild(s); var a = this._panelTitleContainer = this._createReverseGeocodingPanelTitleElement(); o.appendChild(a); var r = this._createReverseGeocodingPanelCloseElement(); o.appendChild(r), n.appendChild(o); var l = this._formContainer = this._createReverseGeocodingPanelFormElement(); l.appendChild(this._createReverseGeocodingFormModeChoiceGeocodingTypeElement(this.options.resources)), l.appendChild(this._createReverseGeocodingFormModeChoiceGeocodingDelimitationElement(this.options.delimitations)); var c = this._createReverseGeocodingSubmitFormElement(); l.appendChild(c), n.appendChild(l); var u = this._waitingContainer = this._createReverseGeocodingWaitingElement(); n.appendChild(u); var d = this._resultsContainer = this._createReverseGeocodingResultsPanelElement(), p = this._resultsListContainer = this._createReverseGeocodingResultsListElement(); return d.appendChild(p), n.appendChild(d), t.appendChild(n), h.log(t), t }, _activateMapInteraction: function (t) { if (h.info("_activateMapInteraction()"), null === this._inputFeaturesLayer) { this._inputFeaturesLayer = new s.a.FeatureGroup, t.addLayer(this._inputFeaturesLayer); var e = this; t.on("draw:created", (function (t) { var i = t.layer, n = t.layerType; h.trace("draw:created"), e._setFeaturePosition(i, n), e._currentIdLayer = s.a.Util.stamp(i), e._setFeatureLayer(i) })), t.on("draw:drawstart", (function () { h.trace("draw:drawstart"), e._removeFeatureLayer(e._lastIdLayer), e._lastIdLayer = e._currentIdLayer })), t.on("draw:drawstop", (function () { h.trace("draw:drawstop") })) } switch (this._currentGeocodingDelimitation.toLowerCase()) { case "point": this._activatePointInteraction(t); break; case "circle": this._activateCircleInteraction(t); break; case "extent": this._activateBoxInteraction(t) } }, _removeMapInteraction: function (t) { t && (null !== this._inputFeaturesLayer && (t.off("draw:created"), t.off("draw:drawstart"), t.off("draw:drawstop"), t.removeLayer(this._inputFeaturesLayer), this._inputFeaturesLayer = null), this._lastIdLayer = this._currentIdLayer = 0, this._currentFeature && this._currentFeature.disable()) }, _activatePointInteraction: function (t) { h.info("_activatePointInteraction()"), this._currentFeature && this._currentFeature.disable(), s.a.drawLocal.draw.handlers.marker.tooltip.start = "click map to place search point"; this._currentFeature = new s.a.Draw.Marker(t, { repeatMode: !0 }), this._currentFeature.enable() }, _activateCircleInteraction: function (t) { h.info("_activateCircleInteraction()"), this._currentFeature && this._currentFeature.disable(); this._currentFeature = new s.a.Draw.Circle(t, { repeatMode: !0 }), this._currentFeature.enable() }, _activateBoxInteraction: function (t) { h.info("_activateBoxInteraction()"), this._currentFeature && this._currentFeature.disable(); this._currentFeature = new s.a.Draw.Rectangle(t, { repeatMode: !0 }), this._currentFeature.enable() }, _setFeaturePosition: function (t, e) { var i = null; if ("marker" === e) i = t.getLatLng(), this._requestPosition = { x: i.lat, y: i.lng }; else if ("circle" === e) i = t.getLatLng(), this._requestPosition = { x: i.lat, y: i.lng }, this._requestCircleFilter = { x: i.lat, y: i.lng, radius: t.getRadius() }; else if ("rectangle" === e) { var n = { lng: ((i = t.getBounds()).getSouthWest().lng + i.getNorthEast().lng) / 2, lat: (i.getSouthWest().lat + i.getNorthEast().lat) / 2 }; this._requestPosition = { x: n.lat, y: n.lng }, this._requestBboxFilter = { left: i.getSouthWest().lat, right: i.getNorthEast().lat, bottom: i.getSouthWest().lng, top: i.getNorthEast().lng } } else h.warn("type gemetric not defined !?"); h.log(i) }, _setFeatureLayer: function (t) { this._inputFeaturesLayer && this._inputFeaturesLayer.addLayer(t) }, _removeFeatureLayer: function (t) { this._inputFeaturesLayer && 0 !== t && (t ? this._inputFeaturesLayer.removeLayer(t) : this._inputFeaturesLayer.clearLayers()) }, _reverseGeocodingRequest: function (t) { var e = this._map; this._removeMapInteraction(e); var i = {}; s.a.Util.extend(i, this.options.reverseGeocodeOptions), s.a.Util.extend(i, t), s.a.Util.extend(i, { apiKey: this.options.apiKey, ssl: this.options.ssl, srs: "EPSG:4326", returnFreeForm: !1, timeOut: 3e4, protocol: "XHR" }); var o = i.filterOptions.type; "circle" === this._currentGeocodingDelimitation.toLowerCase() && this._requestCircleFilter && (this._requestCircleFilter.radius > 1e3 && (h.log("INFO : initial circle radius (" + this._requestCircleFilter.radius + ") limited to 1000m."), this._requestCircleFilter.radius = 1e3), s.a.Util.extend(i, { filterOptions: { type: o, circle: this._requestCircleFilter } })), "extent" === this._currentGeocodingDelimitation.toLowerCase() && this._requestBboxFilter && s.a.Util.extend(i, { filterOptions: { type: o, bbox: this._requestBboxFilter } }), h.log("reverseGeocode request options : ", i), this._displayWaitingContainer(), n.default.Services.reverseGeocode(i) }, _displayGeocodedLocations: function (t) { var e = this._map; this._clearLocations(), this._clearLocationsFeature(e), this._reverseGeocodingLocations = t, t && 0 !== t.length ? (this._formContainer.className = "GPreverseGeocodingComponentHidden", this._hideWaitingContainer(), this._panelTitleContainer.innerHTML = "Résultats de la recherche", this._returnPictoContainer.className = "", this._resultsContainer.className = "GPpanel", this._fillGeocodedLocationListContainer(t), this._displayGeocodedLocationsOnMap(t), e.fitBounds(this._inputResultsLayer.getBounds())) : this._clearInputRequest() }, _fillGeocodedLocationListContainer: function (t) { for (var e = 0; e < t.length; e++) { var i = t[e]; h.log(i); var n = this._fillGeocodedLocationDescription(i); 0 !== n.length && this._createReverseGeocodingResultElement(n, e) } }, _fillGeocodedLocationDescription: function (t) { if (t && t.placeAttributes) { var e = t.placeAttributes, i = ""; switch (t.type) { case "StreetAddress": e.street && (i += e.number ? e.number + " " : "", i += e.street + ", "), i += e.postalCode + " " + e.commune; break; case "PositionOfInterest": "City" === t.matchType && e.commune ? (i += e.commune, i += e.postalCode ? ", " + e.postalCode : "") : "Département" === t.matchType && e.municipality ? (i += e.municipality, i += e.postalCode ? ", " + e.postalCode : "") : "Toponym" === t.matchType && e.municipality ? (i += e.municipality, i += e.postalCode ? ", " + e.postalCode : "", i += e.commune ? " " + e.commune : "") : i += e.municipality ? e.municipality : "", i += e.nature ? " (" + e.nature + ") " : ""; break; case "CadastralParcel": i += e.cadastralParcel ? e.cadastralParcel : "", i += e.municipality ? " (" + e.municipality + ")" : ""; break; case "Administratif": i += e.municipality ? e.municipality : "", e.inseeDepartment ? i += "(Département)" : e.inseeRegion && (i += "(Région)"); break; default: i += e.municipality ? e.municipality : "" }return i } }, _displayGeocodedLocationsOnMap: function (t) { var e = this._map, i = this; function n(t) { var e = t.target; e.setIcon(new c.default("red")); var n = s.a.DomUtil.get("ReverseGeocodedLocation_" + e.options.id + "-" + i._uid); s.a.DomUtil.addClass(n, "GPreverseGeocodedLocationHighlight"), n.scrollIntoView(!1) } function o(t) { var e = t.target; e.setIcon(new c.default("green")); var n = s.a.DomUtil.get("ReverseGeocodedLocation_" + e.options.id + "-" + i._uid); s.a.DomUtil.removeClass(n, "GPreverseGeocodedLocationHighlight") } this._inputResultsLayer = new s.a.FeatureGroup, e.addLayer(this._inputResultsLayer); for (var a = 0; a < t.length; a++) { var r = t[a]; if (r) { var l = { id: a, icon: new c.default("green"), riseOnHover: !0, draggable: !1, clickable: !0, zIndexOffset: 1e3 }, u = s.a.marker(s.a.latLng(r.position.x, r.position.y), l), h = "<ul>", d = r.placeAttributes; for (var p in d) d.hasOwnProperty(p) && "bbox" !== p && (h += "<li>", h += '<span class="gp-attname-others-span">' + p.toUpperCase() + " : </span>", h += d[p], h += " </li>"); h += " </ul>", u.bindPopup(h), u.on("mouseover", n), u.on("mouseout", o), this._inputResultsLayer.addLayer(u) } } }, onShowReverseGeocodingClick: function () { var t = this._map; this._showReverseGeocodingContainer.checked ? this._removeMapInteraction(t) : this._waiting || this._reverseGeocodingLocations.length || this._activateMapInteraction(t) }, onReverseGeocodingTypeChange: function (t) { var e = t.target.selectedIndex, i = t.target.options[e].value; i && (h.log(i), this._currentGeocodingType = i) }, onReverseGeocodingDelimitationChange: function (t) { var e = t.target.selectedIndex, i = t.target.options[e].value; if (i) { h.log(i), this._currentGeocodingDelimitation = i, this._clearInputRequest(); var n = this._map; this._removeMapInteraction(n), this._activateMapInteraction(n) } }, onGPreverseGeocodingReturnPictoClick: function () { var t = this._map; this._clearLocations(), this._clearLocationsFeature(t), this._clearInputRequest(), this._activateMapInteraction(t) }, onReverseGeocodingSubmit: function () { if (this._requestPosition) { if (!this._noRightManagement) { var t = this._map, e = this; this._reverseGeocodingRequest({ position: e._requestPosition, filterOptions: { type: [e._currentGeocodingType] }, onSuccess: function (t) { if (h.log(t), t) { var i = t.locations; e._displayGeocodedLocations(i), e._hideWaitingContainer() } }, onFailure: function (i) { e._hideWaitingContainer(), e._clearLocations(), e._clearLocationsFeature(t), e._clearInputRequest(), h.log(i.message) } }) } } else h.log("missing position") }, onReverseGeocodingResultClick: function (t) { h.log("onReverseGeocodingResultClick", t) }, onReverseGeocodingResultMouseOver: function (t) { var e = l.default.index(t.target.id); t.target.classList && t.target.classList.add("GPreverseGeocodedLocationHighlight"), this._inputResultsLayer && this._inputResultsLayer.eachLayer((function (t) { t.options.id === parseInt(e, 10) && t.fire("mouseover") })) }, onReverseGeocodingResultMouseOut: function (t) { var e = l.default.index(t.target.id); t.target.classList && t.target.classList.remove("GPreverseGeocodedLocationHighlight"), this._inputResultsLayer && this._inputResultsLayer.eachLayer((function (t) { t.options.id === parseInt(e, 10) && t.fire("mouseout") })) }, _clearLocations: function () { if (this._reverseGeocodingLocations = [], this._resultsListContainer) for (; this._resultsListContainer.firstChild;)this._resultsListContainer.removeChild(this._resultsListContainer.firstChild) }, _clearLocationsFeature: function (t) { null !== this._inputResultsLayer && (t.removeLayer(this._inputResultsLayer), this._inputResultsLayer = null) }, _clearInputRequest: function () { this._requestPosition = null, this._requestCircleFilter = null, this._requestBboxFilter = null }, _displayWaitingContainer: function () { this._waitingContainer.className = "GPreverseGeocodingCalcWaitingContainerVisible", this._waiting = !0, this._timer && (clearTimeout(this._timer), this._timer = null); var t = this; this._timer = setTimeout((function () { !0 === t._waiting ? t._hideWaitingContainer() : t._timer && clearTimeout(t._timer) }), 16e3) }, _hideWaitingContainer: function () { this._waiting && (this._waitingContainer.className = "GPreverseGeocodingCalcWaitingContainerHidden", this._waiting = !1, clearTimeout(this._timer), this._timer = null) } }); e.default = d }, function (t, e) { !function (t, e, i) { var n; L.drawVersion = "1.0.4", L.Draw = {}, L.drawLocal = { draw: { toolbar: { actions: { title: "Cancel drawing", text: "Cancel" }, finish: { title: "Finish drawing", text: "Finish" }, undo: { title: "Delete last point drawn", text: "Delete last point" }, buttons: { polyline: "Draw a polyline", polygon: "Draw a polygon", rectangle: "Draw a rectangle", circle: "Draw a circle", marker: "Draw a marker", circlemarker: "Draw a circlemarker" } }, handlers: { circle: { tooltip: { start: "Click and drag to draw circle." }, radius: "Radius" }, circlemarker: { tooltip: { start: "Click map to place circle marker." } }, marker: { tooltip: { start: "Click map to place marker." } }, polygon: { tooltip: { start: "Click to start drawing shape.", cont: "Click to continue drawing shape.", end: "Click first point to close this shape." } }, polyline: { error: "<strong>Error:</strong> shape edges cannot cross!", tooltip: { start: "Click to start drawing line.", cont: "Click to continue drawing line.", end: "Click last point to finish line." } }, rectangle: { tooltip: { start: "Click and drag to draw rectangle." } }, simpleshape: { tooltip: { end: "Release mouse to finish drawing." } } } }, edit: { toolbar: { actions: { save: { title: "Save changes", text: "Save" }, cancel: { title: "Cancel editing, discards all changes", text: "Cancel" }, clearAll: { title: "Clear all layers", text: "Clear All" } }, buttons: { edit: "Edit layers", editDisabled: "No layers to edit", remove: "Delete layers", removeDisabled: "No layers to delete" } }, handlers: { edit: { tooltip: { text: "Drag handles or markers to edit features.", subtext: "Click cancel to undo changes." } }, remove: { tooltip: { text: "Click on a feature to remove." } } } } }, L.Draw.Event = {}, L.Draw.Event.CREATED = "draw:created", L.Draw.Event.EDITED = "draw:edited", L.Draw.Event.DELETED = "draw:deleted", L.Draw.Event.DRAWSTART = "draw:drawstart", L.Draw.Event.DRAWSTOP = "draw:drawstop", L.Draw.Event.DRAWVERTEX = "draw:drawvertex", L.Draw.Event.EDITSTART = "draw:editstart", L.Draw.Event.EDITMOVE = "draw:editmove", L.Draw.Event.EDITRESIZE = "draw:editresize", L.Draw.Event.EDITVERTEX = "draw:editvertex", L.Draw.Event.EDITSTOP = "draw:editstop", L.Draw.Event.DELETESTART = "draw:deletestart", L.Draw.Event.DELETESTOP = "draw:deletestop", L.Draw.Event.TOOLBAROPENED = "draw:toolbaropened", L.Draw.Event.TOOLBARCLOSED = "draw:toolbarclosed", L.Draw.Event.MARKERCONTEXT = "draw:markercontext", L.Draw = L.Draw || {}, L.Draw.Feature = L.Handler.extend({ initialize: function (t, e) { this._map = t, this._container = t._container, this._overlayPane = t._panes.overlayPane, this._popupPane = t._panes.popupPane, e && e.shapeOptions && (e.shapeOptions = L.Util.extend({}, this.options.shapeOptions, e.shapeOptions)), L.setOptions(this, e); var i = L.version.split("."); 1 === parseInt(i[0], 10) && parseInt(i[1], 10) >= 2 ? L.Draw.Feature.include(L.Evented.prototype) : L.Draw.Feature.include(L.Mixin.Events) }, enable: function () { this._enabled || (L.Handler.prototype.enable.call(this), this.fire("enabled", { handler: this.type }), this._map.fire(L.Draw.Event.DRAWSTART, { layerType: this.type })) }, disable: function () { this._enabled && (L.Handler.prototype.disable.call(this), this._map.fire(L.Draw.Event.DRAWSTOP, { layerType: this.type }), this.fire("disabled", { handler: this.type })) }, addHooks: function () { var t = this._map; t && (L.DomUtil.disableTextSelection(), t.getContainer().focus(), this._tooltip = new L.Draw.Tooltip(this._map), L.DomEvent.on(this._container, "keyup", this._cancelDrawing, this)) }, removeHooks: function () { this._map && (L.DomUtil.enableTextSelection(), this._tooltip.dispose(), this._tooltip = null, L.DomEvent.off(this._container, "keyup", this._cancelDrawing, this)) }, setOptions: function (t) { L.setOptions(this, t) }, _fireCreatedEvent: function (t) { this._map.fire(L.Draw.Event.CREATED, { layer: t, layerType: this.type }) }, _cancelDrawing: function (t) { 27 === t.keyCode && (this._map.fire("draw:canceled", { layerType: this.type }), this.disable()) } }), L.Draw.Polyline = L.Draw.Feature.extend({ statics: { TYPE: "polyline" }, Poly: L.Polyline, options: { allowIntersection: !0, repeatMode: !1, drawError: { color: "#b00b00", timeout: 2500 }, icon: new L.DivIcon({ iconSize: new L.Point(8, 8), className: "leaflet-div-icon leaflet-editing-icon" }), touchIcon: new L.DivIcon({ iconSize: new L.Point(20, 20), className: "leaflet-div-icon leaflet-editing-icon leaflet-touch-icon" }), guidelineDistance: 20, maxGuideLineLength: 4e3, shapeOptions: { stroke: !0, color: "#3388ff", weight: 4, opacity: .5, fill: !1, clickable: !0 }, metric: !0, feet: !0, nautic: !1, showLength: !0, zIndexOffset: 2e3, factor: 1, maxPoints: 0 }, initialize: function (t, e) { L.Browser.touch && (this.options.icon = this.options.touchIcon), this.options.drawError.message = L.drawLocal.draw.handlers.polyline.error, e && e.drawError && (e.drawError = L.Util.extend({}, this.options.drawError, e.drawError)), this.type = L.Draw.Polyline.TYPE, L.Draw.Feature.prototype.initialize.call(this, t, e) }, addHooks: function () { L.Draw.Feature.prototype.addHooks.call(this), this._map && (this._markers = [], this._markerGroup = new L.LayerGroup, this._map.addLayer(this._markerGroup), this._poly = new L.Polyline([], this.options.shapeOptions), this._tooltip.updateContent(this._getTooltipText()), this._mouseMarker || (this._mouseMarker = L.marker(this._map.getCenter(), { icon: L.divIcon({ className: "leaflet-mouse-marker", iconAnchor: [20, 20], iconSize: [40, 40] }), opacity: 0, zIndexOffset: this.options.zIndexOffset })), this._mouseMarker.on("mouseout", this._onMouseOut, this).on("mousemove", this._onMouseMove, this).on("mousedown", this._onMouseDown, this).on("mouseup", this._onMouseUp, this).addTo(this._map), this._map.on("mouseup", this._onMouseUp, this).on("mousemove", this._onMouseMove, this).on("zoomlevelschange", this._onZoomEnd, this).on("touchstart", this._onTouch, this).on("zoomend", this._onZoomEnd, this)) }, removeHooks: function () { L.Draw.Feature.prototype.removeHooks.call(this), this._clearHideErrorTimeout(), this._cleanUpShape(), this._map.removeLayer(this._markerGroup), delete this._markerGroup, delete this._markers, this._map.removeLayer(this._poly), delete this._poly, this._mouseMarker.off("mousedown", this._onMouseDown, this).off("mouseout", this._onMouseOut, this).off("mouseup", this._onMouseUp, this).off("mousemove", this._onMouseMove, this), this._map.removeLayer(this._mouseMarker), delete this._mouseMarker, this._clearGuides(), this._map.off("mouseup", this._onMouseUp, this).off("mousemove", this._onMouseMove, this).off("zoomlevelschange", this._onZoomEnd, this).off("zoomend", this._onZoomEnd, this).off("touchstart", this._onTouch, this).off("click", this._onTouch, this) }, deleteLastVertex: function () { if (!(this._markers.length <= 1)) { var t = this._markers.pop(), e = this._poly, i = e.getLatLngs(), n = i.splice(-1, 1)[0]; this._poly.setLatLngs(i), this._markerGroup.removeLayer(t), e.getLatLngs().length < 2 && this._map.removeLayer(e), this._vertexChanged(n, !1) } }, addVertex: function (t) { this._markers.length >= 2 && !this.options.allowIntersection && this._poly.newLatLngIntersects(t) ? this._showErrorTooltip() : (this._errorShown && this._hideErrorTooltip(), this._markers.push(this._createMarker(t)), this._poly.addLatLng(t), 2 === this._poly.getLatLngs().length && this._map.addLayer(this._poly), this._vertexChanged(t, !0)) }, completeShape: function () { this._markers.length <= 1 || !this._shapeIsValid() || (this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable()) }, _finishShape: function () { var t = this._poly._defaultShape ? this._poly._defaultShape() : this._poly.getLatLngs(), e = this._poly.newLatLngIntersects(t[t.length - 1]); !this.options.allowIntersection && e || !this._shapeIsValid() ? this._showErrorTooltip() : (this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable()) }, _shapeIsValid: function () { return !0 }, _onZoomEnd: function () { null !== this._markers && this._updateGuide() }, _onMouseMove: function (t) { var e = this._map.mouseEventToLayerPoint(t.originalEvent), i = this._map.layerPointToLatLng(e); this._currentLatLng = i, this._updateTooltip(i), this._updateGuide(e), this._mouseMarker.setLatLng(i), L.DomEvent.preventDefault(t.originalEvent) }, _vertexChanged: function (t, e) { this._map.fire(L.Draw.Event.DRAWVERTEX, { layers: this._markerGroup }), this._updateFinishHandler(), this._updateRunningMeasure(t, e), this._clearGuides(), this._updateTooltip() }, _onMouseDown: function (t) { if (!this._clickHandled && !this._touchHandled && !this._disableMarkers) { this._onMouseMove(t), this._clickHandled = !0, this._disableNewMarkers(); var e = t.originalEvent, i = e.clientX, n = e.clientY; this._startPoint.call(this, i, n) } }, _startPoint: function (t, e) { this._mouseDownOrigin = L.point(t, e) }, _onMouseUp: function (t) { var e = t.originalEvent, i = e.clientX, n = e.clientY; this._endPoint.call(this, i, n, t), this._clickHandled = null }, _endPoint: function (e, i, n) { if (this._mouseDownOrigin) { var o = L.point(e, i).distanceTo(this._mouseDownOrigin), s = this._calculateFinishDistance(n.latlng); this.options.maxPoints > 1 && this.options.maxPoints == this._markers.length + 1 ? (this.addVertex(n.latlng), this._finishShape()) : s < 10 && L.Browser.touch ? this._finishShape() : Math.abs(o) < 9 * (t.devicePixelRatio || 1) && this.addVertex(n.latlng), this._enableNewMarkers() } this._mouseDownOrigin = null }, _onTouch: function (t) { var e, i, n = t.originalEvent; !n.touches || !n.touches[0] || this._clickHandled || this._touchHandled || this._disableMarkers || (e = n.touches[0].clientX, i = n.touches[0].clientY, this._disableNewMarkers(), this._touchHandled = !0, this._startPoint.call(this, e, i), this._endPoint.call(this, e, i, t), this._touchHandled = null), this._clickHandled = null }, _onMouseOut: function () { this._tooltip && this._tooltip._onMouseOut.call(this._tooltip) }, _calculateFinishDistance: function (t) { var e; if (this._markers.length > 0) { var i; if (this.type === L.Draw.Polyline.TYPE) i = this._markers[this._markers.length - 1]; else { if (this.type !== L.Draw.Polygon.TYPE) return 1 / 0; i = this._markers[0] } var n = this._map.latLngToContainerPoint(i.getLatLng()), o = new L.Marker(t, { icon: this.options.icon, zIndexOffset: 2 * this.options.zIndexOffset }), s = this._map.latLngToContainerPoint(o.getLatLng()); e = n.distanceTo(s) } else e = 1 / 0; return e }, _updateFinishHandler: function () { var t = this._markers.length; t > 1 && this._markers[t - 1].on("click", this._finishShape, this), t > 2 && this._markers[t - 2].off("click", this._finishShape, this) }, _createMarker: function (t) { var e = new L.Marker(t, { icon: this.options.icon, zIndexOffset: 2 * this.options.zIndexOffset }); return this._markerGroup.addLayer(e), e }, _updateGuide: function (t) { var e = this._markers ? this._markers.length : 0; e > 0 && (t = t || this._map.latLngToLayerPoint(this._currentLatLng), this._clearGuides(), this._drawGuide(this._map.latLngToLayerPoint(this._markers[e - 1].getLatLng()), t)) }, _updateTooltip: function (t) { var e = this._getTooltipText(); t && this._tooltip.updatePosition(t), this._errorShown || this._tooltip.updateContent(e) }, _drawGuide: function (t, e) { var i, n, o, s = Math.floor(Math.sqrt(Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2))), a = this.options.guidelineDistance, r = this.options.maxGuideLineLength, l = s > r ? s - r : a; for (this._guidesContainer || (this._guidesContainer = L.DomUtil.create("div", "leaflet-draw-guides", this._overlayPane)); l < s; l += this.options.guidelineDistance)i = l / s, n = { x: Math.floor(t.x * (1 - i) + i * e.x), y: Math.floor(t.y * (1 - i) + i * e.y) }, (o = L.DomUtil.create("div", "leaflet-draw-guide-dash", this._guidesContainer)).style.backgroundColor = this._errorShown ? this.options.drawError.color : this.options.shapeOptions.color, L.DomUtil.setPosition(o, n) }, _updateGuideColor: function (t) { if (this._guidesContainer) for (var e = 0, i = this._guidesContainer.childNodes.length; e < i; e++)this._guidesContainer.childNodes[e].style.backgroundColor = t }, _clearGuides: function () { if (this._guidesContainer) for (; this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild) }, _getTooltipText: function () { var t, e, i = this.options.showLength; return 0 === this._markers.length ? t = { text: L.drawLocal.draw.handlers.polyline.tooltip.start } : (e = i ? this._getMeasurementString() : "", t = 1 === this._markers.length ? { text: L.drawLocal.draw.handlers.polyline.tooltip.cont, subtext: e } : { text: L.drawLocal.draw.handlers.polyline.tooltip.end, subtext: e }), t }, _updateRunningMeasure: function (t, e) { var i, n, o = this._markers.length; 1 === this._markers.length ? this._measurementRunningTotal = 0 : (i = o - (e ? 2 : 1), n = L.GeometryUtil.isVersion07x() ? t.distanceTo(this._markers[i].getLatLng()) * (this.options.factor || 1) : this._map.distance(t, this._markers[i].getLatLng()) * (this.options.factor || 1), this._measurementRunningTotal += n * (e ? 1 : -1)) }, _getMeasurementString: function () { var t, e = this._currentLatLng, i = this._markers[this._markers.length - 1].getLatLng(); return t = L.GeometryUtil.isVersion07x() ? i && e && e.distanceTo ? this._measurementRunningTotal + e.distanceTo(i) * (this.options.factor || 1) : this._measurementRunningTotal || 0 : i && e ? this._measurementRunningTotal + this._map.distance(e, i) * (this.options.factor || 1) : this._measurementRunningTotal || 0, L.GeometryUtil.readableDistance(t, this.options.metric, this.options.feet, this.options.nautic, this.options.precision) }, _showErrorTooltip: function () { this._errorShown = !0, this._tooltip.showAsError().updateContent({ text: this.options.drawError.message }), this._updateGuideColor(this.options.drawError.color), this._poly.setStyle({ color: this.options.drawError.color }), this._clearHideErrorTimeout(), this._hideErrorTimeout = setTimeout(L.Util.bind(this._hideErrorTooltip, this), this.options.drawError.timeout) }, _hideErrorTooltip: function () { this._errorShown = !1, this._clearHideErrorTimeout(), this._tooltip.removeError().updateContent(this._getTooltipText()), this._updateGuideColor(this.options.shapeOptions.color), this._poly.setStyle({ color: this.options.shapeOptions.color }) }, _clearHideErrorTimeout: function () { this._hideErrorTimeout && (clearTimeout(this._hideErrorTimeout), this._hideErrorTimeout = null) }, _disableNewMarkers: function () { this._disableMarkers = !0 }, _enableNewMarkers: function () { setTimeout(function () { this._disableMarkers = !1 }.bind(this), 50) }, _cleanUpShape: function () { this._markers.length > 1 && this._markers[this._markers.length - 1].off("click", this._finishShape, this) }, _fireCreatedEvent: function () { var t = new this.Poly(this._poly.getLatLngs(), this.options.shapeOptions); L.Draw.Feature.prototype._fireCreatedEvent.call(this, t) } }), L.Draw.Polygon = L.Draw.Polyline.extend({ statics: { TYPE: "polygon" }, Poly: L.Polygon, options: { showArea: !1, showLength: !1, shapeOptions: { stroke: !0, color: "#3388ff", weight: 4, opacity: .5, fill: !0, fillColor: null, fillOpacity: .2, clickable: !0 }, metric: !0, feet: !0, nautic: !1, precision: {} }, initialize: function (t, e) { L.Draw.Polyline.prototype.initialize.call(this, t, e), this.type = L.Draw.Polygon.TYPE }, _updateFinishHandler: function () { var t = this._markers.length; 1 === t && this._markers[0].on("click", this._finishShape, this), t > 2 && (this._markers[t - 1].on("dblclick", this._finishShape, this), t > 3 && this._markers[t - 2].off("dblclick", this._finishShape, this)) }, _getTooltipText: function () { var t, e; return 0 === this._markers.length ? t = L.drawLocal.draw.handlers.polygon.tooltip.start : this._markers.length < 3 ? (t = L.drawLocal.draw.handlers.polygon.tooltip.cont, e = this._getMeasurementString()) : (t = L.drawLocal.draw.handlers.polygon.tooltip.end, e = this._getMeasurementString()), { text: t, subtext: e } }, _getMeasurementString: function () { var t = this._area, e = ""; return t || this.options.showLength ? (this.options.showLength && (e = L.Draw.Polyline.prototype._getMeasurementString.call(this)), t && (e += "<br>" + L.GeometryUtil.readableArea(t, this.options.metric, this.options.precision)), e) : null }, _shapeIsValid: function () { return this._markers.length >= 3 }, _vertexChanged: function (t, e) { var i; !this.options.allowIntersection && this.options.showArea && (i = this._poly.getLatLngs(), this._area = L.GeometryUtil.geodesicArea(i)), L.Draw.Polyline.prototype._vertexChanged.call(this, t, e) }, _cleanUpShape: function () { var t = this._markers.length; t > 0 && (this._markers[0].off("click", this._finishShape, this), t > 2 && this._markers[t - 1].off("dblclick", this._finishShape, this)) } }), L.SimpleShape = {}, L.Draw.SimpleShape = L.Draw.Feature.extend({ options: { repeatMode: !1 }, initialize: function (t, e) { this._endLabelText = L.drawLocal.draw.handlers.simpleshape.tooltip.end, L.Draw.Feature.prototype.initialize.call(this, t, e) }, addHooks: function () { L.Draw.Feature.prototype.addHooks.call(this), this._map && (this._mapDraggable = this._map.dragging.enabled(), this._mapDraggable && this._map.dragging.disable(), this._container.style.cursor = "crosshair", this._tooltip.updateContent({ text: this._initialLabelText }), this._map.on("mousedown", this._onMouseDown, this).on("mousemove", this._onMouseMove, this).on("touchstart", this._onMouseDown, this).on("touchmove", this._onMouseMove, this), e.addEventListener("touchstart", L.DomEvent.preventDefault, { passive: !1 })) }, removeHooks: function () { L.Draw.Feature.prototype.removeHooks.call(this), this._map && (this._mapDraggable && this._map.dragging.enable(), this._container.style.cursor = "", this._map.off("mousedown", this._onMouseDown, this).off("mousemove", this._onMouseMove, this).off("touchstart", this._onMouseDown, this).off("touchmove", this._onMouseMove, this), L.DomEvent.off(e, "mouseup", this._onMouseUp, this), L.DomEvent.off(e, "touchend", this._onMouseUp, this), e.removeEventListener("touchstart", L.DomEvent.preventDefault), this._shape && (this._map.removeLayer(this._shape), delete this._shape)), this._isDrawing = !1 }, _getTooltipText: function () { return { text: this._endLabelText } }, _onMouseDown: function (t) { this._isDrawing = !0, this._startLatLng = t.latlng, L.DomEvent.on(e, "mouseup", this._onMouseUp, this).on(e, "touchend", this._onMouseUp, this).preventDefault(t.originalEvent) }, _onMouseMove: function (t) { var e = t.latlng; this._tooltip.updatePosition(e), this._isDrawing && (this._tooltip.updateContent(this._getTooltipText()), this._drawShape(e)) }, _onMouseUp: function () { this._shape && this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable() } }), L.Draw.Rectangle = L.Draw.SimpleShape.extend({ statics: { TYPE: "rectangle" }, options: { shapeOptions: { stroke: !0, color: "#3388ff", weight: 4, opacity: .5, fill: !0, fillColor: null, fillOpacity: .2, clickable: !0 }, showArea: !0, metric: !0 }, initialize: function (t, e) { this.type = L.Draw.Rectangle.TYPE, this._initialLabelText = L.drawLocal.draw.handlers.rectangle.tooltip.start, L.Draw.SimpleShape.prototype.initialize.call(this, t, e) }, disable: function () { this._enabled && (this._isCurrentlyTwoClickDrawing = !1, L.Draw.SimpleShape.prototype.disable.call(this)) }, _onMouseUp: function (t) { this._shape || this._isCurrentlyTwoClickDrawing ? this._isCurrentlyTwoClickDrawing && !function (t, e) { for (; (t = t.parentElement) && !t.classList.contains(e);); return t }(t.target, "leaflet-pane") || L.Draw.SimpleShape.prototype._onMouseUp.call(this) : this._isCurrentlyTwoClickDrawing = !0 }, _drawShape: function (t) { this._shape ? this._shape.setBounds(new L.LatLngBounds(this._startLatLng, t)) : (this._shape = new L.Rectangle(new L.LatLngBounds(this._startLatLng, t), this.options.shapeOptions), this._map.addLayer(this._shape)) }, _fireCreatedEvent: function () { var t = new L.Rectangle(this._shape.getBounds(), this.options.shapeOptions); L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this, t) }, _getTooltipText: function () { var t, e, i, n = L.Draw.SimpleShape.prototype._getTooltipText.call(this), o = this._shape, s = this.options.showArea; return o && (t = this._shape._defaultShape ? this._shape._defaultShape() : this._shape.getLatLngs(), e = L.GeometryUtil.geodesicArea(t), i = s ? L.GeometryUtil.readableArea(e, this.options.metric) : ""), { text: n.text, subtext: i } } }), L.Draw.Marker = L.Draw.Feature.extend({ statics: { TYPE: "marker" }, options: { icon: new L.Icon.Default, repeatMode: !1, zIndexOffset: 2e3 }, initialize: function (t, e) { this.type = L.Draw.Marker.TYPE, this._initialLabelText = L.drawLocal.draw.handlers.marker.tooltip.start, L.Draw.Feature.prototype.initialize.call(this, t, e) }, addHooks: function () { L.Draw.Feature.prototype.addHooks.call(this), this._map && (this._tooltip.updateContent({ text: this._initialLabelText }), this._mouseMarker || (this._mouseMarker = L.marker(this._map.getCenter(), { icon: L.divIcon({ className: "leaflet-mouse-marker", iconAnchor: [20, 20], iconSize: [40, 40] }), opacity: 0, zIndexOffset: this.options.zIndexOffset })), this._mouseMarker.on("click", this._onClick, this).addTo(this._map), this._map.on("mousemove", this._onMouseMove, this), this._map.on("click", this._onTouch, this)) }, removeHooks: function () { L.Draw.Feature.prototype.removeHooks.call(this), this._map && (this._map.off("click", this._onClick, this).off("click", this._onTouch, this), this._marker && (this._marker.off("click", this._onClick, this), this._map.removeLayer(this._marker), delete this._marker), this._mouseMarker.off("click", this._onClick, this), this._map.removeLayer(this._mouseMarker), delete this._mouseMarker, this._map.off("mousemove", this._onMouseMove, this)) }, _onMouseMove: function (t) { var e = t.latlng; this._tooltip.updatePosition(e), this._mouseMarker.setLatLng(e), this._marker ? (e = this._mouseMarker.getLatLng(), this._marker.setLatLng(e)) : (this._marker = this._createMarker(e), this._marker.on("click", this._onClick, this), this._map.on("click", this._onClick, this).addLayer(this._marker)) }, _createMarker: function (t) { return new L.Marker(t, { icon: this.options.icon, zIndexOffset: this.options.zIndexOffset }) }, _onClick: function () { this._fireCreatedEvent(), this.disable(), this.options.repeatMode && this.enable() }, _onTouch: function (t) { this._onMouseMove(t), this._onClick() }, _fireCreatedEvent: function () { var t = new L.Marker.Touch(this._marker.getLatLng(), { icon: this.options.icon }); L.Draw.Feature.prototype._fireCreatedEvent.call(this, t) } }), L.Draw.CircleMarker = L.Draw.Marker.extend({ statics: { TYPE: "circlemarker" }, options: { stroke: !0, color: "#3388ff", weight: 4, opacity: .5, fill: !0, fillColor: null, fillOpacity: .2, clickable: !0, zIndexOffset: 2e3 }, initialize: function (t, e) { this.type = L.Draw.CircleMarker.TYPE, this._initialLabelText = L.drawLocal.draw.handlers.circlemarker.tooltip.start, L.Draw.Feature.prototype.initialize.call(this, t, e) }, _fireCreatedEvent: function () { var t = new L.CircleMarker(this._marker.getLatLng(), this.options); L.Draw.Feature.prototype._fireCreatedEvent.call(this, t) }, _createMarker: function (t) { return new L.CircleMarker(t, this.options) } }), L.Draw.Circle = L.Draw.SimpleShape.extend({ statics: { TYPE: "circle" }, options: { shapeOptions: { stroke: !0, color: "#3388ff", weight: 4, opacity: .5, fill: !0, fillColor: null, fillOpacity: .2, clickable: !0 }, showRadius: !0, metric: !0, feet: !0, nautic: !1 }, initialize: function (t, e) { this.type = L.Draw.Circle.TYPE, this._initialLabelText = L.drawLocal.draw.handlers.circle.tooltip.start, L.Draw.SimpleShape.prototype.initialize.call(this, t, e) }, _drawShape: function (t) { if (L.GeometryUtil.isVersion07x()) var e = this._startLatLng.distanceTo(t); else e = this._map.distance(this._startLatLng, t); this._shape ? this._shape.setRadius(e) : (this._shape = new L.Circle(this._startLatLng, e, this.options.shapeOptions), this._map.addLayer(this._shape)) }, _fireCreatedEvent: function () { var t = new L.Circle(this._startLatLng, this._shape.getRadius(), this.options.shapeOptions); L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this, t) }, _onMouseMove: function (t) { var e, i = t.latlng, n = this.options.showRadius, o = this.options.metric; if (this._tooltip.updatePosition(i), this._isDrawing) { this._drawShape(i), e = this._shape.getRadius().toFixed(1); var s = ""; n && (s = L.drawLocal.draw.handlers.circle.radius + ": " + L.GeometryUtil.readableDistance(e, o, this.options.feet, this.options.nautic)), this._tooltip.updateContent({ text: this._endLabelText, subtext: s }) } } }), L.Edit = L.Edit || {}, L.Edit.Marker = L.Handler.extend({ initialize: function (t, e) { this._marker = t, L.setOptions(this, e) }, addHooks: function () { var t = this._marker; t.dragging.enable(), t.on("dragend", this._onDragEnd, t), this._toggleMarkerHighlight() }, removeHooks: function () { var t = this._marker; t.dragging.disable(), t.off("dragend", this._onDragEnd, t), this._toggleMarkerHighlight() }, _onDragEnd: function (t) { var e = t.target; e.edited = !0, this._map.fire(L.Draw.Event.EDITMOVE, { layer: e }) }, _toggleMarkerHighlight: function () { var t = this._marker._icon; t && (t.style.display = "none", L.DomUtil.hasClass(t, "leaflet-edit-marker-selected") ? (L.DomUtil.removeClass(t, "leaflet-edit-marker-selected"), this._offsetMarker(t, -4)) : (L.DomUtil.addClass(t, "leaflet-edit-marker-selected"), this._offsetMarker(t, 4)), t.style.display = "") }, _offsetMarker: function (t, e) { var i = parseInt(t.style.marginTop, 10) - e, n = parseInt(t.style.marginLeft, 10) - e; t.style.marginTop = i + "px", t.style.marginLeft = n + "px" } }), L.Marker.addInitHook((function () { L.Edit.Marker && (this.editing = new L.Edit.Marker(this), this.options.editable && this.editing.enable()) })), L.Edit = L.Edit || {}, L.Edit.Poly = L.Handler.extend({ initialize: function (t) { this.latlngs = [t._latlngs], t._holes && (this.latlngs = this.latlngs.concat(t._holes)), this._poly = t, this._poly.on("revert-edited", this._updateLatLngs, this) }, _defaultShape: function () { return L.Polyline._flat ? L.Polyline._flat(this._poly._latlngs) ? this._poly._latlngs : this._poly._latlngs[0] : this._poly._latlngs }, _eachVertexHandler: function (t) { for (var e = 0; e < this._verticesHandlers.length; e++)t(this._verticesHandlers[e]) }, addHooks: function () { this._initHandlers(), this._eachVertexHandler((function (t) { t.addHooks() })) }, removeHooks: function () { this._eachVertexHandler((function (t) { t.removeHooks() })) }, updateMarkers: function () { this._eachVertexHandler((function (t) { t.updateMarkers() })) }, _initHandlers: function () { this._verticesHandlers = []; for (var t = 0; t < this.latlngs.length; t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly, this.latlngs[t], this._poly.options.poly)) }, _updateLatLngs: function (t) { this.latlngs = [t.layer._latlngs], t.layer._holes && (this.latlngs = this.latlngs.concat(t.layer._holes)) } }), L.Edit.PolyVerticesEdit = L.Handler.extend({ options: { icon: new L.DivIcon({ iconSize: new L.Point(8, 8), className: "leaflet-div-icon leaflet-editing-icon" }), touchIcon: new L.DivIcon({ iconSize: new L.Point(20, 20), className: "leaflet-div-icon leaflet-editing-icon leaflet-touch-icon" }), drawError: { color: "#b00b00", timeout: 1e3 } }, initialize: function (t, e, i) { L.Browser.touch && (this.options.icon = this.options.touchIcon), this._poly = t, i && i.drawError && (i.drawError = L.Util.extend({}, this.options.drawError, i.drawError)), this._latlngs = e, L.setOptions(this, i) }, _defaultShape: function () { return L.Polyline._flat ? L.Polyline._flat(this._latlngs) ? this._latlngs : this._latlngs[0] : this._latlngs }, addHooks: function () { var t = this._poly, e = t._path; t instanceof L.Polygon || (t.options.fill = !1, t.options.editing && (t.options.editing.fill = !1)), e && t.options.editing && t.options.editing.className && (t.options.original.className && t.options.original.className.split(" ").forEach((function (t) { L.DomUtil.removeClass(e, t) })), t.options.editing.className.split(" ").forEach((function (t) { L.DomUtil.addClass(e, t) }))), t.setStyle(t.options.editing), this._poly._map && (this._map = this._poly._map, this._markerGroup || this._initMarkers(), this._poly._map.addLayer(this._markerGroup)) }, removeHooks: function () { var t = this._poly, e = t._path; e && t.options.editing && t.options.editing.className && (t.options.editing.className.split(" ").forEach((function (t) { L.DomUtil.removeClass(e, t) })), t.options.original.className && t.options.original.className.split(" ").forEach((function (t) { L.DomUtil.addClass(e, t) }))), t.setStyle(t.options.original), t._map && (t._map.removeLayer(this._markerGroup), delete this._markerGroup, delete this._markers) }, updateMarkers: function () { this._markerGroup.clearLayers(), this._initMarkers() }, _initMarkers: function () { this._markerGroup || (this._markerGroup = new L.LayerGroup), this._markers = []; var t, e, i, n, o, s, a = this._defaultShape(); for (t = 0, i = a.length; t < i; t++)(n = this._createMarker(a[t], t)).on("click", this._onMarkerClick, this), n.on("contextmenu", this._onContextMenu, this), this._markers.push(n); for (t = 0, e = i - 1; t < i; e = t++)(0 !== t || L.Polygon && this._poly instanceof L.Polygon) && (o = this._markers[e], s = this._markers[t], this._createMiddleMarker(o, s), this._updatePrevNext(o, s)) }, _createMarker: function (t, e) { var i = new L.Marker.Touch(t, { draggable: !0, icon: this.options.icon }); return i._origLatLng = t, i._index = e, i.on("dragstart", this._onMarkerDragStart, this).on("drag", this._onMarkerDrag, this).on("dragend", this._fireEdit, this).on("touchmove", this._onTouchMove, this).on("touchend", this._fireEdit, this).on("MSPointerMove", this._onTouchMove, this).on("MSPointerUp", this._fireEdit, this), this._markerGroup.addLayer(i), i }, _onMarkerDragStart: function () { this._poly.fire("editstart") }, _spliceLatLngs: function () { var t = this._defaultShape(), e = [].splice.apply(t, arguments); return this._poly._convertLatLngs(t, !0), this._poly.redraw(), e }, _removeMarker: function (t) { var e = t._index; this._markerGroup.removeLayer(t), this._markers.splice(e, 1), this._spliceLatLngs(e, 1), this._updateIndexes(e, -1), t.off("dragstart", this._onMarkerDragStart, this).off("drag", this._onMarkerDrag, this).off("dragend", this._fireEdit, this).off("touchmove", this._onMarkerDrag, this).off("touchend", this._fireEdit, this).off("click", this._onMarkerClick, this).off("MSPointerMove", this._onTouchMove, this).off("MSPointerUp", this._fireEdit, this) }, _fireEdit: function () { this._poly.edited = !0, this._poly.fire("edit"), this._poly._map.fire(L.Draw.Event.EDITVERTEX, { layers: this._markerGroup, poly: this._poly }) }, _onMarkerDrag: function (t) { var e = t.target, i = this._poly, n = L.LatLngUtil.cloneLatLng(e._origLatLng); if (L.extend(e._origLatLng, e._latlng), i.options.poly) { var o = i._map._editTooltip; if (!i.options.poly.allowIntersection && i.intersects()) { L.extend(e._origLatLng, n), e.setLatLng(n); var s = i.options.color; i.setStyle({ color: this.options.drawError.color }), o && o.updateContent({ text: L.drawLocal.draw.handlers.polyline.error }), setTimeout((function () { i.setStyle({ color: s }), o && o.updateContent({ text: L.drawLocal.edit.handlers.edit.tooltip.text, subtext: L.drawLocal.edit.handlers.edit.tooltip.subtext }) }), 1e3) } } e._middleLeft && e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev, e)), e._middleRight && e._middleRight.setLatLng(this._getMiddleLatLng(e, e._next)), this._poly._bounds._southWest = L.latLng(1 / 0, 1 / 0), this._poly._bounds._northEast = L.latLng(-1 / 0, -1 / 0); var a = this._poly.getLatLngs(); this._poly._convertLatLngs(a, !0), this._poly.redraw(), this._poly.fire("editdrag") }, _onMarkerClick: function (t) { var e = L.Polygon && this._poly instanceof L.Polygon ? 4 : 3, i = t.target; this._defaultShape().length < e || (this._removeMarker(i), this._updatePrevNext(i._prev, i._next), i._middleLeft && this._markerGroup.removeLayer(i._middleLeft), i._middleRight && this._markerGroup.removeLayer(i._middleRight), i._prev && i._next ? this._createMiddleMarker(i._prev, i._next) : i._prev ? i._next || (i._prev._middleRight = null) : i._next._middleLeft = null, this._fireEdit()) }, _onContextMenu: function (t) { var e = t.target; this._poly; this._poly._map.fire(L.Draw.Event.MARKERCONTEXT, { marker: e, layers: this._markerGroup, poly: this._poly }), L.DomEvent.stopPropagation }, _onTouchMove: function (t) { var e = this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]), i = this._map.layerPointToLatLng(e), n = t.target; L.extend(n._origLatLng, i), n._middleLeft && n._middleLeft.setLatLng(this._getMiddleLatLng(n._prev, n)), n._middleRight && n._middleRight.setLatLng(this._getMiddleLatLng(n, n._next)), this._poly.redraw(), this.updateMarkers() }, _updateIndexes: function (t, e) { this._markerGroup.eachLayer((function (i) { i._index > t && (i._index += e) })) }, _createMiddleMarker: function (t, e) { var i, n, o, s = this._getMiddleLatLng(t, e), a = this._createMarker(s); a.setOpacity(.6), t._middleRight = e._middleLeft = a, n = function () { a.off("touchmove", n, this); var o = e._index; a._index = o, a.off("click", i, this).on("click", this._onMarkerClick, this), s.lat = a.getLatLng().lat, s.lng = a.getLatLng().lng, this._spliceLatLngs(o, 0, s), this._markers.splice(o, 0, a), a.setOpacity(1), this._updateIndexes(o, 1), e._index++, this._updatePrevNext(t, a), this._updatePrevNext(a, e), this._poly.fire("editstart") }, o = function () { a.off("dragstart", n, this), a.off("dragend", o, this), a.off("touchmove", n, this), this._createMiddleMarker(t, a), this._createMiddleMarker(a, e) }, i = function () { n.call(this), o.call(this), this._fireEdit() }, a.on("click", i, this).on("dragstart", n, this).on("dragend", o, this).on("touchmove", n, this), this._markerGroup.addLayer(a) }, _updatePrevNext: function (t, e) { t && (t._next = e), e && (e._prev = t) }, _getMiddleLatLng: function (t, e) { var i = this._poly._map, n = i.project(t.getLatLng()), o = i.project(e.getLatLng()); return i.unproject(n._add(o)._divideBy(2)) } }), L.Polyline.addInitHook((function () { this.editing || (L.Edit.Poly && (this.editing = new L.Edit.Poly(this), this.options.editable && this.editing.enable()), this.on("add", (function () { this.editing && this.editing.enabled() && this.editing.addHooks() })), this.on("remove", (function () { this.editing && this.editing.enabled() && this.editing.removeHooks() }))) })), L.Edit = L.Edit || {}, L.Edit.SimpleShape = L.Handler.extend({ options: { moveIcon: new L.DivIcon({ iconSize: new L.Point(8, 8), className: "leaflet-div-icon leaflet-editing-icon leaflet-edit-move" }), resizeIcon: new L.DivIcon({ iconSize: new L.Point(8, 8), className: "leaflet-div-icon leaflet-editing-icon leaflet-edit-resize" }), touchMoveIcon: new L.DivIcon({ iconSize: new L.Point(20, 20), className: "leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon" }), touchResizeIcon: new L.DivIcon({ iconSize: new L.Point(20, 20), className: "leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon" }) }, initialize: function (t, e) { L.Browser.touch && (this.options.moveIcon = this.options.touchMoveIcon, this.options.resizeIcon = this.options.touchResizeIcon), this._shape = t, L.Util.setOptions(this, e) }, addHooks: function () { var t = this._shape; this._shape._map && (this._map = this._shape._map, t.setStyle(t.options.editing), t._map && (this._map = t._map, this._markerGroup || this._initMarkers(), this._map.addLayer(this._markerGroup))) }, removeHooks: function () { var t = this._shape; if (t.setStyle(t.options.original), t._map) { this._unbindMarker(this._moveMarker); for (var e = 0, i = this._resizeMarkers.length; e < i; e++)this._unbindMarker(this._resizeMarkers[e]); this._resizeMarkers = null, this._map.removeLayer(this._markerGroup), delete this._markerGroup } this._map = null }, updateMarkers: function () { this._markerGroup.clearLayers(), this._initMarkers() }, _initMarkers: function () { this._markerGroup || (this._markerGroup = new L.LayerGroup), this._createMoveMarker(), this._createResizeMarker() }, _createMoveMarker: function () { }, _createResizeMarker: function () { }, _createMarker: function (t, e) { var i = new L.Marker.Touch(t, { draggable: !0, icon: e, zIndexOffset: 10 }); return this._bindMarker(i), this._markerGroup.addLayer(i), i }, _bindMarker: function (t) { t.on("dragstart", this._onMarkerDragStart, this).on("drag", this._onMarkerDrag, this).on("dragend", this._onMarkerDragEnd, this).on("touchstart", this._onTouchStart, this).on("touchmove", this._onTouchMove, this).on("MSPointerMove", this._onTouchMove, this).on("touchend", this._onTouchEnd, this).on("MSPointerUp", this._onTouchEnd, this) }, _unbindMarker: function (t) { t.off("dragstart", this._onMarkerDragStart, this).off("drag", this._onMarkerDrag, this).off("dragend", this._onMarkerDragEnd, this).off("touchstart", this._onTouchStart, this).off("touchmove", this._onTouchMove, this).off("MSPointerMove", this._onTouchMove, this).off("touchend", this._onTouchEnd, this).off("MSPointerUp", this._onTouchEnd, this) }, _onMarkerDragStart: function (t) { t.target.setOpacity(0), this._shape.fire("editstart") }, _fireEdit: function () { this._shape.edited = !0, this._shape.fire("edit") }, _onMarkerDrag: function (t) { var e = t.target, i = e.getLatLng(); e === this._moveMarker ? this._move(i) : this._resize(i), this._shape.redraw(), this._shape.fire("editdrag") }, _onMarkerDragEnd: function (t) { t.target.setOpacity(1), this._fireEdit() }, _onTouchStart: function (t) { if (L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this, t), "function" == typeof this._getCorners) { var e = this._getCorners(), i = t.target, n = i._cornerIndex; i.setOpacity(0), this._oppositeCorner = e[(n + 2) % 4], this._toggleCornerMarkers(0, n) } this._shape.fire("editstart") }, _onTouchMove: function (t) { var e = this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]), i = this._map.layerPointToLatLng(e); return t.target === this._moveMarker ? this._move(i) : this._resize(i), this._shape.redraw(), !1 }, _onTouchEnd: function (t) { t.target.setOpacity(1), this.updateMarkers(), this._fireEdit() }, _move: function () { }, _resize: function () { } }), L.Edit = L.Edit || {}, L.Edit.Rectangle = L.Edit.SimpleShape.extend({ _createMoveMarker: function () { var t = this._shape.getBounds().getCenter(); this._moveMarker = this._createMarker(t, this.options.moveIcon) }, _createResizeMarker: function () { var t = this._getCorners(); this._resizeMarkers = []; for (var e = 0, i = t.length; e < i; e++)this._resizeMarkers.push(this._createMarker(t[e], this.options.resizeIcon)), this._resizeMarkers[e]._cornerIndex = e }, _onMarkerDragStart: function (t) { L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this, t); var e = this._getCorners(), i = t.target._cornerIndex; this._oppositeCorner = e[(i + 2) % 4], this._toggleCornerMarkers(0, i) }, _onMarkerDragEnd: function (t) { var e, i = t.target; i === this._moveMarker && (e = this._shape.getBounds().getCenter(), i.setLatLng(e)), this._toggleCornerMarkers(1), this._repositionCornerMarkers(), L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this, t) }, _move: function (t) { for (var e, i = this._shape._defaultShape ? this._shape._defaultShape() : this._shape.getLatLngs(), n = this._shape.getBounds().getCenter(), o = [], s = 0, a = i.length; s < a; s++)e = [i[s].lat - n.lat, i[s].lng - n.lng], o.push([t.lat + e[0], t.lng + e[1]]); this._shape.setLatLngs(o), this._repositionCornerMarkers(), this._map.fire(L.Draw.Event.EDITMOVE, { layer: this._shape }) }, _resize: function (t) { var e; this._shape.setBounds(L.latLngBounds(t, this._oppositeCorner)), e = this._shape.getBounds(), this._moveMarker.setLatLng(e.getCenter()), this._map.fire(L.Draw.Event.EDITRESIZE, { layer: this._shape }) }, _getCorners: function () { var t = this._shape.getBounds(); return [t.getNorthWest(), t.getNorthEast(), t.getSouthEast(), t.getSouthWest()] }, _toggleCornerMarkers: function (t) { for (var e = 0, i = this._resizeMarkers.length; e < i; e++)this._resizeMarkers[e].setOpacity(t) }, _repositionCornerMarkers: function () { for (var t = this._getCorners(), e = 0, i = this._resizeMarkers.length; e < i; e++)this._resizeMarkers[e].setLatLng(t[e]) } }), L.Rectangle.addInitHook((function () { L.Edit.Rectangle && (this.editing = new L.Edit.Rectangle(this), this.options.editable && this.editing.enable()) })), L.Edit = L.Edit || {}, L.Edit.CircleMarker = L.Edit.SimpleShape.extend({ _createMoveMarker: function () { var t = this._shape.getLatLng(); this._moveMarker = this._createMarker(t, this.options.moveIcon) }, _createResizeMarker: function () { this._resizeMarkers = [] }, _move: function (t) { if (this._resizeMarkers.length) { var e = this._getResizeMarkerPoint(t); this._resizeMarkers[0].setLatLng(e) } this._shape.setLatLng(t), this._map.fire(L.Draw.Event.EDITMOVE, { layer: this._shape }) } }), L.CircleMarker.addInitHook((function () { L.Edit.CircleMarker && (this.editing = new L.Edit.CircleMarker(this), this.options.editable && this.editing.enable()), this.on("add", (function () { this.editing && this.editing.enabled() && this.editing.addHooks() })), this.on("remove", (function () { this.editing && this.editing.enabled() && this.editing.removeHooks() })) })), L.Edit = L.Edit || {}, L.Edit.Circle = L.Edit.CircleMarker.extend({ _createResizeMarker: function () { var t = this._shape.getLatLng(), e = this._getResizeMarkerPoint(t); this._resizeMarkers = [], this._resizeMarkers.push(this._createMarker(e, this.options.resizeIcon)) }, _getResizeMarkerPoint: function (t) { var e = this._shape._radius * Math.cos(Math.PI / 4), i = this._map.project(t); return this._map.unproject([i.x + e, i.y - e]) }, _resize: function (t) { var e = this._moveMarker.getLatLng(); L.GeometryUtil.isVersion07x() ? radius = e.distanceTo(t) : radius = this._map.distance(e, t), this._shape.setRadius(radius), this._map.editTooltip && this._map._editTooltip.updateContent({ text: L.drawLocal.edit.handlers.edit.tooltip.subtext + "<br />" + L.drawLocal.edit.handlers.edit.tooltip.text, subtext: L.drawLocal.draw.handlers.circle.radius + ": " + L.GeometryUtil.readableDistance(radius, !0, this.options.feet, this.options.nautic) }), this._shape.setRadius(radius), this._map.fire(L.Draw.Event.EDITRESIZE, { layer: this._shape }) } }), L.Circle.addInitHook((function () { L.Edit.Circle && (this.editing = new L.Edit.Circle(this), this.options.editable && this.editing.enable()) })), L.Map.mergeOptions({ touchExtend: !0 }), L.Map.TouchExtend = L.Handler.extend({ initialize: function (t) { this._map = t, this._container = t._container, this._pane = t._panes.overlayPane }, addHooks: function () { L.DomEvent.on(this._container, "touchstart", this._onTouchStart, this), L.DomEvent.on(this._container, "touchend", this._onTouchEnd, this), L.DomEvent.on(this._container, "touchmove", this._onTouchMove, this), this._detectIE() ? (L.DomEvent.on(this._container, "MSPointerDown", this._onTouchStart, this), L.DomEvent.on(this._container, "MSPointerUp", this._onTouchEnd, this), L.DomEvent.on(this._container, "MSPointerMove", this._onTouchMove, this), L.DomEvent.on(this._container, "MSPointerCancel", this._onTouchCancel, this)) : (L.DomEvent.on(this._container, "touchcancel", this._onTouchCancel, this), L.DomEvent.on(this._container, "touchleave", this._onTouchLeave, this)) }, removeHooks: function () { L.DomEvent.off(this._container, "touchstart", this._onTouchStart, this), L.DomEvent.off(this._container, "touchend", this._onTouchEnd, this), L.DomEvent.off(this._container, "touchmove", this._onTouchMove, this), this._detectIE() ? (L.DomEvent.off(this._container, "MSPointerDown", this._onTouchStart, this), L.DomEvent.off(this._container, "MSPointerUp", this._onTouchEnd, this), L.DomEvent.off(this._container, "MSPointerMove", this._onTouchMove, this), L.DomEvent.off(this._container, "MSPointerCancel", this._onTouchCancel, this)) : (L.DomEvent.off(this._container, "touchcancel", this._onTouchCancel, this), L.DomEvent.off(this._container, "touchleave", this._onTouchLeave, this)) }, _touchEvent: function (t, e) { var i = {}; if (void 0 !== t.touches) { if (!t.touches.length) return; i = t.touches[0] } else { if ("touch" !== t.pointerType) return; if (i = t, !this._filterClick(t)) return } var n = this._map.mouseEventToContainerPoint(i), o = this._map.mouseEventToLayerPoint(i), s = this._map.layerPointToLatLng(o); this._map.fire(e, { latlng: s, layerPoint: o, containerPoint: n, pageX: i.pageX, pageY: i.pageY, originalEvent: t }) }, _filterClick: function (t) { var e = t.timeStamp || t.originalEvent.timeStamp, i = L.DomEvent._lastClick && e - L.DomEvent._lastClick; return i && i > 100 && i < 500 || t.target._simulatedClick && !t._simulated ? (L.DomEvent.stop(t), !1) : (L.DomEvent._lastClick = e, !0) }, _onTouchStart: function (t) { if (this._map._loaded) { this._touchEvent(t, "touchstart") } }, _onTouchEnd: function (t) { if (this._map._loaded) { this._touchEvent(t, "touchend") } }, _onTouchCancel: function (t) { if (this._map._loaded) { var e = "touchcancel"; this._detectIE() && (e = "pointercancel"), this._touchEvent(t, e) } }, _onTouchLeave: function (t) { if (this._map._loaded) { this._touchEvent(t, "touchleave") } }, _onTouchMove: function (t) { if (this._map._loaded) { this._touchEvent(t, "touchmove") } }, _detectIE: function () { var e = t.navigator.userAgent, i = e.indexOf("MSIE "); if (i > 0) return parseInt(e.substring(i + 5, e.indexOf(".", i)), 10); if (e.indexOf("Trident/") > 0) { var n = e.indexOf("rv:"); return parseInt(e.substring(n + 3, e.indexOf(".", n)), 10) } var o = e.indexOf("Edge/"); return o > 0 && parseInt(e.substring(o + 5, e.indexOf(".", o)), 10) } }), L.Map.addInitHook("addHandler", "touchExtend", L.Map.TouchExtend), L.Marker.Touch = L.Marker.extend({ _initInteraction: function () { return this.addInteractiveTarget ? L.Marker.prototype._initInteraction.apply(this) : this._initInteractionLegacy() }, _initInteractionLegacy: function () { if (this.options.clickable) { var t = this._icon, e = ["dblclick", "mousedown", "mouseover", "mouseout", "contextmenu", "touchstart", "touchend", "touchmove"]; this._detectIE ? e.concat(["MSPointerDown", "MSPointerUp", "MSPointerMove", "MSPointerCancel"]) : e.concat(["touchcancel"]), L.DomUtil.addClass(t, "leaflet-clickable"), L.DomEvent.on(t, "click", this._onMouseClick, this), L.DomEvent.on(t, "keypress", this._onKeyPress, this); for (var i = 0; i < e.length; i++)L.DomEvent.on(t, e[i], this._fireMouseEvent, this); L.Handler.MarkerDrag && (this.dragging = new L.Handler.MarkerDrag(this), this.options.draggable && this.dragging.enable()) } }, _detectIE: function () { var e = t.navigator.userAgent, i = e.indexOf("MSIE "); if (i > 0) return parseInt(e.substring(i + 5, e.indexOf(".", i)), 10); if (e.indexOf("Trident/") > 0) { var n = e.indexOf("rv:"); return parseInt(e.substring(n + 3, e.indexOf(".", n)), 10) } var o = e.indexOf("Edge/"); return o > 0 && parseInt(e.substring(o + 5, e.indexOf(".", o)), 10) } }), L.LatLngUtil = { cloneLatLngs: function (t) { for (var e = [], i = 0, n = t.length; i < n; i++)Array.isArray(t[i]) ? e.push(L.LatLngUtil.cloneLatLngs(t[i])) : e.push(this.cloneLatLng(t[i])); return e }, cloneLatLng: function (t) { return L.latLng(t.lat, t.lng) } }, n = { km: 2, ha: 2, m: 0, mi: 2, ac: 2, yd: 0, ft: 0, nm: 2 }, L.GeometryUtil = L.extend(L.GeometryUtil || {}, { geodesicArea: function (t) { var e, i, n = t.length, o = 0, s = Math.PI / 180; if (n > 2) { for (var a = 0; a < n; a++)e = t[a], o += ((i = t[(a + 1) % n]).lng - e.lng) * s * (2 + Math.sin(e.lat * s) + Math.sin(i.lat * s)); o = 6378137 * o * 6378137 / 2 } return Math.abs(o) }, formattedNumber: function (t, e) { var i = parseFloat(t).toFixed(e), n = L.drawLocal.format && L.drawLocal.format.numeric, o = n && n.delimiters, s = o && o.thousands, a = o && o.decimal; if (s || a) { var r = i.split("."); i = s ? r[0].replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1" + s) : r[0], a = a || ".", r.length > 1 && (i = i + a + r[1]) } return i }, readableArea: function (t, e, i) { var o, s; return i = L.Util.extend({}, n, i), e ? (s = ["ha", "m"], type = typeof e, "string" === type ? s = [e] : "boolean" !== type && (s = e), o = t >= 1e6 && -1 !== s.indexOf("km") ? L.GeometryUtil.formattedNumber(1e-6 * t, i.km) + " km²" : t >= 1e4 && -1 !== s.indexOf("ha") ? L.GeometryUtil.formattedNumber(1e-4 * t, i.ha) + " ha" : L.GeometryUtil.formattedNumber(t, i.m) + " m²") : o = (t /= .836127) >= 3097600 ? L.GeometryUtil.formattedNumber(t / 3097600, i.mi) + " mi²" : t >= 4840 ? L.GeometryUtil.formattedNumber(t / 4840, i.ac) + " acres" : L.GeometryUtil.formattedNumber(t, i.yd) + " yd²", o }, readableDistance: function (t, e, i, o, s) { var a; switch (s = L.Util.extend({}, n, s), e ? "string" == typeof e ? e : "metric" : i ? "feet" : o ? "nauticalMile" : "yards") { case "metric": a = t > 1e3 ? L.GeometryUtil.formattedNumber(t / 1e3, s.km) + " km" : L.GeometryUtil.formattedNumber(t, s.m) + " m"; break; case "feet": t *= 3.28083, a = L.GeometryUtil.formattedNumber(t, s.ft) + " ft"; break; case "nauticalMile": t *= .53996, a = L.GeometryUtil.formattedNumber(t / 1e3, s.nm) + " nm"; break; default: a = (t *= 1.09361) > 1760 ? L.GeometryUtil.formattedNumber(t / 1760, s.mi) + " miles" : L.GeometryUtil.formattedNumber(t, s.yd) + " yd" }return a }, isVersion07x: function () { var t = L.version.split("."); return 0 === parseInt(t[0], 10) && 7 === parseInt(t[1], 10) } }), L.Util.extend(L.LineUtil, { segmentsIntersect: function (t, e, i, n) { return this._checkCounterclockwise(t, i, n) !== this._checkCounterclockwise(e, i, n) && this._checkCounterclockwise(t, e, i) !== this._checkCounterclockwise(t, e, n) }, _checkCounterclockwise: function (t, e, i) { return (i.y - t.y) * (e.x - t.x) > (e.y - t.y) * (i.x - t.x) } }), L.Polyline.include({ intersects: function () { var t, e, i, n = this._getProjectedPoints(), o = n ? n.length : 0; if (this._tooFewPointsForIntersection()) return !1; for (t = o - 1; t >= 3; t--)if (e = n[t - 1], i = n[t], this._lineSegmentsIntersectsRange(e, i, t - 2)) return !0; return !1 }, newLatLngIntersects: function (t, e) { return !!this._map && this.newPointIntersects(this._map.latLngToLayerPoint(t), e) }, newPointIntersects: function (t, e) { var i = this._getProjectedPoints(), n = i ? i.length : 0, o = i ? i[n - 1] : null, s = n - 2; return !this._tooFewPointsForIntersection(1) && this._lineSegmentsIntersectsRange(o, t, s, e ? 1 : 0) }, _tooFewPointsForIntersection: function (t) { var e = this._getProjectedPoints(), i = e ? e.length : 0; return !e || (i += t || 0) <= 3 }, _lineSegmentsIntersectsRange: function (t, e, i, n) { var o, s, a = this._getProjectedPoints(); n = n || 0; for (var r = i; r > n; r--)if (o = a[r - 1], s = a[r], L.LineUtil.segmentsIntersect(t, e, o, s)) return !0; return !1 }, _getProjectedPoints: function () { if (!this._defaultShape) return this._originalPoints; for (var t = [], e = this._defaultShape(), i = 0; i < e.length; i++)t.push(this._map.latLngToLayerPoint(e[i])); return t } }), L.Polygon.include({ intersects: function () { var t, e, i, n, o = this._getProjectedPoints(); return !this._tooFewPointsForIntersection() && (!!L.Polyline.prototype.intersects.call(this) || (t = o.length, e = o[0], i = o[t - 1], n = t - 2, this._lineSegmentsIntersectsRange(i, e, n, 1))) } }), L.Control.Draw = L.Control.extend({ options: { position: "topleft", draw: {}, edit: !1 }, initialize: function (t) { if (L.version < "0.7") throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/"); var e; L.Control.prototype.initialize.call(this, t), this._toolbars = {}, L.DrawToolbar && this.options.draw && (e = new L.DrawToolbar(this.options.draw), this._toolbars[L.DrawToolbar.TYPE] = e, this._toolbars[L.DrawToolbar.TYPE].on("enable", this._toolbarEnabled, this)), L.EditToolbar && this.options.edit && (e = new L.EditToolbar(this.options.edit), this._toolbars[L.EditToolbar.TYPE] = e, this._toolbars[L.EditToolbar.TYPE].on("enable", this._toolbarEnabled, this)), L.toolbar = this }, onAdd: function (t) { var e, i = L.DomUtil.create("div", "leaflet-draw"), n = !1, o = "leaflet-draw-toolbar-top"; for (var s in this._toolbars) this._toolbars.hasOwnProperty(s) && (e = this._toolbars[s].addToolbar(t)) && (n || (L.DomUtil.hasClass(e, o) || L.DomUtil.addClass(e.childNodes[0], o), n = !0), i.appendChild(e)); return i }, onRemove: function () { for (var t in this._toolbars) this._toolbars.hasOwnProperty(t) && this._toolbars[t].removeToolbar() }, setDrawingOptions: function (t) { for (var e in this._toolbars) this._toolbars[e] instanceof L.DrawToolbar && this._toolbars[e].setOptions(t) }, _toolbarEnabled: function (t) { var e = t.target; for (var i in this._toolbars) this._toolbars[i] !== e && this._toolbars[i].disable() } }), L.Map.mergeOptions({ drawControlTooltips: !0, drawControl: !1 }), L.Map.addInitHook((function () { this.options.drawControl && (this.drawControl = new L.Control.Draw, this.addControl(this.drawControl)) })), L.Toolbar = L.Class.extend({ initialize: function (t) { L.setOptions(this, t), this._modes = {}, this._actionButtons = [], this._activeMode = null; var e = L.version.split("."); 1 === parseInt(e[0], 10) && parseInt(e[1], 10) >= 2 ? L.Toolbar.include(L.Evented.prototype) : L.Toolbar.include(L.Mixin.Events) }, enabled: function () { return null !== this._activeMode }, disable: function () { this.enabled() && this._activeMode.handler.disable() }, addToolbar: function (t) { var e, i = L.DomUtil.create("div", "leaflet-draw-section"), n = 0, o = this._toolbarClass || "", s = this.getModeHandlers(t); for (this._toolbarContainer = L.DomUtil.create("div", "leaflet-draw-toolbar leaflet-bar"), this._map = t, e = 0; e < s.length; e++)s[e].enabled && this._initModeHandler(s[e].handler, this._toolbarContainer, n++, o, s[e].title); if (n) return this._lastButtonIndex = --n, this._actionsContainer = L.DomUtil.create("ul", "leaflet-draw-actions"), i.appendChild(this._toolbarContainer), i.appendChild(this._actionsContainer), i }, removeToolbar: function () { for (var t in this._modes) this._modes.hasOwnProperty(t) && (this._disposeButton(this._modes[t].button, this._modes[t].handler.enable, this._modes[t].handler), this._modes[t].handler.disable(), this._modes[t].handler.off("enabled", this._handlerActivated, this).off("disabled", this._handlerDeactivated, this)); this._modes = {}; for (var e = 0, i = this._actionButtons.length; e < i; e++)this._disposeButton(this._actionButtons[e].button, this._actionButtons[e].callback, this); this._actionButtons = [], this._actionsContainer = null }, _initModeHandler: function (t, e, i, n, o) { var s = t.type; this._modes[s] = {}, this._modes[s].handler = t, this._modes[s].button = this._createButton({ type: s, title: o, className: n + "-" + s, container: e, callback: this._modes[s].handler.enable, context: this._modes[s].handler }), this._modes[s].buttonIndex = i, this._modes[s].handler.on("enabled", this._handlerActivated, this).on("disabled", this._handlerDeactivated, this) }, _detectIOS: function () { return /iPad|iPhone|iPod/.test(navigator.userAgent) && !t.MSStream }, _createButton: function (t) { var e = L.DomUtil.create("a", t.className || "", t.container), i = L.DomUtil.create("span", "sr-only", t.container); e.href = "#", e.appendChild(i), t.title && (e.title = t.title, i.innerHTML = t.title), t.text && (e.innerHTML = t.text, i.innerHTML = t.text); var n = this._detectIOS() ? "touchstart" : "click"; return L.DomEvent.on(e, "click", L.DomEvent.stopPropagation).on(e, "mousedown", L.DomEvent.stopPropagation).on(e, "dblclick", L.DomEvent.stopPropagation).on(e, "touchstart", L.DomEvent.stopPropagation).on(e, "click", L.DomEvent.preventDefault).on(e, n, t.callback, t.context), e }, _disposeButton: function (t, e) { var i = this._detectIOS() ? "touchstart" : "click"; L.DomEvent.off(t, "click", L.DomEvent.stopPropagation).off(t, "mousedown", L.DomEvent.stopPropagation).off(t, "dblclick", L.DomEvent.stopPropagation).off(t, "touchstart", L.DomEvent.stopPropagation).off(t, "click", L.DomEvent.preventDefault).off(t, i, e) }, _handlerActivated: function (t) { this.disable(), this._activeMode = this._modes[t.handler], L.DomUtil.addClass(this._activeMode.button, "leaflet-draw-toolbar-button-enabled"), this._showActionsToolbar(), this.fire("enable") }, _handlerDeactivated: function () { this._hideActionsToolbar(), L.DomUtil.removeClass(this._activeMode.button, "leaflet-draw-toolbar-button-enabled"), this._activeMode = null, this.fire("disable") }, _createActions: function (t) { var e, i, n, o, s = this._actionsContainer, a = this.getActions(t), r = a.length; for (i = 0, n = this._actionButtons.length; i < n; i++)this._disposeButton(this._actionButtons[i].button, this._actionButtons[i].callback); for (this._actionButtons = []; s.firstChild;)s.removeChild(s.firstChild); for (var l = 0; l < r; l++)"enabled" in a[l] && !a[l].enabled || (e = L.DomUtil.create("li", "", s), o = this._createButton({ title: a[l].title, text: a[l].text, container: e, callback: a[l].callback, context: a[l].context }), this._actionButtons.push({ button: o, callback: a[l].callback })) }, _showActionsToolbar: function () { var t = this._activeMode.buttonIndex, e = this._lastButtonIndex, i = this._activeMode.button.offsetTop - 1; this._createActions(this._activeMode.handler), this._actionsContainer.style.top = i + "px", 0 === t && (L.DomUtil.addClass(this._toolbarContainer, "leaflet-draw-toolbar-notop"), L.DomUtil.addClass(this._actionsContainer, "leaflet-draw-actions-top")), t === e && (L.DomUtil.addClass(this._toolbarContainer, "leaflet-draw-toolbar-nobottom"), L.DomUtil.addClass(this._actionsContainer, "leaflet-draw-actions-bottom")), this._actionsContainer.style.display = "block", this._map.fire(L.Draw.Event.TOOLBAROPENED) }, _hideActionsToolbar: function () { this._actionsContainer.style.display = "none", L.DomUtil.removeClass(this._toolbarContainer, "leaflet-draw-toolbar-notop"), L.DomUtil.removeClass(this._toolbarContainer, "leaflet-draw-toolbar-nobottom"), L.DomUtil.removeClass(this._actionsContainer, "leaflet-draw-actions-top"), L.DomUtil.removeClass(this._actionsContainer, "leaflet-draw-actions-bottom"), this._map.fire(L.Draw.Event.TOOLBARCLOSED) } }), L.Draw = L.Draw || {}, L.Draw.Tooltip = L.Class.extend({ initialize: function (t) { this._map = t, this._popupPane = t._panes.popupPane, this._visible = !1, this._container = t.options.drawControlTooltips ? L.DomUtil.create("div", "leaflet-draw-tooltip", this._popupPane) : null, this._singleLineLabel = !1, this._map.on("mouseout", this._onMouseOut, this) }, dispose: function () { this._map.off("mouseout", this._onMouseOut, this), this._container && (this._popupPane.removeChild(this._container), this._container = null) }, updateContent: function (t) { return this._container ? (t.subtext = t.subtext || "", 0 !== t.subtext.length || this._singleLineLabel ? t.subtext.length > 0 && this._singleLineLabel && (L.DomUtil.removeClass(this._container, "leaflet-draw-tooltip-single"), this._singleLineLabel = !1) : (L.DomUtil.addClass(this._container, "leaflet-draw-tooltip-single"), this._singleLineLabel = !0), this._container.innerHTML = (t.subtext.length > 0 ? '<span class="leaflet-draw-tooltip-subtext">' + t.subtext + "</span><br />" : "") + "<span>" + t.text + "</span>", t.text || t.subtext ? (this._visible = !0, this._container.style.visibility = "inherit") : (this._visible = !1, this._container.style.visibility = "hidden"), this) : this }, updatePosition: function (t) { var e = this._map.latLngToLayerPoint(t), i = this._container; return this._container && (this._visible && (i.style.visibility = "inherit"), L.DomUtil.setPosition(i, e)), this }, showAsError: function () { return this._container && L.DomUtil.addClass(this._container, "leaflet-error-draw-tooltip"), this }, removeError: function () { return this._container && L.DomUtil.removeClass(this._container, "leaflet-error-draw-tooltip"), this }, _onMouseOut: function () { this._container && (this._container.style.visibility = "hidden") } }), L.DrawToolbar = L.Toolbar.extend({ statics: { TYPE: "draw" }, options: { polyline: {}, polygon: {}, rectangle: {}, circle: {}, marker: {}, circlemarker: {} }, initialize: function (t) { for (var e in this.options) this.options.hasOwnProperty(e) && t[e] && (t[e] = L.extend({}, this.options[e], t[e])); this._toolbarClass = "leaflet-draw-draw", L.Toolbar.prototype.initialize.call(this, t) }, getModeHandlers: function (t) { return [{ enabled: this.options.polyline, handler: new L.Draw.Polyline(t, this.options.polyline), title: L.drawLocal.draw.toolbar.buttons.polyline }, { enabled: this.options.polygon, handler: new L.Draw.Polygon(t, this.options.polygon), title: L.drawLocal.draw.toolbar.buttons.polygon }, { enabled: this.options.rectangle, handler: new L.Draw.Rectangle(t, this.options.rectangle), title: L.drawLocal.draw.toolbar.buttons.rectangle }, { enabled: this.options.circle, handler: new L.Draw.Circle(t, this.options.circle), title: L.drawLocal.draw.toolbar.buttons.circle }, { enabled: this.options.marker, handler: new L.Draw.Marker(t, this.options.marker), title: L.drawLocal.draw.toolbar.buttons.marker }, { enabled: this.options.circlemarker, handler: new L.Draw.CircleMarker(t, this.options.circlemarker), title: L.drawLocal.draw.toolbar.buttons.circlemarker }] }, getActions: function (t) { return [{ enabled: t.completeShape, title: L.drawLocal.draw.toolbar.finish.title, text: L.drawLocal.draw.toolbar.finish.text, callback: t.completeShape, context: t }, { enabled: t.deleteLastVertex, title: L.drawLocal.draw.toolbar.undo.title, text: L.drawLocal.draw.toolbar.undo.text, callback: t.deleteLastVertex, context: t }, { title: L.drawLocal.draw.toolbar.actions.title, text: L.drawLocal.draw.toolbar.actions.text, callback: this.disable, context: this }] }, setOptions: function (t) { for (var e in L.setOptions(this, t), this._modes) this._modes.hasOwnProperty(e) && t.hasOwnProperty(e) && this._modes[e].handler.setOptions(t[e]) } }), L.EditToolbar = L.Toolbar.extend({ statics: { TYPE: "edit" }, options: { edit: { selectedPathOptions: { dashArray: "10, 10", fill: !0, fillColor: "#fe57a1", fillOpacity: .1, maintainColor: !1 } }, remove: {}, poly: null, featureGroup: null }, initialize: function (t) { t.edit && (void 0 === t.edit.selectedPathOptions && (t.edit.selectedPathOptions = this.options.edit.selectedPathOptions), t.edit.selectedPathOptions = L.extend({}, this.options.edit.selectedPathOptions, t.edit.selectedPathOptions)), t.remove && (t.remove = L.extend({}, this.options.remove, t.remove)), t.poly && (t.poly = L.extend({}, this.options.poly, t.poly)), this._toolbarClass = "leaflet-draw-edit", L.Toolbar.prototype.initialize.call(this, t), this._selectedFeatureCount = 0 }, getModeHandlers: function (t) { var e = this.options.featureGroup; return [{ enabled: this.options.edit, handler: new L.EditToolbar.Edit(t, { featureGroup: e, selectedPathOptions: this.options.edit.selectedPathOptions, poly: this.options.poly }), title: L.drawLocal.edit.toolbar.buttons.edit }, { enabled: this.options.remove, handler: new L.EditToolbar.Delete(t, { featureGroup: e }), title: L.drawLocal.edit.toolbar.buttons.remove }] }, getActions: function (t) { var e = [{ title: L.drawLocal.edit.toolbar.actions.save.title, text: L.drawLocal.edit.toolbar.actions.save.text, callback: this._save, context: this }, { title: L.drawLocal.edit.toolbar.actions.cancel.title, text: L.drawLocal.edit.toolbar.actions.cancel.text, callback: this.disable, context: this }]; return t.removeAllLayers && e.push({ title: L.drawLocal.edit.toolbar.actions.clearAll.title, text: L.drawLocal.edit.toolbar.actions.clearAll.text, callback: this._clearAllLayers, context: this }), e }, addToolbar: function (t) { var e = L.Toolbar.prototype.addToolbar.call(this, t); return this._checkDisabled(), this.options.featureGroup.on("layeradd layerremove", this._checkDisabled, this), e }, removeToolbar: function () { this.options.featureGroup.off("layeradd layerremove", this._checkDisabled, this), L.Toolbar.prototype.removeToolbar.call(this) }, disable: function () { this.enabled() && (this._activeMode.handler.revertLayers(), L.Toolbar.prototype.disable.call(this)) }, _save: function () { this._activeMode.handler.save(), this._activeMode && this._activeMode.handler.disable() }, _clearAllLayers: function () { this._activeMode.handler.removeAllLayers(), this._activeMode && this._activeMode.handler.disable() }, _checkDisabled: function () { var t, e = 0 !== this.options.featureGroup.getLayers().length; this.options.edit && (t = this._modes[L.EditToolbar.Edit.TYPE].button, e ? L.DomUtil.removeClass(t, "leaflet-disabled") : L.DomUtil.addClass(t, "leaflet-disabled"), t.setAttribute("title", e ? L.drawLocal.edit.toolbar.buttons.edit : L.drawLocal.edit.toolbar.buttons.editDisabled)), this.options.remove && (t = this._modes[L.EditToolbar.Delete.TYPE].button, e ? L.DomUtil.removeClass(t, "leaflet-disabled") : L.DomUtil.addClass(t, "leaflet-disabled"), t.setAttribute("title", e ? L.drawLocal.edit.toolbar.buttons.remove : L.drawLocal.edit.toolbar.buttons.removeDisabled)) } }), L.EditToolbar.Edit = L.Handler.extend({ statics: { TYPE: "edit" }, initialize: function (t, e) { if (L.Handler.prototype.initialize.call(this, t), L.setOptions(this, e), this._featureGroup = e.featureGroup, !(this._featureGroup instanceof L.FeatureGroup)) throw new Error("options.featureGroup must be a L.FeatureGroup"); this._uneditedLayerProps = {}, this.type = L.EditToolbar.Edit.TYPE; var i = L.version.split("."); 1 === parseInt(i[0], 10) && parseInt(i[1], 10) >= 2 ? L.EditToolbar.Edit.include(L.Evented.prototype) : L.EditToolbar.Edit.include(L.Mixin.Events) }, enable: function () { !this._enabled && this._hasAvailableLayers() && (this.fire("enabled", { handler: this.type }), this._map.fire(L.Draw.Event.EDITSTART, { handler: this.type }), L.Handler.prototype.enable.call(this), this._featureGroup.on("layeradd", this._enableLayerEdit, this).on("layerremove", this._disableLayerEdit, this)) }, disable: function () { this._enabled && (this._featureGroup.off("layeradd", this._enableLayerEdit, this).off("layerremove", this._disableLayerEdit, this), L.Handler.prototype.disable.call(this), this._map.fire(L.Draw.Event.EDITSTOP, { handler: this.type }), this.fire("disabled", { handler: this.type })) }, addHooks: function () { var t = this._map; t && (t.getContainer().focus(), this._featureGroup.eachLayer(this._enableLayerEdit, this), this._tooltip = new L.Draw.Tooltip(this._map), this._tooltip.updateContent({ text: L.drawLocal.edit.handlers.edit.tooltip.text, subtext: L.drawLocal.edit.handlers.edit.tooltip.subtext }), t._editTooltip = this._tooltip, this._updateTooltip(), this._map.on("mousemove", this._onMouseMove, this).on("touchmove", this._onMouseMove, this).on("MSPointerMove", this._onMouseMove, this).on(L.Draw.Event.EDITVERTEX, this._updateTooltip, this)) }, removeHooks: function () { this._map && (this._featureGroup.eachLayer(this._disableLayerEdit, this), this._uneditedLayerProps = {}, this._tooltip.dispose(), this._tooltip = null, this._map.off("mousemove", this._onMouseMove, this).off("touchmove", this._onMouseMove, this).off("MSPointerMove", this._onMouseMove, this).off(L.Draw.Event.EDITVERTEX, this._updateTooltip, this)) }, revertLayers: function () { this._featureGroup.eachLayer((function (t) { this._revertLayer(t) }), this) }, save: function () { var t = new L.LayerGroup; this._featureGroup.eachLayer((function (e) { e.edited && (t.addLayer(e), e.edited = !1) })), this._map.fire(L.Draw.Event.EDITED, { layers: t }) }, _backupLayer: function (t) { var e = L.Util.stamp(t); this._uneditedLayerProps[e] || (t instanceof L.Polyline || t instanceof L.Polygon || t instanceof L.Rectangle ? this._uneditedLayerProps[e] = { latlngs: L.LatLngUtil.cloneLatLngs(t.getLatLngs()) } : t instanceof L.Circle ? this._uneditedLayerProps[e] = { latlng: L.LatLngUtil.cloneLatLng(t.getLatLng()), radius: t.getRadius() } : (t instanceof L.Marker || t instanceof L.CircleMarker) && (this._uneditedLayerProps[e] = { latlng: L.LatLngUtil.cloneLatLng(t.getLatLng()) })) }, _getTooltipText: function () { return { text: L.drawLocal.edit.handlers.edit.tooltip.text, subtext: L.drawLocal.edit.handlers.edit.tooltip.subtext } }, _updateTooltip: function () { this._tooltip.updateContent(this._getTooltipText()) }, _revertLayer: function (t) { var e = L.Util.stamp(t); t.edited = !1, this._uneditedLayerProps.hasOwnProperty(e) && (t instanceof L.Polyline || t instanceof L.Polygon || t instanceof L.Rectangle ? t.setLatLngs(this._uneditedLayerProps[e].latlngs) : t instanceof L.Circle ? (t.setLatLng(this._uneditedLayerProps[e].latlng), t.setRadius(this._uneditedLayerProps[e].radius)) : (t instanceof L.Marker || t instanceof L.CircleMarker) && t.setLatLng(this._uneditedLayerProps[e].latlng), t.fire("revert-edited", { layer: t })) }, _enableLayerEdit: function (t) { var e, i, n = t.layer || t.target || t; this._backupLayer(n), this.options.poly && (i = L.Util.extend({}, this.options.poly), n.options.poly = i), this.options.selectedPathOptions && ((e = L.Util.extend({}, this.options.selectedPathOptions)).maintainColor && (e.color = n.options.color, e.fillColor = n.options.fillColor), n.options.original = L.extend({}, n.options), n.options.editing = e), n instanceof L.Marker ? (n.editing && n.editing.enable(), n.dragging.enable(), n.on("dragend", this._onMarkerDragEnd).on("touchmove", this._onTouchMove, this).on("MSPointerMove", this._onTouchMove, this).on("touchend", this._onMarkerDragEnd, this).on("MSPointerUp", this._onMarkerDragEnd, this)) : n.editing.enable() }, _disableLayerEdit: function (t) { var e = t.layer || t.target || t; e.edited = !1, e.editing && e.editing.disable(), delete e.options.editing, delete e.options.original, this._selectedPathOptions && (e instanceof L.Marker ? this._toggleMarkerHighlight(e) : (e.setStyle(e.options.previousOptions), delete e.options.previousOptions)), e instanceof L.Marker ? (e.dragging.disable(), e.off("dragend", this._onMarkerDragEnd, this).off("touchmove", this._onTouchMove, this).off("MSPointerMove", this._onTouchMove, this).off("touchend", this._onMarkerDragEnd, this).off("MSPointerUp", this._onMarkerDragEnd, this)) : e.editing.disable() }, _onMouseMove: function (t) { this._tooltip.updatePosition(t.latlng) }, _onMarkerDragEnd: function (t) { var e = t.target; e.edited = !0, this._map.fire(L.Draw.Event.EDITMOVE, { layer: e }) }, _onTouchMove: function (t) { var e = t.originalEvent.changedTouches[0], i = this._map.mouseEventToLayerPoint(e), n = this._map.layerPointToLatLng(i); t.target.setLatLng(n) }, _hasAvailableLayers: function () { return 0 !== this._featureGroup.getLayers().length } }), L.EditToolbar.Delete = L.Handler.extend({ statics: { TYPE: "remove" }, initialize: function (t, e) { if (L.Handler.prototype.initialize.call(this, t), L.Util.setOptions(this, e), this._deletableLayers = this.options.featureGroup, !(this._deletableLayers instanceof L.FeatureGroup)) throw new Error("options.featureGroup must be a L.FeatureGroup"); this.type = L.EditToolbar.Delete.TYPE; var i = L.version.split("."); 1 === parseInt(i[0], 10) && parseInt(i[1], 10) >= 2 ? L.EditToolbar.Delete.include(L.Evented.prototype) : L.EditToolbar.Delete.include(L.Mixin.Events) }, enable: function () { !this._enabled && this._hasAvailableLayers() && (this.fire("enabled", { handler: this.type }), this._map.fire(L.Draw.Event.DELETESTART, { handler: this.type }), L.Handler.prototype.enable.call(this), this._deletableLayers.on("layeradd", this._enableLayerDelete, this).on("layerremove", this._disableLayerDelete, this)) }, disable: function () { this._enabled && (this._deletableLayers.off("layeradd", this._enableLayerDelete, this).off("layerremove", this._disableLayerDelete, this), L.Handler.prototype.disable.call(this), this._map.fire(L.Draw.Event.DELETESTOP, { handler: this.type }), this.fire("disabled", { handler: this.type })) }, addHooks: function () { var t = this._map; t && (t.getContainer().focus(), this._deletableLayers.eachLayer(this._enableLayerDelete, this), this._deletedLayers = new L.LayerGroup, this._tooltip = new L.Draw.Tooltip(this._map), this._tooltip.updateContent({ text: L.drawLocal.edit.handlers.remove.tooltip.text }), this._map.on("mousemove", this._onMouseMove, this)) }, removeHooks: function () { this._map && (this._deletableLayers.eachLayer(this._disableLayerDelete, this), this._deletedLayers = null, this._tooltip.dispose(), this._tooltip = null, this._map.off("mousemove", this._onMouseMove, this)) }, revertLayers: function () { this._deletedLayers.eachLayer((function (t) { this._deletableLayers.addLayer(t), t.fire("revert-deleted", { layer: t }) }), this) }, save: function () { this._map.fire(L.Draw.Event.DELETED, { layers: this._deletedLayers }) }, removeAllLayers: function () { this._deletableLayers.eachLayer((function (t) { this._removeLayer({ layer: t }) }), this), this.save() }, _enableLayerDelete: function (t) { (t.layer || t.target || t).on("click", this._removeLayer, this) }, _disableLayerDelete: function (t) { var e = t.layer || t.target || t; e.off("click", this._removeLayer, this), this._deletedLayers.removeLayer(e) }, _removeLayer: function (t) { var e = t.layer || t.target || t; this._deletableLayers.removeLayer(e), this._deletedLayers.addLayer(e), e.fire("deleted") }, _onMouseMove: function (t) { this._tooltip.updatePosition(t.latlng) }, _hasAvailableLayers: function () { return 0 !== this._deletableLayers.getLayers().length } }) }(window, document) }, function (t, e, i) { "use strict"; i.r(e); var n = { _addUID: function (t) { return this._uid ? t + "-" + this._uid : t }, _createMainContainerElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPreverseGeocoding"), t.className = "GPwidget", t }, _createShowReverseGeocodingElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPshowReverseGeocoding"), t.type = "checkbox", t }, _createShowReverseGeocodingPictoElement: function () { var t = this, e = document.createElement("label"); e.id = this._addUID("GPshowReverseGeocodingPicto"), e.className = "GPshowAdvancedToolPicto", e.htmlFor = this._addUID("GPshowReverseGeocoding"), e.title = "Ouvrir la recherche inverse", e.addEventListener ? e.addEventListener("click", (function () { t.onShowReverseGeocodingClick() })) : e.attachEvent && e.attachEvent("onclick", (function () { t.onShowReverseGeocodingClick() })); var i = document.createElement("span"); return i.id = this._addUID("GPshowReverseGeocodingOpen"), i.className = "GPshowAdvancedToolOpen", e.appendChild(i), e }, _createReverseGeocodingWaitingElement: function () { var t = document.createElement("div"); t.id = this._addUID("GPreverseGeocodingCalcWaitingContainer"), t.className = "GPreverseGeocodingCalcWaitingContainerHidden"; var e = document.createElement("p"); return e.className = "GPreverseGeocodingCalcWaiting", e.innerHTML = "Recherche en cours...", t.appendChild(e), t }, _createReverseGeocodingResultsPanelElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPreverseGeocodingResultsPanel"), t.className = "GPpanel GPreverseGeocodingComponentHidden", t }, _createReverseGeocodingResultsListElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPreverseGeocodingResultsList"), t }, _createReverseGeocodingResultElement: function (t, e) { var i = this, n = document.getElementById(this._addUID("GPreverseGeocodingResultsList")), o = document.createElement("div"); o.id = this._addUID("ReverseGeocodedLocation_" + e), o.className = "GPautoCompleteProposal", o.innerHTML = t, o.title = t, o.addEventListener ? (o.addEventListener("mouseover", (function (t) { i.onReverseGeocodingResultMouseOver(t) })), o.addEventListener("mouseout", (function (t) { i.onReverseGeocodingResultMouseOut(t) })), o.addEventListener("click", (function (t) { "function" == typeof i.onReverseGeocodingResultClick && i.onReverseGeocodingResultClick(t) }))) : o.attachEvent && (o.attachEvent("onmouseover", (function (t) { i.onReverseGeocodingResultMouseOver(t) })), o.attachEvent("onmouseout", (function (t) { i.onReverseGeocodingResultMouseOut(t) })), o.attachEvent("onclick", (function (t) { "function" == typeof i.onReverseGeocodingResultClick && i.onReverseGeocodingResultClick(t) }))), n.appendChild(o) }, _createReverseGeocodingPanelElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPreverseGeocodingPanel"), t.className = "GPpanel", t }, _createReverseGeocodingPanelHeaderElement: function () { var t = document.createElement("div"); return t.className = "GPpanelHeader", t }, _createReverseGeocodingPanelReturnPictoElement: function () { var t = this, e = document.createElement("div"); return e.id = this._addUID("GPreverseGeocodingReturnPicto"), e.title = "Nouvelle recherche", e.className = "GPreverseGeocodingReturnPictoHidden", e.addEventListener ? e.addEventListener("click", (function (e) { document.getElementById(t._addUID("GPreverseGeocodingResultsPanel")).className = "GProuteComponentHidden", document.getElementById(t._addUID("GPreverseGeocodingForm")).className = "", document.getElementById(t._addUID("GPreverseGeocodingHeaderTitle")).innerHTML = "Recherche inverse", document.getElementById(t._addUID("GPreverseGeocodingReturnPicto")).className = "GPreverseGeocodingReturnPictoHidden", t.onGPreverseGeocodingReturnPictoClick(e) })) : e.attachEvent && e.attachEvent("onclick", (function (e) { document.getElementById(t._addUID("GPreverseGeocodingResultsPanel")).className = "GProuteComponentHidden", document.getElementById(t._addUID("GPreverseGeocodingForm")).className = "", document.getElementById(t._addUID("GPreverseGeocodingHeaderTitle")).innerHTML = "Recherche inverse", document.getElementById(t._addUID("GPreverseGeocodingReturnPicto")).className = "GPreverseGeocodingReturnPictoHidden", t.onGPreverseGeocodingReturnPictoClick(e) })), e }, _createReverseGeocodingPanelTitleElement: function () { var t = document.createElement("div"); return t.className = "GPpanelTitle", t.id = this._addUID("GPreverseGeocodingHeaderTitle"), t.innerHTML = "Recherche inverse", t }, _createReverseGeocodingPanelCloseElement: function () { var t = this, e = document.createElement("div"); return e.id = this._addUID("GPreverseGeocodingPanelClose"), e.className = "GPpanelClose", e.title = "Fermer le panneau", e.addEventListener ? e.addEventListener("click", (function () { document.getElementById(t._addUID("GPshowReverseGeocodingPicto")).click() }), !1) : e.attachEvent && e.attachEvent("onclick", (function () { document.getElementById(t._addUID("GPshowReverseGeocodingPicto")).click() })), e }, _createReverseGeocodingPanelFormElement: function () { var t = this, e = document.createElement("form"); return e.id = this._addUID("GPreverseGeocodingForm"), e.addEventListener ? e.addEventListener("submit", (function (e) { e.preventDefault(), t.onReverseGeocodingSubmit() })) : e.attachEvent && e.attachEvent("onsubmit", (function (e) { e.preventDefault(), t.onReverseGeocodingSubmit() })), e }, _createReverseGeocodingFormModeChoiceGeocodingTypeElement: function (t) { var e = this, i = document.createElement("div"); i.className = "GPflexInput"; var n = document.createElement("label"); n.className = "GPreverseGeocodingCodeLabel", n.innerHTML = "Recherche par", n.title = "Recherche par", i.appendChild(n); var o = document.createElement("select"); o.className = "GPreverseGeocodingCode", o.addEventListener ? o.addEventListener("change", (function (t) { e.onReverseGeocodingTypeChange(t) })) : o.attachEvent && o.attachEvent("onchange", (function (t) { e.onReverseGeocodingTypeChange(t) })), t && Array.isArray(t) || (t = ["StreetAddress", "PositionOfInterest", "CadastralParcel"]); for (var s = 0; s < t.length; s++)switch (t[s]) { case "PositionOfInterest": var a = document.createElement("option"); a.value = "PositionOfInterest", a.text = "Lieux/toponymes", o.appendChild(a); break; case "StreetAddress": var r = document.createElement("option"); r.value = "StreetAddress", r.text = "Adresses", o.appendChild(r); break; case "CadastralParcel": var l = document.createElement("option"); l.value = "CadastralParcel", l.text = "Parcelles cadastrales", o.appendChild(l); break; case "Administratif": var c = document.createElement("option"); c.value = "Administratif", c.text = "Unités administratives", o.appendChild(c) }return i.appendChild(o), i }, _createReverseGeocodingFormModeChoiceGeocodingDelimitationElement: function (t) { var e = this, i = document.createElement("div"); i.className = "GPflexInput"; var n = document.createElement("label"); n.className = "GPreverseGeocodingCodeLabel", n.innerHTML = "Délimitation", n.title = "Délimitation", i.appendChild(n); var o = document.createElement("select"); o.className = "GPreverseGeocodingCode", o.addEventListener ? o.addEventListener("change", (function (t) { e.onReverseGeocodingDelimitationChange(t) })) : o.attachEvent && o.attachEvent("onchange", (function (t) { e.onReverseGeocodingDelimitationChange(t) })), t && Array.isArray(t) || (t = ["Point", "Circle", "Extent"]); for (var s = 0; s < t.length; s++)switch (t[s].toLowerCase()) { case "point": var a = document.createElement("option"); a.value = "point", a.text = "Pointer un lieu", o.appendChild(a); break; case "circle": var r = document.createElement("option"); r.value = "circle", r.text = "Dessiner un cercle", o.appendChild(r); break; case "extent": var l = document.createElement("option"); l.value = "extent", l.text = "Dessiner une emprise", o.appendChild(l) }return i.appendChild(o), i }, _createReverseGeocodingSubmitFormElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPreverseGeocodingSubmit"), t.className = "GPinputSubmit", t.type = "submit", t.value = "Rechercher", t } }; e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(40), o = i(2), s = i.n(o), a = i(34), r = i(131), l = i(36), c = i(133), u = i(153), h = a.default.getLogger("route(plus)"), d = s.a.Control.extend({ includes: u.default, options: { position: "topleft", collapsed: !0, graphs: ["Voiture", "Pieton"], exclusions: { toll: !1, tunnel: !1, bridge: !1 }, disableReverse: !1, routeOptions: {}, autocompleteOptions: {} }, initialize: function (t) { s.a.Util.setOptions(this, t), this._uid = l.default.generate(), this._initTransport(), this._initExclusions(), this._initComputation(), this._showRouteContainer = null, this._pictoRouteContainer = null, this._waitingContainer = null, this._formRouteContainer = null, this._resultsRouteContainer = null, this._isDesktop = this._detectSupport(), this._currentPoints = [], this._currentTransport = null, this._currentComputation = null, this._currentExclusions = [], this._geojsonRoute = null, this._geojsonSections = null, this._waiting = !1, this._timer = null, this._currentRouteInformations = null, this._resources = {}, this._noRightManagement = !1, this._checkRightsManagement() }, onAdd: function (t) { var e = this._container = this._initLayout(t); return s.a.DomEvent.disableClickPropagation(e).disableScrollPropagation(e), e }, onRemove: function () { }, _initTransport: function () { this._currentTransport = "Voiture"; var t = this.options.graphs; t && 0 !== t.length || (this.options.graphs = ["Voiture", "Pieton"]), s.a.Util.isArray(t) && t.length && ("Voiture" !== t[0] && "Pieton" !== t[0] || (this._currentTransport = t[0])); var e = this.options.routeOptions; e.graph && (this._currentTransport = e.graph) }, _initComputation: function () { this._currentComputation = "fastest"; var t = this.options.routeOptions; t.routePreference && (this._currentComputation = t.routePreference) }, _initExclusions: function () { this._currentExclusions = []; var t = this.options.exclusions; if (t && 0 !== Object.keys(t).length || (this.options.exclusions = { toll: !1, tunnel: !1, bridge: !1 }), t && Object.keys(t).length) for (var e in t) t.hasOwnProperty(e) && t.k && this._currentExclusions.push(e); var i = this.options.routeOptions; s.a.Util.isArray(i.exclusions) && (this._currentExclusions = i.exclusions) }, _checkRightsManagement: function () { var t = null, e = [], i = null; i = this.options.routeOptions.apiKey, (e = (t = this.options.routeOptions.filterOptions) ? t.type : []) && 0 !== e.length || (e = ["Voiture", "Pieton"]); var n = r.default.check({ key: i || this.options.apiKey, resources: e, services: ["Itineraire"] }); i = this.options.autocompleteOptions.apiKey, (e = (t = this.options.autocompleteOptions.filterOptions) ? t.type : []) && 0 !== e.length || (e = ["StreetAddress", "PositionOfInterest"]); var o = r.default.check({ key: i || this.options.apiKey, resources: e, services: ["AutoCompletion"] }); n || o || (this._noRightManagement = !0), o && (this._resources.AutoCompletion = {}, this._resources.AutoCompletion.resources = o.AutoCompletion, this._resources.AutoCompletion.key = o.key), n && (this._resources.Itineraire = {}, this._resources.Itineraire.resources = n.Itineraire, this._resources.Itineraire.key = n.key) }, _detectSupport: function () { var t = !0, e = window.navigator.userAgent.toLowerCase(); return -1 === e.indexOf("iphone") && -1 === e.indexOf("ipod") && -1 === e.indexOf("ipad") && -1 === e.indexOf("android") && -1 === e.indexOf("mobile") && -1 === e.indexOf("blackberry") && -1 === e.indexOf("tablet") && -1 === e.indexOf("phone") && -1 === e.indexOf("touch") || (t = !1), -1 === e.indexOf("msie") && -1 === e.indexOf("trident") || (t = !0), t }, _initLayout: function (t) { var e = this._createMainContainerElement(), i = this._showRouteContainer = this._createShowRouteElement(); e.appendChild(i), this.options.collapsed || (i.checked = !0); var n = this._pictoRouteContainer = this._createShowRoutePictoElement(); e.appendChild(n); var o = this._createRoutePanelElement(), s = this._createRoutePanelHeaderElement(); o.appendChild(s); for (var a = this._formRouteContainer = this._createRoutePanelFormElement(), r = this._createRoutePanelFormPointsElement(t), l = 0; l < r.length; l++)a.appendChild(r[l]); var c = this._createRoutePanelFormModeChoiceElement(); c.appendChild(this._createRoutePanelFormModeChoiceTransportElement(this.options.graphs)), c.appendChild(this._createRoutePanelFormModeChoiceComputeElement()), a.appendChild(c), a.appendChild(this._createShowRouteExclusionsElement()), a.appendChild(this._createShowRouteExclusionsPictoElement()); var u = this._createRoutePanelFormExclusionsElement(); u.appendChild(this._createRoutePanelFormExclusionOptionsElement(this.options.exclusions)), a.appendChild(u); var h = this._createRouteSubmitFormElement(); a.appendChild(h), o.appendChild(a); var d = this._resultsRouteContainer = this._createRoutePanelResultsElement(); o.appendChild(d); var p = this._waitingContainer = this._createRouteWaitingElement(); return o.appendChild(p), e.appendChild(o), e }, _createRoutePanelFormPointsElement: function (t) { var e = [], i = 1, n = new c.default({ apiKey: this.options.apiKey || null, tag: { id: i, unique: this._uid, label: "Départ", color: "blue", display: !0 }, disableReverse: this.options.disableReverse, autocompleteOptions: this.options.autocompleteOptions || null }); n.setMap(t); var o = this.options.routeOptions; for (o.startPoint && (n._inputAutoCompleteContainer.value = o.startPoint.x + " , " + o.startPoint.y, n.setCoordinate({ lng: o.startPoint.x, lat: o.startPoint.y })), e.push(n.getContainer()), this._currentPoints.push(n), i = 2; i < 7; i++) { var s = new c.default({ apiKey: this.options.apiKey || null, tag: { id: i, unique: this._uid, label: "Etape", color: "green", display: !1, removeOption: !0 }, disableReverse: this.options.disableReverse, autocompleteOptions: this.options.autocompleteOptions || null }); s.setMap(t), e.push(s.getContainer()), this._currentPoints.push(s) } var a = new c.default({ apiKey: this.options.apiKey || null, tag: { id: i, unique: this._uid, label: "Arrivée", color: "red", display: !0, addOption: !0, removeOption: !1 }, disableReverse: this.options.disableReverse, autocompleteOptions: this.options.autocompleteOptions || null }); return a.setMap(t), o.endPoint && (a._inputAutoCompleteContainer.value = o.endPoint.x + " , " + o.endPoint.y, a.setCoordinate({ lng: o.endPoint.x, lat: o.endPoint.y })), e.push(a.getContainer()), this._currentPoints.push(a), e }, onShowRoutePanelClick: function (t) { h.log("onShowRoutePanelClick", t), this._geojsonSections || this._clear() }, onRouteModeComputationChange: function (t) { h.log("onRouteModeComputationChange", t); var e = t.target.selectedIndex, i = t.target.options[e].value; i && (h.log(i), this._currentComputation = i) }, onRouteModeComputationChangeAndRun: function (t) { h.log("onRouteModeComputationChangeAndRun", t), this.onRouteModeComputationChange(t), this._clearRouteResultsDetails(), this._clearRouteResultsGeometry(), this._clearRouteResultsFeatureGeometry(), this.onRouteComputationSubmit({ computation: this._currentComputation, transport: this._currentTransport, exclusions: this._currentExclusions }) }, onRouteModeTransportChange: function (t) { h.log("onRouteModeTransportChange", t); var e = t.target.value; e && (h.log(e), this._currentTransport = e) }, onShowRouteExclusionsClick: function (t) { h.log("onShowRouteExclusionsClick", t) }, onRouteExclusionsChange: function (t) { h.log("onRouteExclusionsChange", t); var e = t.target.value, i = t.target.checked; if (e) { h.log(e, i); for (var n = !1, o = null, s = 0; s < this._currentExclusions.length; s++)this._currentExclusions[s] === e && (o = s, n = !0); !n && i && this._currentExclusions.push(e), n && !i && (this._currentExclusions[o] = null) } }, onRouteComputationSubmit: function (t) { h.log("onRouteComputationSubmit", t); var e = this._currentPoints, i = e[0].getCoordinate(); e[0].dragging(!1), h.log("start", i); var n = e[e.length - 1].getCoordinate(); e[e.length - 1].dragging(!1), h.log("end", n); for (var o = [], s = 1; s < e.length - 1; s++) { var a = e[s].getCoordinate(); e[s].dragging(!1), a && (h.log("step", a), o.push(a)) } if (!this._noRightManagement) { this._currentTransport = t.transport, this._currentComputation = t.computation, this._currentExclusions = t.exclusions, this._displayWaitingContainer(); var r = this; this._requestRouting({ startPoint: i, endPoint: n, viaPoints: o, graph: this._currentTransport, routePreference: this._currentComputation, exclusions: this._currentExclusions, geometryInInstructions: !0, distanceUnit: "m", onSuccess: function (t) { h.log(t), t && r._fillRouteResultsDetails(t) }, onFailure: function (t) { r._hideWaitingContainer(), r._clearRouteResultsDetails(), h.log(t.message) } }) } }, onShowRouteResultsNewClick: function (t) { h.log("onShowRouteResultsNewClick", t); for (var e = this._currentPoints, i = 0; i < e.length; i++)e[i].dragging(!0); this._clearRouteResultsDetails(), this._clearRouteResultsGeometry(), this._clearRouteResultsFeatureGeometry() }, onRouteResultsDetailsMouseOver: function (t) { h.log("onRouteResultsDetailsMouseOver", t); var e = l.default.index(t.target.id); this._isDesktop && this._geojsonSections && this._geojsonSections.eachLayer((function (t) { t.feature.id === parseInt(e, 10) && t.setStyle({ weight: 10, color: "#0F9DE8", opacity: .5 }) })) }, onRouteResultsDetailsMouseOut: function (t) { h.log("onRouteResultsDetailsMouseOut", t); var e = l.default.index(t.target.id); this._isDesktop && this._geojsonSections && this._geojsonSections.eachLayer((function (t) { t.feature.id === parseInt(e, 10) && t.setStyle({ color: "#ED7F10", weight: 5, opacity: .75 }) })) }, onRouteResultsDetailsClick: function (t) { h.log("onRouteResultsDetailsClick", t); var e = l.default.index(t.target.id), i = this; if (!this._isDesktop && this._geojsonSections) { var n = t.target.title, o = t.target.innerHTML; this._geojsonSections.eachLayer((function (i) { i.feature.id === parseInt(e, 10) && (t.target.innerHTML = n, i.setStyle({ weight: 10, color: "#0F9DE8", opacity: .5 })) })), clearTimeout(1e3), setTimeout((function () { i._geojsonSections.eachLayer((function (i) { i.feature.id === parseInt(e, 10) && (t.target.innerHTML = o, i.setStyle({ color: "#ED7F10", weight: 5, opacity: .75 })) })) }), 1e3) } }, _requestRouting: function (t) { if (t && 0 !== Object.keys(t).length && t.startPoint && t.endPoint) if (h.log(t), this._noRightManagement) h.log("no rights for all service !?"); else if (this._resources.Itineraire) { var e = this._resources.Itineraire.resources; if (e && 0 !== Object.keys(e).length) { var i = this._resources.Itineraire.key, o = {}; s.a.Util.extend(o, this.options.routeOptions), s.a.Util.extend(o, t); for (var a = !1, r = 0; r < e.length; r++)e[r] === o.graph && (a = !0); a ? (s.a.Util.extend(o, { apiKey: this.options.routeOptions.apiKey || this.options.apiKey || i }), s.a.Util.extend(o, { ssl: this.options.ssl }), h.log(o), n.default.Services.route(o)) : h.log("no rights for this service !?") } } else h.log("no rights for this service !?") }, _fillRouteResultsDetails: function (t) { var e = t.totalDistance, i = t.totalTime, n = this._simplifiedInstructions(t.routeInstructions); n && this._fillRouteResultsDetailsContainer(e, i, n); var o = t.routeGeometry; o && this._fillRouteResultsDetailsGeometry(o); var a = n && Array.isArray(n) && 0 !== n[0].geometry.length; n && a && this._fillRouteResultsDetailsFeatureGeometry(n); var r = t.bbox; if (r) { var l = this._map, c = s.a.latLngBounds([r.bottom, r.left], [r.top, r.right]); l.fitBounds(c, { padding: [1, 1] }) } this._currentRouteInformations = t, this._formRouteContainer.className = "GProuteComponentHidden", this._hideWaitingContainer(), this._resultsRouteContainer.className = "" }, _fillRouteResultsDetailsContainer: function (t, e, i) { this._resultsRouteValuesContainer = this._addRouteResultsValuesElement(t, e, this._convertSecondsToTime), this._resultsRouteDetailsContainer = this._addRouteResultsDetailsElement(i, this._convertSecondsToTime) }, _fillRouteResultsDetailsGeometry: function (t) { this._clearRouteResultsGeometry(); var e = this._map; this._geojsonRoute = s.a.geoJson(t, { style: { color: "#ff7800", weight: 5, opacity: .65 } }).addTo(e) }, _fillRouteResultsDetailsFeatureGeometry: function (t) { this._clearRouteResultsFeatureGeometry(); for (var e = this._map, i = { type: "FeatureCollection", features: [] }, n = 0; n < t.length; n++) { var o = t[n], a = n + 1; i.features.push({ id: a, type: "Feature", geometry: o.geometry, properties: { popupContent: "(" + a + ") distance : " + this._convertDistance(o.distance) + " / temps : " + this._convertSecondsToTime(o.duration) } }) } var r = this; function l(t) { var e = t.target; r._geojsonSections.resetStyle(e); var i = s.a.DomUtil.get("GProuteResultsDetailsInstruction_" + e.feature.id + "-" + r._uid); s.a.DomUtil.removeClass(i, "GProuteResultsDetailsHighlight") } function c(t) { var e = t.target; h.log(e), e.setStyle({ weight: 10, color: "#0F9DE8", opacity: .5 }); var i = s.a.DomUtil.get("GProuteResultsDetailsInstruction_" + e.feature.id + "-" + r._uid); s.a.DomUtil.addClass(i, "GProuteResultsDetailsHighlight") } this._geojsonSections = s.a.geoJson(i, { style: { color: "#ED7F10", weight: 5, opacity: .75 }, onEachFeature: function (t, e) { e.on({ mouseover: c, mouseout: l }), e.bindPopup(t.properties.popupContent) } }).addTo(e) }, _clear: function () { this._currentTransport = null, this._currentExclusions = [], this._currentComputation = null, this._clearRouteResultsDetails(), this._clearRouteResultsGeometry(), this._clearRouteResultsFeatureGeometry(); for (var t = 0; t < this._currentPoints.length; t++)this._currentPoints[t].clear() }, _clearRouteResultsDetails: function () { if (this._currentRouteInformations = null, this._resultsRouteDetailsContainer) { var t = this._resultsRouteDetailsContainer; if (t.childElementCount) for (; t.firstChild;)t.removeChild(t.firstChild) } if (this._resultsRouteValuesContainer) { var e = this._resultsRouteValuesContainer; if (e.childElementCount) for (; e.firstChild;)e.removeChild(e.firstChild) } }, _clearRouteResultsGeometry: function () { var t = this._map; null != this._geojsonRoute && (t.removeLayer(this._geojsonRoute), this._geojsonRoute = null) }, _clearRouteResultsFeatureGeometry: function () { var t = this._map; null != this._geojsonSections && (t.removeLayer(this._geojsonSections), this._geojsonSections = null) }, _displayWaitingContainer: function () { this._waitingContainer.className = "GProuteCalcWaitingContainerVisible", this._waiting = !0, this._timer && (clearTimeout(this._timer), this._timer = null); var t = this; this._timer = setTimeout((function () { !0 === t._waiting ? t._hideWaitingContainer() : t._timer && clearTimeout(t._timer) }), 16e3) }, _hideWaitingContainer: function () { this._waiting && (this._waitingContainer.className = "GProuteCalcWaitingContainerHidden", this._waiting = !1, clearTimeout(this._timer), this._timer = null) }, _simplifiedInstructions: function (t) { var e = [], i = t[0]; 1 === t.length && e.push(i); for (var n = 1; n < t.length; n++) { var o = t[n]; if (o.instruction === i.instruction) { i.distance = (parseFloat(o.distance) + parseFloat(i.distance)).toString(), i.duration = (parseFloat(o.duration) + parseFloat(i.duration)).toString(); for (var s = 1; s < o.geometry.coordinates.length; s++)i.geometry.coordinates.push(o.geometry.coordinates[s]); n === t.length - 1 && (e.push(i), i = null) } else e.push(i), i = o, n === t.length - 1 && (e.push(o), i = null) } return h.log(e), e }, _convertSecondsToTime: function (t) { t = Math.round(t); var e = Math.floor(t / 3600); e || (e = "00"); var i = t % 3600, n = Math.floor(i / 60); n || (n = "00"); var o = i % 60, s = Math.ceil(o); return s || (s = "00"), e + "h " + n + "m " + s + "s" }, _convertDistance: function (t) { var e = parseInt(t / 1e3, 10); return e ? e + " km" : parseInt(t, 10) + " m" }, compute: function (t, e) { if (this._showRouteContainer.checked || this._pictoRouteContainer.click(), this._map) { var i = { computation: "fastest", transport: "Voiture", exclusions: [] }; s.a.Util.extend(i, e); var n = this._currentPoints; n[0].setCoordinate(t[0]), s.a.DomUtil.get("GPlocationOrigin_1-" + this._uid).value = t[0].lng + " , " + t[0].lat; var o = t.length - 1; n[6].setCoordinate(t[o]), s.a.DomUtil.get("GPlocationOrigin_7-" + this._uid).value = t[o].lng + " , " + t[o].lat; for (var a = 1; a < t.length - 1; a++) { n[a].setCoordinate(t[a]), s.a.DomUtil.get("GPlocationOrigin_" + a + "-" + this._uid).value = t[a].lng + " , " + t[a].lat } "Voiture" === i.transport ? s.a.DomUtil.get("GProuteTransportCar-" + this._uid).checked = !0 : s.a.DomUtil.get("GProuteTransportPedestrian-" + this._uid).checked = !0, s.a.DomUtil.get("GProuteComputationSelect-" + this._uid).selectedIndex = "fastest" === i.computation ? 0 : 1, this.onRouteComputationSubmit(i) } } }); e.default = d }, function (t, e, i) { "use strict"; i.r(e); var n = i(36), o = i(34).default.getLogger("RouteDOM"), s = { _addUID: function (t) { return this._uid ? t + "-" + this._uid : t }, _createMainContainerElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GProute"), t.className = "GPwidget", t }, _createShowRouteElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPshowRoute"), t.type = "checkbox", t }, _createShowRoutePictoElement: function () { var t = this, e = document.createElement("label"); e.id = this._addUID("GPshowRoutePicto"), e.className = "GPshowAdvancedToolPicto", e.htmlFor = this._addUID("GPshowRoute"), e.title = "Ouvrir le calcul d'itinéraire", e.addEventListener ? e.addEventListener("click", (function (e) { t.onShowRoutePanelClick(e) })) : e.attachEvent && e.attachEvent("onclick", (function (e) { t.onShowRoutePanelClick(e) })); var i = document.createElement("span"); return i.id = this._addUID("GPshowRouteOpen"), i.className = "GPshowAdvancedToolOpen", e.appendChild(i), e }, _createRoutePanelElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GProutePanel"), t.className = "GPpanel", t }, _createRoutePanelHeaderElement: function () { var t = this, e = document.createElement("div"); e.className = "GPpanelHeader"; var i = document.createElement("div"); i.className = "GPpanelTitle", i.innerHTML = "Calcul d'itinéraire", e.appendChild(i); var n = document.createElement("div"); return n.id = this._addUID("GProutePanelClose"), n.className = "GPpanelClose", n.title = "Masquer le panneau", n.addEventListener ? n.addEventListener("click", (function () { document.getElementById(t._addUID("GPshowRoutePicto")).click() }), !1) : n.attachEvent && n.attachEvent("onclick", (function () { document.getElementById(t._addUID("GPshowRoutePicto")).click() })), e.appendChild(n), e }, _createRoutePanelFormElement: function () { var t = this, e = document.createElement("form"); return e.id = this._addUID("GProuteForm"), e.setAttribute("onkeypress", "return event.keyCode != 13;"), e.addEventListener("submit", (function (e) { o.log(e), e.preventDefault(); var i, s = document.getElementsByClassName(t._addUID("GPlocationPoint")), a = s[0].childNodes[0].id, r = s[s.length - 1].childNodes[0].id, l = n.default.index(a), c = n.default.index(r); if ("" === document.getElementById(t._addUID("GPlocationOrigin_" + l)).value && "" === document.getElementById(t._addUID("GPlocationOriginCoords_" + l)).value || "" === document.getElementById(t._addUID("GPlocationOrigin_" + c)).value && "" === document.getElementById(t._addUID("GPlocationOriginCoords_" + c)).value) return !1; document.getElementById(t._addUID("GProuteResultsStages")).innerHTML = ""; for (var u = 0; u < s.length; u++) { var h = s[u].childNodes[0].id; if (i = n.default.index(h), "GPflexInput GPlocationStageFlexInput" === document.getElementById(t._addUID("GPlocationPoint_" + i)).className) { var d = document.createElement("div"); d.className = "GProuteResultsStages"; var p = document.createElement("div"); p.className = "GProuteResultStageLabel", p.innerHTML = document.getElementById(t._addUID("GPlocationOriginLabel_" + i)).innerHTML + " :", d.appendChild(p); var m = document.createElement("div"); m.className = "GProuteResultStageValue"; var f = document.getElementById(t._addUID("GPlocationOriginCoords_" + i)), g = f.value, _ = "GPlocationOriginVisible" === f.className; m.innerHTML = null !== g && "" !== g && _ ? g : document.getElementById(t._addUID("GPlocationOrigin_" + i)).value, d.appendChild(m), "" !== m.innerHTML && document.getElementById(t._addUID("GProuteResultsStages")).appendChild(d) } } var v = null; if (document.getElementById(t._addUID("GProuteComputationSelect"))) { var y = document.getElementById(t._addUID("GProuteResultsComputationSelect")); y.selectedIndex = document.getElementById(t._addUID("GProuteComputationSelect")).selectedIndex, v = y.options[y.selectedIndex].value } var E = null; document.getElementById(t._addUID("GProuteTransportCar")) && document.getElementById(t._addUID("GProuteTransportCar")).checked && (E = document.getElementById(t._addUID("GProuteTransportCar")).value), document.getElementById(t._addUID("GProuteTransportPedestrian")) && document.getElementById(t._addUID("GProuteTransportPedestrian")).checked && (E = document.getElementById(t._addUID("GProuteTransportPedestrian")).value); for (var w = [], b = document.getElementsByClassName("GProuteExclusionsOption"), P = 0; P < b.length; P++) { i = b[P].htmlFor; var C = document.getElementById(i); C.checked || w.push(C.value) } return t.onRouteComputationSubmit({ computation: v, transport: E, exclusions: w }), !1 })), e }, _createRoutePanelResultsElement: function () { var t = document.createElement("div"); t.id = this._addUID("GProuteResultsPanel"), t.className = "GProuteComponentHidden", t.appendChild(this._createRouteResultsStagesElement()), t.appendChild(this._createRouteResultsElement()); var e = document.createElement("div"); e.className = "GPfakeBorder GPfakeBorderLeft", t.appendChild(e), t.appendChild(this._createRouteShowResultsDetailsElement()); var i = document.createElement("label"); i.htmlFor = this._addUID("GProuteResultsShowDetails"), i.innerHTML = "Afficher le détail", t.appendChild(i); var n = document.createElement("label"); n.htmlFor = this._addUID("GProuteResultsShowDetails"), n.innerHTML = "Masquer le détail", t.appendChild(n); var o = document.createElement("div"); return o.className = "GPfakeBorder", t.appendChild(o), t.appendChild(this._createRouteResultsDetailsElement()), t }, _createRouteWaitingElement: function () { var t = document.createElement("div"); t.id = this._addUID("GProuteCalcWaitingContainer"), t.className = "GProuteCalcWaitingContainerHidden"; var e = document.createElement("p"); return e.className = "GProuteCalcWaiting", e.innerHTML = "Calcul en cours...", t.appendChild(e), t }, _createRouteResultsStagesElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GProuteResultsStages"), t }, _createRouteResultsElement: function () { var t = this, e = document.createElement("div"); e.id = this._addUID("GProuteResults"); var i = document.createElement("div"); i.id = this._addUID("GProuteResultsValues"), e.appendChild(i); var n = document.createElement("div"); n.id = this._addUID("GProuteResultsMode"); var o = document.createElement("select"); o.id = this._addUID("GProuteResultsComputationSelect"), o.className = "GPinputSelect", o.addEventListener("change", (function (e) { t.onRouteModeComputationChangeAndRun(e) })); for (var s = [{ code: "fastest", label: "Plus rapide" }, { code: "shortest", label: "Plus court" }], a = 0; a < s.length; a++) { var r = document.createElement("option"); r.value = s[a].code, r.text = s[a].label, o.appendChild(r) } n.appendChild(o), e.appendChild(n); var l = document.createElement("div"); return l.id = this._addUID("GProuteResultsNew"), l.title = "Modifier le calcul", l.addEventListener("click", (function (e) { document.getElementById(t._addUID("GProuteResultsPanel")).className = "GProuteComponentHidden", document.getElementById(t._addUID("GProuteForm")).className = "", t.onShowRouteResultsNewClick(e) })), e.appendChild(l), e }, _addRouteResultsValuesElement: function (t, e, i) { var n = document.getElementById(this._addUID("GProuteResultsValues")); if (n.childElementCount) for (; n.firstChild;)n.removeChild(n.firstChild); var o = document.createElement("div"); o.className = "GProuteResultsValue"; var s = document.createElement("label"); s.className = "GProuteResultsValueLabel", s.innerHTML = "Distance :", o.appendChild(s); var a = 0; if (parseInt(t / 1e3, 10)) { var r = Math.round(t); a = (r /= 1e3) + " km" } else a = Math.round(t) + " m"; var l = document.createElement("div"); l.id = this._addUID("GProuteResultsValueDist"), l.innerHTML = a, o.appendChild(l), n.appendChild(o); var c = document.createElement("div"); c.className = "GProuteResultsValue"; var u = document.createElement("label"); u.className = "GProuteResultsValueLabel", u.innerHTML = "Durée :", c.appendChild(u); var h = document.createElement("div"); return h.id = this._addUID("GProuteResultsValueDist"), h.innerHTML = i(e), c.appendChild(h), n.appendChild(c), n }, _createRouteShowResultsDetailsElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GProuteResultsShowDetails"), t.type = "checkbox", t }, _createRouteResultsDetailsElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GProuteResultsDetails"), t }, _addRouteResultsDetailsElement: function (t, e) { var i = this, n = document.getElementById(this._addUID("GProuteResultsDetails")); if (n.childElementCount) for (; n.firstChild;)n.removeChild(n.firstChild); for (var o = 0, s = 0, a = 0; a < t.length; a++) { var r = a + 1, l = t[a], c = document.createElement("div"); c.className = "GProuteResultsDetailsNumber", c.innerHTML = r + ".", n.appendChild(c), s += parseFloat(l.duration), o += parseFloat(l.distance); var u = 0; if (parseInt(o / 1e3, 10)) { var h = Math.round(o); u = (h /= 1e3) + " km" } else u = Math.round(o) + " m"; var d = document.createElement("div"); d.className = "GProuteResultsDetailsInstruction", d.id = this._addUID("GProuteResultsDetailsInstruction_" + r), d.title = "distance : " + u + " / temps : " + e(s), d.innerHTML = l.instruction, d.addEventListener("mouseover", (function (t) { i.onRouteResultsDetailsMouseOver(t) })), d.addEventListener("mouseout", (function (t) { i.onRouteResultsDetailsMouseOut(t) })), d.addEventListener("click", (function (t) { "function" == typeof i.onRouteResultsDetailsClick && i.onRouteResultsDetailsClick(t) })), n.appendChild(d) } return n }, _createRoutePanelFormPointElement: function (t, e, i) { var n = this, o = document.createElement("div"); o.id = "GProutePoint" + t, o.className = i ? "GPflexInput GProuteStageFlexInput" : "GPflexInput GProuteStageFlexInputHidden"; var s = document.createElement("label"); s.id = "GProuteOriginLabel" + t, s.htmlFor = "GProuteOrigin" + t, s.innerHTML = e, s.addEventListener("click", (function () { var t = this.id.charAt(this.id.length - 1); document.getElementById("GProuteOriginCoords" + t).value = ""; for (var e = 1; e < 8; e++)document.getElementById("GProutePoint" + e).style.display = "flex"; document.getElementById("GProuteForm").className = "", document.getElementById("GProuteOriginPointer" + t).checked = !1, document.getElementById("GProuteOrigin" + t).className = "GProuteOriginVisible", document.getElementById("GProuteOriginCoords" + t).className = "GProuteOriginHidden" })), o.appendChild(s); var a = document.createElement("input"); a.id = "GProuteOrigin" + t, a.className = "GProuteOriginVisible", a.type = "text", a.placeholder = "Saisir une adresse", a.addEventListener("keyup", (function (t) { var e = t.which || t.keyCode; if (13 !== e && 10 !== e) { var i = this.id.charAt(this.id.length - 1); document.getElementById("GProuteOrigin" + i).value.length > 2 ? document.getElementById("GProuteAutoCompleteList" + i).style.display = "block" : document.getElementById("GProuteAutoCompleteList" + i).style.display = "none", n.onAutoCompleteSearchText(t) } })), a.addEventListener("blur", (function () { var t = this.id.charAt(this.id.length - 1); document.getElementById("GProuteAutoCompleteList" + t).style.display = "none" })), o.appendChild(a); var r = document.createElement("input"); r.id = "GProuteOriginCoords" + t, r.className = "GProuteOriginHidden", r.type = "text", r.disabled = !0, o.appendChild(r); var l = document.createElement("input"); l.id = "GProuteOriginPointer" + t, l.type = "checkbox", o.appendChild(l); var c = document.createElement("label"); return c.id = "GProuteOriginPointerImg" + t, c.htmlFor = "GProuteOriginPointer" + t, c.className = "GProuteOriginPointerImg", c.title = "Pointer un lieu sur la carte", c.addEventListener("click", (function (t) { t.preventDefault(), t.stopPropagation(); var e, i = this.id.charAt(this.id.length - 1); for (e = 1; e < 8; e++)i !== e && (document.getElementById("GProuteOriginPointer" + e).checked = !1, "Pointer un lieu sur la carte" === document.getElementById("GProuteOriginCoords" + e).value && (document.getElementById("GProuteOriginCoords" + e).value = "", document.getElementById("GProuteOrigin" + e).className = "GProuteOriginVisible", document.getElementById("GProuteOriginCoords" + e).className = "GProuteOriginHidden")); if (document.getElementById("GProuteOriginPointer" + i).checked) { for (document.getElementById("GProuteOriginCoords" + i).value = "", e = 1; e < 8; e++)document.getElementById("GProutePoint" + e).style.display = "flex"; document.getElementById("GProuteForm").className = "", document.getElementById("GProuteOriginPointer" + i).checked = !1, document.getElementById("GProuteOrigin" + i).className = "GProuteOriginVisible", document.getElementById("GProuteOriginCoords" + i).className = "GProuteOriginHidden" } else { for (document.getElementById("GProuteOriginCoords" + i).value = "Pointer un lieu sur la carte", e = 1; e < 8; e++)document.getElementById("GProutePoint" + e).style.display = i === e ? "flex" : "none"; document.getElementById("GProuteForm").className = "GProuteFormMini", document.getElementById("GProuteOriginPointer" + i).checked = !0, document.getElementById("GProuteOrigin" + i).className = "GProuteOriginHidden", document.getElementById("GProuteOriginCoords" + i).className = "GProuteOriginVisible" } n.onRouteMapPointClick(t) })), o.appendChild(c), o }, _createRoutePanelFormRemoveStageElement: function (t) { var e = this, i = document.createElement("div"); return i.id = "GProuteStageRemove" + t, i.className = "GProuteStageRemove", i.title = "Supprimer l'étape", 1 !== t && 7 !== t && i.addEventListener("click", (function (t) { var i = this.id.charAt(this.id.length - 1); document.getElementById("GProutePoint" + i).className = "GPflexInput GProuteStageFlexInputHidden", document.getElementById("GProuteOrigin" + i).value = "", document.getElementById("GProuteOrigin" + i).className = "GProuteOriginVisible", document.getElementById("GProuteOriginCoords" + i).value = "", document.getElementById("GProuteOriginCoords" + i).className = "GProuteOriginHidden", document.getElementById("GProuteStageAdd").style.display = "", e.onRouteRemovePointClick(t) })), i }, _createRoutePanelFormAddStageElement: function () { var t = this, e = document.createElement("div"); return e.id = "GProuteStageAdd", e.title = "Ajouter une étape", e.addEventListener("click", (function (e) { for (var i = 1, n = 0, o = 2; o < 7; o++)"GPflexInput GProuteStageFlexInputHidden" === document.getElementById("GProutePoint" + o).className ? 1 === i && (i = o) : n++; i < 7 && (document.getElementById("GProutePoint" + i).className = "GPflexInput GProuteStageFlexInput"), 4 === n && (document.getElementById("GProuteStageAdd").style.display = "none"), t.onRouteAddPointClick(e) })), e }, _createRoutePanelFormAutoCompleteListElement: function (t) { var e = this, i = document.createElement("div"); return i.id = "GProuteAutoCompleteList" + t, i.className = "GPadvancedAutoCompleteList", i.addEventListener ? i.addEventListener("click", (function (i) { e.onAutoCompletedResultsItemClick(i), document.getElementById("GProuteAutoCompleteList" + t).style.display = "none" }), !1) : i.attachEvent && i.attachEvent("onclick", (function (i) { e.onAutoCompletedResultsItemClick(i), document.getElementById("GProuteAutoCompleteList" + t).style.display = "none" })), i }, _createRouteAutoCompletedLocationElement: function (t, e, i) { var n = document.getElementById("GProuteAutoCompleteList" + e), o = document.createElement("div"); o.id = "AutoCompletedLocation" + i, o.className = "GPautoCompleteProposal", o.innerHTML = t.fullText, n.appendChild(o) }, _createRoutePanelFormModeChoiceElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GProuteModeChoice"), t }, _createRoutePanelFormModeChoiceTransportElement: function (t) { var e = this, i = document.createElement("div"); i.id = this._addUID("GProuteTransportChoice"); var n = document.createElement("span"); n.className = "GProuteModeLabel", n.innerHTML = "Mode de transport", i.appendChild(n); for (var o = 0; o < t.length; o++) { var s = t[o]; if ("Voiture" === s) { var a = document.createElement("input"); a.id = this._addUID("GProuteTransportCar"), a.type = "radio", a.name = "GProuteTransport", a.value = "Voiture", 0 === o && (a.checked = !0), a.addEventListener ? a.addEventListener("change", (function (t) { e.onRouteModeTransportChange(t) })) : a.attachEvent && a.attachEvent("onchange", (function (t) { e.onRouteModeTransportChange(t) })), i.appendChild(a); var r = document.createElement("label"); r.className = "GProuteTransportImg", r.htmlFor = this._addUID("GProuteTransportCar"), r.title = "Voiture", i.appendChild(r) } if ("Pieton" === s) { var l = document.createElement("input"); l.id = this._addUID("GProuteTransportPedestrian"), l.type = "radio", l.name = "GProuteTransport", l.value = "Pieton", 0 === o && (l.checked = !0), l.addEventListener ? l.addEventListener("change", (function (t) { e.onRouteModeTransportChange(t) })) : l.attachEvent && l.attachEvent("onchange", (function (t) { e.onRouteModeTransportChange(t) })), i.appendChild(l); var c = document.createElement("label"); c.className = "GProuteTransportImg", c.htmlFor = this._addUID("GProuteTransportPedestrian"), c.title = "Piéton", i.appendChild(c) } } return i }, _createRoutePanelFormModeChoiceComputeElement: function () { var t = this, e = document.createElement("div"); e.id = this._addUID("GProuteComputationChoice"); var i = document.createElement("label"); i.htmlFor = this._addUID("GProuteComputationSelect"), i.innerHTML = "Mode de calcul"; var n = document.createElement("span"); n.className = "GProuteModeLabel", n.appendChild(i), e.appendChild(n); var o = document.createElement("select"); o.id = this._addUID("GProuteComputationSelect"), o.className = "GPinputSelect", o.addEventListener("change", (function (e) { t.onRouteModeComputationChange(e) })); for (var s = [{ code: "fastest", label: "Plus rapide" }, { code: "shortest", label: "Plus court" }], a = 0; a < s.length; a++) { var r = document.createElement("option"); r.value = s[a].code, r.text = s[a].label, o.appendChild(r) } return e.appendChild(o), e }, _createShowRouteExclusionsElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPshowRouteExclusions"), t.type = "checkbox", t }, _createShowRouteExclusionsPictoElement: function () { var t = this, e = document.createElement("label"); return e.id = this._addUID("GPshowRouteExclusionsPicto"), e.className = "GPshowMoreOptionsImage GPshowMoreOptions GPshowRouteExclusionsPicto", e.htmlFor = this._addUID("GPshowRouteExclusions"), e.title = "Exclusions", e.addEventListener ? e.addEventListener("click", (function (e) { t.onShowRouteExclusionsClick(e) })) : e.attachEvent && e.attachEvent("onclick", (function (e) { t.onShowRouteExclusionsClick(e) })), e }, _createRoutePanelFormExclusionsElement: function () { var t = document.createElement("div"); t.id = this._addUID("GProuteExclusions"); var e = document.createElement("span"); return e.className = "GProuteExclusionsLabel", e.innerHTML = "Passages autorisés", t.appendChild(e), t }, _createRoutePanelFormExclusionOptionsElement: function (t) { var e = this, i = document.createElement("div"); for (var n in i.className = "GProuteExclusionsOptions", t) if (t.hasOwnProperty(n)) { var o = t[n]; switch (n) { case "toll": var s = document.createElement("input"); s.id = this._addUID("GProuteExclusionsToll"), s.type = "checkbox", s.value = "Toll", s.checked = !o, s.addEventListener ? s.addEventListener("change", (function (t) { e.onRouteExclusionsChange(t) })) : s.attachEvent && s.attachEvent("onchange", (function (t) { e.onRouteExclusionsChange(t) })), i.appendChild(s); var a = document.createElement("label"); a.className = "GProuteExclusionsOption", a.htmlFor = this._addUID("GProuteExclusionsToll"), a.innerHTML = "Péages", i.appendChild(a); break; case "tunnel": var r = document.createElement("input"); r.id = this._addUID("GProuteExclusionsTunnel"), r.type = "checkbox", r.value = "Tunnel", r.checked = !o, r.addEventListener ? r.addEventListener("change", (function (t) { e.onRouteExclusionsChange(t) })) : r.attachEvent && r.attachEvent("onchange", (function (t) { e.onRouteExclusionsChange(t) })), i.appendChild(r); var l = document.createElement("label"); l.className = "GProuteExclusionsOption", l.htmlFor = this._addUID("GProuteExclusionsTunnel"), l.innerHTML = "Tunnels", i.appendChild(l); break; case "bridge": var c = document.createElement("input"); c.id = this._addUID("GProuteExclusionsBridge"), c.type = "checkbox", c.value = "Bridge", c.checked = !o, c.addEventListener ? c.addEventListener("change", (function (t) { e.onRouteExclusionsChange(t) })) : c.attachEvent && c.attachEvent("onchange", (function (t) { e.onRouteExclusionsChange(t) })), i.appendChild(c); var u = document.createElement("label"); u.className = "GProuteExclusionsOption", u.htmlFor = this._addUID("GProuteExclusionsBridge"), u.innerHTML = "Ponts", i.appendChild(u) } } return i }, _createRouteSubmitFormElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GProuteSubmit"), t.className = "GPinputSubmit", t.type = "submit", t.value = "Calculer", t }, _createRouteFormResetElement: function () { var t = this, e = document.createElement("div"); return e.id = this._addUID("GProuteReset"), e.title = "Réinitialiser les paramètres", e.addEventListener("click", (function (e) { t.onRouteResetClick(e) })), e } }; e.default = s }, function (t, e, i) { "use strict"; i.r(e); var n = i(40), o = i(2), s = i.n(o), a = i(34), r = i(131), l = i(36), c = i(155), u = i(136), h = i(156), d = a.default.getLogger("searchengine"), p = s.a.Control.extend({ includes: h.default, options: { position: "topleft", collapsed: !0, displayInfo: !0, zoomTo: "", resources: [], placeholder: "Rechercher un lieu, une adresse", displayMarker: !0, markerStyle: "blue", displayAdvancedSearch: !0, advancedSearch: {}, geocodeOptions: {}, autocompleteOptions: { serviceOptions: {}, triggerGeocode: !1, triggerDelay: 1e3 } }, initialize: function (t) { s.a.Util.setOptions(this, t), this._uid = l.default.generate(), this._showContainer = null, this._pictoContainer = null, this._inputContainer = null, this._suggestedContainer = null, this._suggestedLocations = [], this._geocodedContainer = null, this._geocodedLocations = [], this._filterContainer = null, this._currentGeocodingCode = null, this._currentGeocodingLocation = null, this._advancedSearchFilters = {}, this._advancedSearchCodes = [], this._marker = null, this._servicesRightManagement = {}, this._noRightManagement = !1, this._checkRightsManagement(), this._triggerHandler = null }, onAdd: function () { this._initAdvancedSearchCodes(), this._initAdvancedSearchFilters(); var t = this._initLayout(); return s.a.DomEvent.disableClickPropagation(t).disableScrollPropagation(t), t }, onRemove: function (t) { this._clearSuggestedLocation(), this._clearGeocodedLocation(), null != this._marker && (t.removeLayer(this._marker), this._marker = null) }, _checkRightsManagement: function () { this.options.resources && 0 !== this.options.resources.length || (this.options.resources = ["StreetAddress", "PositionOfInterest"]); var t = null, e = [], i = null; i = this.options.geocodeOptions.apiKey, (e = (t = this.options.geocodeOptions.filterOptions) ? t.type : []) && 0 !== e.length || (e = this.options.resources || ["StreetAddress", "PositionOfInterest"]); var n = r.default.check({ key: i || this.options.apiKey, resources: e, services: ["Geocode"] }); i = this.options.autocompleteOptions.apiKey, (e = (t = this.options.autocompleteOptions.filterOptions) ? t.type : []) && 0 !== e.length || (e = this.options.resources || ["StreetAddress", "PositionOfInterest"]); var o = r.default.check({ key: i || this.options.apiKey, resources: e, services: ["AutoCompletion"] }); if (n || o || (this._noRightManagement = !0), o && (this._servicesRightManagement.AutoCompletion = {}, this._servicesRightManagement.AutoCompletion.resources = o.AutoCompletion, this._servicesRightManagement.AutoCompletion.key = o.key), n && (this._servicesRightManagement.Geocode = {}, this._servicesRightManagement.Geocode.resources = n.Geocode, this._servicesRightManagement.Geocode.key = n.key), !this.options.advancedSearch || 0 === Object.keys(this.options.advancedSearch).length) for (var s = this._servicesRightManagement.Geocode.resources, a = 0; a < s.length; a++) { var l = s[a]; this.options.advancedSearch[l] = [] } }, _initLayout: function () { var t = this._createMainContainerElement(), e = this._showContainer = this._createShowSearchEngineElement(); t.appendChild(e), this.options.collapsed || (e.checked = "true"); var i = this._pictoContainer = this._createShowSearchEnginePictoElement(); t.appendChild(i); var n = this._createSearchInputElement(this.options.placeholder); if (t.appendChild(n), this.options.displayAdvancedSearch) { var o = this._createShowAdvancedSearchElement(); t.appendChild(o); var s = this._createAdvancedSearchPanelElement(), a = this._createAdvancedSearchPanelHeaderElement(), r = this._createAdvancedSearchPanelFormElement(this._advancedSearchCodes), l = this._filterContainer = this._createAdvancedSearchFormFiltersElement(); this._setFilter(this._advancedSearchCodes[0].id); var c = this._createAdvancedSearchFormInputElement(); r.appendChild(l), r.appendChild(c), s.appendChild(a), s.appendChild(r), t.appendChild(s) } var u = this._createAutoCompleteElement(), h = this._suggestedContainer = this._createAutoCompleteListElement(); u.appendChild(h), t.appendChild(u); var d = this._createGeocodeResultsElement(), p = this._geocodedContainer = this._createGeocodeResultsListElement(); return d.appendChild(p), t.appendChild(d), t }, _initAdvancedSearchCodes: function () { for (var t = [{ id: "PositionOfInterest", title: "Lieux/toponymes" }, { id: "StreetAddress", title: "Adresses" }, { id: "CadastralParcel", title: "Parcelles cadastrales" }, { id: "Administratif", title: "Administratif" }], e = Object.keys(this.options.advancedSearch), i = 0; i < e.length; i++)for (var n = e[i], o = 0; o < t.length; o++)t[o].id === n && this._advancedSearchCodes.push(t[o]); 0 === this._advancedSearchCodes.length && (this._advancedSearchCodes = t), d.log("advancedSearchCodes", this._advancedSearchCodes) }, _initAdvancedSearchFilters: function () { var t = { PositionOfInterest: [{ name: "city", title: "Ville", filter: !1, sep: !0 }, { name: "importance", title: "Importance", filter: !0 }, { name: "nature", title: "Nature", filter: !0 }, { name: "territory", title: "Territoire", filter: !0 }, { name: "insee", title: "Code commune (INSEE)", filter: !0 }, { name: "department", title: "Département", filter: !0 }], StreetAddress: [{ name: "number", title: "Numéro", filter: !1, sep: !0 }, { name: "street", title: "Rue", filter: !1, sep: !0 }, { name: "postalCode", title: "Code Postal", filter: !1, sep: !0 }, { name: "city", title: "Ville", filter: !1, sep: !0 }, { name: "territory", title: "Territoire", filter: !0 }, { name: "insee", title: "Code commune (INSEE)", filter: !0 }, { name: "department", title: "Département", filter: !0 }], CadastralParcel: [{ name: "department", title: "Département", filter: !1, sep: !1, value: "__" }, { name: "commune", title: "Commune", filter: !1, sep: !1, value: "___" }, { name: "absorbedCity", title: "Commune absorbée", filter: !1, sep: !1, value: "___" }, { name: "section", title: "Section", filter: !1, sep: !1, value: "__" }, { name: "number", title: "Numéro", filter: !1, sep: !1, value: "____" }], Administratif: [{ name: "prefecture", title: "Préfecture", filter: !0 }, { name: "inseeRegion", title: "Code région (INSEE)", filter: !0 }, { name: "inseeDepartment", title: "Code département (INSEE)", filter: !0 }, { name: "city", title: "Ville", filter: !1, sep: !0 }] }, e = this.options.advancedSearch; for (var i in e) if (e.hasOwnProperty(i)) { if (!e[i] || 0 === e[i].length) { e[i] = t[i]; continue } for (var n = e[i], o = 0; o < n.length; o++) { var a = n[o]; a.hasOwnProperty("filter") || (a.filter = "municipality" !== a.name) } } s.a.Util.extend(this._advancedSearchFilters, t, e), d.log("advancedSearchFilters", this._advancedSearchFilters) }, _setFilter: function (t) { for (var e = this._filterContainer, i = !1, n = 0; n < this._advancedSearchCodes.length; n++)if (this._advancedSearchCodes[n].id === t) { i = !0; break } if (i) { for (this._currentGeocodingCode = t; e.firstChild;)e.removeChild(e.firstChild); var o = this._advancedSearchFilters[t]; if (o && 0 !== o.length) { for (var s = this._createAdvancedSearchFiltersTableElement(t, !0), a = 0; a < o.length; a++) { var r = this._createAdvancedSearchFiltersAttributElement(o[a]); s.appendChild(r) } return e.appendChild(s), e } } else for (; e.firstChild;)e.removeChild(e.firstChild) }, _requestAutoComplete: function (t) { if (t && 0 !== Object.keys(t).length && t.text) if (d.log(t), this._noRightManagement) d.log("no rights for all service !?"); else if (this._servicesRightManagement.AutoCompletion) { var e = {}; s.a.Util.extend(e, this.options.autocompleteOptions.serviceOptions), s.a.Util.extend(e, t); var i = this._servicesRightManagement.AutoCompletion.resources; if (i && 0 !== Object.keys(i).length) { s.a.Util.isArray(i) && !e.filterOptions && (e.filterOptions = {}, e.filterOptions.type = i); var o = this._servicesRightManagement.AutoCompletion.key; s.a.Util.extend(e, { apiKey: e.apiKey || this.options.apiKey || o }), s.a.Util.extend(e, { ssl: this.options.ssl }), d.log(e), n.default.Services.autoComplete(e) } } else d.log("no rights for this service !?") }, _fillAutoCompletedLocationListContainer: function (t) { if (t && 0 !== t.length) { var e = this._suggestedContainer; if (e.childElementCount) for (; e.firstChild;)e.removeChild(e.firstChild); for (var i = 0; i < t.length; i++)this._createAutoCompletedLocationElement(t[i], i) } }, _requestGeocoding: function (t) { if (t && 0 !== Object.keys(t).length && t.location) if (d.log(t), this._noRightManagement) d.log("no rights for all service !?"); else if (this._servicesRightManagement.Geocode) { var e = {}; s.a.Util.extend(e, this.options.geocodeOptions), s.a.Util.extend(e, t), e.hasOwnProperty("returnFreeForm") || s.a.Util.extend(e, { returnFreeForm: !0 }); var i = this._servicesRightManagement.Geocode.resources; if (i && 0 !== Object.keys(i).length) { s.a.Util.isArray(i) && !e.filterOptions && (e.filterOptions = {}, e.filterOptions.type = i); var o = this._servicesRightManagement.Geocode.key; s.a.Util.extend(e, { apiKey: e.apiKey || this.options.apiKey || o }), s.a.Util.extend(e, { ssl: this.options.ssl }), d.log(e), n.default.Services.geocode(e) } } else d.log("no rights for this service !?") }, _fillGeocodedLocationListContainer: function (t) { if (t && 0 !== t.length) { var e = this._geocodedContainer; if (e.childElementCount) for (; e.firstChild;)e.removeChild(e.firstChild); for (var i = 0; i < t.length; i++)d.log(t[i]), this._createGeocodedLocationElement(t[i], i); this._geocodedLocations = t } else this._clearGeocodedLocation() }, _getGeocodeCoordinatesFromFullText: function (t, e) { var i = t.fullText, n = this; this._requestGeocoding({ location: i, onSuccess: function (t) { d.log("request from Geocoding (coordinates null)", t), t.locations && 0 !== t.locations.length && t.locations[0].position && n._suggestedLocations && n._suggestedLocations[e] && (n._suggestedLocations[e].position = { x: t.locations[0].position.y, y: t.locations[0].position.x }, n._locationsToBeDisplayed.unshift(n._suggestedLocations[e]), n._fillAutoCompletedLocationListContainer(n._locationsToBeDisplayed)) }, onFailure: function () { n._suggestedLocations && n._suggestedLocations[e] && n._createAutoCompletedLocationElement(n._suggestedLocations[e], e) } }) }, _setLabel: function (t) { s.a.DomUtil.get("GPsearchInputText-" + this._uid).value = t || "" }, _setPosition: function (t, e) { var i = this._map; i.setZoomAround(s.a.latLng(t.x, t.y), e, !0), i.panTo(s.a.latLng(t.x, t.y)) }, _getZoom: function (t) { var e = this._map, i = this.options.zoomTo, n = null; if ("function" == typeof i && (d.trace("zoom function"), n = i.call(this, t)), "number" == typeof i && (d.trace("zoom level"), n = i), "string" == typeof i) if ("auto" === i) d.trace("zoom auto"), n = c.default.zoomToResultsByDefault(t); else { d.trace("zoom level parsing"); var o = parseInt(i, 10); isNaN(o) || (d.trace("zoom parsing"), n = o) } Number.isInteger = Number.isInteger || function (t) { return "number" == typeof t && isFinite(t) && Math.floor(t) === t }, n && "" !== n && Number.isInteger(n) || (d.trace("zoom not found, current zoom..."), n = e.getZoom()); var s = e.getMinZoom(), a = e.getMaxZoom(); return n < s && (d.trace("zoom level min..."), n = s), n > a && (d.trace("zoom level max..."), n = a), d.trace("zoom", n), n }, _setMarker: function (t, e, i, n) { var o = this._map; if (null != this._marker && (o.removeLayer(this._marker), this._marker = null), t) { var a = null; "string" == typeof n ? a = new u.default(n) : n instanceof s.a.Icon ? a = n : (a = new u.default("blue"), d.log("Utilisation du marker par défaut !")); var r = { clickable: !0, zIndexOffset: 1e3, icon: a }; if (this._marker = s.a.marker(s.a.latLng(t.x, t.y), r), this._marker.addTo(o), i) { var l = null; if ("string" != typeof e) { var c = []; if ("DirectGeocodedLocation" === e.service) if (e.fields.freeform) l = e.fields.freeform; else { for (var h = this._advancedSearchFilters[e.type], p = 0; p < h.length; p++) { var m = h[p].name, f = e.fields[m]; "string" != typeof f && "number" != typeof f || c.push(f) } l = c.join(" - ") } else "SuggestedLocation" === e.service ? e.fields.fullText ? l = e.fields.fullText : (c.push(e.fields.street || ""), c.push(e.fields.postalCode || ""), c.push(e.fields.commune || ""), "PositionOfInterest" === e.type && (c.push(e.fields.poi || ""), c.push(e.fields.kind || "")), l = c.join(" - ")) : l = "sans informations." } else l = e; this._marker.bindPopup(l) } } }, _clearResults: function () { this._currentGeocodingLocation = null, this._clearSuggestedLocation(), this._clearGeocodedLocation(), this._setMarker() }, _clearSuggestedLocation: function () { if (this._suggestedLocations = [], this._suggestedContainer) for (; this._suggestedContainer.firstChild;)this._suggestedContainer.removeChild(this._suggestedContainer.firstChild) }, _clearGeocodedLocation: function () { if (this._geocodedLocations = [], this._geocodedContainer) for (; this._geocodedContainer.firstChild;)this._geocodedContainer.removeChild(this._geocodedContainer.firstChild) }, onShowSearchEngineClick: function () { }, onSearchResetClick: function () { this._clearResults() }, onAutoCompleteSearchText: function (t) { var e = t.target.value; if (e && !(this._noRightManagement || (this._currentGeocodingLocation = e, e.length < 3))) { var i = this.options.autocompleteOptions.triggerGeocode, n = this.options.autocompleteOptions.triggerDelay, o = this; this._requestAutoComplete({ text: e, onSuccess: function (t) { if (d.log("request from AutoComplete", t), t) { if (o._suggestedLocations = t.suggestedLocations, o._locationsToBeDisplayed = [], o._servicesRightManagement.Geocode && o._servicesRightManagement.Geocode.key) for (var e = 0; e < o._suggestedLocations.length; e++) { var i = o._suggestedLocations[e]; i.position && 0 === i.position.x && 0 === i.position.y && i.fullText ? o._getGeocodeCoordinatesFromFullText(i, e) : o._locationsToBeDisplayed.push(i) } else o._locationsToBeDisplayed = o._suggestedLocations; o._fillAutoCompletedLocationListContainer(o._locationsToBeDisplayed), o._triggerHandler && (clearTimeout(o._triggerHandler), o._triggerHandler = null, d.warn("Cancel a geocode request !")) } }, onFailure: function (t) { o._clearSuggestedLocation(), d.log(t.message), "No suggestion matching the search" === t.message && i && (o._triggerHandler && (clearTimeout(o._triggerHandler), d.warn("Cancel the last geocode request !")), o._triggerHandler = setTimeout((function () { d.warn("Launch a geocode request (code postal) !"), o._requestGeocoding({ location: e, returnFreeForm: !0, onSuccess: function (t) { if (d.log("request from Geocoding", t), t) { o._locationsToBeDisplayed = []; for (var e = t.locations, i = 0; i < e.length; i++) { var n = e[i]; n.fullText = n.placeAttributes.freeform, n.position = { x: n.position.y, y: n.position.x }, o._locationsToBeDisplayed.push(n) } o._fillAutoCompletedLocationListContainer(e) } }, onFailure: function (t) { d.log(t.message) } }) }), n)) } }) } }, onAutoCompletedResultsItemClick: function (t) { var e = l.default.index(t.target.id), i = t.target.innerHTML; if (d.log(e, i), d.log(this._locationsToBeDisplayed[e]), e) { var n = { x: this._locationsToBeDisplayed[e].position.y, y: this._locationsToBeDisplayed[e].position.x }, o = { service: "SuggestedLocation", type: this._locationsToBeDisplayed[e].type, fields: this._locationsToBeDisplayed[e] }, s = this._getZoom(o); this._setLabel(i), this._setPosition(n, s), this.options.displayMarker && this._setMarker(n, o, this.options.displayInfo, this.options.markerStyle) } }, onGeocodingSearchSubmit: function (t) { d.log(t); var e = t.target[0].value; if (e && !this._noRightManagement) { this._currentGeocodingLocation = e; var i = this; this._requestGeocoding({ location: e, onSuccess: function (t) { if (d.log("request from Geocoding", t), t) { var e = t.locations; i._fillGeocodedLocationListContainer(e) } }, onFailure: function (t) { i._clearGeocodedLocation(), d.log(t.message) } }) } }, onGeocodedResultsItemClick: function (t) { var e = l.default.index(t.target.id), i = t.target.innerHTML; if (d.log(e, i), d.log(this._geocodedLocations[e]), e) { var n = this._geocodedLocations[e].position, o = { service: "DirectGeocodedLocation", type: this._geocodedLocations[e].type, fields: this._geocodedLocations[e].placeAttributes }, s = this._getZoom(o); this._setLabel(i), this._setPosition(n, s), this.options.displayMarker && this._setMarker(n, o, this.options.displayInfo, this.options.markerStyle) } }, onGeocodingAdvancedSearchCodeChange: function (t) { d.log(t); var e = t.target.selectedIndex, i = t.target.options[e].value; i && this._setFilter(i) }, onGeocodingAdvancedSearchSubmit: function (t, e) { if (d.log(e), e && 0 !== e.length) { var i = {}; i.type = [this._currentGeocodingCode]; var n = this._currentGeocodingLocation || ""; "CadastralParcel" === this._currentGeocodingCode && (n = ""); for (var o = 0; o < e.length; o++) { var s = e[o]; if (s.value) for (var a = this._advancedSearchFilters[this._currentGeocodingCode], r = 0; r < a.length; r++) { var l = a[r]; if (l.name === s.key) if (l.filter) i[s.key] = s.value; else if (l.value) { var c = s.value.length, u = l.value.length; if (u !== c) { for (var h = u - c, p = l.value.charAt(0); p.length < h;)p += p; var m = p.slice(0, h); s.value = s.value + m } n += s.value } else "string" == typeof n && (n = {}), n[s.key] = s.value } } var f = this; this._requestGeocoding({ location: n, filterOptions: i, onSuccess: function (t) { if (d.log(t), t) { var e = t.locations; f._fillGeocodedLocationListContainer(e) } }, onFailure: function (t) { f._clearGeocodedLocation(), d.log(t.message) } }) } }, setText: function (t, e, i) { this._showContainer.checked || this._pictoContainer.click(), s.a.Util.extend(this.options, i); var n = s.a.DomUtil.get("GPsearchInputText-" + this._uid); (n.value = t, e) ? s.a.DomUtil.get("GPsearchInput-" + this._uid).dispatchEvent(new Event("submit", { bubbles: !0, cancelable: !0 })) : n.dispatchEvent(new KeyboardEvent("keyup")) } }); e.default = p }, function (t, e, i) { "use strict"; i.r(e); e.default = { advancedSearchFiltersByDefault: { PositionOfInterest: [{ name: "importance", title: "Importance" }, { name: "nature", title: "Nature" }, { name: "territory", title: "Territoire" }, { name: "insee", title: "Code INSEE" }, { name: "municipality", title: "Ville" }, { name: "department", title: "Département" }], StreetAddress: [{ name: "territory", title: "Territoire" }, { name: "insee", title: "Code INSEE" }, { name: "municipality", title: "Ville" }, { name: "department", title: "Département" }], CadastralParcel: [{ name: "department", title: "Département", description: "Numéro du département (ex: 01, 94)" }, { name: "commune", title: "Code commune (INSEE)", description: "Code commune (INSEE) : 3 chiffres (ex: 067)" }, { name: "absorbedCity", title: "Commune absorbée", description: "Commune absorbée : 3 chiffres (ex: 000, 001)" }, { name: "section", title: "Section", description: "Section : 2 caractères (ex: AA, 0D)" }, { name: "number", title: "Numéro", description: "Numéro de la parcelle : 4 chiffres (ex: 0041, 0250)" }], Administratif: [{ name: "prefecture", title: "Préfecture" }, { name: "inseeRegion", title: "Code région (INSEE)" }, { name: "inseeDepartment", title: "Code département (INSEE)" }, { name: "municipality", title: "Ville" }] }, zoomToResultsByDefault: function (t) { var e = 15, i = t.service, n = t.fields, o = t.type, s = { 1: 11, 2: 12, 3: 13, 4: 14, 5: 15, 6: 16, 7: 17, 8: 17 }; return "SuggestedLocation" === i && "PositionOfInterest" === o && (e = s[n.classification]), "DirectGeocodedLocation" === i && "PositionOfInterest" === o && (e = s[n.importance] || 14), "StreetAddress" === o && (e = 17), "CadastralParcel" === o && (e = 17), "Administratif" === o && (e = 12), e } } }, function (t, e, i) { "use strict"; i.r(e); var n = i(36), o = { _addUID: function (t) { return this._uid ? t + "-" + this._uid : t }, _createMainContainerElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPsearchEngine"), t.className = "GPwidget", t }, _createShowSearchEngineElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPshowSearchEngine"), t.type = "checkbox", t }, _createShowSearchEnginePictoElement: function () { var t = this, e = document.createElement("label"); e.id = this._addUID("GPshowSearchEnginePicto"), e.className = "GPshowAdvancedToolPicto", e.htmlFor = this._addUID("GPshowSearchEngine"), e.title = "Afficher/masquer la recherche par lieux", e.addEventListener("click", (function () { document.getElementById(t._addUID("GPautoCompleteList")).style.display = "none", document.getElementById(t._addUID("GPgeocodeResultsList")).style.display = "none"; var e = document.getElementById(t._addUID("GPshowAdvancedSearch")); e && (e.style.display = null, document.getElementById(t._addUID("GPadvancedSearchPanel")).style.display = "none"); var i = "#GPsearchInput-" + t._uid; document.querySelector(i + " input").disabled = !1, t.onShowSearchEngineClick() })); var i = document.createElement("span"); return i.id = this._addUID("GPshowSearchEngineOpen"), i.className = "GPshowAdvancedToolOpen", e.appendChild(i), e }, _createSearchInputElement: function (t) { var e = this, i = document.createElement("form"); i.id = this._addUID("GPsearchInput"), i.addEventListener("submit", (function (t) { return t.preventDefault(), document.getElementById(e._addUID("GPgeocodeResultsList")).style.display = "block", document.getElementById(e._addUID("GPautoCompleteList")).style.display = "none", e.onGeocodingSearchSubmit(t), !1 })); var o = document.createElement("input"); o.id = this._addUID("GPsearchInputText"), o.type = "text", o.placeholder = t, o.autocomplete = "off", o.addEventListener("keyup", (function (t) { var i = t.which || t.keyCode; 13 !== i && 10 !== i && 38 !== i && 40 !== i && (document.getElementById(e._addUID("GPgeocodeResultsList")).style.display = "none", o.value.length > 2 ? document.getElementById(e._addUID("GPautoCompleteList")).style.display = "block" : document.getElementById(e._addUID("GPautoCompleteList")).style.display = "none", e.onAutoCompleteSearchText(t)) })), o.addEventListener("keydown", (function (t) { var i = t.which || t.keyCode, o = document.getElementById(e._addUID("GPautocompleteResults")); if (o) { var s = o.getElementsByClassName("GPautoCompleteProposal current"), a = o.getElementsByClassName("GPautoCompleteProposal"), r = a.length; if (r) { var l = null; if (!s.length) return (l = a[0]).className = "GPautoCompleteProposal current", l.style.color = "#000000", void (l.style["background-color"] = "#CEDBEF"); l = s[0]; var c = parseInt(n.default.index(l.id), 10), u = c === r - 1 ? a[0] : a[c + 1], h = 0 === c ? a[r - 1] : a[c - 1]; switch (l.style["background-color"] = "", l.style.color = "", h.style["background-color"] = "", h.style.color = "", u.style["background-color"] = "", u.style.color = "", i) { case 38: l.className = "GPautoCompleteProposal", h.className = "GPautoCompleteProposal current", h.style.color = "#000000", h.style["background-color"] = "#CEDBEF"; break; case 40: l.className = "GPautoCompleteProposal", u.className = "GPautoCompleteProposal current", u.style.color = "#000000", u.style["background-color"] = "#CEDBEF"; break; case 13: t.preventDefault(), l.click(t) }l.focus() } } })), i.appendChild(o); var s = document.createElement("div"); return s.id = this._addUID("GPsearchInputReset"), s.addEventListener("click", (function () { document.getElementById(e._addUID("GPsearchInputText")).value = "", document.getElementById(e._addUID("GPautoCompleteList")).style.display = "none", document.getElementById(e._addUID("GPgeocodeResultsList")).style.display = "none", e.onSearchResetClick() })), i.appendChild(s), i }, _createShowAdvancedSearchElement: function () { var t = this, e = document.createElement("div"); e.id = this._addUID("GPshowAdvancedSearch"), e.className = "GPshowAdvancedToolPicto", e.title = "Ouvrir la recherche avancée", e.addEventListener("click", (function () { var e = "#GPsearchInput-" + t._uid; document.querySelector(e + " input").disabled = !0, document.getElementById(t._addUID("GPautoCompleteList")).style.display = "none", document.getElementById(t._addUID("GPgeocodeResultsList")).style.display = "none", document.getElementById(t._addUID("GPshowAdvancedSearch")).style.display = "none", document.getElementById(t._addUID("GPadvancedSearchPanel")).style.display = "inline-block" })); var i = document.createElement("span"); return i.id = this._addUID("GPshowAdvancedSearchOpen"), i.className = "GPshowAdvancedToolOpen", e.appendChild(i), e }, _createAdvancedSearchPanelElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPadvancedSearchPanel"), t.className = "GPpanel", t.style.display = "none", t }, _createGeocodeResultsElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPgeocodeResultsList"), t.className = "GPpanel", t.style.display = "none", t.appendChild(this._createGeocodeResultsHeaderElement()), t }, _createAutoCompleteElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPautoCompleteList"), t.className = "GPautoCompleteList", t.style.display = "none", t }, _createAutoCompleteListElement: function () { var t = this, e = document.createElement("div"); return e.id = this._addUID("GPautocompleteResults"), e.addEventListener ? e.addEventListener("click", (function (e) { t.onAutoCompletedResultsItemClick(e), document.getElementById(t._addUID("GPautoCompleteList")).style.display = "none" }), !1) : e.attachEvent && e.attachEvent("onclick", (function (e) { t.onAutoCompletedResultsItemClick(e), document.getElementById(t._addUID("GPautoCompleteList")).style.display = "none" })), e }, _createAutoCompletedLocationElement: function (t, e) { var i = document.getElementById(this._addUID("GPautocompleteResults")), n = document.createElement("div"); n.id = this._addUID("AutoCompletedLocation_" + e), n.className = "GPautoCompleteProposal", n.innerHTML = t.fullText, n.addEventListener ? n.addEventListener("click", (function (t) { i.click(t) }), !1) : n.attachEvent && n.attachEvent("onclick", (function (t) { i.click(t) })), i.appendChild(n) }, _createAdvancedSearchPanelHeaderElement: function () { var t = this, e = document.createElement("div"); e.className = "GPpanelHeader"; var i = document.createElement("div"); i.className = "GPpanelTitle", i.innerHTML = "Recherche avancée", e.appendChild(i); var n = document.createElement("div"); return n.id = this._addUID("GPadvancedSearchClose"), n.className = "GPpanelClose", n.title = "Fermer la recherche avancée", n.addEventListener ? n.addEventListener("click", (function () { var e = "#GPsearchInput-" + t._uid; document.querySelector(e + " input").disabled = !1, document.getElementById(t._addUID("GPgeocodeResultsList")).style.display = "none", document.getElementById(t._addUID("GPshowAdvancedSearch")).style.display = "inline-block", document.getElementById(t._addUID("GPadvancedSearchPanel")).style.display = "none" }), !1) : n.attachEvent && n.attachEvent("onclick", (function () { var e = "#GPsearchInput-" + t._uid; document.querySelector(e + " input").disabled = !1, document.getElementById(t._addUID("GPgeocodeResultsList")).style.display = "none", document.getElementById(t._addUID("GPshowAdvancedSearch")).style.display = "inline-block", document.getElementById(t._addUID("GPadvancedSearchPanel")).style.display = "none" })), e.appendChild(n), e }, _createAdvancedSearchPanelFormElement: function (t) { var e = this, i = document.createElement("form"); i.id = this._addUID("GPadvancedSearchForm"), i.addEventListener("submit", (function (t) { t.preventDefault(); for (var i = [], n = "#GPadvancedSearchFilters-" + e._uid, o = document.querySelectorAll(n + " > div > div > input"), s = 0; s < o.length; s++) { var a = o[s]; i.push({ key: a.name, value: a.value }) } return e.onGeocodingAdvancedSearchSubmit(t, i), document.getElementById(e._addUID("GPgeocodeResultsList")).style.display = "block", !1 })); var n = document.createElement("div"); n.className = "GPflexInput"; var o = document.createElement("label"); o.className = "GPadvancedSearchCodeLabel", o.innerHTML = "Recherche par", n.appendChild(o); var s = this._createAdvancedSearchFormCodeElement(t); return n.appendChild(s), i.appendChild(n), i }, _createAdvancedSearchFormCodeElement: function (t) { var e = this, i = document.createElement("select"); i.id = this._addUID("GPadvancedSearchCode"), i.className = "GPadvancedSearchCode", i.addEventListener("change", (function (t) { e.onGeocodingAdvancedSearchCodeChange(t) }), !1), t || (t = [{ id: "PositionOfInterest", title: "Lieux/toponymes" }, { id: "StreetAddress", title: "Adresses" }, { id: "CadastralParcel", title: "Parcelles cadastrales" }, { id: "Administratif", title: "Administratif" }]); for (var n = 0; n < t.length; n++) { var o = document.createElement("option"); o.value = t[n].id, o.text = t[n].title, i.appendChild(o) } return i }, _createAdvancedSearchFormInputElement: function () { var t = document.createElement("input"); return t.type = "submit", t.id = this._addUID("GPadvancedSearchSubmit"), t.className = "GPinputSubmit", t.value = "Chercher", t }, _createAdvancedSearchFormFiltersElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPadvancedSearchFilters"), t }, _createAdvancedSearchFiltersTableElement: function (t, e) { var i = document.createElement("div"); return i.id = this._addUID(t), e || (i.style.display = "none"), i }, _createAdvancedSearchFiltersAttributElement: function (t) { var e = null, i = t.name, n = t.title, o = t.description, s = t.code, a = t.value, r = document.createElement("div"); r.className = "GPflexInput"; var l = document.createElement("label"); l.className = "GPadvancedSearchFilterLabel", l.htmlFor = i, l.title = o || n, l.innerHTML = n, r.appendChild(l); var c = document.createElement("input"); return c.id = i, c.className = "GPadvancedSearchFilterInput", c.type = "text", c.name = i, a && (c.value = a), r.appendChild(c), (e = document.getElementById(this._addUID(s))) ? e.appendChild(r) : e = r, e }, _createGeocodeResultsHeaderElement: function () { var t = this, e = document.createElement("div"); e.className = "GPpanelHeader"; var i = document.createElement("div"); i.className = "GPpanelTitle", i.innerHTML = "Résultats de la recherche", e.appendChild(i); var n = document.createElement("div"); return n.id = this._addUID("GPgeocodeResultsClose"), n.className = "GPpanelClose", n.title = "Fermer la fenêtre de résultats", n.addEventListener ? n.addEventListener("click", (function () { document.getElementById(t._addUID("GPgeocodeResultsList")).style.display = "none" }), !1) : n.attachEvent && n.attachEvent("onclick", (function () { document.getElementById(t._addUID("GPgeocodeResultsList")).style.display = "none" })), e.appendChild(n), e }, _createGeocodeResultsListElement: function () { var t = this, e = document.createElement("div"); return e.id = this._addUID("GPgeocodeResults"), e.addEventListener ? e.addEventListener("click", (function (e) { e.ctrlKey || (document.getElementById(t._addUID("GPgeocodeResultsList")).style.display = "none"), t.onGeocodedResultsItemClick(e) }), !1) : e.attachEvent && e.attachEvent("onclick", (function (e) { e.ctrlKey || (document.getElementById(t._addUID("GPgeocodeResultsList")).style.display = "none"), t.onGeocodedResultsItemClick(e) })), e }, _createGeocodedLocationElement: function (t, e) { var i = document.getElementById(this._addUID("GPgeocodeResults")), n = document.createElement("div"); if (n.id = this._addUID("GeocodedLocation_" + e), n.className = "GPautoCompleteProposal", "string" == typeof t) n.innerHTML = t; else { var o = t.placeAttributes; o.freeform ? n.innerHTML = o.freeform : o.postalCode ? n.innerHTML = o.postalCode + " " + o.commune : o.cadastralParcel ? n.innerHTML = o.cadastralParcel : n.innerHTML = "..." } i.appendChild(n) } }; e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = i(40), o = i(2), s = i.n(o), a = (i(150), i(34)), r = i(131), l = i(36), c = i(135), u = i(136), h = i(158), d = i(159), p = a.default.getLogger("ElevationPath"), m = s.a.Control.extend({ includes: h.default, options: { position: "topleft", active: !1, elevationPathOptions: {}, stylesOptions: {}, displayProfileOptions: { greaterSlope: !0, meanSlope: !0, ascendingElevation: !0, descendingElevation: !0, currentSlope: !0, apply: null, target: null } }, initialize: function (t) { s.a.Util.setOptions(this, t), this._uid = l.default.generate(), this._initDisplayProfileOptions(), this._showContainer = null, this._pictoContainer = null, this._panelContainer = null, this._profilContainer = null, this._waitingContainer = null, this._infoContainer = null, this._timerHdlr = null, this._reducePanel = !1, this._featuresLayer = null, this._lastIdLayer = 0, this._currentIdLayer = 0, this._currentFeature = null, this._profile = null, this._marker = null, this._geometry = null, this._distance = 0, this._data = {}, this._noRightManagement = !1, this._checkRightsManagement() }, onAdd: function (t) { var e = this._container = this._initLayout(); return t && this.options.active && (null === this._profile && (this._panelContainer.style.display = "none"), this._activateMapInteraction(t)), s.a.DomEvent.disableClickPropagation(e).disableScrollPropagation(e), e }, onRemove: function () { }, _checkRightsManagement: function () { var t = r.default.check({ key: this.options.apiKey, resources: ["SERVICE_CALCUL_ALTIMETRIQUE_RSC"], services: ["ElevationLine"] }); t || (this._noRightManagement = !0), this.options.apiKey || (this.options.apiKey = t.key) }, _initDisplayProfileOptions: function () { var t = this.options.displayProfileOptions, e = t.apply; t.apply = "function" == typeof e ? e : m.DISPLAY_PROFILE_BY_DEFAULT; var i = t.target; t.target = void 0 !== i ? i : null; var n = Object.getPrototypeOf(this.options); void 0 === t.meanSlope && (t.meanSlope = n.displayProfileOptions.meanSlope), void 0 === t.greaterSlope && (t.greaterSlope = n.displayProfileOptions.greaterSlope), void 0 === t.ascendingElevation && (t.ascendingElevation = n.displayProfileOptions.ascendingElevation), void 0 === t.descendingElevation && (t.descendingElevation = n.displayProfileOptions.descendingElevation), void 0 === t.currentSlope && (t.currentSlope = n.displayProfileOptions.currentSlope) }, _initLayout: function () { var t = this._createMainContainerElement(), e = this._showContainer = this._createShowElevationPathElement(); t.appendChild(e), this.options.active && (this._showContainer.checked = !0); var i = this._pictoContainer = this._createShowElevationPathPictoElement(); t.appendChild(i); var n = this._panelContainer = this._createElevationPathPanelElement(), o = this._createElevationPathPanelHeaderElement(); n.appendChild(o); var s = this._profilContainer = this._createElevationPathPanelProfilElement(); n.appendChild(s); var a = this._waitingContainer = this._createElevationPathWaitingElement(); n.appendChild(a); var r = this._infoContainer = this._createElevationPathInformationsElement(); return n.appendChild(r), t.appendChild(n), t }, onShowElevationPathClick: function (t) { p.trace(t); var e = this._map; this._reducePanel ? null !== this._profile && (null === this.options.displayProfileOptions.target && (this._pictoContainer.style.display = "none"), this._panelContainer.style.display = "block") : this._showContainer.checked ? (this._pictoContainer.style.display = "block", this._panelContainer.style.display = "none", this._removeMapInteraction(e), this._clear()) : (null === this._profile && (this._panelContainer.style.display = "none"), this._activateMapInteraction(e)), this._reducePanel = !1 }, onReduceElevationPathPanelClick: function () { this._reducePanel = !0, this._pictoContainer.style.display = "block", this._panelContainer.style.display = "none" }, onOpenElevationPathInfoClick: function () { var t = this.options.displayProfileOptions.meanSlope, e = this.options.displayProfileOptions.greaterSlope, i = this.options.displayProfileOptions.ascendingElevation, n = this.options.displayProfileOptions.descendingElevation, o = this._infoContainer; if (o.childElementCount) for (; o.firstChild;)o.removeChild(o.firstChild); i && this._addElevationPathInformationsItem("Dénivelé positif : " + this._data.ascendingElevation.toLocaleString() + " m"), n && this._addElevationPathInformationsItem("Dénivelé négatif : " + this._data.descendingElevation.toLocaleString() + " m"), t && this._addElevationPathInformationsItem("Pente moyenne : " + this._data.meanSlope.toLocaleString() + " %"), e && this._addElevationPathInformationsItem("Plus forte pente : " + this._data.greaterSlope.toLocaleString() + " %"), "GPelevationPathInformationsContainerVisible" === o.className ? (clearTimeout(this._timerHdlr), o.className = "GPelevationPathInformationsContainerHidden") : o.className = "GPelevationPathInformationsContainerVisible", this._timerHdlr = setTimeout((function () { o.className = "GPelevationPathInformationsContainerHidden" }), 4e3) }, _activateMapInteraction: function (t) { if (p.info("_activateMapInteraction()"), null === this._featuresLayer) { this._featuresLayer = new s.a.FeatureGroup, t.addLayer(this._featuresLayer); var e = this; t.on("contextmenu", (function () { })), t.on("draw:created", (function (t) { p.trace("draw:created"), e._currentIdLayer = s.a.Util.stamp(t.layer), e._getFeatureGeometry(t.layer), e._addFeatureLayer(t.layer) })), t.on("draw:drawstart", (function () { p.trace("draw:drawstart"), e._removeFeatureLayer(e._lastIdLayer), e._lastIdLayer = e._currentIdLayer })), t.on("draw:drawstop", (function () { p.trace("draw:drawstop"), void 0 === e.options.elevationPathOptions.onSuccess && null === e.options.displayProfileOptions.target && (e._pictoContainer.style.display = "none", e._panelContainer.style.display = "block"), e._altiRequest() })) } this._activatePolyLineInteraction(t) }, _removeMapInteraction: function (t) { t && (null !== this._featuresLayer && (t.off("draw:created"), t.off("draw:drawstart"), t.off("draw:drawstop"), t.removeLayer(this._featuresLayer), this._featuresLayer = null), this._lastIdLayer = this._currentIdLayer = 0, this._currentFeature && this._currentFeature.disable()) }, _activatePolyLineInteraction: function (t) { this._currentFeature && this._currentFeature.disable(); var e = this.options.stylesOptions || {}, i = 0 !== Object.keys(e).length ? e : { stroke: !0, color: "#C77A04", weight: 4, opacity: .5, fill: !1 }; this._currentFeature = new s.a.Draw.Polyline(t, { shapeOptions: i }), this._currentFeature.enable() }, _getFeatureGeometry: function (t) { p.log(t.getLatLngs()), null !== this._geometry && (this._geometry = null), this._geometry = [], this._distance = 0; for (var e = t.getLatLngs(), i = 0; i < e.length; i++) { var n = e[i], o = e[i + 1]; this._geometry.push({ lon: n.lng, lat: n.lat }), o && (this._distance += n.distanceTo(o)) } p.log("Geometry", this._geometry), p.log("Distance", this._distance) }, _addFeatureLayer: function (t) { this._featuresLayer && this._featuresLayer.addLayer(t) }, _removeFeatureLayer: function (t) { this._featuresLayer && 0 !== t && (t ? this._featuresLayer.removeLayer(t) : this._featuresLayer.clearLayers()) }, _altiRequest: function () { if (p.log("_altiRequest"), this._geometry) { if (!this._noRightManagement) { var t = {}; s.a.Util.extend(t, this.options.elevationPathOptions), s.a.Util.extend(t, { apiKey: t.apiKey || this.options.apiKey }), s.a.Util.extend(t, { ssl: this.options.ssl }); var e = t.sampling; if (!e) { var i = this._currentFeature._measurementRunningTotal; p.trace("length", i); var o = Math.floor(i) / 5; e = o >= 200 ? 200 : Math.floor(o) } var a = this; s.a.Util.extend(t, { sampling: e, onSuccess: this.options.elevationPathOptions.onSuccess || function (t) { p.log(t), t && (null !== a.options.displayProfileOptions.target && (a._pictoContainer.style.display = "block", a._panelContainer.style.display = "block"), a._displayProfil(t.elevations), a._waitingContainer.className = "GPelevationPathCalcWaitingContainerHidden", a._waiting = !1) }, onFailure: this.options.elevationPathOptions.onFailure || function (t) { p.log(t.message), a._pictoContainer.style.display = "block", a._panelContainer.style.display = "none", a._waitingContainer.className = "GPelevationPathCalcWaitingContainerHidden", a._waiting = !1, a._clear() } }); var r = this._geometry; s.a.Util.extend(t, { positions: r }), p.log(t), this._waitingContainer.className = "GPelevationPathCalcWaitingContainerVisible", n.default.Services.getAltitude(t) } } else p.log("missing position") }, _computeElevationMeasure: function (t) { var e = function (t, e) { var i = c.default.decimalToRadian(t[1]), n = c.default.decimalToRadian(e[1]), o = (n - i) / 2, s = c.default.decimalToRadian(e[0] - t[0]) / 2, a = Math.sin(o) * Math.sin(o) + Math.sin(s) * Math.sin(s) * Math.cos(i) * Math.cos(n); return 12756274 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)) }, i = t, n = this._geometry, o = 0, s = 0, a = n[1]; i[0].dist = 0, i[0].slope = 0, i[0].lat = Math.round(1e4 * i[0].lat) / 1e4, i[0].lon = Math.round(1e4 * i[0].lon) / 1e4; for (var r = 0, l = 0, u = 0, h = 0, d = 0, m = 0, f = [], g = 1; g < i.length; g++) { var _ = [i[g].lon, i[g].lat], v = s + e(_, [n[o].lon, n[o].lat]), y = v - d; _[0].toFixed(8) === a.lon.toFixed(8) && _[1].toFixed(8) === a.lat.toFixed(8) && (o++, s = v, g !== i.length - 1 && (a = n[o + 1])); var E = i[g].z, w = i[g - 1].z; E < 0 && (E = 0), w < 0 && (w = 0); var b = E - w; b < 0 ? (r += y, h += b) : b > 0 && (l += y, u += b), d = v, i[g].dist = v, f.push(v), m += b ? Math.abs(Math.round(b / y * 100)) : 0, i[g].slope = b ? Math.abs(Math.round(b / y * 100)) : 0; var P = i[g].slope; i[g].color = P > 15 && P < 30 ? "#005b4c" : P > 30 && P < 45 ? "#00362d" : P > 45 ? "#00120f" : "#00B798", i[g].lat = Math.round(1e4 * i[g].lat) / 1e4, i[g].lon = Math.round(1e4 * i[g].lon) / 1e4 } p.trace("List Distances", f); for (var C = i[0].z, M = i[0].z, S = i[0].slope, L = 0; L < i.length; L++) { var x = i[L]; x.z < -100 && (x.z = 0), x.z > M && (M = x.z), x.z < C && (C = x.z), x.slope > S && (S = x.slope) } return { greaterSlope: S, meanSlope: Math.round(m / i.length), distancePlus: l, distanceMinus: r, ascendingElevation: u, descendingElevation: h, altMin: C.toLocaleString(), altMax: M.toLocaleString(), distance: this._distance, unit: "m", points: i } }, _displayProfil: function (t) { this._map.off("contextmenu"), this._data && (this._data = {}); var e = this._data = this._computeElevationMeasure(t), i = this.options.displayProfileOptions.target; i && i.appendChild(this._panelContainer), i = this._profilContainer; var n = this.options.displayProfileOptions, o = n.apply; "undefined" != typeof AmCharts && "undefined" != typeof d3 && p.trace("Aucune lib. n'est presente !"), o.call(this, e, i, this); var a = s.a.DomUtil.get("GPelevationPathPanelInfo-" + this._uid); (n.greaterSlope || n.meanSlope || n.ascendingElevation || n.descendingElevation) && (a.style.display = "block") }, _clear: function () { if (this._geometry = null, this._profile = null, this._profilContainer) for (; this._profilContainer.firstChild;)this._profilContainer.removeChild(this._profilContainer.firstChild); var t = this._map; this._marker && (t.removeLayer(this._marker), this._marker = null) } }); m.__createProfileMarker = function (t, e) { p.log("__createProfileMarker"); var i = t, n = i._map; i._marker = s.a.marker(s.a.latLng(e), { icon: new u.default("orange"), draggable: !1, clickable: !1, zIndexOffset: 1e3 }), i._marker.addTo(n) }, m.__updateProfileMarker = function (t, e) { p.log("__updateProfileMarker"); var i = t, n = i._map; i._marker ? (i._marker.setLatLng(s.a.latLng(e)), i._marker.update()) : (i._marker = s.a.marker(s.a.latLng(e), { icon: new u.default("orange"), draggable: !1, clickable: !1, zIndexOffset: 1e3 }), i._marker.addTo(n)) }, m.__removeProfileMarker = function (t) { p.log("__removeProfileMarker"); var e = t, i = e._map; e._marker && (i.removeLayer(e._marker), e._marker = null) }, m.__customRawProfileOperation = function () { p.log("__customRawProfileOperation") }, m.__customRawProfileMouseOverEvent = function (t, e) { p.log("__customRawProfileMouseOverEvent", t, e) }, m.DISPLAY_PROFILE_BY_DEFAULT = function (t, e, i) { p.trace("ElevationPath.DISPLAY_PROFILE_BY_DEFAULT"); var n = d.default.displayProfileByDefault(t, e, i, m); n && (this._profile = n) }, m.DISPLAY_PROFILE_RAW = function (t, e, i) { p.trace("ElevationPath.DISPLAY_PROFILE_RAW"); var n = d.default.displayProfileRaw(t, e, i, m); n && (this._profile = n) }, m.DISPLAY_PROFILE_LIB_D3 = function (t, e, i) { if (p.trace("ElevationPath.DISPLAY_PROFILE_LIB_D3"), "undefined" != typeof d3) { var n = d.default.displayProfileLibD3(t, e, i, m); n && (this._profile = n) } else p.log("Lib. D3 is not loaded !") }, m.DISPLAY_PROFILE_LIB_AMCHARTS = function (t, e, i) { if (p.trace("ElevationPath.DISPLAY_PROFILE_LIB_AMCHARTS"), "undefined" != typeof AmCharts) { var n = d.default.displayProfileLibAmCharts(t, e, i, m); n && (this._profile = n) } else p.log("Lib. AmCharts is not loaded !") }, e.default = m }, function (t, e, i) { "use strict"; i.r(e); var n = { _addUID: function (t) { return this._uid ? t + "-" + this._uid : t }, _createMainContainerElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPelevationPath"), t.className = "GPwidget", t }, _createShowElevationPathElement: function () { var t = document.createElement("input"); return t.id = this._addUID("GPshowElevationPath"), t.type = "checkbox", t }, _createShowElevationPathPictoElement: function () { var t = this, e = document.createElement("label"); e.id = this._addUID("GPshowElevationPathPicto"), e.className = "GPshowAdvancedToolPicto", e.htmlFor = this._addUID("GPshowElevationPath"), e.title = "Calculer un profil", e.addEventListener ? e.addEventListener("click", (function (e) { t.onShowElevationPathClick(e) })) : e.attachEvent && e.attachEvent("onclick", (function (e) { t.onShowElevationPathClick(e) })); var i = document.createElement("span"); return i.id = this._addUID("GPshowElevationPathOpen"), i.className = "GPshowAdvancedToolOpen", e.appendChild(i), e }, _createElevationPathPanelElement: function () { var t = document.createElement("div"); return t.id = this._addUID("GPelevationPathPanel"), t.className = "GPpanel", t }, _createElevationPathPanelHeaderElement: function () { var t = this, e = document.createElement("div"); e.className = "GPpanelHeader"; var i = document.createElement("div"); i.id = this._addUID("GPelevationPathPanelInfo"), i.className = "GPpanelInfo", i.title = "Informations", i.addEventListener ? i.addEventListener("click", (function () { t.onOpenElevationPathInfoClick() })) : i.attachEvent && i.attachEvent("onclick", (function () { t.onOpenElevationPathInfoClick() })), e.appendChild(i); var n = document.createElement("div"); n.className = "GPpanelTitle", n.innerHTML = "Profil Altimétrique", e.appendChild(n); var o = document.createElement("div"); o.id = this._addUID("GPelevationPathPanelReduce"), o.className = "GPpanelReduce", o.title = "Masquer le panneau", o.addEventListener ? o.addEventListener("click", (function () { "function" == typeof t.onReduceElevationPathPanelClick && (document.getElementById(t._addUID("GPshowElevationPath")).checked = !1, t.onReduceElevationPathPanelClick()) }), !1) : o.attachEvent && o.attachEvent("onclick", (function () { "function" == typeof t.onReduceElevationPathPanelClick && (document.getElementById(t._addUID("GPshowElevationPath")).checked = !1, t.onReduceElevationPathPanelClick()) })), e.appendChild(o); var s = document.createElement("div"); return s.id = this._addUID("GPelevationPathPanelClose"), s.className = "GPpanelClose", s.title = "Fermer le panneau", s.addEventListener ? s.addEventListener("click", (function () { document.getElementById(t._addUID("GPshowElevationPathPicto")).click() }), !1) : s.attachEvent && s.attachEvent("onclick", (function () { document.getElementById(t._addUID("GPshowElevationPathPicto")).click() })), e.appendChild(s), e }, _createElevationPathPanelProfilElement: function () { var t = document.createElement("div"); return t.id = "GPelevationPathProfil", t }, _createElevationPathWaitingElement: function () { var t = document.createElement("div"); t.id = this._addUID("GPelevationPathCalcWaitingContainer"), t.className = "GPelevationPathCalcWaitingContainerHidden"; var e = document.createElement("p"); return e.className = "GPelevationPathCalcWaiting", e.innerHTML = "Calcul en cours...", t.appendChild(e), t }, _createElevationPathInformationsElement: function () { var t = document.createElement("div"); t.id = this._addUID("GPelevationPathInformationsContainer"), t.className = "GPelevationPathInformationsContainerHidden"; var e = document.createElement("p"); return e.className = "GPelevationPathInformations", e.innerHTML = "Aucune information...", t.appendChild(e), t }, _addElevationPathInformationsItem: function (t) { var e = document.getElementById(this._addUID("GPelevationPathInformationsContainer")); if (e) { var i = document.createElement("p"); i.className = "GPelevationPathInformations", i.innerHTML = t, e.appendChild(i) } return e } }; e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = { _getCssProperty: function (t, e) { return window.getComputedStyle(t, null).getPropertyValue(e) }, _getTextWidth: function (t, e) { var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null, n = (this.canvas || (this.canvas = document.createElement("canvas"))).getContext("2d"); return n.font = null === i ? "".concat(this._getCssProperty(e, "font-weight"), " ").concat(this._getCssProperty(e, "font-size"), " ").concat(this._getCssProperty(e, "font-family")) : i, n.measureText(t).width }, _dataZToSvgY: function (t, e, i, n) { return e - (t - i) * n - .5 }, _dataDistToSvgX: function (t, e, i, n) { return e - i + t * n }, _svgXToDataDist: function (t, e, i, n) { return (t + i - e) / n }, _arrayBisect: function (t, e) { var i; if (0 === t.length) return 0; for (i = 0; i < t.length; i++)if (e < t[i].dist) return i; return i - 1 }, displayProfileByDefault: function (t, e, i, n) { var o = i; if (e && t) { for (; e.firstChild;)e.removeChild(e.firstChild); var s = 25, a = 15, r = 10, l = 10, c = o.options.displayProfileOptions, u = t.points, h = JSON.parse(JSON.stringify(u)); h.sort((function (t, e) { return t.z - e.z })); var d = h[0].z, p = h[h.length - 1].z, m = t.distance, f = "m", g = document.createElement("div"); g.id = "profileElevationByDefault", e.appendChild(g); var _ = e.clientHeight - s - r, v = e.clientWidth - l - a, y = 17, E = this._getTextWidth(Math.round(p).toLocaleString() + ",88", e, "400 10 Verdana"), w = this._getTextWidth(Math.round(m).toLocaleString() + ",5", e), b = _ - 17 - 15, P = v - y - E, C = document.createElementNS("http://www.w3.org/2000/svg", "svg"); C.id = "profileElevationByDefaultSvg", C.setAttribute("style", "display: block; margin: auto; overflow: visible; position: absolute; left: 10px;"), C.setAttribute("viewBox", "0 0 ".concat(e.clientWidth, " ").concat(e.clientHeight)), C.setAttribute("width", "100%"), C.setAttribute("height", "100%"); var M, S = Math.floor(b / 15); M = p === d ? .1 : Math.pow(10, Math.ceil(Math.log((p - d) / S) / Math.log(10))) / 2; var L = Math.floor(d / M) * M, x = Math.ceil(p / M) * M; x === p && (x += M), L = Math.round(100 * L) / 100, x = Math.round(100 * x) / 100; var G = Math.round((x - L) / M); G + 1 > S && (M = Math.pow(10, Math.ceil(Math.log((p - d) / S) / Math.log(10))), L = Math.floor(d / M) * M, (x = Math.ceil(p / M) * M) === p && (x += M), L = Math.round(100 * L) / 100, x = Math.round(100 * x) / 100, G = Math.floor((x - L) / M)), G = Math.max(Math.round(G), 1); var I = document.createElementNS("http://www.w3.org/2000/svg", "g"); I.setAttribute("class", "profile-z-vertical"); var R, A, k, T, D, O, N = document.createElementNS("http://www.w3.org/2000/svg", "g"), U = b / G, j = b / (x - L); j = p === d ? b / .2 : b / (x - L); for (var F = 0; F <= G; F++)(R = document.createElementNS("http://www.w3.org/2000/svg", "text")).setAttribute("class", "profile-z-graduation"), R.setAttribute("font-family", "Verdana"), R.setAttribute("font-size", "10px"), R.setAttribute("fill", "#5E5E5E"), R.textContent = (Math.round(100 * (L + F * M)) / 100).toLocaleString(), A = b - F * U, R.setAttribute("transform", "translate(".concat(y + E - 8, ", ").concat(A + 5, ")")), R.setAttribute("text-anchor", "end"), I.appendChild(R), k = Math.round(A) - .5, T = document.createElementNS("http://www.w3.org/2000/svg", "g"), (D = document.createElementNS("http://www.w3.org/2000/svg", "path")).setAttribute("cs", "100,100"), D.setAttribute("stroke-width", "1"), 0 !== F ? D.setAttribute("stroke-opacity", "0.2") : D.setAttribute("stroke-opacity", "1"), D.setAttribute("stroke", "#000000"), D.setAttribute("fill", "none"), D.setAttribute("d", "M".concat(y + E, ",").concat(k, " L").concat(P + y + E, ",").concat(k)), (O = document.createElementNS("http://www.w3.org/2000/svg", "path")).setAttribute("cs", "100,100"), O.setAttribute("stroke-width", "1"), O.setAttribute("stroke-opacity", "1"), O.setAttribute("stroke", "#000000"), O.setAttribute("fill", "none"), O.setAttribute("d", "M".concat(y + E, ",").concat(k, " L").concat(y + E + 5, ",").concat(k)), O.setAttribute("transform", "translate(-5, 0)"), T.appendChild(O), T.appendChild(D), N.appendChild(T); var B = document.createElementNS("http://www.w3.org/2000/svg", "text"); B.setAttribute("class", "profile-z-legend"), B.setAttribute("font-family", "Verdana"), B.setAttribute("font-size", "11px"), B.setAttribute("fill", "#5E5E5E"), B.textContent = "Altitude (m)", B.setAttribute("transform", "translate(".concat(9, ", ").concat(Math.round(b / 2), ") rotate(-90)")), B.setAttribute("text-anchor", "middle"), I.appendChild(B), C.appendChild(I), C.appendChild(N), m > 2e3 && (m /= 1e3, f = "km"); var z = Math.floor(P / w), q = Math.pow(10, Math.ceil(Math.log(m / z) / Math.log(10))) / 2, H = m, W = Math.floor(H / q); W > z ? (q = Math.pow(10, Math.ceil(Math.log(m / z) / Math.log(10))), W = Math.floor(H / q)) : W < 1 && (q = Math.pow(10, Math.ceil(Math.log(m / z) / Math.log(10)) - 1), W = Math.floor(H / q)); var V = q * (W = Math.max(W, 1)), Y = document.createElementNS("http://www.w3.org/2000/svg", "g"); Y.setAttribute("class", "profile-x-vertical"); for (var K, X, Z, Q, J, $, tt = document.createElementNS("http://www.w3.org/2000/svg", "g"), et = P / H, it = (H - V) * et, nt = Math.round((P - it) / W), ot = 0; ot <= W + 1; ot++)(K = document.createElementNS("http://www.w3.org/2000/svg", "text")).setAttribute("class", "profile-x-graduation"), K.setAttribute("font-family", "Verdana"), K.setAttribute("font-size", "10px"), K.setAttribute("fill", "#5E5E5E"), ot !== W + 1 && (K.textContent = (Math.round(100 * ot * q) / 100).toLocaleString()), X = y + E + ot * nt, ot === W + 1 && (X = y + E + P), K.setAttribute("transform", "translate(".concat(X, ", ").concat(b + 15 + 5, ")")), K.setAttribute("text-anchor", "middle"), Y.appendChild(K), Z = X - .5, Q = document.createElementNS("http://www.w3.org/2000/svg", "g"), (J = document.createElementNS("http://www.w3.org/2000/svg", "path")).setAttribute("cs", "100,100"), J.setAttribute("stroke-width", "1"), 0 !== ot ? J.setAttribute("stroke-opacity", "0.2") : J.setAttribute("stroke-opacity", "1"), J.setAttribute("stroke", "#000000"), J.setAttribute("fill", "none"), J.setAttribute("d", "M".concat(Z, ",").concat(b, " L").concat(Z, ",0")), ($ = document.createElementNS("http://www.w3.org/2000/svg", "path")).setAttribute("cs", "100,100"), $.setAttribute("stroke-width", "1"), $.setAttribute("stroke-opacity", "1"), $.setAttribute("stroke", "#000000"), $.setAttribute("fill", "none"), $.setAttribute("d", "M".concat(Z, ",").concat(b, " L").concat(Z, ",").concat(b - 5)), $.setAttribute("transform", "translate(0, 5)"), Q.appendChild($), Q.appendChild(J), tt.appendChild(Q); var st = document.createElementNS("http://www.w3.org/2000/svg", "text"); st.setAttribute("class", "profile-x-legend"), st.setAttribute("font-family", "Verdana"), st.setAttribute("font-size", "11px"), st.setAttribute("fill", "#5E5E5E"), st.textContent = "Distance (".concat(f, ")"), st.setAttribute("transform", "translate(".concat(y + E + P / 2, ", ").concat(b + 15 + 17 + 3, ")")), st.setAttribute("text-anchor", "middle"), Y.appendChild(st), C.appendChild(Y), C.appendChild(tt); var at = document.createElementNS("http://www.w3.org/2000/svg", "g"), rt = 1; "km" === f && (rt = 1e3); for (var lt = this._dataDistToSvgX(u[0].dist / rt, v, P, et), ct = this._dataZToSvgY(u[0].z, b, L, j), ut = "M".concat(lt, ",").concat(ct), ht = 1; ht < u.length; ht++)lt = this._dataDistToSvgX(u[ht].dist / rt, v, P, et), ct = this._dataZToSvgY(u[ht].z, b, L, j), ut += " L".concat(lt, ",").concat(ct); var dt = document.createElementNS("http://www.w3.org/2000/svg", "path"); dt.setAttribute("cs", "100,100"), dt.setAttribute("stroke-width", "1"), dt.setAttribute("stroke-opacity", "1"), dt.setAttribute("stroke", "#0B6BA7"), dt.setAttribute("fill", "none"), dt.setAttribute("d", ut), ut += " L".concat(lt, ",").concat(b), ut += " L".concat(v - P, ",").concat(b); var pt = document.createElementNS("http://www.w3.org/2000/svg", "path"); pt.setAttribute("cs", "100,100"), pt.setAttribute("stroke-width", "1"), pt.setAttribute("stroke-opacity", "0"), pt.setAttribute("stroke", "#000000"), pt.setAttribute("fill", "#00B798"), pt.setAttribute("fill-opacity", "0.4"), pt.setAttribute("d", ut), at.appendChild(dt), at.appendChild(pt), C.appendChild(at); var mt = document.createElementNS("http://www.w3.org/2000/svg", "g"), ft = document.createElementNS("http://www.w3.org/2000/svg", "rect"); ft.setAttribute("width", P), ft.setAttribute("height", b), ft.setAttribute("transform", "translate(".concat(v - P, ",0)")), ft.setAttribute("visibility", "hidden"), ft.setAttribute("pointer-events", "all"); var gt = JSON.parse(JSON.stringify(u)); gt.sort((function (t, e) { return t.dist - e.dist })); var _t = document.createElementNS("http://www.w3.org/2000/svg", "line"); _t.setAttribute("id", "focusLineX"), _t.setAttribute("class", "focusLine-default"), _t.setAttribute("fill", "none"), _t.setAttribute("stroke", "#F90"), _t.setAttribute("stroke-width", "0.5px"), _t.setAttribute("visibility", "hidden"); var vt = document.createElementNS("http://www.w3.org/2000/svg", "line"); vt.setAttribute("id", "focusLineY"), vt.setAttribute("class", "focusLine-default"), vt.setAttribute("fill", "none"), vt.setAttribute("stroke", "#F90"), vt.setAttribute("stroke-width", "0.5px"), vt.setAttribute("visibility", "hidden"); var yt = document.createElementNS("http://www.w3.org/2000/svg", "circle"); yt.setAttribute("id", "focusCircle"), yt.setAttribute("r", 4), yt.setAttribute("class", "circle-default focusCircle-default"), yt.setAttribute("fill", "#F90"), yt.setAttribute("visibility", "hidden"), mt.appendChild(yt), mt.appendChild(_t), mt.appendChild(vt); var Et = document.createElementNS("http://www.w3.org/2000/svg", "text"), wt = document.createElementNS("http://www.w3.org/2000/svg", "tspan"), bt = document.createElementNS("http://www.w3.org/2000/svg", "tspan"), Pt = document.createElementNS("http://www.w3.org/2000/svg", "tspan"); Et.setAttribute("style", "text-align:center; max-width:220px; font-size:10px; color:#000000; font-family:Verdana; z-index:50;"), Et.style.pointerEvents = "none", Et.style.position = "fixed", Et.setAttribute("class", "tooltipInit"), Et.setAttribute("text-anchor", "middle"), g.appendChild(Et), wt.setAttribute("class", "altiPathValue"), wt.setAttribute("x", "0"), wt.setAttribute("dy", "-.7em"), bt.setAttribute("class", "altiPathValue"), bt.setAttribute("x", "0"), bt.setAttribute("dy", "1em"), Pt.setAttribute("class", "altiPathCoords"), Pt.setAttribute("x", "0"), Pt.setAttribute("dy", "1em"), Et.appendChild(wt), c.currentSlope && Et.appendChild(bt), Et.appendChild(Pt); var Ct = document.createElementNS("http://www.w3.org/2000/svg", "g"); mt.appendChild(Ct); var Mt = document.createElementNS("http://www.w3.org/2000/svg", "path"); Mt.setAttribute("cs", "100,100"), Mt.setAttribute("fill", "#FFFFFF"), Mt.setAttribute("stroke", "#CCCCCC"), Mt.setAttribute("fill-opacity", "0.8"), Mt.setAttribute("stroke-width", "1"), Mt.setAttribute("stroke-opacity", "1"); var St = document.createElementNS("http://www.w3.org/2000/svg", "path"); return St.setAttribute("cs", "100,100"), St.setAttribute("fill", "#FFFFFF"), St.setAttribute("stroke", "#000000"), St.setAttribute("fill-opacity", "0"), St.setAttribute("stroke-width", "1"), St.setAttribute("stroke-opacity", "0.4"), St.setAttribute("transform", "translate(1,1)"), Ct.appendChild(St), Ct.appendChild(Mt), Ct.appendChild(Et), Ct.setAttribute("class", "tooltipInit"), Ct.style.pointerEvents = "none", ft.addEventListener("mouseover", (function () { _t.setAttribute("visibility", "visible"), vt.setAttribute("visibility", "visible"), yt.setAttribute("visibility", "visible"), n.__createProfileMarker(o, u[0]), Et.setAttribute("class", "tooltipFadeIn"), Ct.setAttribute("class", "tooltipFadeIn") })), ft.addEventListener("mouseout", (function () { _t.setAttribute("visibility", "hidden"), vt.setAttribute("visibility", "hidden"), yt.setAttribute("visibility", "hidden"), n.__removeProfileMarker(o), Et.setAttribute("class", "tooltipFadeOut"), Ct.setAttribute("class", "tooltipFadeOut") })), ft.addEventListener("mousemove", function (t) { var e = C.createSVGPoint(); e.x = t.clientX, e.y = t.clientY; var i = e.matrixTransform(C.getScreenCTM().inverse()), s = this._svgXToDataDist(i.x, v, P, et) * rt, a = Math.max(1, this._arrayBisect(gt, s)), r = u[a - 1], l = u[a], c = r; s - r.dist > l.dist - s && (c = l); var h = this._dataDistToSvgX(c.dist / rt, v, P, et), d = this._dataZToSvgY(c.z, b, L, j); yt.setAttribute("cx", h), yt.setAttribute("cy", d), _t.setAttribute("x1", h), _t.setAttribute("y1", b), _t.setAttribute("x2", h), _t.setAttribute("y2", 0), vt.setAttribute("x1", y + E), vt.setAttribute("y1", d), vt.setAttribute("x2", P + y + E), vt.setAttribute("y2", d), n.__updateProfileMarker(o, c); var p = "Altitude : ".concat(c.z.toLocaleString(), " m"), f = "Pente : ".concat(c.slope, " %"), g = "(lat : ".concat(c.lat.toLocaleString(), " / lon : ").concat(c.lon.toLocaleString(), ")"); wt.innerHTML = p, bt.innerHTML = f, Pt.innerHTML = g; var _, w = Math.max(this._getTextWidth(g, Pt), this._getTextWidth(p, wt)); c.dist > m * rt / 2 ? (_ = "M -0.5 -0.5 l -6 6 l 0 16 l -".concat(w + 10, " 0 l 0 -44 l ").concat(w + 10, " 0 l 0 16 l 6 6"), Et.setAttribute("transform", "translate(".concat(-(w / 2 + 12), ",0)"))) : c.dist <= m * rt / 2 && (_ = "M -0.5 -0.5 l 6 6 l 0 16 l ".concat(w + 10, " 0 l 0 -44 l -").concat(w + 10, " 0 l 0 16 l -6 6"), Et.setAttribute("transform", "translate(".concat(w / 2 + 12, ",0)"))), Mt.setAttribute("d", _), St.setAttribute("d", _), Ct.setAttribute("transform", "translate(".concat(h, ",").concat(d, ")")), Ct.style.transform = "translate(".concat(h, "px,").concat(d, "px)") }.bind(this)), mt.appendChild(ft), C.appendChild(mt), g.appendChild(C), e } }, displayProfileRaw: function (t, e, i, n) { if (e) { for (; e.firstChild;)e.removeChild(e.firstChild); var o = t && t.points ? t.points : {}, s = document.createElement("textarea"); return s.id = "profilElevationResults", s.rows = 10, s.cols = 50, s.style.width = "100%", s.innerHTML = JSON.stringify(o, void 0, 4), s.addEventListener("mouseover", (function (t) { n.__customRawProfileMouseOverEvent(i, t) })), e.appendChild(s), e } }, displayProfileLibD3: function (t, e, i, n) { var o = i; if (e && t) { for (; e.firstChild;)e.removeChild(e.firstChild); var s = t.points; if (t.distance > 2e3) { t.unit = "km"; for (var a = 0; a < s.length; a++)s[a].dist /= 1e3 } var r = o.options.displayProfileOptions, l = 20, c = 20, u = 30, h = 40, d = e.clientWidth - h - c, p = e.clientHeight - l - u, m = d3.scale.linear().range([0, d]), f = d3.scale.linear().range([p, 0]), g = d3.svg.axis().scale(m).orient("bottom").ticks(5), _ = d3.svg.axis().scale(f).orient("left").ticks(5), v = d3.svg.line().interpolate("basis").x((function (t) { return m(t.dist) })).y((function (t) { return f(t.z) })), y = d3.svg.area().interpolate("basis").x((function (t) { return m(t.dist) })).y0(p).y1((function (t) { return f(t.z) })), E = d3.select(e).append("svg").attr("width", d + h + c).attr("height", p + l + u).append("g").attr("transform", "translate(" + h + "," + l + ")"), w = d3.extent(s, (function (t) { return t.dist })); m.domain(w); var b = [0, d3.max(s, (function (t) { return t.z }))]; f.domain(b), E.append("path").datum(s).attr("class", "area-d3").attr("d", y), E.append("g").attr("class", "x axis-d3").attr("transform", "translate(0," + p + ")").call(g).append("text").attr("y", -15).attr("dy", ".71em").attr("x", d).text("Distance (" + t.unit + ")"), E.append("g").attr("class", "y axis-d3").call(_).append("text").attr("transform", "rotate(-90)").attr("y", 6).attr("dy", ".71em").text("Altitude (m)"), E.append("g").attr("class", "grid-d3 vertical").attr("transform", "translate(0," + p + ")").call(g.orient("bottom").tickSize(-p, 0, 0).tickFormat("")), E.append("g").attr("class", "grid-d3 horizontal").call(_.orient("left").tickSize(-d, 0, 0).tickFormat("")), E.append("path").datum(s).attr("class", "line-d3").attr("d", v), E.selectAll("circle").data(s).enter().append("circle").attr("cx", (function (t) { return m(t.dist) })).attr("cy", (function (t) { return f(t.z) })).attr("r", 0).attr("class", "circle-d3"); var P = E.append("g").style("display", "none"); P.append("line").attr("id", "focusLineX").attr("class", "focusLine-d3"), P.append("line").attr("id", "focusLineY").attr("class", "focusLine-d3"), P.append("circle").attr("id", "focusCircle").attr("r", 4).attr("class", "circle-d3 focusCircle-d3"); var C = d3.select(e).append("div").attr("class", "tooltip-d3").style("opacity", 0), M = d3.bisector((function (t) { return t.dist })).left; return E.append("rect").attr("class", "overlay-d3").attr("width", d).attr("height", p).on("mouseover", (function () { P.style("display", null), n.__createProfileMarker(o, s[0]) })).on("mouseout", (function () { P.style("display", "none"), n.__removeProfileMarker(o), C.transition().duration(500).style("opacity", 0) })).on("mousemove", (function () { var t = d3.mouse(this), e = m.invert(t[0]), i = Math.max(1, M(s, e)), a = s[i - 1], l = s[i], c = e - a[0] > l[0] - e ? l : a, u = m(c.dist), h = f(c.z); P.select("#focusCircle").attr("cx", u).attr("cy", h), P.select("#focusLineX").attr("x1", u).attr("y1", f(b[0])).attr("x2", u).attr("y2", f(b[1])), P.select("#focusLineY").attr("x1", m(w[0])).attr("y1", h).attr("x2", m(w[1])).attr("y2", h), n.__updateProfileMarker(o, c), C.transition().duration(200).style("opacity", .9); var d = ""; d += " Altitude : " + c.z + " m", r.currentSlope && (d += "<br/> Pente : " + c.slope + " %"), d += "<br/> (Lat : " + c.lat + "/ Lon : " + c.lon + ")", C.html(d).style("left", d3.event.pageX + "px").style("top", d3.event.pageY - 28 + "px") })), E } }, displayProfileLibAmCharts: function (t, e, i, n) { var o = i; if (e && t) { var s = t.points, a = "<span class='altiPathValue'>[[title]] : [[value]]m</span><br/>"; if (o.options.displayProfileOptions.currentSlope && (a += "<span class='altiPathValue'>Pente : [[slope]] %</span><br/>"), a += "<span class='altiPathCoords'>(Lat: [[lat]] / Lon:[[lon]])</span>", AmCharts.addInitHandler((function () { })), t.distance > 2e3) { t.unit = "km"; for (var r = 0; r < s.length; r++)s[r].dist /= 1e3 } for (var l = 0; l < s.length; l++) { var c = s[l].dist, u = 100; c > 100 ? u = 1 : c > 10 && (u = 10), c = Math.round(c * u) / u, s[l].dist = c } var h = { type: "serial", pathToImages: "http://cdn.amcharts.com/lib/3/images/", categoryField: "dist", autoMarginOffset: 0, marginRight: 10, marginTop: 10, startDuration: 0, color: "#5E5E5E", fontSize: 8, theme: "light", thousandsSeparator: "", numberFormatter: { precision: -1, decimalSeparator: ",", thousandsSeparator: " " }, categoryAxis: { color: "#5E5E5E", gridPosition: "start", minHorizontalGap: 40, tickPosition: "start", title: "Distance (" + t.unit + ")", titleColor: "#5E5E5E", labelOffset: 0, startOnAxis: !0 }, chartCursor: { animationDuration: 0, bulletsEnabled: !0, bulletSize: 10, categoryBalloonEnabled: !1, cursorColor: "#F90", graphBulletAlpha: 1, graphBulletSize: 1, zoomable: !1 }, trendLines: [], graphs: [{ balloonColor: "#CCCCCC", balloonText: a, bullet: "round", bulletAlpha: 0, bulletBorderColor: "#FFF", bulletBorderThickness: 2, bulletColor: "#F90", bulletSize: 6, hidden: !1, id: "AmGraph-1", fillAlphas: .4, fillColors: "#C77A04", lineAlpha: 1, lineColor: "#C77A04", lineThickness: 1, title: "Altitude", valueField: "z" }], guides: [], valueAxes: [{ id: "ValueAxis-1", minVerticalGap: 20, title: "Altitude (m)" }], balloon: { borderColor: "#CCCCCC", borderThickness: 1, fillColor: "#FFFFFF", showBullet: !0 }, titles: [], allLabels: [], dataProvider: s }, d = AmCharts.makeChart(e, h); return d.addListener("changed", (function (t) { var e = t.chart.dataProvider[t.index]; n.__updateProfileMarker(o, e) })), d } } }; e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(2), o = i.n(n), s = o.a.Control.extend({ options: { position: "topright", picto: null, url: null, text: null, size: "30px" }, initialize: function (t) { o.a.setOptions(this, t) }, onAdd: function () { var t = null; t = o.a.DomUtil.create("div", "gp-control-logo", t); var e = !(!this.options.url && !this.options.text), i = null; e && ((i = o.a.DomUtil.create("a", "", t)).target = "_blank", this.options.url && (i.href = this.options.url, this.options.text && (i.title = this.options.text))), e && this.options.text && (i.text = this.options.text); var n = null; return !!this.options.picto && ((n = e ? o.a.DomUtil.create("img", "", i) : o.a.DomUtil.create("img", "", t)).src = this.options.picto, "string" == typeof this.options.size ? n.style.height = n.style.width = this.options.size : (n.style.height = this.options.size.height, n.style.width = this.options.size.width)), t } }); e.default = s }, function (t, e, i) { "use strict"; i.r(e); var n = i(2), o = i.n(n), s = i(34), a = i(162), r = i(164), l = i(166), c = s.default.getLogger("layers"), u = { options: {}, params: {}, protocol: null, serviceUrl: "http://localhost?no-rights-found-for=[{layer}]", _initOptions: function () { if (!this.options || 0 === Object.keys(this.options).length) throw new Error("PARAM_MISSING : options !"); if (!this.options.layer) throw new Error("PARAM_MISSING : layer !"); this.options.apiKey || c.log("PARAM_MISSING : apiKey !"), void 0 === this.options.ssl && (this.options.ssl = !0) }, _initContext: function () { this.protocol = !1 === this.options.ssl ? "http://" : "https://" }, _initParams: function (t) { t || (t = "WMTS"), this.params = a.default.get({ key: this.options.apiKey, layer: this.options.layer, service: t }), this.params && 0 !== Object.keys(this.params).length || (this.params = {}, this.options.apiKey || c.log("WARNING PARAM_MISSING : parameter 'apiKey' is mandatory if the contract key configuration has not been loaded !")) }, WMS: function (t, e) { var i = s.default.getLogger("layers-wms"); this.options = t || {}, this._initOptions(), this.settings = e || {}, this._initContext(), this._initParams("WMS"), i.log(this.params); var n = null; n = this.params.key || this.options.apiKey ? this.params.url || o.a.Util.template("https://wxs.ign.fr/{key}/geoportail/r/wms", { key: this.params.key || this.options.apiKey }) : o.a.Util.template(this.serviceUrl, { layer: this.options.layer }); var a = { layers: this.options.layer, styles: this.params.styles || "normal", format: this.params.format || "image/jpeg", version: this.params.version || "1.3.0" }, l = { minZoom: this.params.minZoom || 1, maxZoom: this.params.maxZoom || 21 }; return o.a.Util.extend(a, this.settings), o.a.Util.extend(l, this.settings), new r.default(n.replace(/(http|https):\/\//, this.protocol), { paramsNative: l, paramsWms: a, originators: this.params.originators || [], legends: this.params.legends || [], metadata: this.params.metadata || [], title: this.params.title || null, description: this.params.description || null, quicklookUrl: this.params.quicklookUrl || null }) }, WMTS: function (t, e) { var i = s.default.getLogger("layers-wmts"); this.options = t || {}, this._initOptions(), this.settings = e || {}, this._initContext(), this._initParams("WMTS"), i.log(this.params); var n = null; n = this.params.key || this.options.apiKey ? this.params.url || o.a.Util.template("https://wxs.ign.fr/{key}/geoportail/wmts", { key: this.params.key || this.options.apiKey }) : o.a.Util.template(this.serviceUrl, { layer: this.options.layer }); var a = { layer: this.options.layer, style: this.params.styles || "normal", format: this.params.format || "image/jpeg", version: this.params.version || "1.0.0", tilematrixset: this.params.TMSLink || "PM" }, r = { minZoom: this.params.minZoom || 1, maxZoom: this.params.maxZoom || 21 }; return o.a.Util.extend(a, this.settings), o.a.Util.extend(r, this.settings), new l.default(n.replace(/(http|https):\/\//, this.protocol), { paramsNative: r, paramsWmts: a, originators: this.params.originators || [], legends: this.params.legends || [], metadata: this.params.metadata || [], title: this.params.title || "", description: this.params.description || "", quicklookUrl: this.params.quicklookUrl || "" }) } }; e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = i(34), o = i(132), s = i(163), a = n.default.getLogger("layer-config"), r = { get: function (t) { var e = {}; if (o.default.isConfigLoaded()) { if ((e = o.default.getLayerParams(t.layer, t.service, t.key)) && 0 !== Object.keys(e).length) return e.minZoom = s.default.getZoomLevelFromScaleDenominator(e.maxScale) || 1, e.maxZoom = s.default.getZoomLevelFromScaleDenominator(e.minScale) || 21, e; a.warn("WARNING AUTOCONF_FAILED : params not found ?!") } else a.warn("WARNING AUTOCONF_MISSING : contract key configuration has to be loaded to load Geoportal layers !") } }; e.default = r }, function (t, e, i) { "use strict"; i.r(e); var n = { getZoomLevelFromScaleDenominator: function (t, e) { var i = {}; if ("EPSG:2154" === e) i = { 0: 104579.224549894, 1: 52277.5323537905, 2: 26135.4870785954, 3: 13066.8913818, 4: 6533.2286041135, 5: 3266.5595244627, 6: 1633.2660045974, 7: 816.629554986, 8: 408.3139146768, 9: 204.1567415109, 10: 102.0783167832, 11: 51.0391448966, 12: 25.5195690743, 13: 12.7597836936, 14: 6.379891636, 15: 3.1899457653, 16: 1.5949728695, 17: .7974864315, 18: .3987432149, 19: .1993716073, 20: .0996858037, 21: .0498429018 }; else i = { 0: 156543.033928041, 1: 78271.51696402048, 2: 39135.758482010235, 3: 19567.87924100512, 4: 9783.93962050256, 5: 4891.96981025128, 6: 2445.98490512564, 7: 1222.99245256282, 8: 611.49622628141, 9: 305.7481131407048, 10: 152.8740565703525, 11: 76.43702828517624, 12: 38.21851414258813, 13: 19.10925707129406, 14: 9.554628535647032, 15: 4.777314267823516, 16: 2.388657133911758, 17: 1.194328566955879, 18: .5971642834779395, 19: .2985821417389697, 20: .1492910708694849, 21: .0746455354347424 }; var n = 28e-5 * t; for (var o in i) if (i.hasOwnProperty(o) && i[o] <= n) return o = parseInt(o, 10); return 0 }, getAttributions: function (t) { var e = t.zoom, i = []; if (null != t.originators && t.visibility) for (var n, o = 0, s = t.originators.length; o < s; o++) { n = !0; for (var a = t.originators[o], r = t.originators[o].constraints || [], l = 0, c = r.length; l < c; l++) { var u = r[l]; n = !0; var h = this.getZoomLevelFromScaleDenominator(u.maxScaleDenominator, t.crs), d = this.getZoomLevelFromScaleDenominator(u.minScaleDenominator, t.crs) || 21; h && h > e && (n = !1), n && d && d < e && (n = !1); var p = u.bbox; if (n && p) { n = !1; var m = t.extent; if (m) { var f = [p.top, p.left, p.bottom, p.right]; if (this.intersects(m, f)) { n = !0; break } } } } if (n) { var g = a.logo, _ = a.url, v = a.name ? a.name : "", y = a.attribution, E = document.createElement("div"); E.className = "gp-control-attribution"; var w = null; (w = document.createElement("a")).className = "gp-control-attribution-link", w.target = "_blank", E.appendChild(w), _ && (w.href = _); var b = null; !!g ? (b = document.createElement("img"), w ? (b.className = "gp-control-attribution-image", w.appendChild(b)) : (b.className = "", E.appendChild(b)), b.src = g, b.title = y || v, b.style.height = "30px", b.style.width = "30px") : w.textContent = v || (y || (_ || "")), i.push(E.innerHTML + " ") } } return i }, intersects: function (t, e) { var i = t[1] <= e[3] && e[1] <= t[3], n = t[2] <= e[0] && e[2] <= t[0]; return i && n } }; e.default = n }, function (t, e, i) { "use strict"; i.r(e); var n = i(40), o = i(2), s = i.n(o), a = i(34), r = i(165), l = i(1), c = a.default.getLogger("wms"), u = s.a.TileLayer.WMS.extend({ includes: r.default, initialize: function (t, e) { var i = {}; s.a.Util.extend(i, e.paramsWms, e.paramsNative), s.a.TileLayer.WMS.prototype.initialize.call(this, n.default.Helper.normalyzeUrl(t, { "gp-leaflet-ext": l.leafletExtVersion || l.version }, !1), i), this._originators = e.originators, this._legends = e.legends, this._metadata = e.metadata, this._title = e.title, this._description = e.description, this._quicklookUrl = e.quicklookUrl, this._geoportal_id = 0 }, onAdd: function (t) { c.trace("onAdd layer", this._geoportal_id), this._map = t, this._geoportal_id = s.a.stamp(this), s.a.TileLayer.WMS.prototype.onAdd.call(this, t), this.setVisible(!0), this.updateAttributions(t), t.on({ overlayremove: this._onRemoveLayer, overlayadd: this._onAddLayer, layerremove: this._onRemoveLayer, layeradd: this._onAddLayer, moveend: this._onMoveEndLayer }, this) }, onRemove: function (t) { c.trace("onRemove layer", this._geoportal_id), this._map = t, s.a.TileLayer.prototype.onRemove.call(this, t), this.setVisible(!1), this.removeAttributions(t), t.off({ overlayremove: this._onRemoveLayer, overlayadd: this._onAddLayer, layerremove: this._onRemoveLayer, layeradd: this._onAddLayer, moveend: this._onMoveEndLayer }, this) }, getTileUrl: function (t) { var e = this._map, i = this.options.tileSize, n = t.multiplyBy(i), o = n.add([i, i]), a = this._crs.project(e.unproject(n, t.z)), r = this._crs.project(e.unproject(o, t.z)), l = this._wmsVersion >= 1.3 && -1 !== ["EPSG:4326"].indexOf(this._crs.code) ? [r.y, a.x, a.y, r.x].join(",") : [a.x, r.y, r.x, a.y].join(","), c = s.a.Util.template(this._url, { s: this._getSubdomain(t) }); return c + s.a.Util.getParamString(this.wmsParams, c, !0) + "&BBOX=" + l } }); e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = i(34), o = i(163), s = n.default.getLogger("layer-event"), a = { _id: null, _attributions: [], _visibility: !0, _originators: [], isEnable: function (t) { return !!t.attributionControl }, setVisible: function (t) { s.log("visibility", t), this._visibility = t, this.fire("visibilitychange") }, getVisible: function () { return this._visibility }, _onRemoveLayer: function (t) { s.trace("onRemove event", t), t.layer._geoportal_id === this._geoportal_id && this.setVisible(!1) }, _onAddLayer: function (t) { s.trace("onAdd event", t), t.layer._geoportal_id === this._geoportal_id && this.setVisible(!0) }, _onMoveEndLayer: function (t) { s.trace("moveend event", t), this.updateAttributions(this._map, this) }, updateAttributions: function (t) { this.isEnable(t) && (this.removeAttributions(t), this.addAttributions(t), this.fire("attributionchange")) }, removeAttributions: function (t) { if (s.trace("removeAttributions...", this._geoportal_id), this.isEnable(t)) { for (var e = 0; e < this._attributions.length; e++)t.attributionControl.removeAttribution(this._attributions[e]); this._attributions = [] } }, addAttributions: function (t) { if (s.trace("addAttributions...", this._geoportal_id), this.isEnable(t)) { var e = t.getBounds().getNorthWest(), i = t.getBounds().getSouthEast(), n = { extent: [e.lat, e.lng, i.lat, i.lng], zoom: t.getZoom(), originators: this._originators, visibility: this._visibility }; s.log(n); var a = o.default.getAttributions(n); if (s.log(a), a && 0 !== a.length) for (var r = 0; r < a.length; r++)this._attributions.push(a[r]), t.attributionControl.addAttribution(a[r]) } } }; e.default = a }, function (t, e, i) { "use strict"; i.r(e); var n = i(40), o = i(2), s = i.n(o), a = i(34), r = i(165), l = i(1), c = a.default.getLogger("wmts"), u = s.a.TileLayer.extend({ includes: r.default, defaultWmtsParams: { service: "WMTS", request: "GetTile", version: "1.0.0", layer: "", style: "", tilematrixset: "PM", format: "image/jpeg" }, initialize: function (t, e) { c.log("initialize"), this._wmtsParams = {}, s.a.Util.extend(this._wmtsParams, this.defaultWmtsParams, e.paramsWmts), s.a.TileLayer.prototype.initialize.call(this, n.default.Helper.normalyzeUrl(t, { "gp-leaflet-ext": l.leafletExtVersion || l.version }, !1), e.paramsNative), this._originators = e.originators, this._legends = e.legends, this._metadata = e.metadata, this._title = e.title, this._description = e.description, this._quicklookUrl = e.quicklookUrl, this._geoportal_id = 0 }, onAdd: function (t) { c.trace("onAdd layer", this._geoportal_id), this._map = t, this._geoportal_id = s.a.stamp(this), s.a.TileLayer.prototype.onAdd.call(this, t), this.setVisible(!0), this.updateAttributions(t), t.on({ overlayremove: this._onRemoveLayer, overlayadd: this._onAddLayer, layerremove: this._onRemoveLayer, layeradd: this._onAddLayer, moveend: this._onMoveEndLayer }, this) }, onRemove: function (t) { c.trace("onRemove layer", this._geoportal_id), this._map = t, s.a.TileLayer.prototype.onRemove.call(this, t), this.setVisible(!1), this.removeAttributions(t), t.off({ overlayremove: this._onRemoveLayer, overlayadd: this._onAddLayer, layerremove: this._onRemoveLayer, layeradd: this._onAddLayer, moveend: this._onMoveEndLayer }, this) }, getTileUrl: function (t) { var e = this._getZoomForUrl(), i = s.a.Util.template(this._url, { s: this._getSubdomain(t) }); return i + s.a.Util.getParamString(this._wmtsParams, i) + "&tilematrix=" + e + "&tilerow=" + t.y + "&tilecol=" + t.x }, setParams: function (t, e) { return s.a.extend(this._wmtsParams, t), e || this.redraw(), this } }); e.default = u }, function (t, e, i) { "use strict"; i.r(e); var n = i(40); !function () { var t = document.getElementsByTagName("script"), e = t[t.length - 1].getAttribute("data-key"); if (e) { var i = e.split(/;|,|\|/); if (i.length > 1) { for (var o = [], s = 0; s < i.length; s++)o.push(i[s]); e = o } } var a = t[t.length - 1].getAttribute("data-url"), r = t[t.length - 1].getAttribute("data-timeout"); if (e || a) { var l = { apiKey: e, onSuccess: function () { }, onFailure: function (t) { throw new Error("Configuration load failed : " + t.message) } }; a && (l.serverUrl = a, l.callbackSuffix = ""), r && (l.timeOut = r), n.default.Config || n.default.Services.getConfig(l) } }() }, function (t, e, i) { "use strict"; i.r(e); var n = i(34), o = { proxifyUrl: function (t, e) { var i = n.default.getLogger("proxifyUrl"); if (!e || !e.hasOwnProperty("proxyUrl") || null === e.proxyUrl || 0 === e.proxyUrl.trim().length) return t; if (e.noProxyDomains && Array.isArray(e.noProxyDomains) && e.noProxyDomains.length > 0) for (var o in e.noProxyDomains) if (i.trace("[ProxyUtils] proxifyUrl : analyzing " + e.noProxyDomains[o]), -1 !== t.indexOf(e.noProxyDomains[o])) return i.info("[ProxyUtils] proxifyUrl : " + t + " found in noProxyDomains list (" + e.noProxyDomains[o] + ")."), t; return e.proxyUrl + encodeURIComponent(t) } }; e.default = o }, function (t, e, i) { "use strict"; i.r(e); var n = { rgbaToHex: function (t) { function e(t) { if (t > 255) throw new Error("'" + t + "'' is greater than 255(0xff);"); return ("0" + Number(t).toString(16)).slice(-2) } var i = /rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(0?.?\d+)\s*)?\)/.exec(t); if (!i) throw new Error("Invalid format: " + t); var n = i[1], o = i[2], s = i[3], a = i[4], r = [e(n), e(o), e(s)], l = {}; return l.hex = "#" + r.join(""), a && (l.opacity = parseFloat(a)), l }, hexToRgba: function (t, e) { if (!t) throw new Error("Invalid format"); t = t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i, (function (t, e, i, n) { return e + e + i + i + n + n })); var i = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t); return (i = i ? { r: parseInt(i[1], 16), g: parseInt(i[2], 16), b: parseInt(i[3], 16) } : null) ? "rgba(" + i.r + ", " + i.g + ", " + i.b + ", " + e + ")" : null }, isHex: function (t) { if (!t) return !1; if ("#" !== t.charAt(0)) return !1; return !!/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t) }, isRGB: function (t) { if (!t) return !1; return !!/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(0?.?\d+)\s*)?\)/.exec(t) } }; e.default = n }])
}));
